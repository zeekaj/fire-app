var wW=Object.defineProperty;var QO=t=>{throw TypeError(t)};var _W=(t,e,n)=>e in t?wW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ae=(t,e,n)=>_W(t,typeof e!="symbol"?e+"":e,n),kj=(t,e,n)=>e.has(t)||QO("Cannot "+n);var h=(t,e,n)=>(kj(t,e,"read from private field"),n?n.call(t):e.get(t)),E=(t,e,n)=>e.has(t)?QO("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),k=(t,e,n,r)=>(kj(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),C=(t,e,n)=>(kj(t,e,"access private method"),n);var Vt=(t,e,n,r)=>({set _(i){k(t,e,i,n)},get _(){return h(t,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function SW(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var VF={exports:{}},JS={},YF={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jb=Symbol.for("react.element"),AW=Symbol.for("react.portal"),jW=Symbol.for("react.fragment"),kW=Symbol.for("react.strict_mode"),NW=Symbol.for("react.profiler"),EW=Symbol.for("react.provider"),CW=Symbol.for("react.context"),PW=Symbol.for("react.forward_ref"),TW=Symbol.for("react.suspense"),OW=Symbol.for("react.memo"),MW=Symbol.for("react.lazy"),JO=Symbol.iterator;function RW(t){return t===null||typeof t!="object"?null:(t=JO&&t[JO]||t["@@iterator"],typeof t=="function"?t:null)}var XF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QF=Object.assign,JF={};function Og(t,e,n){this.props=t,this.context=e,this.refs=JF,this.updater=n||XF}Og.prototype.isReactComponent={};Og.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Og.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ZF(){}ZF.prototype=Og.prototype;function SP(t,e,n){this.props=t,this.context=e,this.refs=JF,this.updater=n||XF}var AP=SP.prototype=new ZF;AP.constructor=SP;QF(AP,Og.prototype);AP.isPureReactComponent=!0;var ZO=Array.isArray,e3=Object.prototype.hasOwnProperty,jP={current:null},t3={key:!0,ref:!0,__self:!0,__source:!0};function n3(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)e3.call(e,r)&&!t3.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:jb,type:t,key:s,ref:a,props:i,_owner:jP.current}}function IW(t,e){return{$$typeof:jb,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kP(t){return typeof t=="object"&&t!==null&&t.$$typeof===jb}function DW(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var eM=/\/+/g;function Nj(t,e){return typeof t=="object"&&t!==null&&t.key!=null?DW(""+t.key):e.toString(36)}function qw(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case jb:case AW:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+Nj(a,0):r,ZO(i)?(n="",t!=null&&(n=t.replace(eM,"$&/")+"/"),qw(i,e,n,"",function(u){return u})):i!=null&&(kP(i)&&(i=IW(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(eM,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",ZO(t))for(var o=0;o<t.length;o++){s=t[o];var l=r+Nj(s,o);a+=qw(s,e,n,l,i)}else if(l=RW(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=r+Nj(s,o++),a+=qw(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Xb(t,e,n){if(t==null)return t;var r=[],i=0;return qw(t,r,"","",function(s){return e.call(n,s,i++)}),r}function $W(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ur={current:null},Gw={transition:null},LW={ReactCurrentDispatcher:Ur,ReactCurrentBatchConfig:Gw,ReactCurrentOwner:jP};function r3(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:Xb,forEach:function(t,e,n){Xb(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xb(t,function(){e++}),e},toArray:function(t){return Xb(t,function(e){return e})||[]},only:function(t){if(!kP(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=Og;Le.Fragment=jW;Le.Profiler=NW;Le.PureComponent=SP;Le.StrictMode=kW;Le.Suspense=TW;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LW;Le.act=r3;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=QF({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=jP.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)e3.call(e,l)&&!t3.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:jb,type:t.type,key:i,ref:s,props:r,_owner:a}};Le.createContext=function(t){return t={$$typeof:CW,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EW,_context:t},t.Consumer=t};Le.createElement=n3;Le.createFactory=function(t){var e=n3.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:PW,render:t}};Le.isValidElement=kP;Le.lazy=function(t){return{$$typeof:MW,_payload:{_status:-1,_result:t},_init:$W}};Le.memo=function(t,e){return{$$typeof:OW,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Gw.transition;Gw.transition={};try{t()}finally{Gw.transition=e}};Le.unstable_act=r3;Le.useCallback=function(t,e){return Ur.current.useCallback(t,e)};Le.useContext=function(t){return Ur.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return Ur.current.useDeferredValue(t)};Le.useEffect=function(t,e){return Ur.current.useEffect(t,e)};Le.useId=function(){return Ur.current.useId()};Le.useImperativeHandle=function(t,e,n){return Ur.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return Ur.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return Ur.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return Ur.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return Ur.current.useReducer(t,e,n)};Le.useRef=function(t){return Ur.current.useRef(t)};Le.useState=function(t){return Ur.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return Ur.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return Ur.current.useTransition()};Le.version="18.3.1";YF.exports=Le;var T=YF.exports;const D=at(T);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FW=T,BW=Symbol.for("react.element"),UW=Symbol.for("react.fragment"),zW=Object.prototype.hasOwnProperty,WW=FW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HW={key:!0,ref:!0,__self:!0,__source:!0};function i3(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)zW.call(e,r)&&!HW.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:BW,type:t,key:s,ref:a,props:i,_owner:WW.current}}JS.Fragment=UW;JS.jsx=i3;JS.jsxs=i3;VF.exports=JS;var c=VF.exports,Yk={},s3={exports:{}},Ki={},a3={exports:{}},o3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,K){var H=U.length;U.push(K);e:for(;0<H;){var Q=H-1>>>1,B=U[Q];if(0<i(B,K))U[Q]=K,U[H]=B,H=Q;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var K=U[0],H=U.pop();if(H!==K){U[0]=H;e:for(var Q=0,B=U.length,Y=B>>>1;Q<Y;){var ne=2*(Q+1)-1,V=U[ne],te=ne+1,$=U[te];if(0>i(V,H))te<B&&0>i($,V)?(U[Q]=$,U[te]=H,Q=te):(U[Q]=V,U[ne]=H,Q=ne);else if(te<B&&0>i($,H))U[Q]=$,U[te]=H,Q=te;else break e}}return K}function i(U,K){var H=U.sortIndex-K.sortIndex;return H!==0?H:U.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,f=null,p=3,m=!1,y=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var K=n(u);K!==null;){if(K.callback===null)r(u);else if(K.startTime<=U)r(u),K.sortIndex=K.expirationTime,e(l,K);else break;K=n(u)}}function S(U){if(g=!1,w(U),!y)if(n(l)!==null)y=!0,F(_);else{var K=n(u);K!==null&&z(S,K.startTime-U)}}function _(U,K){y=!1,g&&(g=!1,b(N),N=-1),m=!0;var H=p;try{for(w(K),f=n(l);f!==null&&(!(f.expirationTime>K)||U&&!M());){var Q=f.callback;if(typeof Q=="function"){f.callback=null,p=f.priorityLevel;var B=Q(f.expirationTime<=K);K=t.unstable_now(),typeof B=="function"?f.callback=B:f===n(l)&&r(l),w(K)}else r(l);f=n(l)}if(f!==null)var Y=!0;else{var ne=n(u);ne!==null&&z(S,ne.startTime-K),Y=!1}return Y}finally{f=null,p=H,m=!1}}var A=!1,j=null,N=-1,P=5,O=-1;function M(){return!(t.unstable_now()-O<P)}function R(){if(j!==null){var U=t.unstable_now();O=U;var K=!0;try{K=j(!0,U)}finally{K?I():(A=!1,j=null)}}else A=!1}var I;if(typeof x=="function")I=function(){x(R)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,W=L.port2;L.port1.onmessage=R,I=function(){W.postMessage(null)}}else I=function(){v(R,0)};function F(U){j=U,A||(A=!0,I())}function z(U,K){N=v(function(){U(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,F(_))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var H=p;p=K;try{return U()}finally{p=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,K){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var H=p;p=U;try{return K()}finally{p=H}},t.unstable_scheduleCallback=function(U,K,H){var Q=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Q+H:Q):H=Q,U){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=H+B,U={id:d++,callback:K,priorityLevel:U,startTime:H,expirationTime:B,sortIndex:-1},H>Q?(U.sortIndex=H,e(u,U),n(l)===null&&U===n(u)&&(g?(b(N),N=-1):g=!0,z(S,H-Q))):(U.sortIndex=B,e(l,U),y||m||(y=!0,F(_))),U},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(U){var K=p;return function(){var H=p;p=K;try{return U.apply(this,arguments)}finally{p=H}}}})(o3);a3.exports=o3;var qW=a3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GW=T,Gi=qW;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l3=new Set,_0={};function Jh(t,e){Ym(t,e),Ym(t+"Capture",e)}function Ym(t,e){for(_0[t]=e,t=0;t<e.length;t++)l3.add(e[t])}var vl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xk=Object.prototype.hasOwnProperty,KW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,tM={},nM={};function VW(t){return Xk.call(nM,t)?!0:Xk.call(tM,t)?!1:KW.test(t)?nM[t]=!0:(tM[t]=!0,!1)}function YW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function XW(t,e,n,r){if(e===null||typeof e>"u"||YW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zr(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var rr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rr[t]=new zr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rr[e]=new zr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rr[t]=new zr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rr[t]=new zr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rr[t]=new zr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rr[t]=new zr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rr[t]=new zr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rr[t]=new zr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rr[t]=new zr(t,5,!1,t.toLowerCase(),null,!1,!1)});var NP=/[\-:]([a-z])/g;function EP(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(NP,EP);rr[e]=new zr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(NP,EP);rr[e]=new zr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(NP,EP);rr[e]=new zr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rr[t]=new zr(t,1,!1,t.toLowerCase(),null,!1,!1)});rr.xlinkHref=new zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rr[t]=new zr(t,1,!1,t.toLowerCase(),null,!0,!0)});function CP(t,e,n,r){var i=rr.hasOwnProperty(e)?rr[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(XW(e,n,i,r)&&(n=null),r||i===null?VW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Nl=GW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qb=Symbol.for("react.element"),Of=Symbol.for("react.portal"),Mf=Symbol.for("react.fragment"),PP=Symbol.for("react.strict_mode"),Qk=Symbol.for("react.profiler"),c3=Symbol.for("react.provider"),u3=Symbol.for("react.context"),TP=Symbol.for("react.forward_ref"),Jk=Symbol.for("react.suspense"),Zk=Symbol.for("react.suspense_list"),OP=Symbol.for("react.memo"),Hl=Symbol.for("react.lazy"),d3=Symbol.for("react.offscreen"),rM=Symbol.iterator;function ey(t){return t===null||typeof t!="object"?null:(t=rM&&t[rM]||t["@@iterator"],typeof t=="function"?t:null)}var Kt=Object.assign,Ej;function Ny(t){if(Ej===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ej=e&&e[1]||""}return`
`+Ej+t}var Cj=!1;function Pj(t,e){if(!t||Cj)return"";Cj=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Cj=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ny(t):""}function QW(t){switch(t.tag){case 5:return Ny(t.type);case 16:return Ny("Lazy");case 13:return Ny("Suspense");case 19:return Ny("SuspenseList");case 0:case 2:case 15:return t=Pj(t.type,!1),t;case 11:return t=Pj(t.type.render,!1),t;case 1:return t=Pj(t.type,!0),t;default:return""}}function eN(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Mf:return"Fragment";case Of:return"Portal";case Qk:return"Profiler";case PP:return"StrictMode";case Jk:return"Suspense";case Zk:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case u3:return(t.displayName||"Context")+".Consumer";case c3:return(t._context.displayName||"Context")+".Provider";case TP:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case OP:return e=t.displayName||null,e!==null?e:eN(t.type)||"Memo";case Hl:e=t._payload,t=t._init;try{return eN(t(e))}catch{}}return null}function JW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return eN(e);case 8:return e===PP?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function h3(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ZW(t){var e=h3(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jb(t){t._valueTracker||(t._valueTracker=ZW(t))}function f3(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=h3(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function F1(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tN(t,e){var n=e.checked;return Kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function iM(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=pu(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function p3(t,e){e=e.checked,e!=null&&CP(t,"checked",e,!1)}function nN(t,e){p3(t,e);var n=pu(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?rN(t,e.type,n):e.hasOwnProperty("defaultValue")&&rN(t,e.type,pu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function sM(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function rN(t,e,n){(e!=="number"||F1(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ey=Array.isArray;function tp(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+pu(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function iN(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return Kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function aM(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(Ey(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:pu(n)}}function m3(t,e){var n=pu(e.value),r=pu(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function oM(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function g3(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sN(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?g3(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zb,y3=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zb=Zb||document.createElement("div"),Zb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function S0(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var t0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eH=["Webkit","ms","Moz","O"];Object.keys(t0).forEach(function(t){eH.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),t0[e]=t0[t]})});function v3(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||t0.hasOwnProperty(t)&&t0[t]?(""+e).trim():e+"px"}function x3(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=v3(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var tH=Kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function aN(t,e){if(e){if(tH[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function oN(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lN=null;function MP(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cN=null,np=null,rp=null;function lM(t){if(t=Eb(t)){if(typeof cN!="function")throw Error(le(280));var e=t.stateNode;e&&(e=rA(e),cN(t.stateNode,t.type,e))}}function b3(t){np?rp?rp.push(t):rp=[t]:np=t}function w3(){if(np){var t=np,e=rp;if(rp=np=null,lM(t),e)for(t=0;t<e.length;t++)lM(e[t])}}function _3(t,e){return t(e)}function S3(){}var Tj=!1;function A3(t,e,n){if(Tj)return t(e,n);Tj=!0;try{return _3(t,e,n)}finally{Tj=!1,(np!==null||rp!==null)&&(S3(),w3())}}function A0(t,e){var n=t.stateNode;if(n===null)return null;var r=rA(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var uN=!1;if(vl)try{var ty={};Object.defineProperty(ty,"passive",{get:function(){uN=!0}}),window.addEventListener("test",ty,ty),window.removeEventListener("test",ty,ty)}catch{uN=!1}function nH(t,e,n,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var n0=!1,B1=null,U1=!1,dN=null,rH={onError:function(t){n0=!0,B1=t}};function iH(t,e,n,r,i,s,a,o,l){n0=!1,B1=null,nH.apply(rH,arguments)}function sH(t,e,n,r,i,s,a,o,l){if(iH.apply(this,arguments),n0){if(n0){var u=B1;n0=!1,B1=null}else throw Error(le(198));U1||(U1=!0,dN=u)}}function Zh(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function j3(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function cM(t){if(Zh(t)!==t)throw Error(le(188))}function aH(t){var e=t.alternate;if(!e){if(e=Zh(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return cM(i),t;if(s===r)return cM(i),e;s=s.sibling}throw Error(le(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(le(189))}}if(n.alternate!==r)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function k3(t){return t=aH(t),t!==null?N3(t):null}function N3(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=N3(t);if(e!==null)return e;t=t.sibling}return null}var E3=Gi.unstable_scheduleCallback,uM=Gi.unstable_cancelCallback,oH=Gi.unstable_shouldYield,lH=Gi.unstable_requestPaint,ln=Gi.unstable_now,cH=Gi.unstable_getCurrentPriorityLevel,RP=Gi.unstable_ImmediatePriority,C3=Gi.unstable_UserBlockingPriority,z1=Gi.unstable_NormalPriority,uH=Gi.unstable_LowPriority,P3=Gi.unstable_IdlePriority,ZS=null,Qa=null;function dH(t){if(Qa&&typeof Qa.onCommitFiberRoot=="function")try{Qa.onCommitFiberRoot(ZS,t,void 0,(t.current.flags&128)===128)}catch{}}var la=Math.clz32?Math.clz32:pH,hH=Math.log,fH=Math.LN2;function pH(t){return t>>>=0,t===0?32:31-(hH(t)/fH|0)|0}var ew=64,tw=4194304;function Cy(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function W1(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=Cy(o):(s&=a,s!==0&&(r=Cy(s)))}else a=n&~i,a!==0?r=Cy(a):s!==0&&(r=Cy(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-la(e),i=1<<n,r|=t[n],e&=~i;return r}function mH(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gH(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-la(s),o=1<<a,l=i[a];l===-1?(!(o&n)||o&r)&&(i[a]=mH(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function hN(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function T3(){var t=ew;return ew<<=1,!(ew&4194240)&&(ew=64),t}function Oj(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function kb(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-la(e),t[e]=n}function yH(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-la(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function IP(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-la(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var st=0;function O3(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var M3,DP,R3,I3,D3,fN=!1,nw=[],ru=null,iu=null,su=null,j0=new Map,k0=new Map,Kl=[],vH="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dM(t,e){switch(t){case"focusin":case"focusout":ru=null;break;case"dragenter":case"dragleave":iu=null;break;case"mouseover":case"mouseout":su=null;break;case"pointerover":case"pointerout":j0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":k0.delete(e.pointerId)}}function ny(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Eb(e),e!==null&&DP(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function xH(t,e,n,r,i){switch(e){case"focusin":return ru=ny(ru,t,e,n,r,i),!0;case"dragenter":return iu=ny(iu,t,e,n,r,i),!0;case"mouseover":return su=ny(su,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return j0.set(s,ny(j0.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,k0.set(s,ny(k0.get(s)||null,t,e,n,r,i)),!0}return!1}function $3(t){var e=Zu(t.target);if(e!==null){var n=Zh(e);if(n!==null){if(e=n.tag,e===13){if(e=j3(n),e!==null){t.blockedOn=e,D3(t.priority,function(){R3(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Kw(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pN(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);lN=r,n.target.dispatchEvent(r),lN=null}else return e=Eb(n),e!==null&&DP(e),t.blockedOn=n,!1;e.shift()}return!0}function hM(t,e,n){Kw(t)&&n.delete(e)}function bH(){fN=!1,ru!==null&&Kw(ru)&&(ru=null),iu!==null&&Kw(iu)&&(iu=null),su!==null&&Kw(su)&&(su=null),j0.forEach(hM),k0.forEach(hM)}function ry(t,e){t.blockedOn===e&&(t.blockedOn=null,fN||(fN=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,bH)))}function N0(t){function e(i){return ry(i,t)}if(0<nw.length){ry(nw[0],t);for(var n=1;n<nw.length;n++){var r=nw[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ru!==null&&ry(ru,t),iu!==null&&ry(iu,t),su!==null&&ry(su,t),j0.forEach(e),k0.forEach(e),n=0;n<Kl.length;n++)r=Kl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Kl.length&&(n=Kl[0],n.blockedOn===null);)$3(n),n.blockedOn===null&&Kl.shift()}var ip=Nl.ReactCurrentBatchConfig,H1=!0;function wH(t,e,n,r){var i=st,s=ip.transition;ip.transition=null;try{st=1,$P(t,e,n,r)}finally{st=i,ip.transition=s}}function _H(t,e,n,r){var i=st,s=ip.transition;ip.transition=null;try{st=4,$P(t,e,n,r)}finally{st=i,ip.transition=s}}function $P(t,e,n,r){if(H1){var i=pN(t,e,n,r);if(i===null)zj(t,e,r,q1,n),dM(t,r);else if(xH(i,t,e,n,r))r.stopPropagation();else if(dM(t,r),e&4&&-1<vH.indexOf(t)){for(;i!==null;){var s=Eb(i);if(s!==null&&M3(s),s=pN(t,e,n,r),s===null&&zj(t,e,r,q1,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else zj(t,e,r,null,n)}}var q1=null;function pN(t,e,n,r){if(q1=null,t=MP(r),t=Zu(t),t!==null)if(e=Zh(t),e===null)t=null;else if(n=e.tag,n===13){if(t=j3(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return q1=t,null}function L3(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cH()){case RP:return 1;case C3:return 4;case z1:case uH:return 16;case P3:return 536870912;default:return 16}default:return 16}}var Jc=null,LP=null,Vw=null;function F3(){if(Vw)return Vw;var t,e=LP,n=e.length,r,i="value"in Jc?Jc.value:Jc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return Vw=i.slice(t,1<r?1-r:void 0)}function Yw(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rw(){return!0}function fM(){return!1}function Vi(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?rw:fM,this.isPropagationStopped=fM,this}return Kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rw)},persist:function(){},isPersistent:rw}),e}var Mg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},FP=Vi(Mg),Nb=Kt({},Mg,{view:0,detail:0}),SH=Vi(Nb),Mj,Rj,iy,eA=Kt({},Nb,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:BP,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==iy&&(iy&&t.type==="mousemove"?(Mj=t.screenX-iy.screenX,Rj=t.screenY-iy.screenY):Rj=Mj=0,iy=t),Mj)},movementY:function(t){return"movementY"in t?t.movementY:Rj}}),pM=Vi(eA),AH=Kt({},eA,{dataTransfer:0}),jH=Vi(AH),kH=Kt({},Nb,{relatedTarget:0}),Ij=Vi(kH),NH=Kt({},Mg,{animationName:0,elapsedTime:0,pseudoElement:0}),EH=Vi(NH),CH=Kt({},Mg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),PH=Vi(CH),TH=Kt({},Mg,{data:0}),mM=Vi(TH),OH={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MH={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RH={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IH(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=RH[t])?!!e[t]:!1}function BP(){return IH}var DH=Kt({},Nb,{key:function(t){if(t.key){var e=OH[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Yw(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?MH[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:BP,charCode:function(t){return t.type==="keypress"?Yw(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yw(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$H=Vi(DH),LH=Kt({},eA,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gM=Vi(LH),FH=Kt({},Nb,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:BP}),BH=Vi(FH),UH=Kt({},Mg,{propertyName:0,elapsedTime:0,pseudoElement:0}),zH=Vi(UH),WH=Kt({},eA,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),HH=Vi(WH),qH=[9,13,27,32],UP=vl&&"CompositionEvent"in window,r0=null;vl&&"documentMode"in document&&(r0=document.documentMode);var GH=vl&&"TextEvent"in window&&!r0,B3=vl&&(!UP||r0&&8<r0&&11>=r0),yM=" ",vM=!1;function U3(t,e){switch(t){case"keyup":return qH.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function z3(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rf=!1;function KH(t,e){switch(t){case"compositionend":return z3(e);case"keypress":return e.which!==32?null:(vM=!0,yM);case"textInput":return t=e.data,t===yM&&vM?null:t;default:return null}}function VH(t,e){if(Rf)return t==="compositionend"||!UP&&U3(t,e)?(t=F3(),Vw=LP=Jc=null,Rf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return B3&&e.locale!=="ko"?null:e.data;default:return null}}var YH={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YH[t.type]:e==="textarea"}function W3(t,e,n,r){b3(r),e=G1(e,"onChange"),0<e.length&&(n=new FP("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var i0=null,E0=null;function XH(t){e4(t,0)}function tA(t){var e=$f(t);if(f3(e))return t}function QH(t,e){if(t==="change")return e}var H3=!1;if(vl){var Dj;if(vl){var $j="oninput"in document;if(!$j){var bM=document.createElement("div");bM.setAttribute("oninput","return;"),$j=typeof bM.oninput=="function"}Dj=$j}else Dj=!1;H3=Dj&&(!document.documentMode||9<document.documentMode)}function wM(){i0&&(i0.detachEvent("onpropertychange",q3),E0=i0=null)}function q3(t){if(t.propertyName==="value"&&tA(E0)){var e=[];W3(e,E0,t,MP(t)),A3(XH,e)}}function JH(t,e,n){t==="focusin"?(wM(),i0=e,E0=n,i0.attachEvent("onpropertychange",q3)):t==="focusout"&&wM()}function ZH(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return tA(E0)}function e7(t,e){if(t==="click")return tA(e)}function t7(t,e){if(t==="input"||t==="change")return tA(e)}function n7(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ha=typeof Object.is=="function"?Object.is:n7;function C0(t,e){if(ha(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Xk.call(e,i)||!ha(t[i],e[i]))return!1}return!0}function _M(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function SM(t,e){var n=_M(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=_M(n)}}function G3(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?G3(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function K3(){for(var t=window,e=F1();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=F1(t.document)}return e}function zP(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function r7(t){var e=K3(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&G3(n.ownerDocument.documentElement,n)){if(r!==null&&zP(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=SM(n,s);var a=SM(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var i7=vl&&"documentMode"in document&&11>=document.documentMode,If=null,mN=null,s0=null,gN=!1;function AM(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;gN||If==null||If!==F1(r)||(r=If,"selectionStart"in r&&zP(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),s0&&C0(s0,r)||(s0=r,r=G1(mN,"onSelect"),0<r.length&&(e=new FP("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=If)))}function iw(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Df={animationend:iw("Animation","AnimationEnd"),animationiteration:iw("Animation","AnimationIteration"),animationstart:iw("Animation","AnimationStart"),transitionend:iw("Transition","TransitionEnd")},Lj={},V3={};vl&&(V3=document.createElement("div").style,"AnimationEvent"in window||(delete Df.animationend.animation,delete Df.animationiteration.animation,delete Df.animationstart.animation),"TransitionEvent"in window||delete Df.transitionend.transition);function nA(t){if(Lj[t])return Lj[t];if(!Df[t])return t;var e=Df[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in V3)return Lj[t]=e[n];return t}var Y3=nA("animationend"),X3=nA("animationiteration"),Q3=nA("animationstart"),J3=nA("transitionend"),Z3=new Map,jM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wu(t,e){Z3.set(t,e),Jh(e,[t])}for(var Fj=0;Fj<jM.length;Fj++){var Bj=jM[Fj],s7=Bj.toLowerCase(),a7=Bj[0].toUpperCase()+Bj.slice(1);wu(s7,"on"+a7)}wu(Y3,"onAnimationEnd");wu(X3,"onAnimationIteration");wu(Q3,"onAnimationStart");wu("dblclick","onDoubleClick");wu("focusin","onFocus");wu("focusout","onBlur");wu(J3,"onTransitionEnd");Ym("onMouseEnter",["mouseout","mouseover"]);Ym("onMouseLeave",["mouseout","mouseover"]);Ym("onPointerEnter",["pointerout","pointerover"]);Ym("onPointerLeave",["pointerout","pointerover"]);Jh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Py="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o7=new Set("cancel close invalid load scroll toggle".split(" ").concat(Py));function kM(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,sH(r,e,void 0,t),t.currentTarget=null}function e4(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;kM(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;kM(i,o,u),s=l}}}if(U1)throw t=dN,U1=!1,dN=null,t}function Ct(t,e){var n=e[wN];n===void 0&&(n=e[wN]=new Set);var r=t+"__bubble";n.has(r)||(t4(e,t,2,!1),n.add(r))}function Uj(t,e,n){var r=0;e&&(r|=4),t4(n,t,r,e)}var sw="_reactListening"+Math.random().toString(36).slice(2);function P0(t){if(!t[sw]){t[sw]=!0,l3.forEach(function(n){n!=="selectionchange"&&(o7.has(n)||Uj(n,!1,t),Uj(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[sw]||(e[sw]=!0,Uj("selectionchange",!1,e))}}function t4(t,e,n,r){switch(L3(e)){case 1:var i=wH;break;case 4:i=_H;break;default:i=$P}n=i.bind(null,e,n,t),i=void 0,!uN||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function zj(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Zu(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}A3(function(){var u=s,d=MP(n),f=[];e:{var p=Z3.get(t);if(p!==void 0){var m=FP,y=t;switch(t){case"keypress":if(Yw(n)===0)break e;case"keydown":case"keyup":m=$H;break;case"focusin":y="focus",m=Ij;break;case"focusout":y="blur",m=Ij;break;case"beforeblur":case"afterblur":m=Ij;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=pM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=jH;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=BH;break;case Y3:case X3:case Q3:m=EH;break;case J3:m=zH;break;case"scroll":m=SH;break;case"wheel":m=HH;break;case"copy":case"cut":case"paste":m=PH;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=gM}var g=(e&4)!==0,v=!g&&t==="scroll",b=g?p!==null?p+"Capture":null:p;g=[];for(var x=u,w;x!==null;){w=x;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=A0(x,b),S!=null&&g.push(T0(x,S,w)))),v)break;x=x.return}0<g.length&&(p=new m(p,y,null,n,d),f.push({event:p,listeners:g}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&n!==lN&&(y=n.relatedTarget||n.fromElement)&&(Zu(y)||y[xl]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=n.relatedTarget||n.toElement,m=u,y=y?Zu(y):null,y!==null&&(v=Zh(y),y!==v||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(g=pM,S="onMouseLeave",b="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=gM,S="onPointerLeave",b="onPointerEnter",x="pointer"),v=m==null?p:$f(m),w=y==null?p:$f(y),p=new g(S,x+"leave",m,n,d),p.target=v,p.relatedTarget=w,S=null,Zu(d)===u&&(g=new g(b,x+"enter",y,n,d),g.target=w,g.relatedTarget=v,S=g),v=S,m&&y)t:{for(g=m,b=y,x=0,w=g;w;w=lf(w))x++;for(w=0,S=b;S;S=lf(S))w++;for(;0<x-w;)g=lf(g),x--;for(;0<w-x;)b=lf(b),w--;for(;x--;){if(g===b||b!==null&&g===b.alternate)break t;g=lf(g),b=lf(b)}g=null}else g=null;m!==null&&NM(f,p,m,g,!1),y!==null&&v!==null&&NM(f,v,y,g,!0)}}e:{if(p=u?$f(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var _=QH;else if(xM(p))if(H3)_=t7;else{_=ZH;var A=JH}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(_=e7);if(_&&(_=_(t,u))){W3(f,_,n,d);break e}A&&A(t,p,u),t==="focusout"&&(A=p._wrapperState)&&A.controlled&&p.type==="number"&&rN(p,"number",p.value)}switch(A=u?$f(u):window,t){case"focusin":(xM(A)||A.contentEditable==="true")&&(If=A,mN=u,s0=null);break;case"focusout":s0=mN=If=null;break;case"mousedown":gN=!0;break;case"contextmenu":case"mouseup":case"dragend":gN=!1,AM(f,n,d);break;case"selectionchange":if(i7)break;case"keydown":case"keyup":AM(f,n,d)}var j;if(UP)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Rf?U3(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(B3&&n.locale!=="ko"&&(Rf||N!=="onCompositionStart"?N==="onCompositionEnd"&&Rf&&(j=F3()):(Jc=d,LP="value"in Jc?Jc.value:Jc.textContent,Rf=!0)),A=G1(u,N),0<A.length&&(N=new mM(N,t,null,n,d),f.push({event:N,listeners:A}),j?N.data=j:(j=z3(n),j!==null&&(N.data=j)))),(j=GH?KH(t,n):VH(t,n))&&(u=G1(u,"onBeforeInput"),0<u.length&&(d=new mM("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=j))}e4(f,e)})}function T0(t,e,n){return{instance:t,listener:e,currentTarget:n}}function G1(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=A0(t,n),s!=null&&r.unshift(T0(t,s,i)),s=A0(t,e),s!=null&&r.push(T0(t,s,i))),t=t.return}return r}function lf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function NM(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=A0(n,s),l!=null&&a.unshift(T0(n,l,o))):i||(l=A0(n,s),l!=null&&a.push(T0(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var l7=/\r\n?/g,c7=/\u0000|\uFFFD/g;function EM(t){return(typeof t=="string"?t:""+t).replace(l7,`
`).replace(c7,"")}function aw(t,e,n){if(e=EM(e),EM(t)!==e&&n)throw Error(le(425))}function K1(){}var yN=null,vN=null;function xN(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bN=typeof setTimeout=="function"?setTimeout:void 0,u7=typeof clearTimeout=="function"?clearTimeout:void 0,CM=typeof Promise=="function"?Promise:void 0,d7=typeof queueMicrotask=="function"?queueMicrotask:typeof CM<"u"?function(t){return CM.resolve(null).then(t).catch(h7)}:bN;function h7(t){setTimeout(function(){throw t})}function Wj(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),N0(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);N0(e)}function au(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function PM(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Rg=Math.random().toString(36).slice(2),Ka="__reactFiber$"+Rg,O0="__reactProps$"+Rg,xl="__reactContainer$"+Rg,wN="__reactEvents$"+Rg,f7="__reactListeners$"+Rg,p7="__reactHandles$"+Rg;function Zu(t){var e=t[Ka];if(e)return e;for(var n=t.parentNode;n;){if(e=n[xl]||n[Ka]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=PM(t);t!==null;){if(n=t[Ka])return n;t=PM(t)}return e}t=n,n=t.parentNode}return null}function Eb(t){return t=t[Ka]||t[xl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function $f(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function rA(t){return t[O0]||null}var _N=[],Lf=-1;function _u(t){return{current:t}}function Rt(t){0>Lf||(t.current=_N[Lf],_N[Lf]=null,Lf--)}function kt(t,e){Lf++,_N[Lf]=t.current,t.current=e}var mu={},wr=_u(mu),li=_u(!1),$h=mu;function Xm(t,e){var n=t.type.contextTypes;if(!n)return mu;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ci(t){return t=t.childContextTypes,t!=null}function V1(){Rt(li),Rt(wr)}function TM(t,e,n){if(wr.current!==mu)throw Error(le(168));kt(wr,e),kt(li,n)}function n4(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(le(108,JW(t)||"Unknown",i));return Kt({},n,r)}function Y1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||mu,$h=wr.current,kt(wr,t),kt(li,li.current),!0}function OM(t,e,n){var r=t.stateNode;if(!r)throw Error(le(169));n?(t=n4(t,e,$h),r.__reactInternalMemoizedMergedChildContext=t,Rt(li),Rt(wr),kt(wr,t)):Rt(li),kt(li,n)}var bo=null,iA=!1,Hj=!1;function r4(t){bo===null?bo=[t]:bo.push(t)}function m7(t){iA=!0,r4(t)}function Su(){if(!Hj&&bo!==null){Hj=!0;var t=0,e=st;try{var n=bo;for(st=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}bo=null,iA=!1}catch(i){throw bo!==null&&(bo=bo.slice(t+1)),E3(RP,Su),i}finally{st=e,Hj=!1}}return null}var Ff=[],Bf=0,X1=null,Q1=0,ms=[],gs=0,Lh=null,al=1,ol="";function Du(t,e){Ff[Bf++]=Q1,Ff[Bf++]=X1,X1=t,Q1=e}function i4(t,e,n){ms[gs++]=al,ms[gs++]=ol,ms[gs++]=Lh,Lh=t;var r=al;t=ol;var i=32-la(r)-1;r&=~(1<<i),n+=1;var s=32-la(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,al=1<<32-la(e)+i|n<<i|r,ol=s+t}else al=1<<s|n<<i|r,ol=t}function WP(t){t.return!==null&&(Du(t,1),i4(t,1,0))}function HP(t){for(;t===X1;)X1=Ff[--Bf],Ff[Bf]=null,Q1=Ff[--Bf],Ff[Bf]=null;for(;t===Lh;)Lh=ms[--gs],ms[gs]=null,ol=ms[--gs],ms[gs]=null,al=ms[--gs],ms[gs]=null}var Wi=null,zi=null,Lt=!1,ia=null;function s4(t,e){var n=xs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function MM(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wi=t,zi=au(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wi=t,zi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Lh!==null?{id:al,overflow:ol}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wi=t,zi=null,!0):!1;default:return!1}}function SN(t){return(t.mode&1)!==0&&(t.flags&128)===0}function AN(t){if(Lt){var e=zi;if(e){var n=e;if(!MM(t,e)){if(SN(t))throw Error(le(418));e=au(n.nextSibling);var r=Wi;e&&MM(t,e)?s4(r,n):(t.flags=t.flags&-4097|2,Lt=!1,Wi=t)}}else{if(SN(t))throw Error(le(418));t.flags=t.flags&-4097|2,Lt=!1,Wi=t}}}function RM(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wi=t}function ow(t){if(t!==Wi)return!1;if(!Lt)return RM(t),Lt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xN(t.type,t.memoizedProps)),e&&(e=zi)){if(SN(t))throw a4(),Error(le(418));for(;e;)s4(t,e),e=au(e.nextSibling)}if(RM(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){zi=au(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}zi=null}}else zi=Wi?au(t.stateNode.nextSibling):null;return!0}function a4(){for(var t=zi;t;)t=au(t.nextSibling)}function Qm(){zi=Wi=null,Lt=!1}function qP(t){ia===null?ia=[t]:ia.push(t)}var g7=Nl.ReactCurrentBatchConfig;function sy(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var r=n.stateNode}if(!r)throw Error(le(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function lw(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function IM(t){var e=t._init;return e(t._payload)}function o4(t){function e(b,x){if(t){var w=b.deletions;w===null?(b.deletions=[x],b.flags|=16):w.push(x)}}function n(b,x){if(!t)return null;for(;x!==null;)e(b,x),x=x.sibling;return null}function r(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=uu(b,x),b.index=0,b.sibling=null,b}function s(b,x,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<x?(b.flags|=2,x):w):(b.flags|=2,x)):(b.flags|=1048576,x)}function a(b){return t&&b.alternate===null&&(b.flags|=2),b}function o(b,x,w,S){return x===null||x.tag!==6?(x=Qj(w,b.mode,S),x.return=b,x):(x=i(x,w),x.return=b,x)}function l(b,x,w,S){var _=w.type;return _===Mf?d(b,x,w.props.children,S,w.key):x!==null&&(x.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Hl&&IM(_)===x.type)?(S=i(x,w.props),S.ref=sy(b,x,w),S.return=b,S):(S=n1(w.type,w.key,w.props,null,b.mode,S),S.ref=sy(b,x,w),S.return=b,S)}function u(b,x,w,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=Jj(w,b.mode,S),x.return=b,x):(x=i(x,w.children||[]),x.return=b,x)}function d(b,x,w,S,_){return x===null||x.tag!==7?(x=Rh(w,b.mode,S,_),x.return=b,x):(x=i(x,w),x.return=b,x)}function f(b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Qj(""+x,b.mode,w),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Qb:return w=n1(x.type,x.key,x.props,null,b.mode,w),w.ref=sy(b,null,x),w.return=b,w;case Of:return x=Jj(x,b.mode,w),x.return=b,x;case Hl:var S=x._init;return f(b,S(x._payload),w)}if(Ey(x)||ey(x))return x=Rh(x,b.mode,w,null),x.return=b,x;lw(b,x)}return null}function p(b,x,w,S){var _=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:o(b,x,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Qb:return w.key===_?l(b,x,w,S):null;case Of:return w.key===_?u(b,x,w,S):null;case Hl:return _=w._init,p(b,x,_(w._payload),S)}if(Ey(w)||ey(w))return _!==null?null:d(b,x,w,S,null);lw(b,w)}return null}function m(b,x,w,S,_){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,o(x,b,""+S,_);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Qb:return b=b.get(S.key===null?w:S.key)||null,l(x,b,S,_);case Of:return b=b.get(S.key===null?w:S.key)||null,u(x,b,S,_);case Hl:var A=S._init;return m(b,x,w,A(S._payload),_)}if(Ey(S)||ey(S))return b=b.get(w)||null,d(x,b,S,_,null);lw(x,S)}return null}function y(b,x,w,S){for(var _=null,A=null,j=x,N=x=0,P=null;j!==null&&N<w.length;N++){j.index>N?(P=j,j=null):P=j.sibling;var O=p(b,j,w[N],S);if(O===null){j===null&&(j=P);break}t&&j&&O.alternate===null&&e(b,j),x=s(O,x,N),A===null?_=O:A.sibling=O,A=O,j=P}if(N===w.length)return n(b,j),Lt&&Du(b,N),_;if(j===null){for(;N<w.length;N++)j=f(b,w[N],S),j!==null&&(x=s(j,x,N),A===null?_=j:A.sibling=j,A=j);return Lt&&Du(b,N),_}for(j=r(b,j);N<w.length;N++)P=m(j,b,N,w[N],S),P!==null&&(t&&P.alternate!==null&&j.delete(P.key===null?N:P.key),x=s(P,x,N),A===null?_=P:A.sibling=P,A=P);return t&&j.forEach(function(M){return e(b,M)}),Lt&&Du(b,N),_}function g(b,x,w,S){var _=ey(w);if(typeof _!="function")throw Error(le(150));if(w=_.call(w),w==null)throw Error(le(151));for(var A=_=null,j=x,N=x=0,P=null,O=w.next();j!==null&&!O.done;N++,O=w.next()){j.index>N?(P=j,j=null):P=j.sibling;var M=p(b,j,O.value,S);if(M===null){j===null&&(j=P);break}t&&j&&M.alternate===null&&e(b,j),x=s(M,x,N),A===null?_=M:A.sibling=M,A=M,j=P}if(O.done)return n(b,j),Lt&&Du(b,N),_;if(j===null){for(;!O.done;N++,O=w.next())O=f(b,O.value,S),O!==null&&(x=s(O,x,N),A===null?_=O:A.sibling=O,A=O);return Lt&&Du(b,N),_}for(j=r(b,j);!O.done;N++,O=w.next())O=m(j,b,N,O.value,S),O!==null&&(t&&O.alternate!==null&&j.delete(O.key===null?N:O.key),x=s(O,x,N),A===null?_=O:A.sibling=O,A=O);return t&&j.forEach(function(R){return e(b,R)}),Lt&&Du(b,N),_}function v(b,x,w,S){if(typeof w=="object"&&w!==null&&w.type===Mf&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Qb:e:{for(var _=w.key,A=x;A!==null;){if(A.key===_){if(_=w.type,_===Mf){if(A.tag===7){n(b,A.sibling),x=i(A,w.props.children),x.return=b,b=x;break e}}else if(A.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Hl&&IM(_)===A.type){n(b,A.sibling),x=i(A,w.props),x.ref=sy(b,A,w),x.return=b,b=x;break e}n(b,A);break}else e(b,A);A=A.sibling}w.type===Mf?(x=Rh(w.props.children,b.mode,S,w.key),x.return=b,b=x):(S=n1(w.type,w.key,w.props,null,b.mode,S),S.ref=sy(b,x,w),S.return=b,b=S)}return a(b);case Of:e:{for(A=w.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(b,x.sibling),x=i(x,w.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else e(b,x);x=x.sibling}x=Jj(w,b.mode,S),x.return=b,b=x}return a(b);case Hl:return A=w._init,v(b,x,A(w._payload),S)}if(Ey(w))return y(b,x,w,S);if(ey(w))return g(b,x,w,S);lw(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(b,x.sibling),x=i(x,w),x.return=b,b=x):(n(b,x),x=Qj(w,b.mode,S),x.return=b,b=x),a(b)):n(b,x)}return v}var Jm=o4(!0),l4=o4(!1),J1=_u(null),Z1=null,Uf=null,GP=null;function KP(){GP=Uf=Z1=null}function VP(t){var e=J1.current;Rt(J1),t._currentValue=e}function jN(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function sp(t,e){Z1=t,GP=Uf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ai=!0),t.firstContext=null)}function As(t){var e=t._currentValue;if(GP!==t)if(t={context:t,memoizedValue:e,next:null},Uf===null){if(Z1===null)throw Error(le(308));Uf=t,Z1.dependencies={lanes:0,firstContext:t}}else Uf=Uf.next=t;return e}var ed=null;function YP(t){ed===null?ed=[t]:ed.push(t)}function c4(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,YP(e)):(n.next=i.next,i.next=n),e.interleaved=n,bl(t,r)}function bl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ql=!1;function XP(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function u4(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function dl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ou(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,bl(t,n)}return i=r.interleaved,i===null?(e.next=e,YP(r)):(e.next=i.next,i.next=e),r.interleaved=e,bl(t,n)}function Xw(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,IP(t,n)}}function DM(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function e_(t,e,n,r){var i=t.updateQueue;ql=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;a=0,d=u=l=null,o=s;do{var p=o.lane,m=o.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,g=o;switch(p=e,m=n,g.tag){case 1:if(y=g.payload,typeof y=="function"){f=y.call(m,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,p=typeof y=="function"?y.call(m,f,p):y,p==null)break e;f=Kt({},f,p);break e;case 2:ql=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Bh|=a,t.lanes=a,t.memoizedState=f}}function $M(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(le(191,i));i.call(r)}}}var Cb={},Ja=_u(Cb),M0=_u(Cb),R0=_u(Cb);function td(t){if(t===Cb)throw Error(le(174));return t}function QP(t,e){switch(kt(R0,e),kt(M0,t),kt(Ja,Cb),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sN(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sN(e,t)}Rt(Ja),kt(Ja,e)}function Zm(){Rt(Ja),Rt(M0),Rt(R0)}function d4(t){td(R0.current);var e=td(Ja.current),n=sN(e,t.type);e!==n&&(kt(M0,t),kt(Ja,n))}function JP(t){M0.current===t&&(Rt(Ja),Rt(M0))}var Wt=_u(0);function t_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qj=[];function ZP(){for(var t=0;t<qj.length;t++)qj[t]._workInProgressVersionPrimary=null;qj.length=0}var Qw=Nl.ReactCurrentDispatcher,Gj=Nl.ReactCurrentBatchConfig,Fh=0,qt=null,jn=null,Bn=null,n_=!1,a0=!1,I0=0,y7=0;function or(){throw Error(le(321))}function eT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ha(t[n],e[n]))return!1;return!0}function tT(t,e,n,r,i,s){if(Fh=s,qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qw.current=t===null||t.memoizedState===null?w7:_7,t=n(r,i),a0){s=0;do{if(a0=!1,I0=0,25<=s)throw Error(le(301));s+=1,Bn=jn=null,e.updateQueue=null,Qw.current=S7,t=n(r,i)}while(a0)}if(Qw.current=r_,e=jn!==null&&jn.next!==null,Fh=0,Bn=jn=qt=null,n_=!1,e)throw Error(le(300));return t}function nT(){var t=I0!==0;return I0=0,t}function xa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?qt.memoizedState=Bn=t:Bn=Bn.next=t,Bn}function js(){if(jn===null){var t=qt.alternate;t=t!==null?t.memoizedState:null}else t=jn.next;var e=Bn===null?qt.memoizedState:Bn.next;if(e!==null)Bn=e,jn=t;else{if(t===null)throw Error(le(310));jn=t,t={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},Bn===null?qt.memoizedState=Bn=t:Bn=Bn.next=t}return Bn}function D0(t,e){return typeof e=="function"?e(t):e}function Kj(t){var e=js(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=jn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var d=u.lane;if((Fh&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=f,a=r):l=l.next=f,qt.lanes|=d,Bh|=d}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,ha(r,e.memoizedState)||(ai=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,qt.lanes|=s,Bh|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vj(t){var e=js(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ha(s,e.memoizedState)||(ai=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function h4(){}function f4(t,e){var n=qt,r=js(),i=e(),s=!ha(r.memoizedState,i);if(s&&(r.memoizedState=i,ai=!0),r=r.queue,rT(g4.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Bn!==null&&Bn.memoizedState.tag&1){if(n.flags|=2048,$0(9,m4.bind(null,n,r,i,e),void 0,null),zn===null)throw Error(le(349));Fh&30||p4(n,e,i)}return i}function p4(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=qt.updateQueue,e===null?(e={lastEffect:null,stores:null},qt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function m4(t,e,n,r){e.value=n,e.getSnapshot=r,y4(e)&&v4(t)}function g4(t,e,n){return n(function(){y4(e)&&v4(t)})}function y4(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ha(t,n)}catch{return!0}}function v4(t){var e=bl(t,1);e!==null&&ca(e,t,1,-1)}function LM(t){var e=xa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:D0,lastRenderedState:t},e.queue=t,t=t.dispatch=b7.bind(null,qt,t),[e.memoizedState,t]}function $0(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=qt.updateQueue,e===null?(e={lastEffect:null,stores:null},qt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function x4(){return js().memoizedState}function Jw(t,e,n,r){var i=xa();qt.flags|=t,i.memoizedState=$0(1|e,n,void 0,r===void 0?null:r)}function sA(t,e,n,r){var i=js();r=r===void 0?null:r;var s=void 0;if(jn!==null){var a=jn.memoizedState;if(s=a.destroy,r!==null&&eT(r,a.deps)){i.memoizedState=$0(e,n,s,r);return}}qt.flags|=t,i.memoizedState=$0(1|e,n,s,r)}function FM(t,e){return Jw(8390656,8,t,e)}function rT(t,e){return sA(2048,8,t,e)}function b4(t,e){return sA(4,2,t,e)}function w4(t,e){return sA(4,4,t,e)}function _4(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function S4(t,e,n){return n=n!=null?n.concat([t]):null,sA(4,4,_4.bind(null,e,t),n)}function iT(){}function A4(t,e){var n=js();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function j4(t,e){var n=js();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function k4(t,e,n){return Fh&21?(ha(n,e)||(n=T3(),qt.lanes|=n,Bh|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ai=!0),t.memoizedState=n)}function v7(t,e){var n=st;st=n!==0&&4>n?n:4,t(!0);var r=Gj.transition;Gj.transition={};try{t(!1),e()}finally{st=n,Gj.transition=r}}function N4(){return js().memoizedState}function x7(t,e,n){var r=cu(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},E4(t))C4(e,n);else if(n=c4(t,e,n,r),n!==null){var i=$r();ca(n,t,r,i),P4(n,e,r)}}function b7(t,e,n){var r=cu(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(E4(t))C4(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,ha(o,a)){var l=e.interleaved;l===null?(i.next=i,YP(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=c4(t,e,i,r),n!==null&&(i=$r(),ca(n,t,r,i),P4(n,e,r))}}function E4(t){var e=t.alternate;return t===qt||e!==null&&e===qt}function C4(t,e){a0=n_=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function P4(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,IP(t,n)}}var r_={readContext:As,useCallback:or,useContext:or,useEffect:or,useImperativeHandle:or,useInsertionEffect:or,useLayoutEffect:or,useMemo:or,useReducer:or,useRef:or,useState:or,useDebugValue:or,useDeferredValue:or,useTransition:or,useMutableSource:or,useSyncExternalStore:or,useId:or,unstable_isNewReconciler:!1},w7={readContext:As,useCallback:function(t,e){return xa().memoizedState=[t,e===void 0?null:e],t},useContext:As,useEffect:FM,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Jw(4194308,4,_4.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Jw(4194308,4,t,e)},useInsertionEffect:function(t,e){return Jw(4,2,t,e)},useMemo:function(t,e){var n=xa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=x7.bind(null,qt,t),[r.memoizedState,t]},useRef:function(t){var e=xa();return t={current:t},e.memoizedState=t},useState:LM,useDebugValue:iT,useDeferredValue:function(t){return xa().memoizedState=t},useTransition:function(){var t=LM(!1),e=t[0];return t=v7.bind(null,t[1]),xa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=qt,i=xa();if(Lt){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),zn===null)throw Error(le(349));Fh&30||p4(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,FM(g4.bind(null,r,s,t),[t]),r.flags|=2048,$0(9,m4.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=xa(),e=zn.identifierPrefix;if(Lt){var n=ol,r=al;n=(r&~(1<<32-la(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=I0++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=y7++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},_7={readContext:As,useCallback:A4,useContext:As,useEffect:rT,useImperativeHandle:S4,useInsertionEffect:b4,useLayoutEffect:w4,useMemo:j4,useReducer:Kj,useRef:x4,useState:function(){return Kj(D0)},useDebugValue:iT,useDeferredValue:function(t){var e=js();return k4(e,jn.memoizedState,t)},useTransition:function(){var t=Kj(D0)[0],e=js().memoizedState;return[t,e]},useMutableSource:h4,useSyncExternalStore:f4,useId:N4,unstable_isNewReconciler:!1},S7={readContext:As,useCallback:A4,useContext:As,useEffect:rT,useImperativeHandle:S4,useInsertionEffect:b4,useLayoutEffect:w4,useMemo:j4,useReducer:Vj,useRef:x4,useState:function(){return Vj(D0)},useDebugValue:iT,useDeferredValue:function(t){var e=js();return jn===null?e.memoizedState=t:k4(e,jn.memoizedState,t)},useTransition:function(){var t=Vj(D0)[0],e=js().memoizedState;return[t,e]},useMutableSource:h4,useSyncExternalStore:f4,useId:N4,unstable_isNewReconciler:!1};function Fs(t,e){if(t&&t.defaultProps){e=Kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function kN(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var aA={isMounted:function(t){return(t=t._reactInternals)?Zh(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$r(),i=cu(t),s=dl(r,i);s.payload=e,n!=null&&(s.callback=n),e=ou(t,s,i),e!==null&&(ca(e,t,i,r),Xw(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$r(),i=cu(t),s=dl(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ou(t,s,i),e!==null&&(ca(e,t,i,r),Xw(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$r(),r=cu(t),i=dl(n,r);i.tag=2,e!=null&&(i.callback=e),e=ou(t,i,r),e!==null&&(ca(e,t,r,n),Xw(e,t,r))}};function BM(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!C0(n,r)||!C0(i,s):!0}function T4(t,e,n){var r=!1,i=mu,s=e.contextType;return typeof s=="object"&&s!==null?s=As(s):(i=ci(e)?$h:wr.current,r=e.contextTypes,s=(r=r!=null)?Xm(t,i):mu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=aA,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function UM(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&aA.enqueueReplaceState(e,e.state,null)}function NN(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},XP(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=As(s):(s=ci(e)?$h:wr.current,i.context=Xm(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(kN(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&aA.enqueueReplaceState(i,i.state,null),e_(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function eg(t,e){try{var n="",r=e;do n+=QW(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yj(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function EN(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var A7=typeof WeakMap=="function"?WeakMap:Map;function O4(t,e,n){n=dl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){s_||(s_=!0,LN=r),EN(t,e)},n}function M4(t,e,n){n=dl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){EN(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){EN(t,e),typeof r!="function"&&(lu===null?lu=new Set([this]):lu.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function zM(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new A7;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=L7.bind(null,t,e,n),e.then(t,t))}function WM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function HM(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=dl(-1,1),e.tag=2,ou(n,e,1))),n.lanes|=1),t)}var j7=Nl.ReactCurrentOwner,ai=!1;function Tr(t,e,n,r){e.child=t===null?l4(e,null,n,r):Jm(e,t.child,n,r)}function qM(t,e,n,r,i){n=n.render;var s=e.ref;return sp(e,i),r=tT(t,e,n,r,s,i),n=nT(),t!==null&&!ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,wl(t,e,i)):(Lt&&n&&WP(e),e.flags|=1,Tr(t,e,r,i),e.child)}function GM(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!hT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,R4(t,e,s,r,i)):(t=n1(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:C0,n(a,r)&&t.ref===e.ref)return wl(t,e,i)}return e.flags|=1,t=uu(s,r),t.ref=e.ref,t.return=e,e.child=t}function R4(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(C0(s,r)&&t.ref===e.ref)if(ai=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(ai=!0);else return e.lanes=t.lanes,wl(t,e,i)}return CN(t,e,n,r,i)}function I4(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},kt(Wf,$i),$i|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,kt(Wf,$i),$i|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,kt(Wf,$i),$i|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,kt(Wf,$i),$i|=r;return Tr(t,e,i,n),e.child}function D4(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function CN(t,e,n,r,i){var s=ci(n)?$h:wr.current;return s=Xm(e,s),sp(e,i),n=tT(t,e,n,r,s,i),r=nT(),t!==null&&!ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,wl(t,e,i)):(Lt&&r&&WP(e),e.flags|=1,Tr(t,e,n,i),e.child)}function KM(t,e,n,r,i){if(ci(n)){var s=!0;Y1(e)}else s=!1;if(sp(e,i),e.stateNode===null)Zw(t,e),T4(e,n,r),NN(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=As(u):(u=ci(n)?$h:wr.current,u=Xm(e,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&UM(e,a,r,u),ql=!1;var p=e.memoizedState;a.state=p,e_(e,r,a,i),l=e.memoizedState,o!==r||p!==l||li.current||ql?(typeof d=="function"&&(kN(e,n,d,r),l=e.memoizedState),(o=ql||BM(e,n,o,r,p,l,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,u4(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Fs(e.type,o),a.props=u,f=e.pendingProps,p=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=As(l):(l=ci(n)?$h:wr.current,l=Xm(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==l)&&UM(e,a,r,l),ql=!1,p=e.memoizedState,a.state=p,e_(e,r,a,i);var y=e.memoizedState;o!==f||p!==y||li.current||ql?(typeof m=="function"&&(kN(e,n,m,r),y=e.memoizedState),(u=ql||BM(e,n,u,r,p,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),a.props=r,a.state=y,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return PN(t,e,n,r,s,i)}function PN(t,e,n,r,i,s){D4(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&OM(e,n,!1),wl(t,e,s);r=e.stateNode,j7.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Jm(e,t.child,null,s),e.child=Jm(e,null,o,s)):Tr(t,e,o,s),e.memoizedState=r.state,i&&OM(e,n,!0),e.child}function $4(t){var e=t.stateNode;e.pendingContext?TM(t,e.pendingContext,e.pendingContext!==e.context):e.context&&TM(t,e.context,!1),QP(t,e.containerInfo)}function VM(t,e,n,r,i){return Qm(),qP(i),e.flags|=256,Tr(t,e,n,r),e.child}var TN={dehydrated:null,treeContext:null,retryLane:0};function ON(t){return{baseLanes:t,cachePool:null,transitions:null}}function L4(t,e,n){var r=e.pendingProps,i=Wt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),kt(Wt,i&1),t===null)return AN(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=cA(a,r,0,null),t=Rh(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=ON(n),e.memoizedState=TN,t):sT(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return k7(t,e,a,r,o,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=uu(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=uu(o,s):(s=Rh(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?ON(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=TN,r}return s=t.child,t=s.sibling,r=uu(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sT(t,e){return e=cA({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function cw(t,e,n,r){return r!==null&&qP(r),Jm(e,t.child,null,n),t=sT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function k7(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=Yj(Error(le(422))),cw(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=cA({mode:"visible",children:r.children},i,0,null),s=Rh(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Jm(e,t.child,null,a),e.child.memoizedState=ON(a),e.memoizedState=TN,s);if(!(e.mode&1))return cw(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(le(419)),r=Yj(s,r,void 0),cw(t,e,a,r)}if(o=(a&t.childLanes)!==0,ai||o){if(r=zn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,bl(t,i),ca(r,t,i,-1))}return dT(),r=Yj(Error(le(421))),cw(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=F7.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,zi=au(i.nextSibling),Wi=e,Lt=!0,ia=null,t!==null&&(ms[gs++]=al,ms[gs++]=ol,ms[gs++]=Lh,al=t.id,ol=t.overflow,Lh=e),e=sT(e,r.children),e.flags|=4096,e)}function YM(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),jN(t.return,e,n)}function Xj(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function F4(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Tr(t,e,r.children,n),r=Wt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&YM(t,n,e);else if(t.tag===19)YM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(kt(Wt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&t_(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xj(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&t_(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xj(e,!0,n,null,s);break;case"together":Xj(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Zw(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function wl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Bh|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=uu(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=uu(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function N7(t,e,n){switch(e.tag){case 3:$4(e),Qm();break;case 5:d4(e);break;case 1:ci(e.type)&&Y1(e);break;case 4:QP(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;kt(J1,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(kt(Wt,Wt.current&1),e.flags|=128,null):n&e.child.childLanes?L4(t,e,n):(kt(Wt,Wt.current&1),t=wl(t,e,n),t!==null?t.sibling:null);kt(Wt,Wt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return F4(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),kt(Wt,Wt.current),r)break;return null;case 22:case 23:return e.lanes=0,I4(t,e,n)}return wl(t,e,n)}var B4,MN,U4,z4;B4=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};MN=function(){};U4=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,td(Ja.current);var s=null;switch(n){case"input":i=tN(t,i),r=tN(t,r),s=[];break;case"select":i=Kt({},i,{value:void 0}),r=Kt({},r,{value:void 0}),s=[];break;case"textarea":i=iN(t,i),r=iN(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=K1)}aN(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_0.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ct("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};z4=function(t,e,n,r){n!==r&&(e.flags|=4)};function ay(t,e){if(!Lt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function E7(t,e,n){var r=e.pendingProps;switch(HP(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(e),null;case 1:return ci(e.type)&&V1(),lr(e),null;case 3:return r=e.stateNode,Zm(),Rt(li),Rt(wr),ZP(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ow(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ia!==null&&(UN(ia),ia=null))),MN(t,e),lr(e),null;case 5:JP(e);var i=td(R0.current);if(n=e.type,t!==null&&e.stateNode!=null)U4(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(le(166));return lr(e),null}if(t=td(Ja.current),ow(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ka]=e,r[O0]=s,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",r),Ct("close",r);break;case"iframe":case"object":case"embed":Ct("load",r);break;case"video":case"audio":for(i=0;i<Py.length;i++)Ct(Py[i],r);break;case"source":Ct("error",r);break;case"img":case"image":case"link":Ct("error",r),Ct("load",r);break;case"details":Ct("toggle",r);break;case"input":iM(r,s),Ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ct("invalid",r);break;case"textarea":aM(r,s),Ct("invalid",r)}aN(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&aw(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&aw(r.textContent,o,t),i=["children",""+o]):_0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ct("scroll",r)}switch(n){case"input":Jb(r),sM(r,s,!0);break;case"textarea":Jb(r),oM(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=K1)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=g3(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Ka]=e,t[O0]=r,B4(t,e,!1,!1),e.stateNode=t;e:{switch(a=oN(n,r),n){case"dialog":Ct("cancel",t),Ct("close",t),i=r;break;case"iframe":case"object":case"embed":Ct("load",t),i=r;break;case"video":case"audio":for(i=0;i<Py.length;i++)Ct(Py[i],t);i=r;break;case"source":Ct("error",t),i=r;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),i=r;break;case"details":Ct("toggle",t),i=r;break;case"input":iM(t,r),i=tN(t,r),Ct("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Kt({},r,{value:void 0}),Ct("invalid",t);break;case"textarea":aM(t,r),i=iN(t,r),Ct("invalid",t);break;default:i=r}aN(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?x3(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&y3(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&S0(t,l):typeof l=="number"&&S0(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(_0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ct("scroll",t):l!=null&&CP(t,s,l,a))}switch(n){case"input":Jb(t),sM(t,r,!1);break;case"textarea":Jb(t),oM(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pu(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?tp(t,!!r.multiple,s,!1):r.defaultValue!=null&&tp(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=K1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lr(e),null;case 6:if(t&&e.stateNode!=null)z4(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(le(166));if(n=td(R0.current),td(Ja.current),ow(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ka]=e,(s=r.nodeValue!==n)&&(t=Wi,t!==null))switch(t.tag){case 3:aw(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&aw(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ka]=e,e.stateNode=r}return lr(e),null;case 13:if(Rt(Wt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Lt&&zi!==null&&e.mode&1&&!(e.flags&128))a4(),Qm(),e.flags|=98560,s=!1;else if(s=ow(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(le(317));s[Ka]=e}else Qm(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lr(e),s=!1}else ia!==null&&(UN(ia),ia=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Wt.current&1?Nn===0&&(Nn=3):dT())),e.updateQueue!==null&&(e.flags|=4),lr(e),null);case 4:return Zm(),MN(t,e),t===null&&P0(e.stateNode.containerInfo),lr(e),null;case 10:return VP(e.type._context),lr(e),null;case 17:return ci(e.type)&&V1(),lr(e),null;case 19:if(Rt(Wt),s=e.memoizedState,s===null)return lr(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)ay(s,!1);else{if(Nn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=t_(t),a!==null){for(e.flags|=128,ay(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return kt(Wt,Wt.current&1|2),e.child}t=t.sibling}s.tail!==null&&ln()>tg&&(e.flags|=128,r=!0,ay(s,!1),e.lanes=4194304)}else{if(!r)if(t=t_(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ay(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Lt)return lr(e),null}else 2*ln()-s.renderingStartTime>tg&&n!==1073741824&&(e.flags|=128,r=!0,ay(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ln(),e.sibling=null,n=Wt.current,kt(Wt,r?n&1|2:n&1),e):(lr(e),null);case 22:case 23:return uT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?$i&1073741824&&(lr(e),e.subtreeFlags&6&&(e.flags|=8192)):lr(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function C7(t,e){switch(HP(e),e.tag){case 1:return ci(e.type)&&V1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zm(),Rt(li),Rt(wr),ZP(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return JP(e),null;case 13:if(Rt(Wt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));Qm()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Wt),null;case 4:return Zm(),null;case 10:return VP(e.type._context),null;case 22:case 23:return uT(),null;case 24:return null;default:return null}}var uw=!1,yr=!1,P7=typeof WeakSet=="function"?WeakSet:Set,me=null;function zf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){tn(t,e,r)}else n.current=null}function RN(t,e,n){try{n()}catch(r){tn(t,e,r)}}var XM=!1;function T7(t,e){if(yN=H1,t=K3(),zP(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,d=0,f=t,p=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(o=a+i),f!==s||r!==0&&f.nodeType!==3||(l=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===t)break t;if(p===n&&++u===i&&(o=a),p===s&&++d===r&&(l=a),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(vN={focusedElem:t,selectionRange:n},H1=!1,me=e;me!==null;)if(e=me,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,me=t;else for(;me!==null;){e=me;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,v=y.memoizedState,b=e.stateNode,x=b.getSnapshotBeforeUpdate(e.elementType===e.type?g:Fs(e.type,g),v);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(S){tn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}return y=XM,XM=!1,y}function o0(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&RN(e,n,s)}i=i.next}while(i!==r)}}function oA(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function IN(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function W4(t){var e=t.alternate;e!==null&&(t.alternate=null,W4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ka],delete e[O0],delete e[wN],delete e[f7],delete e[p7])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function H4(t){return t.tag===5||t.tag===3||t.tag===4}function QM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||H4(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function DN(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=K1));else if(r!==4&&(t=t.child,t!==null))for(DN(t,e,n),t=t.sibling;t!==null;)DN(t,e,n),t=t.sibling}function $N(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($N(t,e,n),t=t.sibling;t!==null;)$N(t,e,n),t=t.sibling}var Qn=null,ea=!1;function Il(t,e,n){for(n=n.child;n!==null;)q4(t,e,n),n=n.sibling}function q4(t,e,n){if(Qa&&typeof Qa.onCommitFiberUnmount=="function")try{Qa.onCommitFiberUnmount(ZS,n)}catch{}switch(n.tag){case 5:yr||zf(n,e);case 6:var r=Qn,i=ea;Qn=null,Il(t,e,n),Qn=r,ea=i,Qn!==null&&(ea?(t=Qn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qn.removeChild(n.stateNode));break;case 18:Qn!==null&&(ea?(t=Qn,n=n.stateNode,t.nodeType===8?Wj(t.parentNode,n):t.nodeType===1&&Wj(t,n),N0(t)):Wj(Qn,n.stateNode));break;case 4:r=Qn,i=ea,Qn=n.stateNode.containerInfo,ea=!0,Il(t,e,n),Qn=r,ea=i;break;case 0:case 11:case 14:case 15:if(!yr&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&RN(n,e,a),i=i.next}while(i!==r)}Il(t,e,n);break;case 1:if(!yr&&(zf(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){tn(n,e,o)}Il(t,e,n);break;case 21:Il(t,e,n);break;case 22:n.mode&1?(yr=(r=yr)||n.memoizedState!==null,Il(t,e,n),yr=r):Il(t,e,n);break;default:Il(t,e,n)}}function JM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new P7),e.forEach(function(r){var i=B7.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Rs(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Qn=o.stateNode,ea=!1;break e;case 3:Qn=o.stateNode.containerInfo,ea=!0;break e;case 4:Qn=o.stateNode.containerInfo,ea=!0;break e}o=o.return}if(Qn===null)throw Error(le(160));q4(s,a,i),Qn=null,ea=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){tn(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)G4(e,t),e=e.sibling}function G4(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rs(e,t),ma(t),r&4){try{o0(3,t,t.return),oA(3,t)}catch(g){tn(t,t.return,g)}try{o0(5,t,t.return)}catch(g){tn(t,t.return,g)}}break;case 1:Rs(e,t),ma(t),r&512&&n!==null&&zf(n,n.return);break;case 5:if(Rs(e,t),ma(t),r&512&&n!==null&&zf(n,n.return),t.flags&32){var i=t.stateNode;try{S0(i,"")}catch(g){tn(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&p3(i,s),oN(o,a);var u=oN(o,s);for(a=0;a<l.length;a+=2){var d=l[a],f=l[a+1];d==="style"?x3(i,f):d==="dangerouslySetInnerHTML"?y3(i,f):d==="children"?S0(i,f):CP(i,d,f,u)}switch(o){case"input":nN(i,s);break;case"textarea":m3(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?tp(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?tp(i,!!s.multiple,s.defaultValue,!0):tp(i,!!s.multiple,s.multiple?[]:"",!1))}i[O0]=s}catch(g){tn(t,t.return,g)}}break;case 6:if(Rs(e,t),ma(t),r&4){if(t.stateNode===null)throw Error(le(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){tn(t,t.return,g)}}break;case 3:if(Rs(e,t),ma(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{N0(e.containerInfo)}catch(g){tn(t,t.return,g)}break;case 4:Rs(e,t),ma(t);break;case 13:Rs(e,t),ma(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(lT=ln())),r&4&&JM(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(yr=(u=yr)||d,Rs(e,t),yr=u):Rs(e,t),ma(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(me=t,d=t.child;d!==null;){for(f=me=d;me!==null;){switch(p=me,m=p.child,p.tag){case 0:case 11:case 14:case 15:o0(4,p,p.return);break;case 1:zf(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(g){tn(r,n,g)}}break;case 5:zf(p,p.return);break;case 22:if(p.memoizedState!==null){eR(f);continue}}m!==null?(m.return=p,me=m):eR(f)}d=d.sibling}e:for(d=null,f=t;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=v3("display",a))}catch(g){tn(t,t.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){tn(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Rs(e,t),ma(t),r&4&&JM(t);break;case 21:break;default:Rs(e,t),ma(t)}}function ma(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(H4(n)){var r=n;break e}n=n.return}throw Error(le(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(S0(i,""),r.flags&=-33);var s=QM(t);$N(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=QM(t);DN(t,o,a);break;default:throw Error(le(161))}}catch(l){tn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function O7(t,e,n){me=t,K4(t)}function K4(t,e,n){for(var r=(t.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||uw;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||yr;o=uw;var u=yr;if(uw=a,(yr=l)&&!u)for(me=i;me!==null;)a=me,l=a.child,a.tag===22&&a.memoizedState!==null?tR(i):l!==null?(l.return=a,me=l):tR(i);for(;s!==null;)me=s,K4(s),s=s.sibling;me=i,uw=o,yr=u}ZM(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):ZM(t)}}function ZM(t){for(;me!==null;){var e=me;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yr||oA(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!yr)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Fs(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$M(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$M(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&N0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}yr||e.flags&512&&IN(e)}catch(p){tn(e,e.return,p)}}if(e===t){me=null;break}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}}function eR(t){for(;me!==null;){var e=me;if(e===t){me=null;break}var n=e.sibling;if(n!==null){n.return=e.return,me=n;break}me=e.return}}function tR(t){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{oA(4,e)}catch(l){tn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){tn(e,i,l)}}var s=e.return;try{IN(e)}catch(l){tn(e,s,l)}break;case 5:var a=e.return;try{IN(e)}catch(l){tn(e,a,l)}}}catch(l){tn(e,e.return,l)}if(e===t){me=null;break}var o=e.sibling;if(o!==null){o.return=e.return,me=o;break}me=e.return}}var M7=Math.ceil,i_=Nl.ReactCurrentDispatcher,aT=Nl.ReactCurrentOwner,ws=Nl.ReactCurrentBatchConfig,qe=0,zn=null,mn=null,tr=0,$i=0,Wf=_u(0),Nn=0,L0=null,Bh=0,lA=0,oT=0,l0=null,ii=null,lT=0,tg=1/0,mo=null,s_=!1,LN=null,lu=null,dw=!1,Zc=null,a_=0,c0=0,FN=null,e1=-1,t1=0;function $r(){return qe&6?ln():e1!==-1?e1:e1=ln()}function cu(t){return t.mode&1?qe&2&&tr!==0?tr&-tr:g7.transition!==null?(t1===0&&(t1=T3()),t1):(t=st,t!==0||(t=window.event,t=t===void 0?16:L3(t.type)),t):1}function ca(t,e,n,r){if(50<c0)throw c0=0,FN=null,Error(le(185));kb(t,n,r),(!(qe&2)||t!==zn)&&(t===zn&&(!(qe&2)&&(lA|=n),Nn===4&&Vl(t,tr)),ui(t,r),n===1&&qe===0&&!(e.mode&1)&&(tg=ln()+500,iA&&Su()))}function ui(t,e){var n=t.callbackNode;gH(t,e);var r=W1(t,t===zn?tr:0);if(r===0)n!==null&&uM(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&uM(n),e===1)t.tag===0?m7(nR.bind(null,t)):r4(nR.bind(null,t)),d7(function(){!(qe&6)&&Su()}),n=null;else{switch(O3(r)){case 1:n=RP;break;case 4:n=C3;break;case 16:n=z1;break;case 536870912:n=P3;break;default:n=z1}n=tB(n,V4.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function V4(t,e){if(e1=-1,t1=0,qe&6)throw Error(le(327));var n=t.callbackNode;if(ap()&&t.callbackNode!==n)return null;var r=W1(t,t===zn?tr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=o_(t,r);else{e=r;var i=qe;qe|=2;var s=X4();(zn!==t||tr!==e)&&(mo=null,tg=ln()+500,Mh(t,e));do try{D7();break}catch(o){Y4(t,o)}while(!0);KP(),i_.current=s,qe=i,mn!==null?e=0:(zn=null,tr=0,e=Nn)}if(e!==0){if(e===2&&(i=hN(t),i!==0&&(r=i,e=BN(t,i))),e===1)throw n=L0,Mh(t,0),Vl(t,r),ui(t,ln()),n;if(e===6)Vl(t,r);else{if(i=t.current.alternate,!(r&30)&&!R7(i)&&(e=o_(t,r),e===2&&(s=hN(t),s!==0&&(r=s,e=BN(t,s))),e===1))throw n=L0,Mh(t,0),Vl(t,r),ui(t,ln()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(le(345));case 2:$u(t,ii,mo);break;case 3:if(Vl(t,r),(r&130023424)===r&&(e=lT+500-ln(),10<e)){if(W1(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){$r(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bN($u.bind(null,t,ii,mo),e);break}$u(t,ii,mo);break;case 4:if(Vl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-la(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=ln()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*M7(r/1960))-r,10<r){t.timeoutHandle=bN($u.bind(null,t,ii,mo),r);break}$u(t,ii,mo);break;case 5:$u(t,ii,mo);break;default:throw Error(le(329))}}}return ui(t,ln()),t.callbackNode===n?V4.bind(null,t):null}function BN(t,e){var n=l0;return t.current.memoizedState.isDehydrated&&(Mh(t,e).flags|=256),t=o_(t,e),t!==2&&(e=ii,ii=n,e!==null&&UN(e)),t}function UN(t){ii===null?ii=t:ii.push.apply(ii,t)}function R7(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ha(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vl(t,e){for(e&=~oT,e&=~lA,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-la(e),r=1<<n;t[n]=-1,e&=~r}}function nR(t){if(qe&6)throw Error(le(327));ap();var e=W1(t,0);if(!(e&1))return ui(t,ln()),null;var n=o_(t,e);if(t.tag!==0&&n===2){var r=hN(t);r!==0&&(e=r,n=BN(t,r))}if(n===1)throw n=L0,Mh(t,0),Vl(t,e),ui(t,ln()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$u(t,ii,mo),ui(t,ln()),null}function cT(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(tg=ln()+500,iA&&Su())}}function Uh(t){Zc!==null&&Zc.tag===0&&!(qe&6)&&ap();var e=qe;qe|=1;var n=ws.transition,r=st;try{if(ws.transition=null,st=1,t)return t()}finally{st=r,ws.transition=n,qe=e,!(qe&6)&&Su()}}function uT(){$i=Wf.current,Rt(Wf)}function Mh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,u7(n)),mn!==null)for(n=mn.return;n!==null;){var r=n;switch(HP(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&V1();break;case 3:Zm(),Rt(li),Rt(wr),ZP();break;case 5:JP(r);break;case 4:Zm();break;case 13:Rt(Wt);break;case 19:Rt(Wt);break;case 10:VP(r.type._context);break;case 22:case 23:uT()}n=n.return}if(zn=t,mn=t=uu(t.current,null),tr=$i=e,Nn=0,L0=null,oT=lA=Bh=0,ii=l0=null,ed!==null){for(e=0;e<ed.length;e++)if(n=ed[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}ed=null}return t}function Y4(t,e){do{var n=mn;try{if(KP(),Qw.current=r_,n_){for(var r=qt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}n_=!1}if(Fh=0,Bn=jn=qt=null,a0=!1,I0=0,aT.current=null,n===null||n.return===null){Nn=1,L0=e,mn=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=tr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=WM(a);if(m!==null){m.flags&=-257,HM(m,a,o,s,e),m.mode&1&&zM(s,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var g=new Set;g.add(l),e.updateQueue=g}else y.add(l);break e}else{if(!(e&1)){zM(s,u,e),dT();break e}l=Error(le(426))}}else if(Lt&&o.mode&1){var v=WM(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),HM(v,a,o,s,e),qP(eg(l,o));break e}}s=l=eg(l,o),Nn!==4&&(Nn=2),l0===null?l0=[s]:l0.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var b=O4(s,l,e);DM(s,b);break e;case 1:o=l;var x=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(lu===null||!lu.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=M4(s,o,e);DM(s,S);break e}}s=s.return}while(s!==null)}J4(n)}catch(_){e=_,mn===n&&n!==null&&(mn=n=n.return);continue}break}while(!0)}function X4(){var t=i_.current;return i_.current=r_,t===null?r_:t}function dT(){(Nn===0||Nn===3||Nn===2)&&(Nn=4),zn===null||!(Bh&268435455)&&!(lA&268435455)||Vl(zn,tr)}function o_(t,e){var n=qe;qe|=2;var r=X4();(zn!==t||tr!==e)&&(mo=null,Mh(t,e));do try{I7();break}catch(i){Y4(t,i)}while(!0);if(KP(),qe=n,i_.current=r,mn!==null)throw Error(le(261));return zn=null,tr=0,Nn}function I7(){for(;mn!==null;)Q4(mn)}function D7(){for(;mn!==null&&!oH();)Q4(mn)}function Q4(t){var e=eB(t.alternate,t,$i);t.memoizedProps=t.pendingProps,e===null?J4(t):mn=e,aT.current=null}function J4(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=C7(n,e),n!==null){n.flags&=32767,mn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nn=6,mn=null;return}}else if(n=E7(n,e,$i),n!==null){mn=n;return}if(e=e.sibling,e!==null){mn=e;return}mn=e=t}while(e!==null);Nn===0&&(Nn=5)}function $u(t,e,n){var r=st,i=ws.transition;try{ws.transition=null,st=1,$7(t,e,n,r)}finally{ws.transition=i,st=r}return null}function $7(t,e,n,r){do ap();while(Zc!==null);if(qe&6)throw Error(le(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(yH(t,s),t===zn&&(mn=zn=null,tr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||dw||(dw=!0,tB(z1,function(){return ap(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=ws.transition,ws.transition=null;var a=st;st=1;var o=qe;qe|=4,aT.current=null,T7(t,n),G4(n,t),r7(vN),H1=!!yN,vN=yN=null,t.current=n,O7(n),lH(),qe=o,st=a,ws.transition=s}else t.current=n;if(dw&&(dw=!1,Zc=t,a_=i),s=t.pendingLanes,s===0&&(lu=null),dH(n.stateNode),ui(t,ln()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(s_)throw s_=!1,t=LN,LN=null,t;return a_&1&&t.tag!==0&&ap(),s=t.pendingLanes,s&1?t===FN?c0++:(c0=0,FN=t):c0=0,Su(),null}function ap(){if(Zc!==null){var t=O3(a_),e=ws.transition,n=st;try{if(ws.transition=null,st=16>t?16:t,Zc===null)var r=!1;else{if(t=Zc,Zc=null,a_=0,qe&6)throw Error(le(331));var i=qe;for(qe|=4,me=t.current;me!==null;){var s=me,a=s.child;if(me.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(me=u;me!==null;){var d=me;switch(d.tag){case 0:case 11:case 15:o0(8,d,s)}var f=d.child;if(f!==null)f.return=d,me=f;else for(;me!==null;){d=me;var p=d.sibling,m=d.return;if(W4(d),d===u){me=null;break}if(p!==null){p.return=m,me=p;break}me=m}}}var y=s.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}me=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,me=a;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:o0(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,me=b;break e}me=s.return}}var x=t.current;for(me=x;me!==null;){a=me;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,me=w;else e:for(a=x;me!==null;){if(o=me,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:oA(9,o)}}catch(_){tn(o,o.return,_)}if(o===a){me=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,me=S;break e}me=o.return}}if(qe=i,Su(),Qa&&typeof Qa.onPostCommitFiberRoot=="function")try{Qa.onPostCommitFiberRoot(ZS,t)}catch{}r=!0}return r}finally{st=n,ws.transition=e}}return!1}function rR(t,e,n){e=eg(n,e),e=O4(t,e,1),t=ou(t,e,1),e=$r(),t!==null&&(kb(t,1,e),ui(t,e))}function tn(t,e,n){if(t.tag===3)rR(t,t,n);else for(;e!==null;){if(e.tag===3){rR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(lu===null||!lu.has(r))){t=eg(n,t),t=M4(e,t,1),e=ou(e,t,1),t=$r(),e!==null&&(kb(e,1,t),ui(e,t));break}}e=e.return}}function L7(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$r(),t.pingedLanes|=t.suspendedLanes&n,zn===t&&(tr&n)===n&&(Nn===4||Nn===3&&(tr&130023424)===tr&&500>ln()-lT?Mh(t,0):oT|=n),ui(t,e)}function Z4(t,e){e===0&&(t.mode&1?(e=tw,tw<<=1,!(tw&130023424)&&(tw=4194304)):e=1);var n=$r();t=bl(t,e),t!==null&&(kb(t,e,n),ui(t,n))}function F7(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Z4(t,n)}function B7(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(le(314))}r!==null&&r.delete(e),Z4(t,n)}var eB;eB=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||li.current)ai=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ai=!1,N7(t,e,n);ai=!!(t.flags&131072)}else ai=!1,Lt&&e.flags&1048576&&i4(e,Q1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Zw(t,e),t=e.pendingProps;var i=Xm(e,wr.current);sp(e,n),i=tT(null,e,r,t,i,n);var s=nT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ci(r)?(s=!0,Y1(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,XP(e),i.updater=aA,e.stateNode=i,i._reactInternals=e,NN(e,r,t,n),e=PN(null,e,r,!0,s,n)):(e.tag=0,Lt&&s&&WP(e),Tr(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Zw(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=z7(r),t=Fs(r,t),i){case 0:e=CN(null,e,r,t,n);break e;case 1:e=KM(null,e,r,t,n);break e;case 11:e=qM(null,e,r,t,n);break e;case 14:e=GM(null,e,r,Fs(r.type,t),n);break e}throw Error(le(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fs(r,i),CN(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fs(r,i),KM(t,e,r,i,n);case 3:e:{if($4(e),t===null)throw Error(le(387));r=e.pendingProps,s=e.memoizedState,i=s.element,u4(t,e),e_(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=eg(Error(le(423)),e),e=VM(t,e,r,n,i);break e}else if(r!==i){i=eg(Error(le(424)),e),e=VM(t,e,r,n,i);break e}else for(zi=au(e.stateNode.containerInfo.firstChild),Wi=e,Lt=!0,ia=null,n=l4(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qm(),r===i){e=wl(t,e,n);break e}Tr(t,e,r,n)}e=e.child}return e;case 5:return d4(e),t===null&&AN(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,xN(r,i)?a=null:s!==null&&xN(r,s)&&(e.flags|=32),D4(t,e),Tr(t,e,a,n),e.child;case 6:return t===null&&AN(e),null;case 13:return L4(t,e,n);case 4:return QP(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Jm(e,null,r,n):Tr(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fs(r,i),qM(t,e,r,i,n);case 7:return Tr(t,e,e.pendingProps,n),e.child;case 8:return Tr(t,e,e.pendingProps.children,n),e.child;case 12:return Tr(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,kt(J1,r._currentValue),r._currentValue=a,s!==null)if(ha(s.value,a)){if(s.children===i.children&&!li.current){e=wl(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=dl(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),jN(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(le(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),jN(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Tr(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,sp(e,n),i=As(i),r=r(i),e.flags|=1,Tr(t,e,r,n),e.child;case 14:return r=e.type,i=Fs(r,e.pendingProps),i=Fs(r.type,i),GM(t,e,r,i,n);case 15:return R4(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Fs(r,i),Zw(t,e),e.tag=1,ci(r)?(t=!0,Y1(e)):t=!1,sp(e,n),T4(e,r,i),NN(e,r,i,n),PN(null,e,r,!0,t,n);case 19:return F4(t,e,n);case 22:return I4(t,e,n)}throw Error(le(156,e.tag))};function tB(t,e){return E3(t,e)}function U7(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xs(t,e,n,r){return new U7(t,e,n,r)}function hT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function z7(t){if(typeof t=="function")return hT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===TP)return 11;if(t===OP)return 14}return 2}function uu(t,e){var n=t.alternate;return n===null?(n=xs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function n1(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")hT(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Mf:return Rh(n.children,i,s,e);case PP:a=8,i|=8;break;case Qk:return t=xs(12,n,e,i|2),t.elementType=Qk,t.lanes=s,t;case Jk:return t=xs(13,n,e,i),t.elementType=Jk,t.lanes=s,t;case Zk:return t=xs(19,n,e,i),t.elementType=Zk,t.lanes=s,t;case d3:return cA(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case c3:a=10;break e;case u3:a=9;break e;case TP:a=11;break e;case OP:a=14;break e;case Hl:a=16,r=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=xs(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Rh(t,e,n,r){return t=xs(7,t,r,e),t.lanes=n,t}function cA(t,e,n,r){return t=xs(22,t,r,e),t.elementType=d3,t.lanes=n,t.stateNode={isHidden:!1},t}function Qj(t,e,n){return t=xs(6,t,null,e),t.lanes=n,t}function Jj(t,e,n){return e=xs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function W7(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oj(0),this.expirationTimes=Oj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oj(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function fT(t,e,n,r,i,s,a,o,l){return t=new W7(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=xs(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},XP(s),t}function H7(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Of,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function nB(t){if(!t)return mu;t=t._reactInternals;e:{if(Zh(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ci(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(ci(n))return n4(t,n,e)}return e}function rB(t,e,n,r,i,s,a,o,l){return t=fT(n,r,!0,t,i,s,a,o,l),t.context=nB(null),n=t.current,r=$r(),i=cu(n),s=dl(r,i),s.callback=e??null,ou(n,s,i),t.current.lanes=i,kb(t,i,r),ui(t,r),t}function uA(t,e,n,r){var i=e.current,s=$r(),a=cu(i);return n=nB(n),e.context===null?e.context=n:e.pendingContext=n,e=dl(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ou(i,e,a),t!==null&&(ca(t,i,a,s),Xw(t,i,a)),a}function l_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function iR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pT(t,e){iR(t,e),(t=t.alternate)&&iR(t,e)}function q7(){return null}var iB=typeof reportError=="function"?reportError:function(t){console.error(t)};function mT(t){this._internalRoot=t}dA.prototype.render=mT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));uA(t,e,null,null)};dA.prototype.unmount=mT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Uh(function(){uA(null,t,null,null)}),e[xl]=null}};function dA(t){this._internalRoot=t}dA.prototype.unstable_scheduleHydration=function(t){if(t){var e=I3();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Kl.length&&e!==0&&e<Kl[n].priority;n++);Kl.splice(n,0,t),n===0&&$3(t)}};function gT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hA(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function sR(){}function G7(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=l_(a);s.call(u)}}var a=rB(e,r,t,0,null,!1,!1,"",sR);return t._reactRootContainer=a,t[xl]=a.current,P0(t.nodeType===8?t.parentNode:t),Uh(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=l_(l);o.call(u)}}var l=fT(t,0,!1,null,null,!1,!1,"",sR);return t._reactRootContainer=l,t[xl]=l.current,P0(t.nodeType===8?t.parentNode:t),Uh(function(){uA(e,l,n,r)}),l}function fA(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=l_(a);o.call(l)}}uA(e,a,t,i)}else a=G7(n,e,t,i,r);return l_(a)}M3=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Cy(e.pendingLanes);n!==0&&(IP(e,n|1),ui(e,ln()),!(qe&6)&&(tg=ln()+500,Su()))}break;case 13:Uh(function(){var r=bl(t,1);if(r!==null){var i=$r();ca(r,t,1,i)}}),pT(t,1)}};DP=function(t){if(t.tag===13){var e=bl(t,134217728);if(e!==null){var n=$r();ca(e,t,134217728,n)}pT(t,134217728)}};R3=function(t){if(t.tag===13){var e=cu(t),n=bl(t,e);if(n!==null){var r=$r();ca(n,t,e,r)}pT(t,e)}};I3=function(){return st};D3=function(t,e){var n=st;try{return st=t,e()}finally{st=n}};cN=function(t,e,n){switch(e){case"input":if(nN(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=rA(r);if(!i)throw Error(le(90));f3(r),nN(r,i)}}}break;case"textarea":m3(t,n);break;case"select":e=n.value,e!=null&&tp(t,!!n.multiple,e,!1)}};_3=cT;S3=Uh;var K7={usingClientEntryPoint:!1,Events:[Eb,$f,rA,b3,w3,cT]},oy={findFiberByHostInstance:Zu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},V7={bundleType:oy.bundleType,version:oy.version,rendererPackageName:oy.rendererPackageName,rendererConfig:oy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=k3(t),t===null?null:t.stateNode},findFiberByHostInstance:oy.findFiberByHostInstance||q7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hw.isDisabled&&hw.supportsFiber)try{ZS=hw.inject(V7),Qa=hw}catch{}}Ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K7;Ki.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gT(e))throw Error(le(200));return H7(t,e,null,n)};Ki.createRoot=function(t,e){if(!gT(t))throw Error(le(299));var n=!1,r="",i=iB;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=fT(t,1,!1,null,null,n,!1,r,i),t[xl]=e.current,P0(t.nodeType===8?t.parentNode:t),new mT(e)};Ki.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=k3(e),t=t===null?null:t.stateNode,t};Ki.flushSync=function(t){return Uh(t)};Ki.hydrate=function(t,e,n){if(!hA(e))throw Error(le(200));return fA(null,t,e,!0,n)};Ki.hydrateRoot=function(t,e,n){if(!gT(t))throw Error(le(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=iB;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=rB(e,null,t,1,n??null,i,!1,s,a),t[xl]=e.current,P0(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new dA(e)};Ki.render=function(t,e,n){if(!hA(e))throw Error(le(200));return fA(null,t,e,!1,n)};Ki.unmountComponentAtNode=function(t){if(!hA(t))throw Error(le(40));return t._reactRootContainer?(Uh(function(){fA(null,null,t,!1,function(){t._reactRootContainer=null,t[xl]=null})}),!0):!1};Ki.unstable_batchedUpdates=cT;Ki.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hA(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return fA(t,e,n,!1,r)};Ki.version="18.3.1-next-f1338f8080-20240426";function sB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sB)}catch(t){console.error(t)}}sB(),s3.exports=Ki;var Y7=s3.exports,aR=Y7;Yk.createRoot=aR.createRoot,Yk.hydrateRoot=aR.hydrateRoot;var Ig=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},X7={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},Jl,_P,DF,Q7=(DF=class{constructor(){E(this,Jl,X7);E(this,_P,!1)}setTimeoutProvider(t){k(this,Jl,t)}setTimeout(t,e){return h(this,Jl).setTimeout(t,e)}clearTimeout(t){h(this,Jl).clearTimeout(t)}setInterval(t,e){return h(this,Jl).setInterval(t,e)}clearInterval(t){h(this,Jl).clearInterval(t)}},Jl=new WeakMap,_P=new WeakMap,DF),nd=new Q7;function J7(t){setTimeout(t,0)}var zh=typeof window>"u"||"Deno"in globalThis;function Or(){}function Z7(t,e){return typeof t=="function"?t(e):t}function zN(t){return typeof t=="number"&&t>=0&&t!==1/0}function aB(t,e){return Math.max(t+(e||0)-Date.now(),0)}function du(t,e){return typeof t=="function"?t(e):t}function ps(t,e){return typeof t=="function"?t(e):t}function oR(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:a,stale:o}=t;if(a){if(r){if(e.queryHash!==yT(a,e.options))return!1}else if(!F0(e.queryKey,a))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||i&&i!==e.state.fetchStatus||s&&!s(e))}function lR(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Wh(e.options.mutationKey)!==Wh(s))return!1}else if(!F0(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function yT(t,e){return((e==null?void 0:e.queryKeyHashFn)||Wh)(t)}function Wh(t){return JSON.stringify(t,(e,n)=>WN(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function F0(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>F0(t[n],e[n])):!1}var eq=Object.prototype.hasOwnProperty;function oB(t,e){if(t===e)return t;const n=cR(t)&&cR(e);if(!n&&!(WN(t)&&WN(e)))return e;const i=(n?t:Object.keys(t)).length,s=n?e:Object.keys(e),a=s.length,o=n?new Array(a):{};let l=0;for(let u=0;u<a;u++){const d=n?u:s[u],f=t[d],p=e[d];if(f===p){o[d]=f,(n?u<i:eq.call(t,d))&&l++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){o[d]=p;continue}const m=oB(f,p);o[d]=m,m===f&&l++}return i===a&&l===i?t:o}function c_(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function cR(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function WN(t){if(!uR(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!uR(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function uR(t){return Object.prototype.toString.call(t)==="[object Object]"}function tq(t){return new Promise(e=>{nd.setTimeout(e,t)})}function HN(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?oB(t,e):e}function nq(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function rq(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var vT=Symbol();function lB(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===vT?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function cB(t,e){return typeof t=="function"?t(...e):!!t}var cd,Zl,hp,$F,iq=($F=class extends Ig{constructor(){super();E(this,cd);E(this,Zl);E(this,hp);k(this,hp,e=>{if(!zh&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){h(this,Zl)||this.setEventListener(h(this,hp))}onUnsubscribe(){var e;this.hasListeners()||((e=h(this,Zl))==null||e.call(this),k(this,Zl,void 0))}setEventListener(e){var n;k(this,hp,e),(n=h(this,Zl))==null||n.call(this),k(this,Zl,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){h(this,cd)!==e&&(k(this,cd,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof h(this,cd)=="boolean"?h(this,cd):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},cd=new WeakMap,Zl=new WeakMap,hp=new WeakMap,$F),xT=new iq;function qN(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var sq=J7;function aq(){let t=[],e=0,n=o=>{o()},r=o=>{o()},i=sq;const s=o=>{e?t.push(o):i(()=>{n(o)})},a=()=>{const o=t;t=[],o.length&&i(()=>{r(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{i=o}}}var kn=aq(),fp,ec,pp,LF,oq=(LF=class extends Ig{constructor(){super();E(this,fp,!0);E(this,ec);E(this,pp);k(this,pp,e=>{if(!zh&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){h(this,ec)||this.setEventListener(h(this,pp))}onUnsubscribe(){var e;this.hasListeners()||((e=h(this,ec))==null||e.call(this),k(this,ec,void 0))}setEventListener(e){var n;k(this,pp,e),(n=h(this,ec))==null||n.call(this),k(this,ec,e(this.setOnline.bind(this)))}setOnline(e){h(this,fp)!==e&&(k(this,fp,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return h(this,fp)}},fp=new WeakMap,ec=new WeakMap,pp=new WeakMap,LF),u_=new oq;function lq(t){return Math.min(1e3*2**t,3e4)}function uB(t){return(t??"online")==="online"?u_.isOnline():!0}var GN=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function dB(t){let e=!1,n=0,r;const i=qN(),s=()=>i.status!=="pending",a=g=>{var v;if(!s()){const b=new GN(g);p(b),(v=t.onCancel)==null||v.call(t,b)}},o=()=>{e=!0},l=()=>{e=!1},u=()=>xT.isFocused()&&(t.networkMode==="always"||u_.isOnline())&&t.canRun(),d=()=>uB(t.networkMode)&&t.canRun(),f=g=>{s()||(r==null||r(),i.resolve(g))},p=g=>{s()||(r==null||r(),i.reject(g))},m=()=>new Promise(g=>{var v;r=b=>{(s()||u())&&g(b)},(v=t.onPause)==null||v.call(t)}).then(()=>{var g;r=void 0,s()||(g=t.onContinue)==null||g.call(t)}),y=()=>{if(s())return;let g;const v=n===0?t.initialPromise:void 0;try{g=v??t.fn()}catch(b){g=Promise.reject(b)}Promise.resolve(g).then(f).catch(b=>{var A;if(s())return;const x=t.retry??(zh?0:3),w=t.retryDelay??lq,S=typeof w=="function"?w(n,b):w,_=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,b);if(e||!_){p(b);return}n++,(A=t.onFail)==null||A.call(t,n,b),tq(S).then(()=>u()?void 0:m()).then(()=>{e?p(b):y()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(r==null||r(),i),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?y():m().then(y),i)}}var ud,FF,hB=(FF=class{constructor(){E(this,ud)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zN(this.gcTime)&&k(this,ud,nd.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(zh?1/0:5*60*1e3))}clearGcTimeout(){h(this,ud)&&(nd.clearTimeout(h(this,ud)),k(this,ud,void 0))}},ud=new WeakMap,FF),dd,mp,ts,hd,Tn,Tv,fd,Bs,uo,BF,cq=(BF=class extends hB{constructor(e){super();E(this,Bs);E(this,dd);E(this,mp);E(this,ts);E(this,hd);E(this,Tn);E(this,Tv);E(this,fd);k(this,fd,!1),k(this,Tv,e.defaultOptions),this.setOptions(e.options),this.observers=[],k(this,hd,e.client),k(this,ts,h(this,hd).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,k(this,dd,dR(this.options)),this.state=e.state??h(this,dd),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=h(this,Tn))==null?void 0:e.promise}setOptions(e){if(this.options={...h(this,Tv),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=dR(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),k(this,dd,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&h(this,ts).remove(this)}setData(e,n){const r=HN(this.state.data,e,this.options);return C(this,Bs,uo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){C(this,Bs,uo).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=h(this,Tn))==null?void 0:r.promise;return(i=h(this,Tn))==null||i.cancel(e),n?n.then(Or).catch(Or):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(h(this,dd))}isActive(){return this.observers.some(e=>ps(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===vT||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>du(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!aB(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=h(this,Tn))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=h(this,Tn))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),h(this,ts).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(h(this,Tn)&&(h(this,fd)?h(this,Tn).cancel({revert:!0}):h(this,Tn).cancelRetry()),this.scheduleGc()),h(this,ts).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||C(this,Bs,uo).call(this,{type:"invalidate"})}async fetch(e,n){var l,u,d,f,p,m,y,g,v,b,x,w;if(this.state.fetchStatus!=="idle"&&((l=h(this,Tn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(h(this,Tn))return h(this,Tn).continueRetry(),h(this,Tn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const S=this.observers.find(_=>_.options.queryFn);S&&this.setOptions(S.options)}const r=new AbortController,i=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(k(this,fd,!0),r.signal)})},s=()=>{const S=lB(this.options,n),A=(()=>{const j={client:h(this,hd),queryKey:this.queryKey,meta:this.meta};return i(j),j})();return k(this,fd,!1),this.options.persister?this.options.persister(S,A,this):S(A)},o=(()=>{const S={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:h(this,hd),state:this.state,fetchFn:s};return i(S),S})();(u=this.options.behavior)==null||u.onFetch(o,this),k(this,mp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&C(this,Bs,uo).call(this,{type:"fetch",meta:(f=o.fetchOptions)==null?void 0:f.meta}),k(this,Tn,dB({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,onCancel:S=>{S instanceof GN&&S.revert&&this.setState({...h(this,mp),fetchStatus:"idle"}),r.abort()},onFail:(S,_)=>{C(this,Bs,uo).call(this,{type:"failed",failureCount:S,error:_})},onPause:()=>{C(this,Bs,uo).call(this,{type:"pause"})},onContinue:()=>{C(this,Bs,uo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await h(this,Tn).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(m=(p=h(this,ts).config).onSuccess)==null||m.call(p,S,this),(g=(y=h(this,ts).config).onSettled)==null||g.call(y,S,this.state.error,this),S}catch(S){if(S instanceof GN){if(S.silent)return h(this,Tn).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw C(this,Bs,uo).call(this,{type:"error",error:S}),(b=(v=h(this,ts).config).onError)==null||b.call(v,S,this),(w=(x=h(this,ts).config).onSettled)==null||w.call(x,this.state.data,S,this),S}finally{this.scheduleGc()}}},dd=new WeakMap,mp=new WeakMap,ts=new WeakMap,hd=new WeakMap,Tn=new WeakMap,Tv=new WeakMap,fd=new WeakMap,Bs=new WeakSet,uo=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...fB(r.data,this.options),fetchMeta:e.meta??null};case"success":const i={...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return k(this,mp,e.manual?i:void 0),i;case"error":const s=e.error;return{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),kn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),h(this,ts).notify({query:this,type:"updated",action:e})})},BF);function fB(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uB(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function dR(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Vr,Ue,Ov,Ar,pd,gp,wo,tc,Mv,yp,vp,md,gd,nc,xp,Ze,Ty,KN,VN,YN,XN,QN,JN,ZN,pB,UF,uq=(UF=class extends Ig{constructor(e,n){super();E(this,Ze);E(this,Vr);E(this,Ue);E(this,Ov);E(this,Ar);E(this,pd);E(this,gp);E(this,wo);E(this,tc);E(this,Mv);E(this,yp);E(this,vp);E(this,md);E(this,gd);E(this,nc);E(this,xp,new Set);this.options=n,k(this,Vr,e),k(this,tc,null),k(this,wo,qN()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(h(this,Ue).addObserver(this),hR(h(this,Ue),this.options)?C(this,Ze,Ty).call(this):this.updateResult(),C(this,Ze,XN).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return eE(h(this,Ue),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return eE(h(this,Ue),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,C(this,Ze,QN).call(this),C(this,Ze,JN).call(this),h(this,Ue).removeObserver(this)}setOptions(e){const n=this.options,r=h(this,Ue);if(this.options=h(this,Vr).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ps(this.options.enabled,h(this,Ue))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");C(this,Ze,ZN).call(this),h(this,Ue).setOptions(this.options),n._defaulted&&!c_(this.options,n)&&h(this,Vr).getQueryCache().notify({type:"observerOptionsUpdated",query:h(this,Ue),observer:this});const i=this.hasListeners();i&&fR(h(this,Ue),r,this.options,n)&&C(this,Ze,Ty).call(this),this.updateResult(),i&&(h(this,Ue)!==r||ps(this.options.enabled,h(this,Ue))!==ps(n.enabled,h(this,Ue))||du(this.options.staleTime,h(this,Ue))!==du(n.staleTime,h(this,Ue)))&&C(this,Ze,KN).call(this);const s=C(this,Ze,VN).call(this);i&&(h(this,Ue)!==r||ps(this.options.enabled,h(this,Ue))!==ps(n.enabled,h(this,Ue))||s!==h(this,nc))&&C(this,Ze,YN).call(this,s)}getOptimisticResult(e){const n=h(this,Vr).getQueryCache().build(h(this,Vr),e),r=this.createResult(n,e);return hq(this,r)&&(k(this,Ar,r),k(this,gp,this.options),k(this,pd,h(this,Ue).state)),r}getCurrentResult(){return h(this,Ar)}trackResult(e,n){return new Proxy(e,{get:(r,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&h(this,wo).status==="pending"&&h(this,wo).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,i))})}trackProp(e){h(this,xp).add(e)}getCurrentQuery(){return h(this,Ue)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=h(this,Vr).defaultQueryOptions(e),r=h(this,Vr).getQueryCache().build(h(this,Vr),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return C(this,Ze,Ty).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),h(this,Ar)))}createResult(e,n){var P;const r=h(this,Ue),i=this.options,s=h(this,Ar),a=h(this,pd),o=h(this,gp),u=e!==r?e.state:h(this,Ov),{state:d}=e;let f={...d},p=!1,m;if(n._optimisticResults){const O=this.hasListeners(),M=!O&&hR(e,n),R=O&&fR(e,r,n,i);(M||R)&&(f={...f,...fB(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:g,status:v}=f;m=f.data;let b=!1;if(n.placeholderData!==void 0&&m===void 0&&v==="pending"){let O;s!=null&&s.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(O=s.data,b=!0):O=typeof n.placeholderData=="function"?n.placeholderData((P=h(this,vp))==null?void 0:P.state.data,h(this,vp)):n.placeholderData,O!==void 0&&(v="success",m=HN(s==null?void 0:s.data,O,n),p=!0)}if(n.select&&m!==void 0&&!b)if(s&&m===(a==null?void 0:a.data)&&n.select===h(this,Mv))m=h(this,yp);else try{k(this,Mv,n.select),m=n.select(m),m=HN(s==null?void 0:s.data,m,n),k(this,yp,m),k(this,tc,null)}catch(O){k(this,tc,O)}h(this,tc)&&(y=h(this,tc),m=h(this,yp),g=Date.now(),v="error");const x=f.fetchStatus==="fetching",w=v==="pending",S=v==="error",_=w&&x,A=m!==void 0,N={status:v,fetchStatus:f.fetchStatus,isPending:w,isSuccess:v==="success",isError:S,isInitialLoading:_,isLoading:_,data:m,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:g,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:x,isRefetching:x&&!w,isLoadingError:S&&!A,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:S&&A,isStale:bT(e,n),refetch:this.refetch,promise:h(this,wo),isEnabled:ps(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const O=I=>{N.status==="error"?I.reject(N.error):N.data!==void 0&&I.resolve(N.data)},M=()=>{const I=k(this,wo,N.promise=qN());O(I)},R=h(this,wo);switch(R.status){case"pending":e.queryHash===r.queryHash&&O(R);break;case"fulfilled":(N.status==="error"||N.data!==R.value)&&M();break;case"rejected":(N.status!=="error"||N.error!==R.reason)&&M();break}}return N}updateResult(){const e=h(this,Ar),n=this.createResult(h(this,Ue),this.options);if(k(this,pd,h(this,Ue).state),k(this,gp,this.options),h(this,pd).data!==void 0&&k(this,vp,h(this,Ue)),c_(n,e))return;k(this,Ar,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!h(this,xp).size)return!0;const a=new Set(s??h(this,xp));return this.options.throwOnError&&a.add("error"),Object.keys(h(this,Ar)).some(o=>{const l=o;return h(this,Ar)[l]!==e[l]&&a.has(l)})};C(this,Ze,pB).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&C(this,Ze,XN).call(this)}},Vr=new WeakMap,Ue=new WeakMap,Ov=new WeakMap,Ar=new WeakMap,pd=new WeakMap,gp=new WeakMap,wo=new WeakMap,tc=new WeakMap,Mv=new WeakMap,yp=new WeakMap,vp=new WeakMap,md=new WeakMap,gd=new WeakMap,nc=new WeakMap,xp=new WeakMap,Ze=new WeakSet,Ty=function(e){C(this,Ze,ZN).call(this);let n=h(this,Ue).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Or)),n},KN=function(){C(this,Ze,QN).call(this);const e=du(this.options.staleTime,h(this,Ue));if(zh||h(this,Ar).isStale||!zN(e))return;const r=aB(h(this,Ar).dataUpdatedAt,e)+1;k(this,md,nd.setTimeout(()=>{h(this,Ar).isStale||this.updateResult()},r))},VN=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(h(this,Ue)):this.options.refetchInterval)??!1},YN=function(e){C(this,Ze,JN).call(this),k(this,nc,e),!(zh||ps(this.options.enabled,h(this,Ue))===!1||!zN(h(this,nc))||h(this,nc)===0)&&k(this,gd,nd.setInterval(()=>{(this.options.refetchIntervalInBackground||xT.isFocused())&&C(this,Ze,Ty).call(this)},h(this,nc)))},XN=function(){C(this,Ze,KN).call(this),C(this,Ze,YN).call(this,C(this,Ze,VN).call(this))},QN=function(){h(this,md)&&(nd.clearTimeout(h(this,md)),k(this,md,void 0))},JN=function(){h(this,gd)&&(nd.clearInterval(h(this,gd)),k(this,gd,void 0))},ZN=function(){const e=h(this,Vr).getQueryCache().build(h(this,Vr),this.options);if(e===h(this,Ue))return;const n=h(this,Ue);k(this,Ue,e),k(this,Ov,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},pB=function(e){kn.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(h(this,Ar))}),h(this,Vr).getQueryCache().notify({query:h(this,Ue),type:"observerResultsUpdated"})})},UF);function dq(t,e){return ps(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function hR(t,e){return dq(t,e)||t.state.data!==void 0&&eE(t,e,e.refetchOnMount)}function eE(t,e,n){if(ps(e.enabled,t)!==!1&&du(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&bT(t,e)}return!1}function fR(t,e,n,r){return(t!==e||ps(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&bT(t,n)}function bT(t,e){return ps(e.enabled,t)!==!1&&t.isStaleByTime(du(e.staleTime,t))}function hq(t,e){return!c_(t.getCurrentResult(),e)}function pR(t){return{onFetch:(e,n)=>{var d,f,p,m,y;const r=e.options,i=(p=(f=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,s=((m=e.state.data)==null?void 0:m.pages)||[],a=((y=e.state.data)==null?void 0:y.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let g=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?g=!0:e.signal.addEventListener("abort",()=>{g=!0}),e.signal)})},b=lB(e.options,e.fetchOptions),x=async(w,S,_)=>{if(g)return Promise.reject();if(S==null&&w.pages.length)return Promise.resolve(w);const j=(()=>{const M={client:e.client,queryKey:e.queryKey,pageParam:S,direction:_?"backward":"forward",meta:e.options.meta};return v(M),M})(),N=await b(j),{maxPages:P}=e.options,O=_?rq:nq;return{pages:O(w.pages,N,P),pageParams:O(w.pageParams,S,P)}};if(i&&s.length){const w=i==="backward",S=w?fq:mR,_={pages:s,pageParams:a},A=S(r,_);o=await x(_,A,w)}else{const w=t??s.length;do{const S=l===0?a[0]??r.initialPageParam:mR(r,o);if(l>0&&S==null)break;o=await x(o,S),l++}while(l<w)}return o};e.options.persister?e.fetchFn=()=>{var g,v;return(v=(g=e.options).persister)==null?void 0:v.call(g,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function mR(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function fq(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Rv,_a,jr,yd,Sa,Bl,zF,pq=(zF=class extends hB{constructor(e){super();E(this,Sa);E(this,Rv);E(this,_a);E(this,jr);E(this,yd);k(this,Rv,e.client),this.mutationId=e.mutationId,k(this,jr,e.mutationCache),k(this,_a,[]),this.state=e.state||mB(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){h(this,_a).includes(e)||(h(this,_a).push(e),this.clearGcTimeout(),h(this,jr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){k(this,_a,h(this,_a).filter(n=>n!==e)),this.scheduleGc(),h(this,jr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){h(this,_a).length||(this.state.status==="pending"?this.scheduleGc():h(this,jr).remove(this))}continue(){var e;return((e=h(this,yd))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,o,l,u,d,f,p,m,y,g,v,b,x,w,S,_,A,j,N,P;const n=()=>{C(this,Sa,Bl).call(this,{type:"continue"})},r={client:h(this,Rv),meta:this.options.meta,mutationKey:this.options.mutationKey};k(this,yd,dB({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(O,M)=>{C(this,Sa,Bl).call(this,{type:"failed",failureCount:O,error:M})},onPause:()=>{C(this,Sa,Bl).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>h(this,jr).canRun(this)}));const i=this.state.status==="pending",s=!h(this,yd).canStart();try{if(i)n();else{C(this,Sa,Bl).call(this,{type:"pending",variables:e,isPaused:s}),await((o=(a=h(this,jr).config).onMutate)==null?void 0:o.call(a,e,this,r));const M=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,e,r));M!==this.state.context&&C(this,Sa,Bl).call(this,{type:"pending",context:M,variables:e,isPaused:s})}const O=await h(this,yd).start();return await((f=(d=h(this,jr).config).onSuccess)==null?void 0:f.call(d,O,e,this.state.context,this,r)),await((m=(p=this.options).onSuccess)==null?void 0:m.call(p,O,e,this.state.context,r)),await((g=(y=h(this,jr).config).onSettled)==null?void 0:g.call(y,O,null,this.state.variables,this.state.context,this,r)),await((b=(v=this.options).onSettled)==null?void 0:b.call(v,O,null,e,this.state.context,r)),C(this,Sa,Bl).call(this,{type:"success",data:O}),O}catch(O){try{throw await((w=(x=h(this,jr).config).onError)==null?void 0:w.call(x,O,e,this.state.context,this,r)),await((_=(S=this.options).onError)==null?void 0:_.call(S,O,e,this.state.context,r)),await((j=(A=h(this,jr).config).onSettled)==null?void 0:j.call(A,void 0,O,this.state.variables,this.state.context,this,r)),await((P=(N=this.options).onSettled)==null?void 0:P.call(N,void 0,O,e,this.state.context,r)),O}finally{C(this,Sa,Bl).call(this,{type:"error",error:O})}}finally{h(this,jr).runNext(this)}}},Rv=new WeakMap,_a=new WeakMap,jr=new WeakMap,yd=new WeakMap,Sa=new WeakSet,Bl=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),kn.batch(()=>{h(this,_a).forEach(r=>{r.onMutationUpdate(e)}),h(this,jr).notify({mutation:this,type:"updated",action:e})})},zF);function mB(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var _o,Us,Iv,WF,mq=(WF=class extends Ig{constructor(e={}){super();E(this,_o);E(this,Us);E(this,Iv);this.config=e,k(this,_o,new Set),k(this,Us,new Map),k(this,Iv,0)}build(e,n,r){const i=new pq({client:e,mutationCache:this,mutationId:++Vt(this,Iv)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){h(this,_o).add(e);const n=fw(e);if(typeof n=="string"){const r=h(this,Us).get(n);r?r.push(e):h(this,Us).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(h(this,_o).delete(e)){const n=fw(e);if(typeof n=="string"){const r=h(this,Us).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&h(this,Us).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=fw(e);if(typeof n=="string"){const r=h(this,Us).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=fw(e);if(typeof n=="string"){const i=(r=h(this,Us).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){kn.batch(()=>{h(this,_o).forEach(e=>{this.notify({type:"removed",mutation:e})}),h(this,_o).clear(),h(this,Us).clear()})}getAll(){return Array.from(h(this,_o))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>lR(n,r))}findAll(e={}){return this.getAll().filter(n=>lR(e,n))}notify(e){kn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return kn.batch(()=>Promise.all(e.map(n=>n.continue().catch(Or))))}},_o=new WeakMap,Us=new WeakMap,Iv=new WeakMap,WF);function fw(t){var e;return(e=t.options.scope)==null?void 0:e.id}var So,rc,Yr,Ao,pl,r1,tE,HF,gq=(HF=class extends Ig{constructor(n,r){super();E(this,pl);E(this,So);E(this,rc);E(this,Yr);E(this,Ao);k(this,So,n),this.setOptions(r),this.bindMethods(),C(this,pl,r1).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=h(this,So).defaultMutationOptions(n),c_(this.options,r)||h(this,So).getMutationCache().notify({type:"observerOptionsUpdated",mutation:h(this,Yr),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Wh(r.mutationKey)!==Wh(this.options.mutationKey)?this.reset():((i=h(this,Yr))==null?void 0:i.state.status)==="pending"&&h(this,Yr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=h(this,Yr))==null||n.removeObserver(this)}onMutationUpdate(n){C(this,pl,r1).call(this),C(this,pl,tE).call(this,n)}getCurrentResult(){return h(this,rc)}reset(){var n;(n=h(this,Yr))==null||n.removeObserver(this),k(this,Yr,void 0),C(this,pl,r1).call(this),C(this,pl,tE).call(this)}mutate(n,r){var i;return k(this,Ao,r),(i=h(this,Yr))==null||i.removeObserver(this),k(this,Yr,h(this,So).getMutationCache().build(h(this,So),this.options)),h(this,Yr).addObserver(this),h(this,Yr).execute(n)}},So=new WeakMap,rc=new WeakMap,Yr=new WeakMap,Ao=new WeakMap,pl=new WeakSet,r1=function(){var r;const n=((r=h(this,Yr))==null?void 0:r.state)??mB();k(this,rc,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},tE=function(n){kn.batch(()=>{var r,i,s,a,o,l,u,d;if(h(this,Ao)&&this.hasListeners()){const f=h(this,rc).variables,p=h(this,rc).context,m={client:h(this,So),meta:this.options.meta,mutationKey:this.options.mutationKey};(n==null?void 0:n.type)==="success"?((i=(r=h(this,Ao)).onSuccess)==null||i.call(r,n.data,f,p,m),(a=(s=h(this,Ao)).onSettled)==null||a.call(s,n.data,null,f,p,m)):(n==null?void 0:n.type)==="error"&&((l=(o=h(this,Ao)).onError)==null||l.call(o,n.error,f,p,m),(d=(u=h(this,Ao)).onSettled)==null||d.call(u,void 0,n.error,f,p,m))}this.listeners.forEach(f=>{f(h(this,rc))})})},HF),Aa,qF,yq=(qF=class extends Ig{constructor(e={}){super();E(this,Aa);this.config=e,k(this,Aa,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??yT(i,n);let a=this.get(s);return a||(a=new cq({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){h(this,Aa).has(e.queryHash)||(h(this,Aa).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=h(this,Aa).get(e.queryHash);n&&(e.destroy(),n===e&&h(this,Aa).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){kn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return h(this,Aa).get(e)}getAll(){return[...h(this,Aa).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>oR(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>oR(e,r)):n}notify(e){kn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){kn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){kn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Aa=new WeakMap,qF),Yt,ic,sc,bp,wp,ac,_p,Sp,GF,vq=(GF=class{constructor(t={}){E(this,Yt);E(this,ic);E(this,sc);E(this,bp);E(this,wp);E(this,ac);E(this,_p);E(this,Sp);k(this,Yt,t.queryCache||new yq),k(this,ic,t.mutationCache||new mq),k(this,sc,t.defaultOptions||{}),k(this,bp,new Map),k(this,wp,new Map),k(this,ac,0)}mount(){Vt(this,ac)._++,h(this,ac)===1&&(k(this,_p,xT.subscribe(async t=>{t&&(await this.resumePausedMutations(),h(this,Yt).onFocus())})),k(this,Sp,u_.subscribe(async t=>{t&&(await this.resumePausedMutations(),h(this,Yt).onOnline())})))}unmount(){var t,e;Vt(this,ac)._--,h(this,ac)===0&&((t=h(this,_p))==null||t.call(this),k(this,_p,void 0),(e=h(this,Sp))==null||e.call(this),k(this,Sp,void 0))}isFetching(t){return h(this,Yt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return h(this,ic).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=h(this,Yt).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=h(this,Yt).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(du(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return h(this,Yt).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=h(this,Yt).get(r.queryHash),s=i==null?void 0:i.state.data,a=Z7(e,s);if(a!==void 0)return h(this,Yt).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return kn.batch(()=>h(this,Yt).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=h(this,Yt).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=h(this,Yt);kn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=h(this,Yt);return kn.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=kn.batch(()=>h(this,Yt).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(Or).catch(Or)}invalidateQueries(t,e={}){return kn.batch(()=>(h(this,Yt).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=kn.batch(()=>h(this,Yt).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(Or)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(Or)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=h(this,Yt).build(this,e);return n.isStaleByTime(du(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Or).catch(Or)}fetchInfiniteQuery(t){return t.behavior=pR(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Or).catch(Or)}ensureInfiniteQueryData(t){return t.behavior=pR(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return u_.isOnline()?h(this,ic).resumePausedMutations():Promise.resolve()}getQueryCache(){return h(this,Yt)}getMutationCache(){return h(this,ic)}getDefaultOptions(){return h(this,sc)}setDefaultOptions(t){k(this,sc,t)}setQueryDefaults(t,e){h(this,bp).set(Wh(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...h(this,bp).values()],n={};return e.forEach(r=>{F0(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){h(this,wp).set(Wh(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...h(this,wp).values()],n={};return e.forEach(r=>{F0(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...h(this,sc).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=yT(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===vT&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...h(this,sc).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){h(this,Yt).clear(),h(this,ic).clear()}},Yt=new WeakMap,ic=new WeakMap,sc=new WeakMap,bp=new WeakMap,wp=new WeakMap,ac=new WeakMap,_p=new WeakMap,Sp=new WeakMap,GF),gB=T.createContext(void 0),Xe=t=>{const e=T.useContext(gB);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},xq=({client:t,children:e})=>(T.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),c.jsx(gB.Provider,{value:t,children:e})),yB=T.createContext(!1),bq=()=>T.useContext(yB);yB.Provider;function wq(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var _q=T.createContext(wq()),Sq=()=>T.useContext(_q),Aq=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},jq=t=>{T.useEffect(()=>{t.clearReset()},[t])},kq=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||cB(n,[t.error,r])),Nq=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Eq=(t,e)=>t.isLoading&&t.isFetching&&!e,Cq=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,gR=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function Pq(t,e,n){var f,p,m,y,g;const r=bq(),i=Sq(),s=Xe(),a=s.defaultQueryOptions(t);(p=(f=s.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||p.call(f,a),a._optimisticResults=r?"isRestoring":"optimistic",Nq(a),Aq(a,i),jq(i);const o=!s.getQueryCache().get(a.queryHash),[l]=T.useState(()=>new e(s,a)),u=l.getOptimisticResult(a),d=!r&&t.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(v=>{const b=d?l.subscribe(kn.batchCalls(v)):Or;return l.updateResult(),b},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),T.useEffect(()=>{l.setOptions(a)},[a,l]),Cq(a,u))throw gR(a,l,i);if(kq({result:u,errorResetBoundary:i,throwOnError:a.throwOnError,query:s.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;if((y=(m=s.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||y.call(m,a,u),a.experimental_prefetchInRender&&!zh&&Eq(u,r)){const v=o?gR(a,l,i):(g=s.getQueryCache().get(a.queryHash))==null?void 0:g.promise;v==null||v.catch(Or).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?u:l.trackResult(u)}function Bt(t,e){return Pq(t,uq)}function et(t,e){const n=Xe(),[r]=T.useState(()=>new gq(n,t));T.useEffect(()=>{r.setOptions(t)},[r,t]);const i=T.useSyncExternalStore(T.useCallback(a=>r.subscribe(kn.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),s=T.useCallback((a,o)=>{r.mutate(a,o).catch(Or)},[r]);if(i.error&&cB(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}const Tq="modulepreload",Oq=function(t){return"/fire-app/"+t},yR={},Pb=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=Oq(l),l in yR)return;yR[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Tq,u||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})},Mq=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Pb(async()=>{const{default:r}=await Promise.resolve().then(()=>Dg);return{default:r}},[]).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class wT extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class vR extends wT{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class xR extends wT{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bR extends wT{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var nE;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(nE||(nE={}));var Rq=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class Iq{constructor(e,{headers:n={},customFetch:r,region:i=nE.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=Mq(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Rq(this,arguments,void 0,function*(n,r={}){var i;try{const{headers:s,method:a,body:o,signal:l}=r;let u={},{region:d}=r;d||(d=this.region);const f=new URL(`${this.url}/${n}`);d&&d!=="any"&&(u["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let p;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(u["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(u["Content-Type"]="application/json",p=JSON.stringify(o)));const m=yield this.fetch(f.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:p,signal:l}).catch(b=>{throw b.name==="AbortError"?b:new vR(b)}),y=m.headers.get("x-relay-error");if(y&&y==="true")throw new xR(m);if(!m.ok)throw new bR(m);let g=((i=m.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),v;return g==="application/json"?v=yield m.json():g==="application/octet-stream"?v=yield m.blob():g==="text/event-stream"?v=m:g==="multipart/form-data"?v=yield m.formData():v=yield m.text(),{data:v,error:null,response:m}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new vR(s)}:{data:null,error:s,response:s instanceof bR||s instanceof xR?s.context:void 0}}})}}var si={},_T={},pA={},Tb={},mA={},gA={},Dq=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ng=Dq();const $q=ng.fetch,vB=ng.fetch.bind(ng),xB=ng.Headers,Lq=ng.Request,Fq=ng.Response,Dg=Object.freeze(Object.defineProperty({__proto__:null,Headers:xB,Request:Lq,Response:Fq,default:vB,fetch:$q},Symbol.toStringTag,{value:"Module"})),Bq=SW(Dg);var yA={};Object.defineProperty(yA,"__esModule",{value:!0});let Uq=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};yA.default=Uq;var bB=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gA,"__esModule",{value:!0});const zq=bB(Bq),Wq=bB(yA);let Hq=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=zq.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l,u;let d=null,f=null,p=null,m=s.status,y=s.statusText;if(s.ok){if(this.method!=="HEAD"){const x=await s.text();x===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?f=x:f=JSON.parse(x))}const v=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),b=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,m=406,y="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const v=await s.text();try{d=JSON.parse(v),Array.isArray(d)&&s.status===404&&(f=[],d=null,m=200,y="OK")}catch{s.status===404&&v===""?(m=204,y="No Content"):d={message:v}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,m=200,y="OK"),d&&this.shouldThrowOnError)throw new Wq.default(d)}return{error:d,data:f,count:p,status:m,statusText:y}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};gA.default=Hq;var qq=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(mA,"__esModule",{value:!0});const Gq=qq(gA);let Kq=class extends Gq.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};mA.default=Kq;var Vq=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tb,"__esModule",{value:!0});const Yq=Vq(mA);let Xq=class extends Yq.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Tb.default=Xq;var Qq=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pA,"__esModule",{value:!0});const ly=Qq(Tb);let Jq=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=i}select(e,n){const{head:r=!1,count:i}=n??{},s=r?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),i&&this.headers.append("Prefer",`count=${i}`),new ly.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var i;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ly.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new ly.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:n}={}){var r;const i="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new ly.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new ly.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};pA.default=Jq;var wB=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_T,"__esModule",{value:!0});const Zq=wB(pA),eG=wB(Tb);let tG=class _B{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new Zq.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new _B(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let u;r||i?(o=r?"HEAD":"GET",Object.entries(n).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{l.searchParams.append(f,p)})):(o="POST",u=n);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new eG.default({method:o,url:l,headers:d,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};_T.default=tG;var $g=xr&&xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(si,"__esModule",{value:!0});si.PostgrestError=si.PostgrestBuilder=si.PostgrestTransformBuilder=si.PostgrestFilterBuilder=si.PostgrestQueryBuilder=si.PostgrestClient=void 0;const SB=$g(_T);si.PostgrestClient=SB.default;const AB=$g(pA);si.PostgrestQueryBuilder=AB.default;const jB=$g(Tb);si.PostgrestFilterBuilder=jB.default;const kB=$g(mA);si.PostgrestTransformBuilder=kB.default;const NB=$g(gA);si.PostgrestBuilder=NB.default;const EB=$g(yA);si.PostgrestError=EB.default;var nG=si.default={PostgrestClient:SB.default,PostgrestQueryBuilder:AB.default,PostgrestFilterBuilder:jB.default,PostgrestTransformBuilder:kB.default,PostgrestBuilder:NB.default,PostgrestError:EB.default};const{PostgrestClient:rG,PostgrestQueryBuilder:MNe,PostgrestFilterBuilder:RNe,PostgrestTransformBuilder:INe,PostgrestBuilder:DNe,PostgrestError:$Ne}=nG;class iG{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const sG="2.75.1",aG=`realtime-js/${sG}`,oG="1.0.0",rE=1e4,lG=1e3,cG=100;var u0;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(u0||(u0={}));var bn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(bn||(bn={}));var ta;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ta||(ta={}));var iE;(function(t){t.websocket="websocket"})(iE||(iE={}));var Gu;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Gu||(Gu={}));class uG{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+i));a=a+i;const l=r.decode(e.slice(a,a+s));a=a+s;const u=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class CB{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var wt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(wt||(wt={}));const wR=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((s,a)=>(s[a]=dG(a,t,e,i),s),{}):{}},dG=(t,e,n,r)=>{const i=e.find(o=>o.name===t),s=i==null?void 0:i.type,a=n[t];return s&&!r.includes(s)?PB(s,a):sE(a)},PB=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return mG(e,n)}switch(t){case wt.bool:return hG(e);case wt.float4:case wt.float8:case wt.int2:case wt.int4:case wt.int8:case wt.numeric:case wt.oid:return fG(e);case wt.json:case wt.jsonb:return pG(e);case wt.timestamp:return gG(e);case wt.abstime:case wt.date:case wt.daterange:case wt.int4range:case wt.int8range:case wt.money:case wt.reltime:case wt.text:case wt.time:case wt.timestamptz:case wt.timetz:case wt.tsrange:case wt.tstzrange:return sE(e);default:return sE(e)}},sE=t=>t,hG=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},fG=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},pG=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},mG=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const a=t.slice(1,n);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>PB(e,o))}return t},gG=t=>typeof t=="string"?t.replace(" ","T"):t,TB=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Zj{constructor(e,n,r={},i=rE){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var _R;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(_R||(_R={}));class d0{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=d0.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=d0.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=d0.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),a=this.transformState(n),o={},l={};return this.map(s,(u,d)=>{a[u]||(l[u]=d)}),this.map(a,(u,d)=>{const f=s[u];if(f){const p=d.map(v=>v.presence_ref),m=f.map(v=>v.presence_ref),y=d.filter(v=>m.indexOf(v.presence_ref)<0),g=f.filter(v=>p.indexOf(v.presence_ref)<0);y.length>0&&(o[u]=y),g.length>0&&(l[u]=g)}else o[u]=d}),this.syncDiff(s,{joins:o,leaves:l},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const f=e[o].map(m=>m.presence_ref),p=d.filter(m=>f.indexOf(m.presence_ref)<0);e[o].unshift(...p)}r(o,d,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),e[o]=u,i(o,u,l),u.length===0&&delete e[o]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var SR;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(SR||(SR={}));var h0;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(h0||(h0={}));var go;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(go||(go={}));class ST{constructor(e,n={config:{}},r){var i,s;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=bn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Zj(this,ta.join,this.params,this.timeout),this.rejoinTimer=new CB(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=bn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ta.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new d0(this),this.broadcastEndpointURL=TB(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==bn.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,u=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[h0.PRESENCE]&&this.bindings[h0.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},p={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(go.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(go.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var y;if(this.socket.setAuth(),m===void 0){e==null||e(go.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(y=g==null?void 0:g.length)!==null&&y!==void 0?y:0,b=[];for(let x=0;x<v;x++){const w=g[x],{filter:{event:S,schema:_,table:A,filter:j}}=w,N=m&&m[x];if(N&&N.event===S&&N.schema===_&&N.table===A&&N.filter===j)b.push(Object.assign(Object.assign({},w),{id:N.id}));else{this.unsubscribe(),this.state=bn.errored,e==null||e(go.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(go.SUBSCRIBED);return}}).receive("error",m=>{this.state=bn.errored,e==null||e(go.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(go.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===bn.joined&&e===h0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=bn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ta.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new Zj(this,ta.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=bn.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Zj(this,e,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>cG){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=ta;if(r&&[o,l,u,d].indexOf(a)>=0&&r!==this._joinRef())return;let p=this._onMessage(a,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var y,g,v;return((y=m.filter)===null||y===void 0?void 0:y.event)==="*"||((v=(g=m.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(m=>m.callback(p,r)):(s=this.bindings[a])===null||s===void 0||s.filter(m=>{var y,g,v,b,x,w;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const S=m.id,_=(y=m.filter)===null||y===void 0?void 0:y.event;return S&&((g=n.ids)===null||g===void 0?void 0:g.includes(S))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const S=(x=(b=m==null?void 0:m.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return S==="*"||S===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:g,table:v,commit_timestamp:b,type:x,errors:w}=y;p=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:b,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(y))}m.callback(p,r)})}_isClosed(){return this.state===bn.closed}_isJoined(){return this.state===bn.joined}_isJoining(){return this.state===bn.joining}_isLeaving(){return this.state===bn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&ST.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ta.close,{},e)}_onError(e){this._on(ta.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=wR(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=wR(e.columns,e.old_record)),n}}const ek=()=>{},pw={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},yG=[1e3,2e3,5e3,1e4],vG=1e4,xG=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bG{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=rE,this.transport=null,this.heartbeatIntervalMs=pw.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ek,this.ref=0,this.reconnectTimer=null,this.logger=ek,this.conn=null,this.sendBuffer=[],this.serializer=new uG,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...a)=>Pb(async()=>{const{default:o}=await Promise.resolve().then(()=>Dg);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...a)=>s(...a)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${iE.websocket}`,this.httpEndpoint=TB(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=iG.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oG}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case u0.connecting:return Gu.Connecting;case u0.open:return Gu.Open;case u0.closing:return Gu.Closing;default:return Gu.Closed}}isConnected(){return this.connectionState()===Gu.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new ST(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(lG,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},pw.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:s,ref:a}=n,o=a?`(${a})`:"",l=s.status||"";this.log("receive",`${l} ${r} ${i} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(i,s,a)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ta.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([xG],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:aG};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(ta.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new CB(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pw.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,i,s,a,o,l,u,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:rE,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:pw.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:ek,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:f=>yG[f-1]||vG,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(f,p)=>p(JSON.stringify(f)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class AT extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function pn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wG extends AT{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class aE extends AT{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var _G=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const OB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Pb(async()=>{const{default:r}=await Promise.resolve().then(()=>Dg);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},SG=()=>_G(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Pb(()=>Promise.resolve().then(()=>Dg),void 0)).Response:Response}),oE=t=>{if(Array.isArray(t))return t.map(n=>oE(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=oE(r)}),e},AG=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var ef=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const tk=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),jG=(t,e,n)=>ef(void 0,void 0,void 0,function*(){const r=yield SG();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{const s=t.status||500,a=(i==null?void 0:i.statusCode)||s+"";e(new wG(tk(i),s,a))}).catch(i=>{e(new aE(tk(i),i))}):e(new aE(tk(t),t))}),kG=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?i:(AG(r)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(r)):i.body=r,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function Ob(t,e,n,r,i,s){return ef(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(n,kG(e,r,i,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>jG(l,o,r))})})}function d_(t,e,n,r){return ef(this,void 0,void 0,function*(){return Ob(t,"GET",e,n,r)})}function ba(t,e,n,r,i){return ef(this,void 0,void 0,function*(){return Ob(t,"POST",e,r,i,n)})}function lE(t,e,n,r,i){return ef(this,void 0,void 0,function*(){return Ob(t,"PUT",e,r,i,n)})}function NG(t,e,n,r){return ef(this,void 0,void 0,function*(){return Ob(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function MB(t,e,n,r,i){return ef(this,void 0,void 0,function*(){return Ob(t,"DELETE",e,r,i,n)})}var EG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class CG{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n}then(e,n){return this.execute().then(e,n)}execute(){return EG(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pn(e))return{data:null,error:e};throw e}})}}var PG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})},RB;class TG{constructor(e,n){this.downloadFn=e,this.shouldThrowOnError=n,this[RB]="BlobDownloadBuilder",this.promise=null}asStream(){return new CG(this.downloadFn,this.shouldThrowOnError)}then(e,n){return this.getPromise().then(e,n)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return PG(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pn(e))return{data:null,error:e};throw e}})}}RB=Symbol.toStringTag;var qr=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const OG={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},AR={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class MG{constructor(e,n={},r,i){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=OB(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,i){return qr(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},AR),i);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const u=this._removeEmptyFolders(n),d=this._getFinalPath(u),f=yield(e=="PUT"?lE:ba)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pn(s))return{data:null,error:s};throw s}})}upload(e,n,r){return qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return qr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:AR.upsert},i),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield lE(this.fetch,o.toString(),l,{headers:d});return{data:{path:s,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return qr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const s=yield ba(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new AT("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}})}update(e,n,r){return qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return qr(this,void 0,void 0,function*(){try{return{data:yield ba(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}copy(e,n,r){return qr(this,void 0,void 0,function*(){try{return{data:{path:(yield ba(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return qr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield ba(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return qr(this,void 0,void 0,function*(){try{const i=yield ba(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}download(e,n){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),a=s?`?${s}`:"",o=this._getFinalPath(e),l=()=>d_(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new TG(l,this.shouldThrowOnError)}info(e){return qr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield d_(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:oE(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}})}exists(e){return qr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield NG(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pn(r)&&r instanceof aE){const i=r.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const o=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}remove(e){return qr(this,void 0,void 0,function*(){try{return{data:yield MB(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pn(n))return{data:null,error:n};throw n}})}list(e,n,r){return qr(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},OG),n),{prefix:e||""});return{data:yield ba(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}listV2(e,n){return qr(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ba(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const RG="2.75.1",IG={"X-Client-Info":`storage-js/${RG}`};var cf=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class DG{constructor(e,n={},r,i){this.shouldThrowOnError=!1;const s=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},IG),n),this.fetch=OB(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return cf(this,void 0,void 0,function*(){try{return{data:yield d_(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pn(e))return{data:null,error:e};throw e}})}getBucket(e){return cf(this,void 0,void 0,function*(){try{return{data:yield d_(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pn(n))return{data:null,error:n};throw n}})}createBucket(e){return cf(this,arguments,void 0,function*(n,r={public:!1}){try{return{data:yield ba(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(pn(i))return{data:null,error:i};throw i}})}updateBucket(e,n){return cf(this,void 0,void 0,function*(){try{return{data:yield lE(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return cf(this,void 0,void 0,function*(){try{return{data:yield ba(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return cf(this,void 0,void 0,function*(){try{return{data:yield MB(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pn(n))return{data:null,error:n};throw n}})}}class $G extends DG{constructor(e,n={},r,i){super(e,n,r,i)}from(e){return new MG(this.url,this.headers,e,this.fetch)}}const LG="2.75.1";let Oy="";typeof Deno<"u"?Oy="deno":typeof document<"u"?Oy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oy="react-native":Oy="node";const FG={"X-Client-Info":`supabase-js-${Oy}/${LG}`},BG={headers:FG},UG={schema:"public"},zG={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},WG={};var HG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};const qG=t=>{let e;return t?e=t:typeof fetch>"u"?e=vB:e=fetch,(...n)=>e(...n)},GG=()=>typeof Headers>"u"?xB:Headers,KG=(t,e,n)=>{const r=qG(n),i=GG();return(s,a)=>HG(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let u=new i(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},a),{headers:u}))})};var VG=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};function YG(t){return t.endsWith("/")?t:t+"/"}function XG(t,e){var n,r;const{db:i,auth:s,realtime:a,global:o}=t,{db:l,auth:u,realtime:d,global:f}=e,p={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(n=f==null?void 0:f.headers)!==null&&n!==void 0?n:{}),(r=o==null?void 0:o.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>VG(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function QG(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(YG(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const IB="2.75.1",_f=30*1e3,cE=3,nk=cE*_f,JG="http://localhost:9999",ZG="supabase.auth.token",eK={"X-Client-Info":`gotrue-js/${IB}`},uE="X-Supabase-Api-Version",DB={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tK=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nK=10*60*1e3;class B0 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function be(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class rK extends B0{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function iK(t){return be(t)&&t.name==="AuthApiError"}class Ku extends B0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Au extends B0{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class Ul extends Au{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sK(t){return be(t)&&t.name==="AuthSessionMissingError"}class uf extends Au{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class mw extends Au{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class gw extends Au{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aK(t){return be(t)&&t.name==="AuthImplicitGrantRedirectError"}class jR extends Au{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class dE extends Au{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function rk(t){return be(t)&&t.name==="AuthRetryableFetchError"}class kR extends Au{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class hE extends Au{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const h_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),NR=` 	
\r=`.split(""),oK=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<NR.length;e+=1)t[NR[e].charCodeAt(0)]=-2;for(let e=0;e<h_.length;e+=1)t[h_[e].charCodeAt(0)]=e;return t})();function ER(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(h_[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(h_[r]),e.queuedBits-=6}}function $B(t,e,n){const r=oK[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function CR(t){const e=[],n=a=>{e.push(String.fromCodePoint(a))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{uK(a,r,n)};for(let a=0;a<t.length;a+=1)$B(t.charCodeAt(a),i,s);return e.join("")}function lK(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function cK(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}lK(r,e)}}function uK(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function op(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)$B(t.charCodeAt(i),n,r);return new Uint8Array(e)}function dK(t){const e=[];return cK(t,n=>e.push(n)),new Uint8Array(e)}function rd(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>ER(i,n,r)),ER(null,n,r),e.join("")}function hK(t){return Math.round(Date.now()/1e3)+t}function fK(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const mi=()=>typeof window<"u"&&typeof document<"u",Tu={tested:!1,writable:!1},LB=()=>{if(!mi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Tu.tested)return Tu.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Tu.tested=!0,Tu.writable=!0}catch{Tu.tested=!0,Tu.writable=!1}return Tu.writable};function pK(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const FB=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Pb(async()=>{const{default:r}=await Promise.resolve().then(()=>Dg);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},mK=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Sf=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Ou=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Dl=async(t,e)=>{await t.removeItem(e)};class vA{constructor(){this.promise=new vA.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}vA.promiseConstructor=Promise;function ik(t){const e=t.split(".");if(e.length!==3)throw new hE("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!tK.test(e[r]))throw new hE("JWT not in base64url format");return{header:JSON.parse(CR(e[0])),payload:JSON.parse(CR(e[1])),signature:op(e[2]),raw:{header:e[0],payload:e[1]}}}async function gK(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function yK(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await t(s);if(!e(s,null,a)){r(a);return}}catch(a){if(!e(s,a)){i(a);return}}})()})}function vK(t){return("0"+t.toString(16)).substr(-2)}function xK(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,vK).join("")}async function bK(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function wK(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await bK(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function df(t,e,n=!1){const r=xK();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await Sf(t,`${e}-code-verifier`,i);const s=await wK(r);return[s,r===s?"plain":"s256"]}const _K=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function SK(t){const e=t.headers.get(uE);if(!e||!e.match(_K))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function AK(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function jK(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const kK=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hf(t){if(!kK.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function sk(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function PR(t){return JSON.parse(JSON.stringify(t))}var NK=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Lu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),EK=[502,503,504];async function TR(t){var e;if(!mK(t))throw new dE(Lu(t),0);if(EK.includes(t.status))throw new dE(Lu(t),t.status);let n;try{n=await t.json()}catch(s){throw new Ku(Lu(s),s)}let r;const i=SK(t);if(i&&i.getTime()>=DB["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new kR(Lu(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ul}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new kR(Lu(n),t.status,n.weak_password.reasons);throw new rK(Lu(n),t.status||500,r)}const CK=(t,e,n,r)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function ke(t,e,n,r){var i;const s=Object.assign({},r==null?void 0:r.headers);s[uE]||(s[uE]=DB["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const a=(i=r==null?void 0:r.query)!==null&&i!==void 0?i:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await PK(t,e,n+o,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function PK(t,e,n,r,i,s){const a=CK(e,r,i,s);let o;try{o=await t(n,Object.assign({},a))}catch(l){throw console.error(l),new dE(Lu(l),0)}if(o.ok||await TR(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(l){await TR(l)}}function Ds(t){var e;let n=null;MK(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=hK(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function OR(t){const e=Ds(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Yl(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function TK(t){return{data:t,error:null}}function OK(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,a=NK(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function MR(t){return t}function MK(t){return t.access_token&&t.refresh_token&&t.expires_in}const ak=["global","local","others"];var RK=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class IK{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=FB(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=ak[0]){if(ak.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ak.join(", ")}`);try{return await ke(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await ke(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Yl})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=RK(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r==null?void 0:r.newEmail,delete i.newEmail),await ke(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:OK,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(be(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Yl})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ke(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:MR});if(d.error)throw d.error;const f=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);u[`${v}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(be(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){hf(e);try{return await ke(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Yl})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){hf(e);try{return await ke(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Yl})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){hf(e);try{return await ke(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Yl})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){hf(e.userId);try{const{data:n,error:r}=await ke(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteFactor(e){hf(e.userId),hf(e.id);try{return{data:await ke(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,i,s,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:MR});if(d.error)throw d.error;const f=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(y=>{const g=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(y.split(";")[1].split("=")[1]);u[`${v}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(be(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ke(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await ke(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ke(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}}function RR(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const ff={debug:!!(globalThis&&LB()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BB extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class DK extends BB{}async function $K(t,e,n){ff.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),ff.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){ff.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{ff.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw ff.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new DK(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ff.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function LK(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function UB(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function FK(t){return parseInt(t,16)}function BK(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function UK(t){var e;const{chainId:n,domain:r,expirationTime:i,issuedAt:s=new Date,nonce:a,notBefore:o,requestId:l,resources:u,scheme:d,uri:f,version:p}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const m=UB(t.address),y=d?`${d}://${r}`:r,g=t.statement?`${t.statement}
`:"",v=`${y} wants you to sign in with your Ethereum account:
${m}

${g}`;let b=`URI: ${f}
Version: ${p}
Chain ID: ${n}${a?`
Nonce: ${a}`:""}
Issued At: ${s.toISOString()}`;if(i&&(b+=`
Expiration Time: ${i.toISOString()}`),o&&(b+=`
Not Before: ${o.toISOString()}`),l&&(b+=`
Request ID: ${l}`),u){let x=`
Resources:`;for(const w of u){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);x+=`
- ${w}`}b+=x}return`${v}
${b}`}class fn extends Error{constructor({message:e,code:n,cause:r,name:i}){var s;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(s=i??(r instanceof Error?r.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=n}}class f_ extends fn{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function zK({error:t,options:e}){var n,r,i;const{publicKey:s}=e;if(!s)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new fn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new fn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=s.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new fn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new fn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new fn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new fn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new fn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new fn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(WB(a)){if(s.rp.id!==a)return new fn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new fn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new fn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new fn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new fn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function WK({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new fn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new fn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(WB(r)){if(n.rpId!==r)return new fn({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new fn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new fn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new fn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}var zB=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class HK{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const qK=new HK;function GK(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,i=zB(t,["challenge","user","excludeCredentials"]),s=op(e).buffer,a=Object.assign(Object.assign({},n),{id:op(n.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:s,user:a});if(r&&r.length>0){o.excludeCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const u=r[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:op(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function KK(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=zB(t,["challenge","allowCredentials"]),i=op(e).buffer,s=Object.assign(Object.assign({},r),{challenge:i});if(n&&n.length>0){s.allowCredentials=new Array(n.length);for(let a=0;a<n.length;a++){const o=n[a];s.allowCredentials[a]=Object.assign(Object.assign({},o),{id:op(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function VK(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:rd(new Uint8Array(t.response.attestationObject)),clientDataJSON:rd(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function YK(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),i=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:rd(new Uint8Array(i.authenticatorData)),clientDataJSON:rd(new Uint8Array(i.clientDataJSON)),signature:rd(new Uint8Array(i.signature)),userHandle:i.userHandle?rd(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function WB(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function IR(){var t,e;return!!(mi()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function XK(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f_("Browser returned unexpected credential type",e)}:{data:null,error:new f_("Empty credential response",e)}}catch(e){return{data:null,error:zK({error:e,options:t})}}}async function QK(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new f_("Browser returned unexpected credential type",e)}:{data:null,error:new f_("Empty credential response",e)}}catch(e){return{data:null,error:WK({error:e,options:t})}}}const JK={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},ZK={userVerification:"preferred",hints:["security-key"]};function p_(...t){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),r={};for(const i of t)if(i)for(const s in i){const a=i[s];if(a!==void 0)if(Array.isArray(a))r[s]=a;else if(n(a))r[s]=a;else if(e(a)){const o=r[s];e(o)?r[s]=p_(o,a):r[s]=p_(a)}else r[s]=a}return r}function eV(t,e){return p_(JK,t,e||{})}function tV(t,e){return p_(ZK,t,e||{})}class nV{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:i},s){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!a)return{data:null,error:o};const l=i??qK.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${r}`),u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=eV(a.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:d,error:f}=await XK({publicKey:u,signal:l});return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=tV(a.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:d,error:f}=await QK(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:l}));return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Ku("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i}},s){if(!n)return{data:null,error:new B0("rpId is required for WebAuthn authentication")};try{if(!IR())return{data:null,error:new Ku("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:i},{request:s});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:n,rpOrigins:r,credential_response:l.credential_response}})}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Ku("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:i},s){if(!n)return{data:null,error:new B0("rpId is required for WebAuthn registration")};try{if(!IR())return{data:null,error:new Ku("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:i},{create:s});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:n,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(a){return be(a)?{data:null,error:a}:{data:null,error:new Ku("Unexpected error in register",a)}}}}LK();const rV={url:JG,storageKey:ZG,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eK,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function DR(t,e,n){return await n()}const pf={};class U0{get jwks(){var e,n;return(n=(e=pf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){pf[this.storageKey]=Object.assign(Object.assign({},pf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=pf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){pf[this.storageKey]=Object.assign(Object.assign({},pf[this.storageKey]),{cachedAt:e})}constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=U0.nextInstanceID,U0.nextInstanceID+=1,this.instanceID>0&&mi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},rV),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new IK({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=FB(i.fetch),this.lock=i.lock||DR,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:mi()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=$K:this.lock=DR,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new nV(this)},this.persistSession?(i.storage?this.storage=i.storage:LB()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=RR(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=RR(this.memoryStorage)),mi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${IB}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=pK(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),mi()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),aK(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return be(n)?{error:n}:{error:new Ku("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ds}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(be(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:d,password:f,options:p}=e;let m=null,y=null;this.flowType==="pkce"&&([m,y]=await df(this.storage,this.storageKey)),s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:y},xform:Ds})}else if("phone"in e){const{phone:d,password:f,options:p}=e;s=await ke(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Ds})}else throw new mw("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(be(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:a,options:o}=e;n=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:OR})}else if("phone"in e){const{phone:s,password:a,options:o}=e;n=await ke(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:OR})}else throw new mw("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new uf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,i,s,a,o,l,u,d,f,p;let m,y;if("message"in e)m=e.message,y=e.signature;else{const{chain:g,wallet:v,statement:b,options:x}=e;let w;if(mi())if(typeof v=="object")w=v;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")w=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=v}const S=new URL((n=x==null?void 0:x.url)!==null&&n!==void 0?n:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const A=UB(_[0]);let j=(r=x==null?void 0:x.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!j){const P=await w.request({method:"eth_chainId"});j=FK(P)}const N={domain:S.host,address:A,statement:b,uri:S.href,version:"1",chainId:j,nonce:(i=x==null?void 0:x.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(s=x==null?void 0:x.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=x==null?void 0:x.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=x==null?void 0:x.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=x==null?void 0:x.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=x==null?void 0:x.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=UK(N),y=await w.request({method:"personal_sign",params:[BK(m),A]})}try{const{data:g,error:v}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:y},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ds});if(v)throw v;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new uf}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:v})}catch(g){if(be(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(e){var n,r,i,s,a,o,l,u,d,f,p,m;let y,g;if("message"in e)y=e.message,g=e.signature;else{const{chain:v,wallet:b,statement:x,options:w}=e;let S;if(mi())if(typeof b=="object")S=b;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))S=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=b}const _=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const A=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),x?{statement:x}:null));let j;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")j=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)j=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)y=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),g=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${_.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...x?["",x,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(i=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(d=w==null?void 0:w.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const A=await S.signMessage(new TextEncoder().encode(y),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=A}}try{const{data:v,error:b}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:rd(g)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Ds});if(b)throw b;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new uf}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:b})}catch(v){if(be(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(e){const n=await Ou(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:a}=await ke(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ds});if(await Dl(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new uf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(be(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:a}=e,o=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ds}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new uf}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await df(this.storage,this.storageKey));const{error:f}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await ke(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new mw("You must provide either an email or phone number.")}catch(o){if(be(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await ke(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Ds});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(be(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await df(this.storage,this.storageKey)),await ke(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:TK})}catch(s){if(be(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ul;const{error:i}=await ke(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:a}=await ke(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:a,error:o}=await ke(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new mw("You must provide either an email or phone number and a type")}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Ou(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<nk:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const a=await Ou(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=sk()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Yl}):await this._useSession(async n=>{var r,i,s;const{data:a,error:o}=n;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ul}:await ke(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Yl})})}catch(n){if(be(n))return sK(n)&&(await this._removeSession(),await Dl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new Ul;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await df(this.storage,this.storageKey));const{data:u,error:d}=await ke(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Yl});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ul;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:a}=ik(e.access_token);if(a.exp&&(r=a.exp,i=r<=n),i){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(be(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:o}=n;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ul;const{data:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(be(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!mi())throw new gw("No browser detected.");if(e.error||e.error_description||e.error_code)throw new gw(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new jR("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new gw("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new jR("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!s||!o||!a||!u)throw new gw("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let p=d+f;l&&(p=parseInt(l));const m=p-d;m*1e3<=_f&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const y=p-f;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:g,error:v}=await this._getUser(s);if(v)throw v;const b={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:p,refresh_token:a,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(r){if(be(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Ou(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const a=(r=i.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(iK(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Dl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=fK(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await df(this.storage,this.storageKey,!0));try{return await ke(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(be(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var a,o,l,u,d;const{data:f,error:p}=s;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ke(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return mi()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(be(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:i,data:{session:s}}=n;if(i)throw i;const{options:a,provider:o,token:l,access_token:u,nonce:d}=e,f=await ke(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=s==null?void 0:s.access_token)!==null&&r!==void 0?r:void 0,body:{provider:o,id_token:l,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Ds}),{data:p,error:m}=f;return m?{data:{user:null,session:null},error:m}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new uf}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),{data:p,error:m})}catch(i){if(be(i))return{data:{user:null,session:null},error:i};throw i}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)throw a;return await ke(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await yK(async i=>(i>0&&await gK(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await ke(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ds})),(i,s)=>{const a=200*Math.pow(2,i);return s&&rk(s)&&Date.now()+a-r<_f})}catch(r){if(this._debug(n,"error",r),be(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),mi()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await Ou(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Ou(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Sf(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:sk()}else if(i&&!i.user&&!i.user){const a=await Ou(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await Dl(this.storage,this.storageKey+"-user"),await Sf(this.storage,this.storageKey,i)):i.user=sk()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<nk;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${nk}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),rk(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ul;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new vA;const{data:s,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new Ul;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),be(s)){const a={data:null,error:s};return rk(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Sf(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=PR(i);await Sf(this.storage,this.storageKey,s)}else{const i=PR(n);await Sf(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Dl(this.storage,this.storageKey),await Dl(this.storage,this.storageKey+"-code-verifier"),await Dl(this.storage,this.storageKey+"-user"),this.userStorage&&await Dl(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&mi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_f);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/_f);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${_f}ms, refresh threshold is ${cE} ticks`),i<=cE&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof BB)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,a]=await df(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await ke(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:a}=n;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:u}=await ke(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(be(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?VK(e.webauthn.credential_response):YK(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const a=await ke(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:GK(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:KK(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(be(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=ik(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(o=>o.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+nK>i)return r;const{data:s,error:a}=await ke(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(o=>o.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:m,error:y}=await this.getSession();if(y||!m.session)return{data:null,error:y};r=m.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=ik(r);n!=null&&n.allowExpired||AK(s.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:s,header:i,signature:a},error:null}}const d=jK(i.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,a,dK(`${o}.${l}`)))throw new hE("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}}U0.nextInstanceID=0;const iV=U0;class sV extends iV{constructor(e){super(e)}}var aV=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{u(r.next(d))}catch(f){a(f)}}function l(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(o,l)}u((r=r.apply(t,e||[])).next())})};class oV{constructor(e,n,r){var i,s,a;this.supabaseUrl=e,this.supabaseKey=n;const o=QG(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:UG,realtime:WG,auth:Object.assign(Object.assign({},zG),{storageKey:l}),global:BG},d=XG(r??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=KG(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new rG(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new $G(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Iq(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return aV(this,void 0,void 0,function*(){var e,n;if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,storageKey:a,flowType:o,lock:l,debug:u},d,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sV({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),d),storageKey:a,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,flowType:o,lock:l,debug:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new bG(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const lV=(t,e,n)=>new oV(t,e,n);function cV(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}cV()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const uV="https://slgmjbbwqhcqtguudglc.supabase.co",dV="";throw new Error("Missing Supabase environment variables. Ensure VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY are set in .env.local");const he=lV(uV,dV,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});async function hV(){const{data:{user:t}}=await he.auth.getUser();return(t==null?void 0:t.id)??null}async function He(){const t=await hV();if(!t)throw new Error("Authentication required");return t}const Vu={enabled:!1,level:"info",logToConsole:!0},$R={debug:0,info:1,warn:2,error:3};function yw(t){return Vu.enabled?$R[t]>=$R[Vu.level]:t==="error"}function vw(t,e,n){const r=new Date().toISOString(),i=n?` | ${JSON.stringify(n)}`:"";return`[${r}] [${t.toUpperCase()}] ${e}${i}`}const Me={debug(t,e){yw("debug")&&Vu.logToConsole&&console.log(vw("debug",t,e))},info(t,e){yw("info")&&Vu.logToConsole&&console.log(vw("info",t,e))},warn(t,e){yw("warn")&&Vu.logToConsole&&console.warn(vw("warn",t,e))},error(t,e,n){if(yw("error")&&Vu.logToConsole){const r=e instanceof Error?{name:e.name,message:e.message,stack:e.stack}:{error:e};console.error(vw("error",t,{...r,...n}))}},configure(t){Object.assign(Vu,t)}};function aa(t,e){Me.info(`[SETUP] ${t}`,e)}const HB=T.createContext(void 0);function Mb(){const t=T.useContext(HB);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function fV({children:t}){const[e,n]=T.useState(null),[r,i]=T.useState(null),[s,a]=T.useState(!0);T.useEffect(()=>{he.auth.getSession().then(({data:{session:f}})=>{i(f),n((f==null?void 0:f.user)??null),a(!1),f!=null&&f.user&&LR(f.user)});const{data:{subscription:d}}=he.auth.onAuthStateChange((f,p)=>{i(p),n((p==null?void 0:p.user)??null),a(!1),p!=null&&p.user&&LR(p.user)});return()=>{d.unsubscribe()}},[]);const u={user:e,session:r,loading:s,signInWithGoogle:async()=>{try{await he.auth.signInWithOAuth({provider:"google",options:{redirectTo:"https://zeekaj.github.io/fire-app/"}})}catch(d){Me.error("Sign-in error",d)}},signOut:async()=>{try{await he.auth.signOut()}catch(d){Me.error("Sign-out error",d)}}};return c.jsx(HB.Provider,{value:u,children:t})}async function LR(t){try{const{error:e}=await he.from("users").upsert({id:t.id,email:t.email},{onConflict:"id",ignoreDuplicates:!0});e&&Me.error("Error creating user record",e)}catch(e){Me.error("Unexpected error creating user",e)}}function pV(){const{signInWithGoogle:t}=Mb(),[e,n]=T.useState(!1),r=async()=>{n(!0);try{await t()}catch(i){Me.error("Sign-in failed",i),n(!1)}};return c.jsx("div",{className:"min-h-screen bg-[#F9FAFB] flex items-center justify-center px-4",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#E4572E] to-[#CC4E29] mb-4 shadow-lg",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),c.jsx("h1",{className:"text-3xl font-bold text-[#0F1115] mb-2",children:"FIRE Finance"}),c.jsx("p",{className:"text-[#4B5563] text-base",children:"Track your path to financial independence"})]}),c.jsx("div",{className:"bg-white rounded-[14px] shadow-sm p-8 border border-gray-100",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-xl font-semibold text-[#0F1115] mb-2",children:"Welcome back"}),c.jsx("p",{className:"text-sm text-[#4B5563]",children:"Sign in with your Google account to continue"})]}),c.jsx("button",{onClick:r,disabled:e,className:"w-full flex items-center justify-center gap-3 px-6 py-3 bg-[#E4572E] hover:bg-[#CC4E29] text-white font-medium rounded-[14px] transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:e?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c.jsx("span",{children:"Signing in..."})]}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:[c.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),c.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),c.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),c.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),c.jsx("span",{children:"Continue with Google"})]})}),c.jsx("div",{className:"text-center text-xs text-[#4B5563]",children:c.jsxs("p",{children:["By signing in, you agree to our"," ",c.jsx("a",{href:"#",className:"text-[#E4572E] hover:underline",children:"Terms of Service"})," ","and"," ",c.jsx("a",{href:"#",className:"text-[#E4572E] hover:underline",children:"Privacy Policy"})]})})]})}),c.jsxs("div",{className:"mt-8 grid grid-cols-3 gap-4 text-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-[#2E86AB] font-semibold text-sm mb-1",children:" Secure"}),c.jsx("div",{className:"text-xs text-[#4B5563]",children:"End-to-end encryption"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-[#2E86AB] font-semibold text-sm mb-1",children:" Insights"}),c.jsx("div",{className:"text-xs text-[#4B5563]",children:"FIRE projections"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-[#2E86AB] font-semibold text-sm mb-1",children:" Simple"}),c.jsx("div",{className:"text-xs text-[#4B5563]",children:"Manual tracking"})]})]})]})})}function mV({children:t}){const{user:e,loading:n}=Mb();return n?c.jsx("div",{className:"min-h-screen bg-[#F9FAFB] flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-[#E4572E] to-[#CC4E29] mb-4 animate-pulse",children:c.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),c.jsx("p",{className:"text-[#4B5563] text-sm",children:"Loading..."})]})}):e?c.jsx(c.Fragment,{children:t}):c.jsx(pV,{})}async function ks(t,e){const n=await He(),i=(Array.isArray(e)?e:[e]).map(o=>({...o,created_by:n})),{data:s,error:a}=await he.from(t).insert(i).select();if(a)throw a;return s}function qB(t){const e=new Date(t),n=new Date;let r=n.getFullYear()-e.getFullYear();const i=n.getMonth()-e.getMonth();return(i<0||i===0&&n.getDate()<e.getDate())&&r--,r}function gV(t){const e={},{transactionType:n,accountId:r,toAccountId:i,payeeName:s,categoryId:a,amount:o,date:l}=t;r||(e.accountId="Account is required");const u=typeof o=="string"?parseFloat(o||""):o;if(u===void 0||Number.isNaN(u)||u<=0?e.amount="Valid positive amount is required":Math.abs(u)>1e9&&(e.amount="Amount is unrealistically large"),!l)e.date="Date is required";else{const d=new Date(l);if(isNaN(d.getTime()))e.date="Invalid date";else{const f=new Date,p=new Date;p.setFullYear(f.getFullYear()+1),d>p&&(e.date="Date is too far in the future"),d<new Date("1900-01-01")&&(e.date="Date is too far in the past")}}return n==="transfer"||n==="payment"?(i||(e.toAccountId="Destination account is required"),i&&r&&i===r&&(e.toAccountId="Destination account must be different")):((!s||!s.trim())&&(e.payeeName="Payee is required"),a||(e.categoryId="Category is required")),e}const fE=[{name:"Checking",icon:"bank",color:"#2E86AB",sort_order:1},{name:"Savings",icon:"piggy-bank",color:"#10B981",sort_order:2},{name:"Credit Card",icon:"credit-card",color:"#F59E0B",sort_order:3},{name:"Investment",icon:"trending-up",color:"#8B5CF6",sort_order:4},{name:"Retirement",icon:"shield",color:"#14B8A6",sort_order:5},{name:"HSA",icon:"heart",color:"#06B6D4",sort_order:6},{name:"Mortgage",icon:"home",color:"#EF4444",sort_order:7},{name:"Cash",icon:"wallet",color:"#6B7280",sort_order:8},{name:"Asset",icon:"box",color:"#6366F1",sort_order:9}],FR=[{name:"Income",is_budgetable:!1},{name:"Housing"},{name:"Transportation"},{name:"Food"},{name:"Utilities"},{name:"Healthcare"},{name:"Insurance"},{name:"Debt Payments",is_debt_service:!0},{name:"Savings & Investments",is_budgetable:!1,is_transfer:!0},{name:"Personal"},{name:"Entertainment"},{name:"Giving"},{name:"Travel",is_envelope:!0},{name:"Taxes",is_budgetable:!1},{name:"Uncategorized"},{name:"Salary",parent:"Income"},{name:"Bonus",parent:"Income"},{name:"Side Hustle",parent:"Income"},{name:"Investment Income",parent:"Income"},{name:"Rent/Mortgage",parent:"Housing"},{name:"Property Tax",parent:"Housing",is_envelope:!0},{name:"Home Insurance",parent:"Housing"},{name:"HOA Fees",parent:"Housing"},{name:"Repairs",parent:"Housing",is_envelope:!0},{name:"Furniture",parent:"Housing"},{name:"Car Payment",parent:"Transportation"},{name:"Gas",parent:"Transportation"},{name:"Car Insurance",parent:"Transportation"},{name:"Car Maintenance",parent:"Transportation",is_envelope:!0},{name:"Public Transit",parent:"Transportation"},{name:"Parking",parent:"Transportation"},{name:"Groceries",parent:"Food"},{name:"Restaurants",parent:"Food"},{name:"Coffee Shops",parent:"Food"},{name:"Electric",parent:"Utilities"},{name:"Water",parent:"Utilities"},{name:"Gas",parent:"Utilities"},{name:"Internet",parent:"Utilities"},{name:"Phone",parent:"Utilities"},{name:"Cell Phone",parent:"Utilities"},{name:"Trash",parent:"Utilities"},{name:"Health Insurance",parent:"Healthcare"},{name:"Medical",parent:"Healthcare",is_envelope:!0},{name:"Dental",parent:"Healthcare"},{name:"Vision",parent:"Healthcare"},{name:"Prescriptions",parent:"Healthcare"},{name:"Life Insurance",parent:"Insurance"},{name:"Disability Insurance",parent:"Insurance"},{name:"Umbrella Policy",parent:"Insurance"},{name:"Credit Card Payment",parent:"Debt Payments"},{name:"Student Loan",parent:"Debt Payments"},{name:"Personal Loan",parent:"Debt Payments"},{name:"Emergency Fund",parent:"Savings & Investments"},{name:"401k Contribution",parent:"Savings & Investments"},{name:"IRA Contribution",parent:"Savings & Investments"},{name:"HSA Contribution",parent:"Savings & Investments"},{name:"Brokerage",parent:"Savings & Investments"},{name:"Clothing",parent:"Personal"},{name:"Gym",parent:"Personal"},{name:"Hobbies",parent:"Personal"},{name:"Gifts",parent:"Personal",is_envelope:!0},{name:"Annual Subscriptions",parent:"Personal",is_envelope:!0},{name:"Personal Care",parent:"Personal"},{name:"Streaming Services",parent:"Entertainment"},{name:"Movies",parent:"Entertainment"},{name:"Concerts",parent:"Entertainment"},{name:"Sports",parent:"Entertainment"},{name:"Charity",parent:"Giving"},{name:"Church",parent:"Giving"},{name:"Federal Tax",parent:"Taxes"},{name:"State Tax",parent:"Taxes"},{name:"Estimated Tax",parent:"Taxes"}];async function yV(){const t=await He();try{const{data:e,error:n}=await he.from("accounts").select("id").limit(1);if(n&&Me.error("Error checking existing accounts",n),e&&e.length>0){aa("Setup already completed");return}aa("Running first-time setup...");const r=`setup_running_${t}`;if(sessionStorage.getItem(r)){aa("Setup already in progress, skipping...");return}sessionStorage.setItem(r,"true");try{const s=await vV();await xV(s),await bV(),await wV(t),aa("First-time setup completed successfully")}finally{sessionStorage.removeItem(r)}}catch(e){throw Me.error("Error during first-time setup",e),e}}async function vV(){const t=fE.map(e=>({name:e.name,icon:e.icon,color:e.color,sort_order:e.sort_order,is_system:!0}));try{const e=await ks("account_groups",t),n=new Map;return e==null||e.forEach(r=>{n.set(r.name,r.id)}),aa(`Created ${t.length} default account groups`),n}catch(e){if((e==null?void 0:e.code)==="23505"){aa("Account groups already exist, fetching existing...");const n=fE.map(s=>s.name),{data:r}=await he.from("account_groups").select("id, name").in("name",n),i=new Map;return r==null||r.forEach(s=>{i.set(s.name,s.id)}),i}throw e}}async function xV(t){const e={Checking:"checking",Savings:"savings","Credit Card":"credit",Investment:"investment",Retirement:"retirement",HSA:"hsa",Mortgage:"mortgage",Cash:"cash",Asset:"asset"},n=fE.map(r=>({name:r.name,type:e[r.name]||"checking",account_group_id:t.get(r.name),opening_balance:0,current_balance:0}));try{await ks("accounts",n),aa(`Created ${n.length} default accounts`)}catch(r){if((r==null?void 0:r.code)==="23505"){aa("Accounts already exist, skipping creation");return}throw r}}async function bV(){try{const t=FR.filter(a=>!a.parent),e=t.map(a=>({name:a.name,path:a.name,is_envelope:a.is_envelope??!1,is_budgetable:a.is_budgetable??!0,is_transfer:a.is_transfer??!1,is_debt_service:a.is_debt_service??!1,parent_id:null})),n=await ks("categories",e),r=new Map;n==null||n.forEach(a=>{r.set(a.name,a.id)});const i=FR.filter(a=>a.parent),s=i.map(a=>{const o=r.get(a.parent);if(!o)throw new Error(`Parent category not found: ${a.parent}`);return{name:a.name,parent_id:o,path:`${a.parent}>${a.name}`,is_envelope:a.is_envelope??!1,is_budgetable:a.is_budgetable??!0,is_transfer:a.is_transfer??!1,is_debt_service:a.is_debt_service??!1}});await ks("categories",s),aa(`Created ${t.length} top-level and ${i.length} subcategories`)}catch(t){if((t==null?void 0:t.code)==="23505"){aa("Categories already exist, skipping creation");return}throw t}}async function wV(t){const{error:e}=await he.from("settings").insert({created_by:t,learning:{},feature_flags:{},export_prefs:{}});if(e&&!e.message.includes("duplicate"))throw e;aa("Created settings record")}const BR="fire-app-active-tab";function _V(){const[t,e]=T.useState(()=>{try{return localStorage.getItem(BR)||"dashboard"}catch{return"dashboard"}}),[n,r]=T.useState(null),[i,s]=T.useState([t]);T.useEffect(()=>{try{localStorage.setItem(BR,t)}catch{}},[t]);const a=T.useCallback((f,p)=>{const{resetScenario:m=!1,addToHistory:y=!0}=p||{};e(f),m&&r(null),y&&i[i.length-1]!==f&&s(g=>[...g.slice(-4),f])},[i]),o=T.useCallback(()=>{if(i.length>1){const f=i[i.length-2];e(f),s(p=>p.slice(0,-1))}},[i]),l=T.useCallback(f=>{r(f)},[]),u=T.useMemo(()=>{const f=[];if(f.push({label:"Dashboard",tab:"dashboard",onClick:()=>a("dashboard"),isActive:t==="dashboard"&&!n}),t!=="dashboard"){const p={dashboard:"Dashboard",analytics:"Analytics",scenarios:"Scenarios",budgets:"Budgets",bills:"Bills",accounts:"Accounts",transactions:"Transactions",categories:"Categories",profile:"Profile"};f.push({label:p[t],tab:t,onClick:()=>a(t,{resetScenario:!0}),isActive:!n})}return n&&t==="scenarios"&&f.push({label:"Scenario Details",isActive:!0}),f},[t,n,a]),d=i.length>1;return{activeTab:t,selectedScenarioId:n,navigationHistory:i,breadcrumbs:u,canGoBack:d,navigateToTab:a,navigateBack:o,setScenario:l}}async function SV(t,e){try{const n=await He();console.log(` Looking for account: "${t}"...`);const{data:r,error:i}=await he.from("accounts").select("*").eq("created_by",n).ilike("name",`%${t}%`);if(i)throw i;if(!r||r.length===0){console.error(` No account found matching: "${t}"`);return}if(r.length>1){console.log(`  Found ${r.length} matching accounts:`),r.forEach(o=>{console.log(`  - ${o.name} (type: ${o.type})`)}),console.log("Please be more specific or update the first one manually.");return}const s=r[0];console.log(` Found account: "${s.name}" (current type: ${s.type})`);const{error:a}=await he.from("accounts").update({type:e}).eq("id",s.id);if(a)throw a;console.log(` Successfully updated "${s.name}" to type: ${e}`),console.log(" Refreshing page to see changes..."),setTimeout(()=>window.location.reload(),1e3)}catch(n){console.error(" Error updating account:",n)}}typeof window<"u"&&(window.fixAccountType=SV,console.log(' Tip: Run fixAccountType("Ally Emergency Fund", "savings") in console to fix the account type'));const AV={primary:"bg-primary/10 text-primary",success:"bg-success/10 text-success",danger:"bg-danger/10 text-danger",warning:"bg-warning/10 text-warning",accent:"bg-accent/10 text-accent"};function ok({title:t,value:e,subtitle:n,trend:r,icon:i,color:s="primary"}){return c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("div",{children:c.jsx("p",{className:"text-sm font-medium text-gray-600",children:t})}),i&&c.jsx("div",{className:`p-2 rounded-lg ${AV[s]}`,children:i})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e}),n&&c.jsx("p",{className:"text-sm text-gray-500",children:n}),r&&c.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[c.jsxs("span",{className:r.value>=0?"text-success":"text-danger",children:[r.value>=0?"":""," ",Math.abs(r.value),"%"]}),c.jsx("span",{className:"text-gray-500",children:r.label})]})]})]})}function UR(t,e){const{startAge:n,endAge:r,startStockAllocation:i,endStockAllocation:s}=e;if(t<=n)return i;if(t>=r)return s;const a=(t-n)/(r-n);return i-a*(i-s)}function jV(t){const{currentAge:e,currentNetWorth:n,initialAnnualSavings:r,initialAnnualExpenses:i,stockGrowthRate:s,bondGrowthRate:a,inflationRate:o,incomeGrowthRate:l,withdrawalRate:u,glidePath:d}=t;let f=0,p=e,m=n,y=r,g=i;const v=UR(p,d),b=v*s+(1-v)*a,x=[{year:f,age:p,netWorth:m,expenses:g,savings:y,investmentReturn:b}],w=100;for(;f<w;){f++,p++;const S=UR(p,d),_=S*s+(1-S)*a;m*=1+_,m+=y,g*=1+o,y*=1+l,x.push({year:f,age:p,netWorth:m,expenses:g,savings:y,investmentReturn:_});const A=g/u;if(m>=A){const j=new Date;return j.setFullYear(j.getFullYear()+f),{yearsToFI:f,projectedFIDate:j,fiNumber:A,projection:x}}}return{yearsToFI:1/0,projectedFIDate:new Date(9999,11,31),fiNumber:g/u,projection:x}}const kV={stockGrowthRate:.1,bondGrowthRate:.03,inflationRate:.03,incomeGrowthRate:.03,withdrawalRate:.04},NV={startAge:30,endAge:60,startStockAllocation:.95,endStockAllocation:.6};async function EV(t,e){const{data:n,error:r}=await he.from("accounts").select("current_balance, type").eq("user_id",t);if(r)throw new Error(r.message);const i=Array.isArray(n)?n.reduce((g,v)=>{const b=v.current_balance??0;return["credit","mortgage"].includes(v.type)?g-Math.abs(b):g+b},0):0,s=new Date;s.setFullYear(s.getFullYear()-1);const{data:a,error:o}=await he.from("transactions").select("amount").eq("user_id",t).gte("date",s.toISOString());if(o)throw new Error(o.message);const l=Array.isArray(a)?a:[],u=l.filter(g=>g.amount>0).reduce((g,v)=>g+v.amount,0),d=l.filter(g=>g.amount<0).reduce((g,v)=>g+Math.abs(v.amount),0),f=u-d,m={currentAge:qB(e),currentNetWorth:i,initialAnnualSavings:f,initialAnnualExpenses:d,...kV,glidePath:NV};return jV(m)}function CV(){var n;const{user:t}=Mb(),e=(n=t==null?void 0:t.user_metadata)==null?void 0:n.date_of_birth;return Bt({queryKey:["fi-projection",t==null?void 0:t.id],queryFn:async()=>{if(!(t!=null&&t.id)||!e)throw new Error("User not logged in or date of birth not set.");return EV(t.id,e)},enabled:!!t&&!!e})}function GB(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=GB(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Ee(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=GB(t))&&(r&&(r+=" "),r+=e);return r}var PV=Array.isArray,hi=PV,TV=typeof xr=="object"&&xr&&xr.Object===Object&&xr,KB=TV,OV=KB,MV=typeof self=="object"&&self&&self.Object===Object&&self,RV=OV||MV||Function("return this")(),ao=RV,IV=ao,DV=IV.Symbol,Rb=DV,zR=Rb,VB=Object.prototype,$V=VB.hasOwnProperty,LV=VB.toString,cy=zR?zR.toStringTag:void 0;function FV(t){var e=$V.call(t,cy),n=t[cy];try{t[cy]=void 0;var r=!0}catch{}var i=LV.call(t);return r&&(e?t[cy]=n:delete t[cy]),i}var BV=FV,UV=Object.prototype,zV=UV.toString;function WV(t){return zV.call(t)}var HV=WV,WR=Rb,qV=BV,GV=HV,KV="[object Null]",VV="[object Undefined]",HR=WR?WR.toStringTag:void 0;function YV(t){return t==null?t===void 0?VV:KV:HR&&HR in Object(t)?qV(t):GV(t)}var El=YV;function XV(t){return t!=null&&typeof t=="object"}var Cl=XV,QV=El,JV=Cl,ZV="[object Symbol]";function eY(t){return typeof t=="symbol"||JV(t)&&QV(t)==ZV}var Lg=eY,tY=hi,nY=Lg,rY=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,iY=/^\w*$/;function sY(t,e){if(tY(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||nY(t)?!0:iY.test(t)||!rY.test(t)||e!=null&&t in Object(e)}var jT=sY;function aY(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ju=aY;const Fg=at(ju);var oY=El,lY=ju,cY="[object AsyncFunction]",uY="[object Function]",dY="[object GeneratorFunction]",hY="[object Proxy]";function fY(t){if(!lY(t))return!1;var e=oY(t);return e==uY||e==dY||e==cY||e==hY}var kT=fY;const _e=at(kT);var pY=ao,mY=pY["__core-js_shared__"],gY=mY,lk=gY,qR=function(){var t=/[^.]+$/.exec(lk&&lk.keys&&lk.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function yY(t){return!!qR&&qR in t}var vY=yY,xY=Function.prototype,bY=xY.toString;function wY(t){if(t!=null){try{return bY.call(t)}catch{}try{return t+""}catch{}}return""}var YB=wY,_Y=kT,SY=vY,AY=ju,jY=YB,kY=/[\\^$.*+?()[\]{}|]/g,NY=/^\[object .+?Constructor\]$/,EY=Function.prototype,CY=Object.prototype,PY=EY.toString,TY=CY.hasOwnProperty,OY=RegExp("^"+PY.call(TY).replace(kY,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function MY(t){if(!AY(t)||SY(t))return!1;var e=_Y(t)?OY:NY;return e.test(jY(t))}var RY=MY;function IY(t,e){return t==null?void 0:t[e]}var DY=IY,$Y=RY,LY=DY;function FY(t,e){var n=LY(t,e);return $Y(n)?n:void 0}var tf=FY,BY=tf,UY=BY(Object,"create"),xA=UY,GR=xA;function zY(){this.__data__=GR?GR(null):{},this.size=0}var WY=zY;function HY(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var qY=HY,GY=xA,KY="__lodash_hash_undefined__",VY=Object.prototype,YY=VY.hasOwnProperty;function XY(t){var e=this.__data__;if(GY){var n=e[t];return n===KY?void 0:n}return YY.call(e,t)?e[t]:void 0}var QY=XY,JY=xA,ZY=Object.prototype,eX=ZY.hasOwnProperty;function tX(t){var e=this.__data__;return JY?e[t]!==void 0:eX.call(e,t)}var nX=tX,rX=xA,iX="__lodash_hash_undefined__";function sX(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rX&&e===void 0?iX:e,this}var aX=sX,oX=WY,lX=qY,cX=QY,uX=nX,dX=aX;function Bg(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Bg.prototype.clear=oX;Bg.prototype.delete=lX;Bg.prototype.get=cX;Bg.prototype.has=uX;Bg.prototype.set=dX;var hX=Bg;function fX(){this.__data__=[],this.size=0}var pX=fX;function mX(t,e){return t===e||t!==t&&e!==e}var NT=mX,gX=NT;function yX(t,e){for(var n=t.length;n--;)if(gX(t[n][0],e))return n;return-1}var bA=yX,vX=bA,xX=Array.prototype,bX=xX.splice;function wX(t){var e=this.__data__,n=vX(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():bX.call(e,n,1),--this.size,!0}var _X=wX,SX=bA;function AX(t){var e=this.__data__,n=SX(e,t);return n<0?void 0:e[n][1]}var jX=AX,kX=bA;function NX(t){return kX(this.__data__,t)>-1}var EX=NX,CX=bA;function PX(t,e){var n=this.__data__,r=CX(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var TX=PX,OX=pX,MX=_X,RX=jX,IX=EX,DX=TX;function Ug(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Ug.prototype.clear=OX;Ug.prototype.delete=MX;Ug.prototype.get=RX;Ug.prototype.has=IX;Ug.prototype.set=DX;var wA=Ug,$X=tf,LX=ao,FX=$X(LX,"Map"),ET=FX,KR=hX,BX=wA,UX=ET;function zX(){this.size=0,this.__data__={hash:new KR,map:new(UX||BX),string:new KR}}var WX=zX;function HX(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var qX=HX,GX=qX;function KX(t,e){var n=t.__data__;return GX(e)?n[typeof e=="string"?"string":"hash"]:n.map}var _A=KX,VX=_A;function YX(t){var e=VX(this,t).delete(t);return this.size-=e?1:0,e}var XX=YX,QX=_A;function JX(t){return QX(this,t).get(t)}var ZX=JX,eQ=_A;function tQ(t){return eQ(this,t).has(t)}var nQ=tQ,rQ=_A;function iQ(t,e){var n=rQ(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var sQ=iQ,aQ=WX,oQ=XX,lQ=ZX,cQ=nQ,uQ=sQ;function zg(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}zg.prototype.clear=aQ;zg.prototype.delete=oQ;zg.prototype.get=lQ;zg.prototype.has=cQ;zg.prototype.set=uQ;var CT=zg,XB=CT,dQ="Expected a function";function PT(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(dQ);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(PT.Cache||XB),n}PT.Cache=XB;var QB=PT;const hQ=at(QB);var fQ=QB,pQ=500;function mQ(t){var e=fQ(t,function(r){return n.size===pQ&&n.clear(),r}),n=e.cache;return e}var gQ=mQ,yQ=gQ,vQ=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,xQ=/\\(\\)?/g,bQ=yQ(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(vQ,function(n,r,i,s){e.push(i?s.replace(xQ,"$1"):r||n)}),e}),wQ=bQ;function _Q(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var TT=_Q,VR=Rb,SQ=TT,AQ=hi,jQ=Lg,YR=VR?VR.prototype:void 0,XR=YR?YR.toString:void 0;function JB(t){if(typeof t=="string")return t;if(AQ(t))return SQ(t,JB)+"";if(jQ(t))return XR?XR.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var kQ=JB,NQ=kQ;function EQ(t){return t==null?"":NQ(t)}var ZB=EQ,CQ=hi,PQ=jT,TQ=wQ,OQ=ZB;function MQ(t,e){return CQ(t)?t:PQ(t,e)?[t]:TQ(OQ(t))}var e5=MQ,RQ=Lg;function IQ(t){if(typeof t=="string"||RQ(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var SA=IQ,DQ=e5,$Q=SA;function LQ(t,e){e=DQ(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[$Q(e[n++])];return n&&n==r?t:void 0}var OT=LQ,FQ=OT;function BQ(t,e,n){var r=t==null?void 0:FQ(t,e);return r===void 0?n:r}var t5=BQ;const Hi=at(t5);function UQ(t){return t==null}var zQ=UQ;const we=at(zQ);var WQ=El,HQ=hi,qQ=Cl,GQ="[object String]";function KQ(t){return typeof t=="string"||!HQ(t)&&qQ(t)&&WQ(t)==GQ}var VQ=KQ;const Hh=at(VQ);var n5={exports:{}},ot={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MT=Symbol.for("react.element"),RT=Symbol.for("react.portal"),AA=Symbol.for("react.fragment"),jA=Symbol.for("react.strict_mode"),kA=Symbol.for("react.profiler"),NA=Symbol.for("react.provider"),EA=Symbol.for("react.context"),YQ=Symbol.for("react.server_context"),CA=Symbol.for("react.forward_ref"),PA=Symbol.for("react.suspense"),TA=Symbol.for("react.suspense_list"),OA=Symbol.for("react.memo"),MA=Symbol.for("react.lazy"),XQ=Symbol.for("react.offscreen"),r5;r5=Symbol.for("react.module.reference");function Ts(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case MT:switch(t=t.type,t){case AA:case kA:case jA:case PA:case TA:return t;default:switch(t=t&&t.$$typeof,t){case YQ:case EA:case CA:case MA:case OA:case NA:return t;default:return e}}case RT:return e}}}ot.ContextConsumer=EA;ot.ContextProvider=NA;ot.Element=MT;ot.ForwardRef=CA;ot.Fragment=AA;ot.Lazy=MA;ot.Memo=OA;ot.Portal=RT;ot.Profiler=kA;ot.StrictMode=jA;ot.Suspense=PA;ot.SuspenseList=TA;ot.isAsyncMode=function(){return!1};ot.isConcurrentMode=function(){return!1};ot.isContextConsumer=function(t){return Ts(t)===EA};ot.isContextProvider=function(t){return Ts(t)===NA};ot.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===MT};ot.isForwardRef=function(t){return Ts(t)===CA};ot.isFragment=function(t){return Ts(t)===AA};ot.isLazy=function(t){return Ts(t)===MA};ot.isMemo=function(t){return Ts(t)===OA};ot.isPortal=function(t){return Ts(t)===RT};ot.isProfiler=function(t){return Ts(t)===kA};ot.isStrictMode=function(t){return Ts(t)===jA};ot.isSuspense=function(t){return Ts(t)===PA};ot.isSuspenseList=function(t){return Ts(t)===TA};ot.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===AA||t===kA||t===jA||t===PA||t===TA||t===XQ||typeof t=="object"&&t!==null&&(t.$$typeof===MA||t.$$typeof===OA||t.$$typeof===NA||t.$$typeof===EA||t.$$typeof===CA||t.$$typeof===r5||t.getModuleId!==void 0)};ot.typeOf=Ts;n5.exports=ot;var QQ=n5.exports,JQ=El,ZQ=Cl,eJ="[object Number]";function tJ(t){return typeof t=="number"||ZQ(t)&&JQ(t)==eJ}var i5=tJ;const nJ=at(i5);var rJ=i5;function iJ(t){return rJ(t)&&t!=+t}var sJ=iJ;const Wg=at(sJ);var Mr=function(e){return e===0?0:e>0?1:-1},id=function(e){return Hh(e)&&e.indexOf("%")===e.length-1},oe=function(e){return nJ(e)&&!Wg(e)},aJ=function(e){return we(e)},En=function(e){return oe(e)||Hh(e)},oJ=0,ku=function(e){var n=++oJ;return"".concat(e||"").concat(n)},Rr=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!oe(e)&&!Hh(e))return r;var s;if(id(e)){var a=e.indexOf("%");s=n*parseFloat(e.slice(0,a))/100}else s=+e;return Wg(s)&&(s=r),i&&s>n&&(s=n),s},Xl=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},lJ=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,r={},i=0;i<n;i++)if(!r[e[i]])r[e[i]]=!0;else return!0;return!1},Ht=function(e,n){return oe(e)&&oe(n)?function(r){return e+r*(n-e)}:function(){return n}};function m_(t,e,n){return!t||!t.length?null:t.find(function(r){return r&&(typeof e=="function"?e(r):Hi(r,e))===n})}var cJ=function(e){if(!e||!e.length)return null;for(var n=e.length,r=0,i=0,s=0,a=0,o=1/0,l=-1/0,u=0,d=0,f=0;f<n;f++)u=e[f].cx||0,d=e[f].cy||0,r+=u,i+=d,s+=u*d,a+=u*u,o=Math.min(o,u),l=Math.max(l,u);var p=n*a!==r*r?(n*s-r*i)/(n*a-r*r):0;return{xmin:o,xmax:l,a:p,b:(i-p*r)/n}},uJ=function(e,n){return oe(e)&&oe(n)?e-n:Hh(e)&&Hh(n)?e.localeCompare(n):e instanceof Date&&n instanceof Date?e.getTime()-n.getTime():String(e).localeCompare(String(n))};function lp(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function pE(t){"@babel/helpers - typeof";return pE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pE(t)}var dJ=["viewBox","children"],hJ=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],QR=["points","pathLength"],ck={svg:dJ,polygon:QR,polyline:QR},IT=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],g_=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(T.isValidElement(e)&&(r=e.props),!Fg(r))return null;var i={};return Object.keys(r).forEach(function(s){IT.includes(s)&&(i[s]=n||function(a){return r[s](r,a)})}),i},fJ=function(e,n,r){return function(i){return e(n,r,i),null}},gu=function(e,n,r){if(!Fg(e)||pE(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(s){var a=e[s];IT.includes(s)&&typeof a=="function"&&(i||(i={}),i[s]=fJ(a,n,r))}),i},pJ=["children"],mJ=["children"];function JR(t,e){if(t==null)return{};var n=gJ(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function gJ(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function mE(t){"@babel/helpers - typeof";return mE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mE(t)}var ZR={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},hl=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},eI=null,uk=null,DT=function t(e){if(e===eI&&Array.isArray(uk))return uk;var n=[];return T.Children.forEach(e,function(r){we(r)||(QQ.isFragment(r)?n=n.concat(t(r.props.children)):n.push(r))}),uk=n,eI=e,n};function Lr(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(function(i){return hl(i)}):r=[hl(e)],DT(t).forEach(function(i){var s=Hi(i,"type.displayName")||Hi(i,"type.name");r.indexOf(s)!==-1&&n.push(i)}),n}function Li(t,e){var n=Lr(t,e);return n&&n[0]}var tI=function(e){if(!e||!e.props)return!1;var n=e.props,r=n.width,i=n.height;return!(!oe(r)||r<=0||!oe(i)||i<=0)},yJ=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],vJ=function(e){return e&&e.type&&Hh(e.type)&&yJ.indexOf(e.type)>=0},s5=function(e){return e&&mE(e)==="object"&&"clipDot"in e},xJ=function(e,n,r,i){var s,a=(s=ck==null?void 0:ck[i])!==null&&s!==void 0?s:[];return n.startsWith("data-")||!_e(e)&&(i&&a.includes(n)||hJ.includes(n))||r&&IT.includes(n)},xe=function(e,n,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(T.isValidElement(e)&&(i=e.props),!Fg(i))return null;var s={};return Object.keys(i).forEach(function(a){var o;xJ((o=i)===null||o===void 0?void 0:o[a],a,n,r)&&(s[a]=i[a])}),s},gE=function t(e,n){if(e===n)return!0;var r=T.Children.count(e);if(r!==T.Children.count(n))return!1;if(r===0)return!0;if(r===1)return nI(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var i=0;i<r;i++){var s=e[i],a=n[i];if(Array.isArray(s)||Array.isArray(a)){if(!t(s,a))return!1}else if(!nI(s,a))return!1}return!0},nI=function(e,n){if(we(e)&&we(n))return!0;if(!we(e)&&!we(n)){var r=e.props||{},i=r.children,s=JR(r,pJ),a=n.props||{},o=a.children,l=JR(a,mJ);return i&&o?lp(s,l)&&gE(i,o):!i&&!o?lp(s,l):!1}return!1},rI=function(e,n){var r=[],i={};return DT(e).forEach(function(s,a){if(vJ(s))r.push(s);else if(s){var o=hl(s.type),l=n[o]||{},u=l.handler,d=l.once;if(u&&(!d||!i[o])){var f=u(s,o,a);r.push(f),i[o]=!0}}}),r},bJ=function(e){var n=e&&e.type;return n&&ZR[n]?ZR[n]:null},wJ=function(e,n){return DT(n).indexOf(e)},_J=["children","width","height","viewBox","className","style","title","desc"];function yE(){return yE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yE.apply(this,arguments)}function SJ(t,e){if(t==null)return{};var n=AJ(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function AJ(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function vE(t){var e=t.children,n=t.width,r=t.height,i=t.viewBox,s=t.className,a=t.style,o=t.title,l=t.desc,u=SJ(t,_J),d=i||{width:n,height:r,x:0,y:0},f=Ee("recharts-surface",s);return D.createElement("svg",yE({},xe(u,!0,"svg"),{className:f,width:n,height:r,style:a,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),D.createElement("title",null,o),D.createElement("desc",null,l),e)}var jJ=["children","className"];function xE(){return xE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xE.apply(this,arguments)}function kJ(t,e){if(t==null)return{};var n=NJ(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function NJ(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Re=D.forwardRef(function(t,e){var n=t.children,r=t.className,i=kJ(t,jJ),s=Ee("recharts-layer",r);return D.createElement("g",xE({className:s},xe(i,!0),{ref:e}),n)}),ua=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s]};function EJ(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}var CJ=EJ,PJ=CJ;function TJ(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:PJ(t,e,n)}var OJ=TJ,MJ="\\ud800-\\udfff",RJ="\\u0300-\\u036f",IJ="\\ufe20-\\ufe2f",DJ="\\u20d0-\\u20ff",$J=RJ+IJ+DJ,LJ="\\ufe0e\\ufe0f",FJ="\\u200d",BJ=RegExp("["+FJ+MJ+$J+LJ+"]");function UJ(t){return BJ.test(t)}var a5=UJ;function zJ(t){return t.split("")}var WJ=zJ,o5="\\ud800-\\udfff",HJ="\\u0300-\\u036f",qJ="\\ufe20-\\ufe2f",GJ="\\u20d0-\\u20ff",KJ=HJ+qJ+GJ,VJ="\\ufe0e\\ufe0f",YJ="["+o5+"]",bE="["+KJ+"]",wE="\\ud83c[\\udffb-\\udfff]",XJ="(?:"+bE+"|"+wE+")",l5="[^"+o5+"]",c5="(?:\\ud83c[\\udde6-\\uddff]){2}",u5="[\\ud800-\\udbff][\\udc00-\\udfff]",QJ="\\u200d",d5=XJ+"?",h5="["+VJ+"]?",JJ="(?:"+QJ+"(?:"+[l5,c5,u5].join("|")+")"+h5+d5+")*",ZJ=h5+d5+JJ,eZ="(?:"+[l5+bE+"?",bE,c5,u5,YJ].join("|")+")",tZ=RegExp(wE+"(?="+wE+")|"+eZ+ZJ,"g");function nZ(t){return t.match(tZ)||[]}var rZ=nZ,iZ=WJ,sZ=a5,aZ=rZ;function oZ(t){return sZ(t)?aZ(t):iZ(t)}var lZ=oZ,cZ=OJ,uZ=a5,dZ=lZ,hZ=ZB;function fZ(t){return function(e){e=hZ(e);var n=uZ(e)?dZ(e):void 0,r=n?n[0]:e.charAt(0),i=n?cZ(n,1).join(""):e.slice(1);return r[t]()+i}}var pZ=fZ,mZ=pZ,gZ=mZ("toUpperCase"),yZ=gZ;const RA=at(yZ);function jt(t){return function(){return t}}const f5=Math.cos,y_=Math.sin,pa=Math.sqrt,v_=Math.PI,IA=2*v_,_E=Math.PI,SE=2*_E,Fu=1e-6,vZ=SE-Fu;function p5(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xZ(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return p5;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class bZ{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?p5:xZ(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-e,u=i-n,d=a-e,f=o-n,p=d*d+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(p>Fu)if(!(Math.abs(f*l-u*d)>Fu)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let m=r-a,y=i-o,g=l*l+u*u,v=m*m+y*y,b=Math.sqrt(g),x=Math.sqrt(p),w=s*Math.tan((_E-Math.acos((g+p-v)/(2*b*x)))/2),S=w/x,_=w/b;Math.abs(S-1)>Fu&&this._append`L${e+S*d},${n+S*f}`,this._append`A${s},${s},0,0,${+(f*m>d*y)},${this._x1=e+_*l},${this._y1=n+_*u}`}}arc(e,n,r,i,s,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),u=e+o,d=n+l,f=1^a,p=a?i-s:s-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Fu||Math.abs(this._y1-d)>Fu)&&this._append`L${u},${d}`,r&&(p<0&&(p=p%SE+SE),p>vZ?this._append`A${r},${r},0,1,${f},${e-o},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=d}`:p>Fu&&this._append`A${r},${r},0,${+(p>=_E)},${f},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function $T(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new bZ(e)}function LT(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function m5(t){this._context=t}m5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function DA(t){return new m5(t)}function g5(t){return t[0]}function y5(t){return t[1]}function v5(t,e){var n=jt(!0),r=null,i=DA,s=null,a=$T(o);t=typeof t=="function"?t:t===void 0?g5:jt(t),e=typeof e=="function"?e:e===void 0?y5:jt(e);function o(l){var u,d=(l=LT(l)).length,f,p=!1,m;for(r==null&&(s=i(m=a())),u=0;u<=d;++u)!(u<d&&n(f=l[u],u,l))===p&&((p=!p)?s.lineStart():s.lineEnd()),p&&s.point(+t(f,u,l),+e(f,u,l));if(m)return s=null,m+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:jt(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:jt(+l),o):e},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:jt(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function xw(t,e,n){var r=null,i=jt(!0),s=null,a=DA,o=null,l=$T(u);t=typeof t=="function"?t:t===void 0?g5:jt(+t),e=typeof e=="function"?e:jt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?y5:jt(+n);function u(f){var p,m,y,g=(f=LT(f)).length,v,b=!1,x,w=new Array(g),S=new Array(g);for(s==null&&(o=a(x=l())),p=0;p<=g;++p){if(!(p<g&&i(v=f[p],p,f))===b)if(b=!b)m=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),y=p-1;y>=m;--y)o.point(w[y],S[y]);o.lineEnd(),o.areaEnd()}b&&(w[p]=+t(v,p,f),S[p]=+e(v,p,f),o.point(r?+r(v,p,f):w[p],n?+n(v,p,f):S[p]))}if(x)return o=null,x+""||null}function d(){return v5().defined(i).curve(a).context(s)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:jt(+f),r=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:jt(+f),u):t},u.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:jt(+f),u):r},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:jt(+f),n=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:jt(+f),u):e},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:jt(+f),u):n},u.lineX0=u.lineY0=function(){return d().x(t).y(e)},u.lineY1=function(){return d().x(t).y(n)},u.lineX1=function(){return d().x(r).y(e)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:jt(!!f),u):i},u.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),u):a},u.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),u):s},u}class x5{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function wZ(t){return new x5(t,!0)}function _Z(t){return new x5(t,!1)}const FT={draw(t,e){const n=pa(e/v_);t.moveTo(n,0),t.arc(0,0,n,0,IA)}},SZ={draw(t,e){const n=pa(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},b5=pa(1/3),AZ=b5*2,jZ={draw(t,e){const n=pa(e/AZ),r=n*b5;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},kZ={draw(t,e){const n=pa(e),r=-n/2;t.rect(r,r,n,n)}},NZ=.8908130915292852,w5=y_(v_/10)/y_(7*v_/10),EZ=y_(IA/10)*w5,CZ=-f5(IA/10)*w5,PZ={draw(t,e){const n=pa(e*NZ),r=EZ*n,i=CZ*n;t.moveTo(0,-n),t.lineTo(r,i);for(let s=1;s<5;++s){const a=IA*s/5,o=f5(a),l=y_(a);t.lineTo(l*n,-o*n),t.lineTo(o*r-l*i,l*r+o*i)}t.closePath()}},dk=pa(3),TZ={draw(t,e){const n=-pa(e/(dk*3));t.moveTo(0,n*2),t.lineTo(-dk*n,-n),t.lineTo(dk*n,-n),t.closePath()}},Yi=-.5,Xi=pa(3)/2,AE=1/pa(12),OZ=(AE/2+1)*3,MZ={draw(t,e){const n=pa(e/OZ),r=n/2,i=n*AE,s=r,a=n*AE+n,o=-s,l=a;t.moveTo(r,i),t.lineTo(s,a),t.lineTo(o,l),t.lineTo(Yi*r-Xi*i,Xi*r+Yi*i),t.lineTo(Yi*s-Xi*a,Xi*s+Yi*a),t.lineTo(Yi*o-Xi*l,Xi*o+Yi*l),t.lineTo(Yi*r+Xi*i,Yi*i-Xi*r),t.lineTo(Yi*s+Xi*a,Yi*a-Xi*s),t.lineTo(Yi*o+Xi*l,Yi*l-Xi*o),t.closePath()}};function RZ(t,e){let n=null,r=$T(i);t=typeof t=="function"?t:jt(t||FT),e=typeof e=="function"?e:jt(e===void 0?64:+e);function i(){let s;if(n||(n=s=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(t=typeof s=="function"?s:jt(s),i):t},i.size=function(s){return arguments.length?(e=typeof s=="function"?s:jt(+s),i):e},i.context=function(s){return arguments.length?(n=s??null,i):n},i}function x_(){}function b_(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function _5(t){this._context=t}_5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:b_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:b_(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function IZ(t){return new _5(t)}function S5(t){this._context=t}S5.prototype={areaStart:x_,areaEnd:x_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:b_(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function DZ(t){return new S5(t)}function A5(t){this._context=t}A5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:b_(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function $Z(t){return new A5(t)}function j5(t){this._context=t}j5.prototype={areaStart:x_,areaEnd:x_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function LZ(t){return new j5(t)}function iI(t){return t<0?-1:1}function sI(t,e,n){var r=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(iI(s)+iI(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function aI(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function hk(t,e,n){var r=t._x0,i=t._y0,s=t._x1,a=t._y1,o=(s-r)/3;t._context.bezierCurveTo(r+o,i+o*e,s-o,a-o*n,s,a)}function w_(t){this._context=t}w_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:hk(this,this._t0,aI(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,hk(this,aI(this,n=sI(this,t,e)),n);break;default:hk(this,this._t0,n=sI(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function k5(t){this._context=new N5(t)}(k5.prototype=Object.create(w_.prototype)).point=function(t,e){w_.prototype.point.call(this,e,t)};function N5(t){this._context=t}N5.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,s){this._context.bezierCurveTo(e,t,r,n,s,i)}};function FZ(t){return new w_(t)}function BZ(t){return new k5(t)}function E5(t){this._context=t}E5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=oI(t),i=oI(e),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],t[a],e[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function oI(t){var e,n=t.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,s[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/s[e-1],s[e]-=r,a[e]-=r*a[e-1];for(i[n-1]=a[n-1]/s[n-1],e=n-2;e>=0;--e)i[e]=(a[e]-i[e+1])/s[e];for(s[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-i[e+1];return[i,s]}function UZ(t){return new E5(t)}function $A(t,e){this._context=t,this._t=e}$A.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function zZ(t){return new $A(t,.5)}function WZ(t){return new $A(t,0)}function HZ(t){return new $A(t,1)}function rg(t,e){if((a=t.length)>1)for(var n=1,r,i,s=t[e[0]],a,o=s.length;n<a;++n)for(i=s,s=t[e[n]],r=0;r<o;++r)s[r][1]+=s[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function jE(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function qZ(t,e){return t[e]}function GZ(t){const e=[];return e.key=t,e}function KZ(){var t=jt([]),e=jE,n=rg,r=qZ;function i(s){var a=Array.from(t.apply(this,arguments),GZ),o,l=a.length,u=-1,d;for(const f of s)for(o=0,++u;o<l;++o)(a[o][u]=[0,+r(f,a[o].key,u,s)]).data=f;for(o=0,d=LT(e(a));o<l;++o)a[d[o]].index=o;return n(a,d),a}return i.keys=function(s){return arguments.length?(t=typeof s=="function"?s:jt(Array.from(s)),i):t},i.value=function(s){return arguments.length?(r=typeof s=="function"?s:jt(+s),i):r},i.order=function(s){return arguments.length?(e=s==null?jE:typeof s=="function"?s:jt(Array.from(s)),i):e},i.offset=function(s){return arguments.length?(n=s??rg,i):n},i}function VZ(t,e){if((r=t.length)>0){for(var n,r,i=0,s=t[0].length,a;i<s;++i){for(a=n=0;n<r;++n)a+=t[n][i][1]||0;if(a)for(n=0;n<r;++n)t[n][i][1]/=a}rg(t,e)}}function YZ(t,e){if((i=t.length)>0){for(var n=0,r=t[e[0]],i,s=r.length;n<s;++n){for(var a=0,o=0;a<i;++a)o+=t[a][n][1]||0;r[n][1]+=r[n][0]=-o/2}rg(t,e)}}function XZ(t,e){if(!(!((a=t.length)>0)||!((s=(i=t[e[0]]).length)>0))){for(var n=0,r=1,i,s,a;r<s;++r){for(var o=0,l=0,u=0;o<a;++o){for(var d=t[e[o]],f=d[r][1]||0,p=d[r-1][1]||0,m=(f-p)/2,y=0;y<o;++y){var g=t[e[y]],v=g[r][1]||0,b=g[r-1][1]||0;m+=v-b}l+=f,u+=m*f}i[r-1][1]+=i[r-1][0]=n,l&&(n-=u/l)}i[r-1][1]+=i[r-1][0]=n,rg(t,e)}}function z0(t){"@babel/helpers - typeof";return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z0(t)}var QZ=["type","size","sizeType"];function kE(){return kE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kE.apply(this,arguments)}function lI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function cI(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lI(Object(n),!0).forEach(function(r){JZ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function JZ(t,e,n){return e=ZZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZZ(t){var e=eee(t,"string");return z0(e)=="symbol"?e:e+""}function eee(t,e){if(z0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(z0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tee(t,e){if(t==null)return{};var n=nee(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function nee(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var C5={symbolCircle:FT,symbolCross:SZ,symbolDiamond:jZ,symbolSquare:kZ,symbolStar:PZ,symbolTriangle:TZ,symbolWye:MZ},ree=Math.PI/180,iee=function(e){var n="symbol".concat(RA(e));return C5[n]||FT},see=function(e,n,r){if(n==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*ree;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},aee=function(e,n){C5["symbol".concat(RA(e))]=n},LA=function(e){var n=e.type,r=n===void 0?"circle":n,i=e.size,s=i===void 0?64:i,a=e.sizeType,o=a===void 0?"area":a,l=tee(e,QZ),u=cI(cI({},l),{},{type:r,size:s,sizeType:o}),d=function(){var v=iee(r),b=RZ().type(v).size(see(s,o,r));return b()},f=u.className,p=u.cx,m=u.cy,y=xe(u,!0);return p===+p&&m===+m&&s===+s?D.createElement("path",kE({},y,{className:Ee("recharts-symbols",f),transform:"translate(".concat(p,", ").concat(m,")"),d:d()})):null};LA.registerSymbol=aee;function ig(t){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ig(t)}function NE(){return NE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},NE.apply(this,arguments)}function uI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function oee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uI(Object(n),!0).forEach(function(r){W0(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,T5(r.key),r)}}function uee(t,e,n){return e&&cee(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function dee(t,e,n){return e=__(e),hee(t,P5()?Reflect.construct(e,n||[],__(t).constructor):e.apply(t,n))}function hee(t,e){if(e&&(ig(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fee(t)}function fee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P5=function(){return!!t})()}function __(t){return __=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},__(t)}function pee(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EE(t,e)}function EE(t,e){return EE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},EE(t,e)}function W0(t,e,n){return e=T5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T5(t){var e=mee(t,"string");return ig(e)=="symbol"?e:e+""}function mee(t,e){if(ig(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(ig(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Qi=32,BT=function(t){function e(){return lee(this,e),dee(this,e,arguments)}return pee(e,t),uee(e,[{key:"renderIcon",value:function(r){var i=this.props.inactiveColor,s=Qi/2,a=Qi/6,o=Qi/3,l=r.inactive?i:r.color;if(r.type==="plainline")return D.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:s,x2:Qi,y2:s,className:"recharts-legend-icon"});if(r.type==="line")return D.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(s,`
            H`).concat(Qi,"M").concat(2*o,",").concat(s,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(s),className:"recharts-legend-icon"});if(r.type==="rect")return D.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Qi/8,"h").concat(Qi,"v").concat(Qi*3/4,"h").concat(-Qi,"z"),className:"recharts-legend-icon"});if(D.isValidElement(r.legendIcon)){var u=oee({},r);return delete u.legendIcon,D.cloneElement(r.legendIcon,u)}return D.createElement(LA,{fill:l,cx:s,cy:s,size:Qi,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,i=this.props,s=i.payload,a=i.iconSize,o=i.layout,l=i.formatter,u=i.inactiveColor,d={x:0,y:0,width:Qi,height:Qi},f={display:o==="horizontal"?"inline-block":"block",marginRight:10},p={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(m,y){var g=m.formatter||l,v=Ee(W0(W0({"recharts-legend-item":!0},"legend-item-".concat(y),!0),"inactive",m.inactive));if(m.type==="none")return null;var b=_e(m.value)?null:m.value;ua(!_e(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var x=m.inactive?u:m.color;return D.createElement("li",NE({className:v,style:f,key:"legend-item-".concat(y)},gu(r.props,m,y)),D.createElement(vE,{width:a,height:a,viewBox:d,style:p},r.renderIcon(m)),D.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g?g(b,m,y):b))})}},{key:"render",value:function(){var r=this.props,i=r.payload,s=r.layout,a=r.align;if(!i||!i.length)return null;var o={padding:0,margin:0,textAlign:s==="horizontal"?a:"left"};return D.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(T.PureComponent);W0(BT,"displayName","Legend");W0(BT,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var gee=wA;function yee(){this.__data__=new gee,this.size=0}var vee=yee;function xee(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var bee=xee;function wee(t){return this.__data__.get(t)}var _ee=wee;function See(t){return this.__data__.has(t)}var Aee=See,jee=wA,kee=ET,Nee=CT,Eee=200;function Cee(t,e){var n=this.__data__;if(n instanceof jee){var r=n.__data__;if(!kee||r.length<Eee-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Nee(r)}return n.set(t,e),this.size=n.size,this}var Pee=Cee,Tee=wA,Oee=vee,Mee=bee,Ree=_ee,Iee=Aee,Dee=Pee;function Hg(t){var e=this.__data__=new Tee(t);this.size=e.size}Hg.prototype.clear=Oee;Hg.prototype.delete=Mee;Hg.prototype.get=Ree;Hg.prototype.has=Iee;Hg.prototype.set=Dee;var O5=Hg,$ee="__lodash_hash_undefined__";function Lee(t){return this.__data__.set(t,$ee),this}var Fee=Lee;function Bee(t){return this.__data__.has(t)}var Uee=Bee,zee=CT,Wee=Fee,Hee=Uee;function S_(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new zee;++e<n;)this.add(t[e])}S_.prototype.add=S_.prototype.push=Wee;S_.prototype.has=Hee;var M5=S_;function qee(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var R5=qee;function Gee(t,e){return t.has(e)}var I5=Gee,Kee=M5,Vee=R5,Yee=I5,Xee=1,Qee=2;function Jee(t,e,n,r,i,s){var a=n&Xee,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var u=s.get(t),d=s.get(e);if(u&&d)return u==e&&d==t;var f=-1,p=!0,m=n&Qee?new Kee:void 0;for(s.set(t,e),s.set(e,t);++f<o;){var y=t[f],g=e[f];if(r)var v=a?r(g,y,f,e,t,s):r(y,g,f,t,e,s);if(v!==void 0){if(v)continue;p=!1;break}if(m){if(!Vee(e,function(b,x){if(!Yee(m,x)&&(y===b||i(y,b,n,r,s)))return m.push(x)})){p=!1;break}}else if(!(y===g||i(y,g,n,r,s))){p=!1;break}}return s.delete(t),s.delete(e),p}var D5=Jee,Zee=ao,ete=Zee.Uint8Array,tte=ete;function nte(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}var rte=nte;function ite(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var UT=ite,dI=Rb,hI=tte,ste=NT,ate=D5,ote=rte,lte=UT,cte=1,ute=2,dte="[object Boolean]",hte="[object Date]",fte="[object Error]",pte="[object Map]",mte="[object Number]",gte="[object RegExp]",yte="[object Set]",vte="[object String]",xte="[object Symbol]",bte="[object ArrayBuffer]",wte="[object DataView]",fI=dI?dI.prototype:void 0,fk=fI?fI.valueOf:void 0;function _te(t,e,n,r,i,s,a){switch(n){case wte:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case bte:return!(t.byteLength!=e.byteLength||!s(new hI(t),new hI(e)));case dte:case hte:case mte:return ste(+t,+e);case fte:return t.name==e.name&&t.message==e.message;case gte:case vte:return t==e+"";case pte:var o=ote;case yte:var l=r&cte;if(o||(o=lte),t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;r|=ute,a.set(t,e);var d=ate(o(t),o(e),r,i,s,a);return a.delete(t),d;case xte:if(fk)return fk.call(t)==fk.call(e)}return!1}var Ste=_te;function Ate(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var $5=Ate,jte=$5,kte=hi;function Nte(t,e,n){var r=e(t);return kte(t)?r:jte(r,n(t))}var Ete=Nte;function Cte(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}var Pte=Cte;function Tte(){return[]}var Ote=Tte,Mte=Pte,Rte=Ote,Ite=Object.prototype,Dte=Ite.propertyIsEnumerable,pI=Object.getOwnPropertySymbols,$te=pI?function(t){return t==null?[]:(t=Object(t),Mte(pI(t),function(e){return Dte.call(t,e)}))}:Rte,Lte=$te;function Fte(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Bte=Fte,Ute=El,zte=Cl,Wte="[object Arguments]";function Hte(t){return zte(t)&&Ute(t)==Wte}var qte=Hte,mI=qte,Gte=Cl,L5=Object.prototype,Kte=L5.hasOwnProperty,Vte=L5.propertyIsEnumerable,Yte=mI(function(){return arguments}())?mI:function(t){return Gte(t)&&Kte.call(t,"callee")&&!Vte.call(t,"callee")},zT=Yte,A_={exports:{}};function Xte(){return!1}var Qte=Xte;A_.exports;(function(t,e){var n=ao,r=Qte,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,a=s&&s.exports===i,o=a?n.Buffer:void 0,l=o?o.isBuffer:void 0,u=l||r;t.exports=u})(A_,A_.exports);var F5=A_.exports,Jte=9007199254740991,Zte=/^(?:0|[1-9]\d*)$/;function ene(t,e){var n=typeof t;return e=e??Jte,!!e&&(n=="number"||n!="symbol"&&Zte.test(t))&&t>-1&&t%1==0&&t<e}var WT=ene,tne=9007199254740991;function nne(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=tne}var HT=nne,rne=El,ine=HT,sne=Cl,ane="[object Arguments]",one="[object Array]",lne="[object Boolean]",cne="[object Date]",une="[object Error]",dne="[object Function]",hne="[object Map]",fne="[object Number]",pne="[object Object]",mne="[object RegExp]",gne="[object Set]",yne="[object String]",vne="[object WeakMap]",xne="[object ArrayBuffer]",bne="[object DataView]",wne="[object Float32Array]",_ne="[object Float64Array]",Sne="[object Int8Array]",Ane="[object Int16Array]",jne="[object Int32Array]",kne="[object Uint8Array]",Nne="[object Uint8ClampedArray]",Ene="[object Uint16Array]",Cne="[object Uint32Array]",Tt={};Tt[wne]=Tt[_ne]=Tt[Sne]=Tt[Ane]=Tt[jne]=Tt[kne]=Tt[Nne]=Tt[Ene]=Tt[Cne]=!0;Tt[ane]=Tt[one]=Tt[xne]=Tt[lne]=Tt[bne]=Tt[cne]=Tt[une]=Tt[dne]=Tt[hne]=Tt[fne]=Tt[pne]=Tt[mne]=Tt[gne]=Tt[yne]=Tt[vne]=!1;function Pne(t){return sne(t)&&ine(t.length)&&!!Tt[rne(t)]}var Tne=Pne;function One(t){return function(e){return t(e)}}var B5=One,j_={exports:{}};j_.exports;(function(t,e){var n=KB,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,a=s&&n.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();t.exports=o})(j_,j_.exports);var Mne=j_.exports,Rne=Tne,Ine=B5,gI=Mne,yI=gI&&gI.isTypedArray,Dne=yI?Ine(yI):Rne,U5=Dne,$ne=Bte,Lne=zT,Fne=hi,Bne=F5,Une=WT,zne=U5,Wne=Object.prototype,Hne=Wne.hasOwnProperty;function qne(t,e){var n=Fne(t),r=!n&&Lne(t),i=!n&&!r&&Bne(t),s=!n&&!r&&!i&&zne(t),a=n||r||i||s,o=a?$ne(t.length,String):[],l=o.length;for(var u in t)(e||Hne.call(t,u))&&!(a&&(u=="length"||i&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Une(u,l)))&&o.push(u);return o}var Gne=qne,Kne=Object.prototype;function Vne(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Kne;return t===n}var Yne=Vne;function Xne(t,e){return function(n){return t(e(n))}}var z5=Xne,Qne=z5,Jne=Qne(Object.keys,Object),Zne=Jne,ere=Yne,tre=Zne,nre=Object.prototype,rre=nre.hasOwnProperty;function ire(t){if(!ere(t))return tre(t);var e=[];for(var n in Object(t))rre.call(t,n)&&n!="constructor"&&e.push(n);return e}var sre=ire,are=kT,ore=HT;function lre(t){return t!=null&&ore(t.length)&&!are(t)}var Ib=lre,cre=Gne,ure=sre,dre=Ib;function hre(t){return dre(t)?cre(t):ure(t)}var FA=hre,fre=Ete,pre=Lte,mre=FA;function gre(t){return fre(t,mre,pre)}var yre=gre,vI=yre,vre=1,xre=Object.prototype,bre=xre.hasOwnProperty;function wre(t,e,n,r,i,s){var a=n&vre,o=vI(t),l=o.length,u=vI(e),d=u.length;if(l!=d&&!a)return!1;for(var f=l;f--;){var p=o[f];if(!(a?p in e:bre.call(e,p)))return!1}var m=s.get(t),y=s.get(e);if(m&&y)return m==e&&y==t;var g=!0;s.set(t,e),s.set(e,t);for(var v=a;++f<l;){p=o[f];var b=t[p],x=e[p];if(r)var w=a?r(x,b,p,e,t,s):r(b,x,p,t,e,s);if(!(w===void 0?b===x||i(b,x,n,r,s):w)){g=!1;break}v||(v=p=="constructor")}if(g&&!v){var S=t.constructor,_=e.constructor;S!=_&&"constructor"in t&&"constructor"in e&&!(typeof S=="function"&&S instanceof S&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return s.delete(t),s.delete(e),g}var _re=wre,Sre=tf,Are=ao,jre=Sre(Are,"DataView"),kre=jre,Nre=tf,Ere=ao,Cre=Nre(Ere,"Promise"),Pre=Cre,Tre=tf,Ore=ao,Mre=Tre(Ore,"Set"),W5=Mre,Rre=tf,Ire=ao,Dre=Rre(Ire,"WeakMap"),$re=Dre,CE=kre,PE=ET,TE=Pre,OE=W5,ME=$re,H5=El,qg=YB,xI="[object Map]",Lre="[object Object]",bI="[object Promise]",wI="[object Set]",_I="[object WeakMap]",SI="[object DataView]",Fre=qg(CE),Bre=qg(PE),Ure=qg(TE),zre=qg(OE),Wre=qg(ME),Bu=H5;(CE&&Bu(new CE(new ArrayBuffer(1)))!=SI||PE&&Bu(new PE)!=xI||TE&&Bu(TE.resolve())!=bI||OE&&Bu(new OE)!=wI||ME&&Bu(new ME)!=_I)&&(Bu=function(t){var e=H5(t),n=e==Lre?t.constructor:void 0,r=n?qg(n):"";if(r)switch(r){case Fre:return SI;case Bre:return xI;case Ure:return bI;case zre:return wI;case Wre:return _I}return e});var Hre=Bu,pk=O5,qre=D5,Gre=Ste,Kre=_re,AI=Hre,jI=hi,kI=F5,Vre=U5,Yre=1,NI="[object Arguments]",EI="[object Array]",bw="[object Object]",Xre=Object.prototype,CI=Xre.hasOwnProperty;function Qre(t,e,n,r,i,s){var a=jI(t),o=jI(e),l=a?EI:AI(t),u=o?EI:AI(e);l=l==NI?bw:l,u=u==NI?bw:u;var d=l==bw,f=u==bw,p=l==u;if(p&&kI(t)){if(!kI(e))return!1;a=!0,d=!1}if(p&&!d)return s||(s=new pk),a||Vre(t)?qre(t,e,n,r,i,s):Gre(t,e,l,n,r,i,s);if(!(n&Yre)){var m=d&&CI.call(t,"__wrapped__"),y=f&&CI.call(e,"__wrapped__");if(m||y){var g=m?t.value():t,v=y?e.value():e;return s||(s=new pk),i(g,v,n,r,s)}}return p?(s||(s=new pk),Kre(t,e,n,r,i,s)):!1}var Jre=Qre,Zre=Jre,PI=Cl;function q5(t,e,n,r,i){return t===e?!0:t==null||e==null||!PI(t)&&!PI(e)?t!==t&&e!==e:Zre(t,e,n,r,q5,i)}var qT=q5,eie=O5,tie=qT,nie=1,rie=2;function iie(t,e,n,r){var i=n.length,s=i,a=!r;if(t==null)return!s;for(t=Object(t);i--;){var o=n[i];if(a&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=n[i];var l=o[0],u=t[l],d=o[1];if(a&&o[2]){if(u===void 0&&!(l in t))return!1}else{var f=new eie;if(r)var p=r(u,d,l,t,e,f);if(!(p===void 0?tie(d,u,nie|rie,r,f):p))return!1}}return!0}var sie=iie,aie=ju;function oie(t){return t===t&&!aie(t)}var G5=oie,lie=G5,cie=FA;function uie(t){for(var e=cie(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,lie(i)]}return e}var die=uie;function hie(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var K5=hie,fie=sie,pie=die,mie=K5;function gie(t){var e=pie(t);return e.length==1&&e[0][2]?mie(e[0][0],e[0][1]):function(n){return n===t||fie(n,t,e)}}var yie=gie;function vie(t,e){return t!=null&&e in Object(t)}var xie=vie,bie=e5,wie=zT,_ie=hi,Sie=WT,Aie=HT,jie=SA;function kie(t,e,n){e=bie(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var a=jie(e[r]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&Aie(i)&&Sie(a,i)&&(_ie(t)||wie(t)))}var Nie=kie,Eie=xie,Cie=Nie;function Pie(t,e){return t!=null&&Cie(t,e,Eie)}var Tie=Pie,Oie=qT,Mie=t5,Rie=Tie,Iie=jT,Die=G5,$ie=K5,Lie=SA,Fie=1,Bie=2;function Uie(t,e){return Iie(t)&&Die(e)?$ie(Lie(t),e):function(n){var r=Mie(n,t);return r===void 0&&r===e?Rie(n,t):Oie(e,r,Fie|Bie)}}var zie=Uie;function Wie(t){return t}var Gg=Wie;function Hie(t){return function(e){return e==null?void 0:e[t]}}var qie=Hie,Gie=OT;function Kie(t){return function(e){return Gie(e,t)}}var Vie=Kie,Yie=qie,Xie=Vie,Qie=jT,Jie=SA;function Zie(t){return Qie(t)?Yie(Jie(t)):Xie(t)}var ese=Zie,tse=yie,nse=zie,rse=Gg,ise=hi,sse=ese;function ase(t){return typeof t=="function"?t:t==null?rse:typeof t=="object"?ise(t)?nse(t[0],t[1]):tse(t):sse(t)}var oo=ase;function ose(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}var V5=ose;function lse(t){return t!==t}var cse=lse;function use(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}var dse=use,hse=V5,fse=cse,pse=dse;function mse(t,e,n){return e===e?pse(t,e,n):hse(t,fse,n)}var gse=mse,yse=gse;function vse(t,e){var n=t==null?0:t.length;return!!n&&yse(t,e,0)>-1}var xse=vse;function bse(t,e,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}var wse=bse;function _se(){}var Sse=_se,mk=W5,Ase=Sse,jse=UT,kse=1/0,Nse=mk&&1/jse(new mk([,-0]))[1]==kse?function(t){return new mk(t)}:Ase,Ese=Nse,Cse=M5,Pse=xse,Tse=wse,Ose=I5,Mse=Ese,Rse=UT,Ise=200;function Dse(t,e,n){var r=-1,i=Pse,s=t.length,a=!0,o=[],l=o;if(n)a=!1,i=Tse;else if(s>=Ise){var u=e?null:Mse(t);if(u)return Rse(u);a=!1,i=Ose,l=new Cse}else l=e?[]:o;e:for(;++r<s;){var d=t[r],f=e?e(d):d;if(d=n||d!==0?d:0,a&&f===f){for(var p=l.length;p--;)if(l[p]===f)continue e;e&&l.push(f),o.push(d)}else i(l,f,n)||(l!==o&&l.push(f),o.push(d))}return o}var $se=Dse,Lse=oo,Fse=$se;function Bse(t,e){return t&&t.length?Fse(t,Lse(e)):[]}var Use=Bse;const TI=at(Use);function Y5(t,e,n){return e===!0?TI(t,n):_e(e)?TI(t,e):t}function sg(t){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sg(t)}var zse=["ref"];function OI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function co(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OI(Object(n),!0).forEach(function(r){BA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Wse(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q5(r.key),r)}}function Hse(t,e,n){return e&&MI(t.prototype,e),n&&MI(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qse(t,e,n){return e=k_(e),Gse(t,X5()?Reflect.construct(e,n||[],k_(t).constructor):e.apply(t,n))}function Gse(t,e){if(e&&(sg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kse(t)}function Kse(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X5=function(){return!!t})()}function k_(t){return k_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},k_(t)}function Vse(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RE(t,e)}function RE(t,e){return RE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},RE(t,e)}function BA(t,e,n){return e=Q5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q5(t){var e=Yse(t,"string");return sg(e)=="symbol"?e:e+""}function Yse(t,e){if(sg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(sg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Xse(t,e){if(t==null)return{};var n=Qse(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Qse(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Jse(t){return t.value}function Zse(t,e){if(D.isValidElement(t))return D.cloneElement(t,e);if(typeof t=="function")return D.createElement(t,e);e.ref;var n=Xse(e,zse);return D.createElement(BT,n)}var RI=1,Fr=function(t){function e(){var n;Wse(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=qse(this,e,[].concat(i)),BA(n,"lastBoundingBox",{width:-1,height:-1}),n}return Vse(e,t),Hse(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>RI||Math.abs(i.height-this.lastBoundingBox.height)>RI)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,r&&r(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?co({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var i=this.props,s=i.layout,a=i.align,o=i.verticalAlign,l=i.margin,u=i.chartWidth,d=i.chartHeight,f,p;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(a==="center"&&s==="vertical"){var m=this.getBBoxSnapshot();f={left:((u||0)-m.width)/2}}else f=a==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(o==="middle"){var y=this.getBBoxSnapshot();p={top:((d||0)-y.height)/2}}else p=o==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return co(co({},f),p)}},{key:"render",value:function(){var r=this,i=this.props,s=i.content,a=i.width,o=i.height,l=i.wrapperStyle,u=i.payloadUniqBy,d=i.payload,f=co(co({position:"absolute",width:a||"auto",height:o||"auto"},this.getDefaultPosition(l)),l);return D.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){r.wrapperNode=m}},Zse(s,co(co({},this.props),{},{payload:Y5(d,u,Jse)})))}}],[{key:"getWithHeight",value:function(r,i){var s=co(co({},this.defaultProps),r.props),a=s.layout;return a==="vertical"&&oe(r.props.height)?{height:r.props.height}:a==="horizontal"?{width:r.props.width||i}:null}}])}(T.PureComponent);BA(Fr,"displayName","Legend");BA(Fr,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var II=Rb,eae=zT,tae=hi,DI=II?II.isConcatSpreadable:void 0;function nae(t){return tae(t)||eae(t)||!!(DI&&t&&t[DI])}var rae=nae,iae=$5,sae=rae;function J5(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=sae),i||(i=[]);++s<a;){var o=t[s];e>0&&n(o)?e>1?J5(o,e-1,n,r,i):iae(i,o):r||(i[i.length]=o)}return i}var Z5=J5;function aae(t){return function(e,n,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var l=a[t?o:++i];if(n(s[l],l,s)===!1)break}return e}}var oae=aae,lae=oae,cae=lae(),uae=cae,dae=uae,hae=FA;function fae(t,e){return t&&dae(t,e,hae)}var e6=fae,pae=Ib;function mae(t,e){return function(n,r){if(n==null)return n;if(!pae(n))return t(n,r);for(var i=n.length,s=e?i:-1,a=Object(n);(e?s--:++s<i)&&r(a[s],s,a)!==!1;);return n}}var gae=mae,yae=e6,vae=gae,xae=vae(yae),GT=xae,bae=GT,wae=Ib;function _ae(t,e){var n=-1,r=wae(t)?Array(t.length):[];return bae(t,function(i,s,a){r[++n]=e(i,s,a)}),r}var t6=_ae;function Sae(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var Aae=Sae,$I=Lg;function jae(t,e){if(t!==e){var n=t!==void 0,r=t===null,i=t===t,s=$I(t),a=e!==void 0,o=e===null,l=e===e,u=$I(e);if(!o&&!u&&!s&&t>e||s&&a&&l&&!o&&!u||r&&a&&l||!n&&l||!i)return 1;if(!r&&!s&&!u&&t<e||u&&n&&i&&!r&&!s||o&&n&&i||!a&&i||!l)return-1}return 0}var kae=jae,Nae=kae;function Eae(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,a=i.length,o=n.length;++r<a;){var l=Nae(i[r],s[r]);if(l){if(r>=o)return l;var u=n[r];return l*(u=="desc"?-1:1)}}return t.index-e.index}var Cae=Eae,gk=TT,Pae=OT,Tae=oo,Oae=t6,Mae=Aae,Rae=B5,Iae=Cae,Dae=Gg,$ae=hi;function Lae(t,e,n){e.length?e=gk(e,function(s){return $ae(s)?function(a){return Pae(a,s.length===1?s[0]:s)}:s}):e=[Dae];var r=-1;e=gk(e,Rae(Tae));var i=Oae(t,function(s,a,o){var l=gk(e,function(u){return u(s)});return{criteria:l,index:++r,value:s}});return Mae(i,function(s,a){return Iae(s,a,n)})}var Fae=Lae;function Bae(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var Uae=Bae,zae=Uae,LI=Math.max;function Wae(t,e,n){return e=LI(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=LI(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),zae(t,this,o)}}var Hae=Wae;function qae(t){return function(){return t}}var Gae=qae,Kae=tf,Vae=function(){try{var t=Kae(Object,"defineProperty");return t({},"",{}),t}catch{}}(),n6=Vae,Yae=Gae,FI=n6,Xae=Gg,Qae=FI?function(t,e){return FI(t,"toString",{configurable:!0,enumerable:!1,value:Yae(e),writable:!0})}:Xae,Jae=Qae,Zae=800,eoe=16,toe=Date.now;function noe(t){var e=0,n=0;return function(){var r=toe(),i=eoe-(r-n);if(n=r,i>0){if(++e>=Zae)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var roe=noe,ioe=Jae,soe=roe,aoe=soe(ioe),ooe=aoe,loe=Gg,coe=Hae,uoe=ooe;function doe(t,e){return uoe(coe(t,e,loe),t+"")}var hoe=doe,foe=NT,poe=Ib,moe=WT,goe=ju;function yoe(t,e,n){if(!goe(n))return!1;var r=typeof e;return(r=="number"?poe(n)&&moe(e,n.length):r=="string"&&e in n)?foe(n[e],t):!1}var UA=yoe,voe=Z5,xoe=Fae,boe=hoe,BI=UA,woe=boe(function(t,e){if(t==null)return[];var n=e.length;return n>1&&BI(t,e[0],e[1])?e=[]:n>2&&BI(e[0],e[1],e[2])&&(e=[e[0]]),xoe(t,voe(e,1),[])}),_oe=woe;const KT=at(_oe);function H0(t){"@babel/helpers - typeof";return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H0(t)}function IE(){return IE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IE.apply(this,arguments)}function Soe(t,e){return Noe(t)||koe(t,e)||joe(t,e)||Aoe()}function Aoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function joe(t,e){if(t){if(typeof t=="string")return UI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UI(t,e)}}function UI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function koe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Noe(t){if(Array.isArray(t))return t}function zI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function yk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zI(Object(n),!0).forEach(function(r){Eoe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Eoe(t,e,n){return e=Coe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Coe(t){var e=Poe(t,"string");return H0(e)=="symbol"?e:e+""}function Poe(t,e){if(H0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(H0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Toe(t){return Array.isArray(t)&&En(t[0])&&En(t[1])?t.join(" ~ "):t}var Ooe=function(e){var n=e.separator,r=n===void 0?" : ":n,i=e.contentStyle,s=i===void 0?{}:i,a=e.itemStyle,o=a===void 0?{}:a,l=e.labelStyle,u=l===void 0?{}:l,d=e.payload,f=e.formatter,p=e.itemSorter,m=e.wrapperClassName,y=e.labelClassName,g=e.label,v=e.labelFormatter,b=e.accessibilityLayer,x=b===void 0?!1:b,w=function(){if(d&&d.length){var R={padding:0,margin:0},I=(p?KT(d,p):d).map(function(L,W){if(L.type==="none")return null;var F=yk({display:"block",paddingTop:4,paddingBottom:4,color:L.color||"#000"},o),z=L.formatter||f||Toe,U=L.value,K=L.name,H=U,Q=K;if(z&&H!=null&&Q!=null){var B=z(U,K,L,W,d);if(Array.isArray(B)){var Y=Soe(B,2);H=Y[0],Q=Y[1]}else H=B}return D.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(W),style:F},En(Q)?D.createElement("span",{className:"recharts-tooltip-item-name"},Q):null,En(Q)?D.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,D.createElement("span",{className:"recharts-tooltip-item-value"},H),D.createElement("span",{className:"recharts-tooltip-item-unit"},L.unit||""))});return D.createElement("ul",{className:"recharts-tooltip-item-list",style:R},I)}return null},S=yk({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),_=yk({margin:0},u),A=!we(g),j=A?g:"",N=Ee("recharts-default-tooltip",m),P=Ee("recharts-tooltip-label",y);A&&v&&d!==void 0&&d!==null&&(j=v(g,d));var O=x?{role:"status","aria-live":"assertive"}:{};return D.createElement("div",IE({className:N,style:S},O),D.createElement("p",{className:P,style:_},D.isValidElement(j)?j:"".concat(j)),w())};function q0(t){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q0(t)}function ww(t,e,n){return e=Moe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Moe(t){var e=Roe(t,"string");return q0(e)=="symbol"?e:e+""}function Roe(t,e){if(q0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(q0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uy="recharts-tooltip-wrapper",Ioe={visibility:"hidden"};function Doe(t){var e=t.coordinate,n=t.translateX,r=t.translateY;return Ee(uy,ww(ww(ww(ww({},"".concat(uy,"-right"),oe(n)&&e&&oe(e.x)&&n>=e.x),"".concat(uy,"-left"),oe(n)&&e&&oe(e.x)&&n<e.x),"".concat(uy,"-bottom"),oe(r)&&e&&oe(e.y)&&r>=e.y),"".concat(uy,"-top"),oe(r)&&e&&oe(e.y)&&r<e.y))}function WI(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.key,i=t.offsetTopLeft,s=t.position,a=t.reverseDirection,o=t.tooltipDimension,l=t.viewBox,u=t.viewBoxDimension;if(s&&oe(s[r]))return s[r];var d=n[r]-o-i,f=n[r]+i;if(e[r])return a[r]?d:f;if(a[r]){var p=d,m=l[r];return p<m?Math.max(f,l[r]):Math.max(d,l[r])}var y=f+o,g=l[r]+u;return y>g?Math.max(d,l[r]):Math.max(f,l[r])}function $oe(t){var e=t.translateX,n=t.translateY,r=t.useTranslate3d;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function Loe(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.offsetTopLeft,i=t.position,s=t.reverseDirection,a=t.tooltipBox,o=t.useTranslate3d,l=t.viewBox,u,d,f;return a.height>0&&a.width>0&&n?(d=WI({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:i,reverseDirection:s,tooltipDimension:a.width,viewBox:l,viewBoxDimension:l.width}),f=WI({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:i,reverseDirection:s,tooltipDimension:a.height,viewBox:l,viewBoxDimension:l.height}),u=$oe({translateX:d,translateY:f,useTranslate3d:o})):u=Ioe,{cssProperties:u,cssClasses:Doe({translateX:d,translateY:f,coordinate:n})}}function ag(t){"@babel/helpers - typeof";return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ag(t)}function HI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function qI(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HI(Object(n),!0).forEach(function(r){$E(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Foe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Boe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i6(r.key),r)}}function Uoe(t,e,n){return e&&Boe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zoe(t,e,n){return e=N_(e),Woe(t,r6()?Reflect.construct(e,n||[],N_(t).constructor):e.apply(t,n))}function Woe(t,e){if(e&&(ag(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hoe(t)}function Hoe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r6=function(){return!!t})()}function N_(t){return N_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},N_(t)}function qoe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DE(t,e)}function DE(t,e){return DE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},DE(t,e)}function $E(t,e,n){return e=i6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=Goe(t,"string");return ag(e)=="symbol"?e:e+""}function Goe(t,e){if(ag(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(ag(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var GI=1,Koe=function(t){function e(){var n;Foe(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=zoe(this,e,[].concat(i)),$E(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),$E(n,"handleKeyDown",function(a){if(a.key==="Escape"){var o,l,u,d;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&o!==void 0?o:0,y:(u=(d=n.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),n}return qoe(e,t),Uoe(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>GI||Math.abs(r.height-this.state.lastBoundingBox.height)>GI)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,i=this.props,s=i.active,a=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,u=i.children,d=i.coordinate,f=i.hasPayload,p=i.isAnimationActive,m=i.offset,y=i.position,g=i.reverseDirection,v=i.useTranslate3d,b=i.viewBox,x=i.wrapperStyle,w=Loe({allowEscapeViewBox:a,coordinate:d,offsetTopLeft:m,position:y,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:b}),S=w.cssClasses,_=w.cssProperties,A=qI(qI({transition:p&&s?"transform ".concat(o,"ms ").concat(l):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&f?"visible":"hidden",position:"absolute",top:0,left:0},x);return D.createElement("div",{tabIndex:-1,className:S,style:A,ref:function(N){r.wrapperNode=N}},u)}}])}(T.PureComponent),Voe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Pl={isSsr:Voe()};function og(t){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},og(t)}function KI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function VI(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KI(Object(n),!0).forEach(function(r){VT(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Yoe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xoe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,a6(r.key),r)}}function Qoe(t,e,n){return e&&Xoe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Joe(t,e,n){return e=E_(e),Zoe(t,s6()?Reflect.construct(e,n||[],E_(t).constructor):e.apply(t,n))}function Zoe(t,e){if(e&&(og(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ele(t)}function ele(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s6(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s6=function(){return!!t})()}function E_(t){return E_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},E_(t)}function tle(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LE(t,e)}function LE(t,e){return LE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},LE(t,e)}function VT(t,e,n){return e=a6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a6(t){var e=nle(t,"string");return og(e)=="symbol"?e:e+""}function nle(t,e){if(og(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(og(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function rle(t){return t.dataKey}function ile(t,e){return D.isValidElement(t)?D.cloneElement(t,e):typeof t=="function"?D.createElement(t,e):D.createElement(Ooe,e)}var on=function(t){function e(){return Yoe(this,e),Joe(this,e,arguments)}return tle(e,t),Qoe(e,[{key:"render",value:function(){var r=this,i=this.props,s=i.active,a=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,u=i.content,d=i.coordinate,f=i.filterNull,p=i.isAnimationActive,m=i.offset,y=i.payload,g=i.payloadUniqBy,v=i.position,b=i.reverseDirection,x=i.useTranslate3d,w=i.viewBox,S=i.wrapperStyle,_=y??[];f&&_.length&&(_=Y5(y.filter(function(j){return j.value!=null&&(j.hide!==!0||r.props.includeHidden)}),g,rle));var A=_.length>0;return D.createElement(Koe,{allowEscapeViewBox:a,animationDuration:o,animationEasing:l,isAnimationActive:p,active:s,coordinate:d,hasPayload:A,offset:m,position:v,reverseDirection:b,useTranslate3d:x,viewBox:w,wrapperStyle:S},ile(u,VI(VI({},this.props),{},{payload:_})))}}])}(T.PureComponent);VT(on,"displayName","Tooltip");VT(on,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Pl.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var sle=ao,ale=function(){return sle.Date.now()},ole=ale,lle=/\s/;function cle(t){for(var e=t.length;e--&&lle.test(t.charAt(e)););return e}var ule=cle,dle=ule,hle=/^\s+/;function fle(t){return t&&t.slice(0,dle(t)+1).replace(hle,"")}var ple=fle,mle=ple,YI=ju,gle=Lg,XI=NaN,yle=/^[-+]0x[0-9a-f]+$/i,vle=/^0b[01]+$/i,xle=/^0o[0-7]+$/i,ble=parseInt;function wle(t){if(typeof t=="number")return t;if(gle(t))return XI;if(YI(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=YI(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=mle(t);var n=vle.test(t);return n||xle.test(t)?ble(t.slice(2),n?2:8):yle.test(t)?XI:+t}var o6=wle,_le=ju,vk=ole,QI=o6,Sle="Expected a function",Ale=Math.max,jle=Math.min;function kle(t,e,n){var r,i,s,a,o,l,u=0,d=!1,f=!1,p=!0;if(typeof t!="function")throw new TypeError(Sle);e=QI(e)||0,_le(n)&&(d=!!n.leading,f="maxWait"in n,s=f?Ale(QI(n.maxWait)||0,e):s,p="trailing"in n?!!n.trailing:p);function m(A){var j=r,N=i;return r=i=void 0,u=A,a=t.apply(N,j),a}function y(A){return u=A,o=setTimeout(b,e),d?m(A):a}function g(A){var j=A-l,N=A-u,P=e-j;return f?jle(P,s-N):P}function v(A){var j=A-l,N=A-u;return l===void 0||j>=e||j<0||f&&N>=s}function b(){var A=vk();if(v(A))return x(A);o=setTimeout(b,g(A))}function x(A){return o=void 0,p&&r?m(A):(r=i=void 0,a)}function w(){o!==void 0&&clearTimeout(o),u=0,r=l=i=o=void 0}function S(){return o===void 0?a:x(vk())}function _(){var A=vk(),j=v(A);if(r=arguments,i=this,l=A,j){if(o===void 0)return y(l);if(f)return clearTimeout(o),o=setTimeout(b,e),m(l)}return o===void 0&&(o=setTimeout(b,e)),a}return _.cancel=w,_.flush=S,_}var Nle=kle,Ele=Nle,Cle=ju,Ple="Expected a function";function Tle(t,e,n){var r=!0,i=!0;if(typeof t!="function")throw new TypeError(Ple);return Cle(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ele(t,e,{leading:r,maxWait:e,trailing:i})}var Ole=Tle;const l6=at(Ole);function G0(t){"@babel/helpers - typeof";return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G0(t)}function JI(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function _w(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JI(Object(n),!0).forEach(function(r){Mle(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JI(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Mle(t,e,n){return e=Rle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rle(t){var e=Ile(t,"string");return G0(e)=="symbol"?e:e+""}function Ile(t,e){if(G0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(G0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dle(t,e){return Ble(t)||Fle(t,e)||Lle(t,e)||$le()}function $le(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lle(t,e){if(t){if(typeof t=="string")return ZI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZI(t,e)}}function ZI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fle(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Ble(t){if(Array.isArray(t))return t}var _s=T.forwardRef(function(t,e){var n=t.aspect,r=t.initialDimension,i=r===void 0?{width:-1,height:-1}:r,s=t.width,a=s===void 0?"100%":s,o=t.height,l=o===void 0?"100%":o,u=t.minWidth,d=u===void 0?0:u,f=t.minHeight,p=t.maxHeight,m=t.children,y=t.debounce,g=y===void 0?0:y,v=t.id,b=t.className,x=t.onResize,w=t.style,S=w===void 0?{}:w,_=T.useRef(null),A=T.useRef();A.current=x,T.useImperativeHandle(e,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var j=T.useState({containerWidth:i.width,containerHeight:i.height}),N=Dle(j,2),P=N[0],O=N[1],M=T.useCallback(function(I,L){O(function(W){var F=Math.round(I),z=Math.round(L);return W.containerWidth===F&&W.containerHeight===z?W:{containerWidth:F,containerHeight:z}})},[]);T.useEffect(function(){var I=function(K){var H,Q=K[0].contentRect,B=Q.width,Y=Q.height;M(B,Y),(H=A.current)===null||H===void 0||H.call(A,B,Y)};g>0&&(I=l6(I,g,{trailing:!0,leading:!1}));var L=new ResizeObserver(I),W=_.current.getBoundingClientRect(),F=W.width,z=W.height;return M(F,z),L.observe(_.current),function(){L.disconnect()}},[M,g]);var R=T.useMemo(function(){var I=P.containerWidth,L=P.containerHeight;if(I<0||L<0)return null;ua(id(a)||id(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,l),ua(!n||n>0,"The aspect(%s) must be greater than zero.",n);var W=id(a)?I:a,F=id(l)?L:l;n&&n>0&&(W?F=W/n:F&&(W=F*n),p&&F>p&&(F=p)),ua(W>0||F>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,W,F,a,l,d,f,n);var z=!Array.isArray(m)&&hl(m.type).endsWith("Chart");return D.Children.map(m,function(U){return D.isValidElement(U)?T.cloneElement(U,_w({width:W,height:F},z?{style:_w({height:"100%",width:"100%",maxHeight:F,maxWidth:W},U.props.style)}:{})):U})},[n,m,l,p,f,d,P,a]);return D.createElement("div",{id:v?"".concat(v):void 0,className:Ee("recharts-responsive-container",b),style:_w(_w({},S),{},{width:a,height:l,minWidth:d,minHeight:f,maxHeight:p}),ref:_},R)}),Kg=function(e){return null};Kg.displayName="Cell";function K0(t){"@babel/helpers - typeof";return K0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K0(t)}function eD(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function FE(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?eD(Object(n),!0).forEach(function(r){Ule(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eD(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ule(t,e,n){return e=zle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Wle(t,"string");return K0(e)=="symbol"?e:e+""}function Wle(t,e){if(K0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(K0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mf={widthCache:{},cacheCount:0},Hle=2e3,qle={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},tD="recharts_measurement_span";function Gle(t){var e=FE({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var f0=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Pl.isSsr)return{width:0,height:0};var r=Gle(n),i=JSON.stringify({text:e,copyStyle:r});if(mf.widthCache[i])return mf.widthCache[i];try{var s=document.getElementById(tD);s||(s=document.createElement("span"),s.setAttribute("id",tD),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var a=FE(FE({},qle),r);Object.assign(s.style,a),s.textContent="".concat(e);var o=s.getBoundingClientRect(),l={width:o.width,height:o.height};return mf.widthCache[i]=l,++mf.cacheCount>Hle&&(mf.cacheCount=0,mf.widthCache={}),l}catch{return{width:0,height:0}}},Kle=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function V0(t){"@babel/helpers - typeof";return V0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V0(t)}function C_(t,e){return Qle(t)||Xle(t,e)||Yle(t,e)||Vle()}function Vle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yle(t,e){if(t){if(typeof t=="string")return nD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nD(t,e)}}function nD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xle(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Qle(t){if(Array.isArray(t))return t}function Jle(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rD(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ece(r.key),r)}}function Zle(t,e,n){return e&&rD(t.prototype,e),n&&rD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ece(t){var e=tce(t,"string");return V0(e)=="symbol"?e:e+""}function tce(t,e){if(V0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(V0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var iD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nce=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,rce=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,c6={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ice=Object.keys(c6),Hf="NaN";function sce(t,e){return t*c6[e]}var Sw=function(){function t(e,n){Jle(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!nce.test(n)&&(this.num=NaN,this.unit=""),ice.includes(n)&&(this.num=sce(e,n),this.unit="px")}return Zle(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,i=(r=rce.exec(n))!==null&&r!==void 0?r:[],s=C_(i,3),a=s[1],o=s[2];return new t(parseFloat(a),o??"")}}])}();function u6(t){if(t.includes(Hf))return Hf;for(var e=t;e.includes("*")||e.includes("/");){var n,r=(n=iD.exec(e))!==null&&n!==void 0?n:[],i=C_(r,4),s=i[1],a=i[2],o=i[3],l=Sw.parse(s??""),u=Sw.parse(o??""),d=a==="*"?l.multiply(u):l.divide(u);if(d.isNaN())return Hf;e=e.replace(iD,d.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var f,p=(f=sD.exec(e))!==null&&f!==void 0?f:[],m=C_(p,4),y=m[1],g=m[2],v=m[3],b=Sw.parse(y??""),x=Sw.parse(v??""),w=g==="+"?b.add(x):b.subtract(x);if(w.isNaN())return Hf;e=e.replace(sD,w.toString())}return e}var aD=/\(([^()]*)\)/;function ace(t){for(var e=t;e.includes("(");){var n=aD.exec(e),r=C_(n,2),i=r[1];e=e.replace(aD,u6(i))}return e}function oce(t){var e=t.replace(/\s+/g,"");return e=ace(e),e=u6(e),e}function lce(t){try{return oce(t)}catch{return Hf}}function xk(t){var e=lce(t.slice(5,-1));return e===Hf?"":e}var cce=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],uce=["dx","dy","angle","className","breakAll"];function BE(){return BE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},BE.apply(this,arguments)}function oD(t,e){if(t==null)return{};var n=dce(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dce(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function lD(t,e){return mce(t)||pce(t,e)||fce(t,e)||hce()}function hce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fce(t,e){if(t){if(typeof t=="string")return cD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cD(t,e)}}function cD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pce(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function mce(t){if(Array.isArray(t))return t}var d6=/[ \f\n\r\t\v\u2028\u2029]+/,h6=function(e){var n=e.children,r=e.breakAll,i=e.style;try{var s=[];we(n)||(r?s=n.toString().split(""):s=n.toString().split(d6));var a=s.map(function(l){return{word:l,width:f0(l,i).width}}),o=r?0:f0("",i).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}},gce=function(e,n,r,i,s){var a=e.maxLines,o=e.children,l=e.style,u=e.breakAll,d=oe(a),f=o,p=function(){var W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return W.reduce(function(F,z){var U=z.word,K=z.width,H=F[F.length-1];if(H&&(i==null||s||H.width+K+r<Number(i)))H.words.push(U),H.width+=K+r;else{var Q={words:[U],width:K};F.push(Q)}return F},[])},m=p(n),y=function(W){return W.reduce(function(F,z){return F.width>z.width?F:z})};if(!d)return m;for(var g="",v=function(W){var F=f.slice(0,W),z=h6({breakAll:u,style:l,children:F+g}).wordsWithComputedWidth,U=p(z),K=U.length>a||y(U).width>Number(i);return[K,U]},b=0,x=f.length-1,w=0,S;b<=x&&w<=f.length-1;){var _=Math.floor((b+x)/2),A=_-1,j=v(A),N=lD(j,2),P=N[0],O=N[1],M=v(_),R=lD(M,1),I=R[0];if(!P&&!I&&(b=_+1),P&&I&&(x=_-1),!P&&I){S=O;break}w++}return S||m},uD=function(e){var n=we(e)?[]:e.toString().split(d6);return[{words:n}]},yce=function(e){var n=e.width,r=e.scaleToFit,i=e.children,s=e.style,a=e.breakAll,o=e.maxLines;if((n||r)&&!Pl.isSsr){var l,u,d=h6({breakAll:a,children:i,style:s});if(d){var f=d.wordsWithComputedWidth,p=d.spaceWidth;l=f,u=p}else return uD(i);return gce({breakAll:a,children:i,maxLines:o,style:s},l,u,n,r)}return uD(i)},dD="#808080",qh=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i,a=e.lineHeight,o=a===void 0?"1em":a,l=e.capHeight,u=l===void 0?"0.71em":l,d=e.scaleToFit,f=d===void 0?!1:d,p=e.textAnchor,m=p===void 0?"start":p,y=e.verticalAnchor,g=y===void 0?"end":y,v=e.fill,b=v===void 0?dD:v,x=oD(e,cce),w=T.useMemo(function(){return yce({breakAll:x.breakAll,children:x.children,maxLines:x.maxLines,scaleToFit:f,style:x.style,width:x.width})},[x.breakAll,x.children,x.maxLines,f,x.style,x.width]),S=x.dx,_=x.dy,A=x.angle,j=x.className,N=x.breakAll,P=oD(x,uce);if(!En(r)||!En(s))return null;var O=r+(oe(S)?S:0),M=s+(oe(_)?_:0),R;switch(g){case"start":R=xk("calc(".concat(u,")"));break;case"middle":R=xk("calc(".concat((w.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:R=xk("calc(".concat(w.length-1," * -").concat(o,")"));break}var I=[];if(f){var L=w[0].width,W=x.width;I.push("scale(".concat((oe(W)?W/L:1)/L,")"))}return A&&I.push("rotate(".concat(A,", ").concat(O,", ").concat(M,")")),I.length&&(P.transform=I.join(" ")),D.createElement("text",BE({},xe(P,!0),{x:O,y:M,className:Ee("recharts-text",j),textAnchor:m,fill:b.includes("url")?dD:b}),w.map(function(F,z){var U=F.words.join(N?"":" ");return D.createElement("tspan",{x:O,dy:z===0?R:o,key:"".concat(U,"-").concat(z)},U)}))};function hu(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function vce(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function YT(t){let e,n,r;t.length!==2?(e=hu,n=(o,l)=>hu(t(o),l),r=(o,l)=>t(o)-l):(e=t===hu||t===vce?t:xce,n=t,r=t);function i(o,l,u=0,d=o.length){if(u<d){if(e(l,l)!==0)return d;do{const f=u+d>>>1;n(o[f],l)<0?u=f+1:d=f}while(u<d)}return u}function s(o,l,u=0,d=o.length){if(u<d){if(e(l,l)!==0)return d;do{const f=u+d>>>1;n(o[f],l)<=0?u=f+1:d=f}while(u<d)}return u}function a(o,l,u=0,d=o.length){const f=i(o,l,u,d-1);return f>u&&r(o[f-1],l)>-r(o[f],l)?f-1:f}return{left:i,center:a,right:s}}function xce(){return 0}function f6(t){return t===null?NaN:+t}function*bce(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const wce=YT(hu),Db=wce.right;YT(f6).center;class hD extends Map{constructor(e,n=Ace){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(fD(this,e))}has(e){return super.has(fD(this,e))}set(e,n){return super.set(_ce(this,e),n)}delete(e){return super.delete(Sce(this,e))}}function fD({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function _ce({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Sce({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Ace(t){return t!==null&&typeof t=="object"?t.valueOf():t}function jce(t=hu){if(t===hu)return p6;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function p6(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const kce=Math.sqrt(50),Nce=Math.sqrt(10),Ece=Math.sqrt(2);function P_(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=kce?10:s>=Nce?5:s>=Ece?2:1;let o,l,u;return i<0?(u=Math.pow(10,-i)/a,o=Math.round(t*u),l=Math.round(e*u),o/u<t&&++o,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*a,o=Math.round(t/u),l=Math.round(e/u),o*u<t&&++o,l*u>e&&--l),l<o&&.5<=n&&n<2?P_(t,e,n*2):[o,l,u]}function UE(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,a]=r?P_(e,t,n):P_(t,e,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let u=0;u<o;++u)l[u]=(s-u)/-a;else for(let u=0;u<o;++u)l[u]=(s-u)*a;else if(a<0)for(let u=0;u<o;++u)l[u]=(i+u)/-a;else for(let u=0;u<o;++u)l[u]=(i+u)*a;return l}function zE(t,e,n){return e=+e,t=+t,n=+n,P_(t,e,n)[2]}function WE(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?zE(e,t,n):zE(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function pD(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function mD(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function m6(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?p6:jce(i);r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,d=Math.log(l),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(l-f)/l)*(u-l/2<0?-1:1),m=Math.max(n,Math.floor(e-u*f/l+p)),y=Math.min(r,Math.floor(e+(l-u)*f/l+p));m6(t,e,m,y,i)}const s=t[e];let a=n,o=r;for(dy(t,n,e),i(t[r],s)>0&&dy(t,n,r);a<o;){for(dy(t,a,o),++a,--o;i(t[a],s)<0;)++a;for(;i(t[o],s)>0;)--o}i(t[n],s)===0?dy(t,n,o):(++o,dy(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}return t}function dy(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Cce(t,e,n){if(t=Float64Array.from(bce(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return mD(t);if(e>=1)return pD(t);var r,i=(r-1)*e,s=Math.floor(i),a=pD(m6(t,s).subarray(0,s+1)),o=mD(t.subarray(s+1));return a+(o-a)*(i-s)}}function Pce(t,e,n=f6){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,s=Math.floor(i),a=+n(t[s],s,t),o=+n(t[s+1],s+1,t);return a+(o-a)*(i-s)}}function Tce(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function Os(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Tl(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const HE=Symbol("implicit");function XT(){var t=new hD,e=[],n=[],r=HE;function i(s){let a=t.get(s);if(a===void 0){if(r!==HE)return r;t.set(s,a=e.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new hD;for(const a of s)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return XT(e,n).unknown(r)},Os.apply(i,arguments),i}function Y0(){var t=XT().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,a,o=!1,l=0,u=0,d=.5;delete t.unknown;function f(){var p=e().length,m=i<r,y=m?i:r,g=m?r:i;s=(g-y)/Math.max(1,p-l+u*2),o&&(s=Math.floor(s)),y+=(g-y-s*(p-l))*d,a=s*(1-l),o&&(y=Math.round(y),a=Math.round(a));var v=Tce(p).map(function(b){return y+s*b});return n(m?v.reverse():v)}return t.domain=function(p){return arguments.length?(e(p),f()):e()},t.range=function(p){return arguments.length?([r,i]=p,r=+r,i=+i,f()):[r,i]},t.rangeRound=function(p){return[r,i]=p,r=+r,i=+i,o=!0,f()},t.bandwidth=function(){return a},t.step=function(){return s},t.round=function(p){return arguments.length?(o=!!p,f()):o},t.padding=function(p){return arguments.length?(l=Math.min(1,u=+p),f()):l},t.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),f()):l},t.paddingOuter=function(p){return arguments.length?(u=+p,f()):u},t.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),f()):d},t.copy=function(){return Y0(e(),[r,i]).round(o).paddingInner(l).paddingOuter(u).align(d)},Os.apply(f(),arguments)}function g6(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return g6(e())},t}function p0(){return g6(Y0.apply(null,arguments).paddingInner(1))}function QT(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function y6(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function $b(){}var X0=.7,T_=1/X0,cp="\\s*([+-]?\\d+)\\s*",Q0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Za="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Oce=/^#([0-9a-f]{3,8})$/,Mce=new RegExp(`^rgb\\(${cp},${cp},${cp}\\)$`),Rce=new RegExp(`^rgb\\(${Za},${Za},${Za}\\)$`),Ice=new RegExp(`^rgba\\(${cp},${cp},${cp},${Q0}\\)$`),Dce=new RegExp(`^rgba\\(${Za},${Za},${Za},${Q0}\\)$`),$ce=new RegExp(`^hsl\\(${Q0},${Za},${Za}\\)$`),Lce=new RegExp(`^hsla\\(${Q0},${Za},${Za},${Q0}\\)$`),gD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};QT($b,J0,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:yD,formatHex:yD,formatHex8:Fce,formatHsl:Bce,formatRgb:vD,toString:vD});function yD(){return this.rgb().formatHex()}function Fce(){return this.rgb().formatHex8()}function Bce(){return v6(this).formatHsl()}function vD(){return this.rgb().formatRgb()}function J0(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Oce.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?xD(e):n===3?new oi(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Aw(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Aw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Mce.exec(t))?new oi(e[1],e[2],e[3],1):(e=Rce.exec(t))?new oi(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Ice.exec(t))?Aw(e[1],e[2],e[3],e[4]):(e=Dce.exec(t))?Aw(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=$ce.exec(t))?_D(e[1],e[2]/100,e[3]/100,1):(e=Lce.exec(t))?_D(e[1],e[2]/100,e[3]/100,e[4]):gD.hasOwnProperty(t)?xD(gD[t]):t==="transparent"?new oi(NaN,NaN,NaN,0):null}function xD(t){return new oi(t>>16&255,t>>8&255,t&255,1)}function Aw(t,e,n,r){return r<=0&&(t=e=n=NaN),new oi(t,e,n,r)}function Uce(t){return t instanceof $b||(t=J0(t)),t?(t=t.rgb(),new oi(t.r,t.g,t.b,t.opacity)):new oi}function qE(t,e,n,r){return arguments.length===1?Uce(t):new oi(t,e,n,r??1)}function oi(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}QT(oi,qE,y6($b,{brighter(t){return t=t==null?T_:Math.pow(T_,t),new oi(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?X0:Math.pow(X0,t),new oi(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new oi(Ih(this.r),Ih(this.g),Ih(this.b),O_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bD,formatHex:bD,formatHex8:zce,formatRgb:wD,toString:wD}));function bD(){return`#${sd(this.r)}${sd(this.g)}${sd(this.b)}`}function zce(){return`#${sd(this.r)}${sd(this.g)}${sd(this.b)}${sd((isNaN(this.opacity)?1:this.opacity)*255)}`}function wD(){const t=O_(this.opacity);return`${t===1?"rgb(":"rgba("}${Ih(this.r)}, ${Ih(this.g)}, ${Ih(this.b)}${t===1?")":`, ${t})`}`}function O_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ih(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function sd(t){return t=Ih(t),(t<16?"0":"")+t.toString(16)}function _D(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new sa(t,e,n,r)}function v6(t){if(t instanceof sa)return new sa(t.h,t.s,t.l,t.opacity);if(t instanceof $b||(t=J0(t)),!t)return new sa;if(t instanceof sa)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(e===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new sa(a,o,l,t.opacity)}function Wce(t,e,n,r){return arguments.length===1?v6(t):new sa(t,e,n,r??1)}function sa(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}QT(sa,Wce,y6($b,{brighter(t){return t=t==null?T_:Math.pow(T_,t),new sa(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?X0:Math.pow(X0,t),new sa(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new oi(bk(t>=240?t-240:t+120,i,r),bk(t,i,r),bk(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new sa(SD(this.h),jw(this.s),jw(this.l),O_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=O_(this.opacity);return`${t===1?"hsl(":"hsla("}${SD(this.h)}, ${jw(this.s)*100}%, ${jw(this.l)*100}%${t===1?")":`, ${t})`}`}}));function SD(t){return t=(t||0)%360,t<0?t+360:t}function jw(t){return Math.max(0,Math.min(1,t||0))}function bk(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const JT=t=>()=>t;function Hce(t,e){return function(n){return t+n*e}}function qce(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Gce(t){return(t=+t)==1?x6:function(e,n){return n-e?qce(e,n,t):JT(isNaN(e)?n:e)}}function x6(t,e){var n=e-t;return n?Hce(t,n):JT(isNaN(t)?e:t)}const AD=function t(e){var n=Gce(e);function r(i,s){var a=n((i=qE(i)).r,(s=qE(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),u=x6(i.opacity,s.opacity);return function(d){return i.r=a(d),i.g=o(d),i.b=l(d),i.opacity=u(d),i+""}}return r.gamma=t,r}(1);function Kce(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Vce(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Yce(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=Vg(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function Xce(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function M_(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Qce(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Vg(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var GE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wk=new RegExp(GE.source,"g");function Jce(t){return function(){return t}}function Zce(t){return function(e){return t(e)+""}}function eue(t,e){var n=GE.lastIndex=wk.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(r=GE.exec(t))&&(i=wk.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:M_(r,i)})),n=wk.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Zce(l[0].x):Jce(e):(e=l.length,function(u){for(var d=0,f;d<e;++d)o[(f=l[d]).i]=f.x(u);return o.join("")})}function Vg(t,e){var n=typeof e,r;return e==null||n==="boolean"?JT(e):(n==="number"?M_:n==="string"?(r=J0(e))?(e=r,AD):eue:e instanceof J0?AD:e instanceof Date?Xce:Vce(e)?Kce:Array.isArray(e)?Yce:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Qce:M_)(t,e)}function ZT(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function tue(t,e){e===void 0&&(e=t,t=Vg);for(var n=0,r=e.length-1,i=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(i,i=e[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function nue(t){return function(){return t}}function R_(t){return+t}var jD=[0,1];function Ir(t){return t}function KE(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:nue(isNaN(e)?NaN:.5)}function rue(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function iue(t,e,n){var r=t[0],i=t[1],s=e[0],a=e[1];return i<r?(r=KE(i,r),s=n(a,s)):(r=KE(r,i),s=n(s,a)),function(o){return s(r(o))}}function sue(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=KE(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(o){var l=Db(t,o,1,r)-1;return s[l](i[l](o))}}function Lb(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function zA(){var t=jD,e=jD,n=Vg,r,i,s,a=Ir,o,l,u;function d(){var p=Math.min(t.length,e.length);return a!==Ir&&(a=rue(t[0],t[p-1])),o=p>2?sue:iue,l=u=null,f}function f(p){return p==null||isNaN(p=+p)?s:(l||(l=o(t.map(r),e,n)))(r(a(p)))}return f.invert=function(p){return a(i((u||(u=o(e,t.map(r),M_)))(p)))},f.domain=function(p){return arguments.length?(t=Array.from(p,R_),d()):t.slice()},f.range=function(p){return arguments.length?(e=Array.from(p),d()):e.slice()},f.rangeRound=function(p){return e=Array.from(p),n=ZT,d()},f.clamp=function(p){return arguments.length?(a=p?!0:Ir,d()):a!==Ir},f.interpolate=function(p){return arguments.length?(n=p,d()):n},f.unknown=function(p){return arguments.length?(s=p,f):s},function(p,m){return r=p,i=m,d()}}function eO(){return zA()(Ir,Ir)}function aue(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function I_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function lg(t){return t=I_(Math.abs(t)),t?t[1]:NaN}function oue(t,e){return function(n,r){for(var i=n.length,s=[],a=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}}function lue(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var cue=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Z0(t){if(!(e=cue.exec(t)))throw new Error("invalid format: "+t);var e;return new tO({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Z0.prototype=tO.prototype;function tO(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}tO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uue(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var b6;function due(t,e){var n=I_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(b6=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+I_(t,Math.max(0,e+s-1))[0]}function kD(t,e){var n=I_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const ND={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:aue,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>kD(t*100,e),r:kD,s:due,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ED(t){return t}var CD=Array.prototype.map,PD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hue(t){var e=t.grouping===void 0||t.thousands===void 0?ED:oue(CD.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?ED:lue(CD.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(f){f=Z0(f);var p=f.fill,m=f.align,y=f.sign,g=f.symbol,v=f.zero,b=f.width,x=f.comma,w=f.precision,S=f.trim,_=f.type;_==="n"?(x=!0,_="g"):ND[_]||(w===void 0&&(w=12),S=!0,_="g"),(v||p==="0"&&m==="=")&&(v=!0,p="0",m="=");var A=g==="$"?n:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",j=g==="$"?r:/[%p]/.test(_)?a:"",N=ND[_],P=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function O(M){var R=A,I=j,L,W,F;if(_==="c")I=N(M)+I,M="";else{M=+M;var z=M<0||1/M<0;if(M=isNaN(M)?l:N(Math.abs(M),w),S&&(M=uue(M)),z&&+M==0&&y!=="+"&&(z=!1),R=(z?y==="("?y:o:y==="-"||y==="("?"":y)+R,I=(_==="s"?PD[8+b6/3]:"")+I+(z&&y==="("?")":""),P){for(L=-1,W=M.length;++L<W;)if(F=M.charCodeAt(L),48>F||F>57){I=(F===46?i+M.slice(L+1):M.slice(L))+I,M=M.slice(0,L);break}}}x&&!v&&(M=e(M,1/0));var U=R.length+M.length+I.length,K=U<b?new Array(b-U+1).join(p):"";switch(x&&v&&(M=e(K+M,K.length?b-I.length:1/0),K=""),m){case"<":M=R+M+I+K;break;case"=":M=R+K+M+I;break;case"^":M=K.slice(0,U=K.length>>1)+R+M+I+K.slice(U);break;default:M=K+R+M+I;break}return s(M)}return O.toString=function(){return f+""},O}function d(f,p){var m=u((f=Z0(f),f.type="f",f)),y=Math.max(-8,Math.min(8,Math.floor(lg(p)/3)))*3,g=Math.pow(10,-y),v=PD[8+y/3];return function(b){return m(g*b)+v}}return{format:u,formatPrefix:d}}var kw,nO,w6;fue({thousands:",",grouping:[3],currency:["$",""]});function fue(t){return kw=hue(t),nO=kw.format,w6=kw.formatPrefix,kw}function pue(t){return Math.max(0,-lg(Math.abs(t)))}function mue(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lg(e)/3)))*3-lg(Math.abs(t)))}function gue(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,lg(e)-lg(t))+1}function _6(t,e,n,r){var i=WE(t,e,n),s;switch(r=Z0(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=mue(i,a))&&(r.precision=s),w6(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=gue(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=pue(i))&&(r.precision=s-(r.type==="%")*2);break}}return nO(r)}function Nu(t){var e=t.domain;return t.ticks=function(n){var r=e();return UE(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return _6(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,a=r[i],o=r[s],l,u,d=10;for(o<a&&(u=a,a=o,o=u,u=i,i=s,s=u);d-- >0;){if(u=zE(a,o,n),u===l)return r[i]=a,r[s]=o,e(r);if(u>0)a=Math.floor(a/u)*u,o=Math.ceil(o/u)*u;else if(u<0)a=Math.ceil(a*u)/u,o=Math.floor(o*u)/u;else break;l=u}return t},t}function D_(){var t=eO();return t.copy=function(){return Lb(t,D_())},Os.apply(t,arguments),Nu(t)}function S6(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,R_),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return S6(t).unknown(e)},t=arguments.length?Array.from(t,R_):[0,1],Nu(n)}function A6(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),t[n]=e.floor(i),t[r]=e.ceil(s),t}function TD(t){return Math.log(t)}function OD(t){return Math.exp(t)}function yue(t){return-Math.log(-t)}function vue(t){return-Math.exp(-t)}function xue(t){return isFinite(t)?+("1e"+t):t<0?0:t}function bue(t){return t===10?xue:t===Math.E?Math.exp:e=>Math.pow(t,e)}function wue(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function MD(t){return(e,n)=>-t(-e,n)}function rO(t){const e=t(TD,OD),n=e.domain;let r=10,i,s;function a(){return i=wue(r),s=bue(r),n()[0]<0?(i=MD(i),s=MD(s),t(yue,vue)):t(TD,OD),e}return e.base=function(o){return arguments.length?(r=+o,a()):r},e.domain=function(o){return arguments.length?(n(o),a()):n()},e.ticks=o=>{const l=n();let u=l[0],d=l[l.length-1];const f=d<u;f&&([u,d]=[d,u]);let p=i(u),m=i(d),y,g;const v=o==null?10:+o;let b=[];if(!(r%1)&&m-p<v){if(p=Math.floor(p),m=Math.ceil(m),u>0){for(;p<=m;++p)for(y=1;y<r;++y)if(g=p<0?y/s(-p):y*s(p),!(g<u)){if(g>d)break;b.push(g)}}else for(;p<=m;++p)for(y=r-1;y>=1;--y)if(g=p>0?y/s(-p):y*s(p),!(g<u)){if(g>d)break;b.push(g)}b.length*2<v&&(b=UE(u,d,v))}else b=UE(p,m,Math.min(m-p,v)).map(s);return f?b.reverse():b},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Z0(l)).precision==null&&(l.trim=!0),l=nO(l)),o===1/0)return l;const u=Math.max(1,r*o/e.ticks().length);return d=>{let f=d/s(Math.round(i(d)));return f*r<r-.5&&(f*=r),f<=u?l(d):""}},e.nice=()=>n(A6(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),e}function j6(){const t=rO(zA()).domain([1,10]);return t.copy=()=>Lb(t,j6()).base(t.base()),Os.apply(t,arguments),t}function RD(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function ID(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function iO(t){var e=1,n=t(RD(e),ID(e));return n.constant=function(r){return arguments.length?t(RD(e=+r),ID(e)):e},Nu(n)}function k6(){var t=iO(zA());return t.copy=function(){return Lb(t,k6()).constant(t.constant())},Os.apply(t,arguments)}function DD(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function _ue(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Sue(t){return t<0?-t*t:t*t}function sO(t){var e=t(Ir,Ir),n=1;function r(){return n===1?t(Ir,Ir):n===.5?t(_ue,Sue):t(DD(n),DD(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},Nu(e)}function aO(){var t=sO(zA());return t.copy=function(){return Lb(t,aO()).exponent(t.exponent())},Os.apply(t,arguments),t}function Aue(){return aO.apply(null,arguments).exponent(.5)}function $D(t){return Math.sign(t)*t*t}function jue(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function N6(){var t=eO(),e=[0,1],n=!1,r;function i(s){var a=jue(t(s));return isNaN(a)?r:n?Math.round(a):a}return i.invert=function(s){return t.invert($D(s))},i.domain=function(s){return arguments.length?(t.domain(s),i):t.domain()},i.range=function(s){return arguments.length?(t.range((e=Array.from(s,R_)).map($D)),i):e.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(n=!!s,i):n},i.clamp=function(s){return arguments.length?(t.clamp(s),i):t.clamp()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return N6(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},Os.apply(i,arguments),Nu(i)}function E6(){var t=[],e=[],n=[],r;function i(){var a=0,o=Math.max(1,e.length);for(n=new Array(o-1);++a<o;)n[a-1]=Pce(t,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:e[Db(n,a)]}return s.invertExtent=function(a){var o=e.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:t[0],o<n.length?n[o]:t[t.length-1]]},s.domain=function(a){if(!arguments.length)return t.slice();t=[];for(let o of a)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(hu),i()},s.range=function(a){return arguments.length?(e=Array.from(a),i()):e.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return E6().domain(t).range(e).unknown(r)},Os.apply(s,arguments)}function C6(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[Db(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return a}return a.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var u=i.indexOf(l);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return C6().domain([t,e]).range(i).unknown(s)},Os.apply(Nu(a),arguments)}function P6(){var t=[.5],e=[0,1],n,r=1;function i(s){return s!=null&&s<=s?e[Db(t,s,0,r)]:n}return i.domain=function(s){return arguments.length?(t=Array.from(s),r=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),r=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var a=e.indexOf(s);return[t[a-1],t[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return P6().domain(t).range(e).unknown(n)},Os.apply(i,arguments)}const _k=new Date,Sk=new Date;function Pn(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(e(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let u;do l.push(u=new Date(+s)),e(s,o),t(s);while(u<s&&s<a);return l},i.filter=s=>Pn(a=>{if(a>=a)for(;t(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;e(a,-1),!s(a););else for(;--o>=0;)for(;e(a,1),!s(a););}),n&&(i.count=(s,a)=>(_k.setTime(+s),Sk.setTime(+a),t(_k),t(Sk),Math.floor(n(_k,Sk))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const $_=Pn(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);$_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Pn(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):$_);$_.range;const ll=1e3,bs=ll*60,cl=bs*60,_l=cl*24,oO=_l*7,LD=_l*30,Ak=_l*365,ad=Pn(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*ll)},(t,e)=>(e-t)/ll,t=>t.getUTCSeconds());ad.range;const lO=Pn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ll)},(t,e)=>{t.setTime(+t+e*bs)},(t,e)=>(e-t)/bs,t=>t.getMinutes());lO.range;const cO=Pn(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*bs)},(t,e)=>(e-t)/bs,t=>t.getUTCMinutes());cO.range;const uO=Pn(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*ll-t.getMinutes()*bs)},(t,e)=>{t.setTime(+t+e*cl)},(t,e)=>(e-t)/cl,t=>t.getHours());uO.range;const dO=Pn(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*cl)},(t,e)=>(e-t)/cl,t=>t.getUTCHours());dO.range;const Fb=Pn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*bs)/_l,t=>t.getDate()-1);Fb.range;const WA=Pn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_l,t=>t.getUTCDate()-1);WA.range;const T6=Pn(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/_l,t=>Math.floor(t/_l));T6.range;function nf(t){return Pn(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*bs)/oO)}const HA=nf(0),L_=nf(1),kue=nf(2),Nue=nf(3),cg=nf(4),Eue=nf(5),Cue=nf(6);HA.range;L_.range;kue.range;Nue.range;cg.range;Eue.range;Cue.range;function rf(t){return Pn(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/oO)}const qA=rf(0),F_=rf(1),Pue=rf(2),Tue=rf(3),ug=rf(4),Oue=rf(5),Mue=rf(6);qA.range;F_.range;Pue.range;Tue.range;ug.range;Oue.range;Mue.range;const hO=Pn(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());hO.range;const fO=Pn(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());fO.range;const Sl=Pn(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Sl.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Pn(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Sl.range;const Al=Pn(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Al.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Pn(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Al.range;function O6(t,e,n,r,i,s){const a=[[ad,1,ll],[ad,5,5*ll],[ad,15,15*ll],[ad,30,30*ll],[s,1,bs],[s,5,5*bs],[s,15,15*bs],[s,30,30*bs],[i,1,cl],[i,3,3*cl],[i,6,6*cl],[i,12,12*cl],[r,1,_l],[r,2,2*_l],[n,1,oO],[e,1,LD],[e,3,3*LD],[t,1,Ak]];function o(u,d,f){const p=d<u;p&&([u,d]=[d,u]);const m=f&&typeof f.range=="function"?f:l(u,d,f),y=m?m.range(u,+d+1):[];return p?y.reverse():y}function l(u,d,f){const p=Math.abs(d-u)/f,m=YT(([,,v])=>v).right(a,p);if(m===a.length)return t.every(WE(u/Ak,d/Ak,f));if(m===0)return $_.every(Math.max(WE(u,d,f),1));const[y,g]=a[p/a[m-1][2]<a[m][2]/p?m-1:m];return y.every(g)}return[o,l]}const[Rue,Iue]=O6(Al,fO,qA,T6,dO,cO),[Due,$ue]=O6(Sl,hO,HA,Fb,uO,lO);function jk(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function kk(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function hy(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Lue(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,a=t.shortDays,o=t.months,l=t.shortMonths,u=fy(i),d=py(i),f=fy(s),p=py(s),m=fy(a),y=py(a),g=fy(o),v=py(o),b=fy(l),x=py(l),w={a:z,A:U,b:K,B:H,c:null,d:HD,e:HD,f:ode,g:yde,G:xde,H:ide,I:sde,j:ade,L:M6,m:lde,M:cde,p:Q,q:B,Q:KD,s:VD,S:ude,u:dde,U:hde,V:fde,w:pde,W:mde,x:null,X:null,y:gde,Y:vde,Z:bde,"%":GD},S={a:Y,A:ne,b:V,B:te,c:null,d:qD,e:qD,f:Ade,g:Rde,G:Dde,H:wde,I:_de,j:Sde,L:I6,m:jde,M:kde,p:$,q,Q:KD,s:VD,S:Nde,u:Ede,U:Cde,V:Pde,w:Tde,W:Ode,x:null,X:null,y:Mde,Y:Ide,Z:$de,"%":GD},_={a:O,A:M,b:R,B:I,c:L,d:zD,e:zD,f:ede,g:UD,G:BD,H:WD,I:WD,j:Xue,L:Zue,m:Yue,M:Que,p:P,q:Vue,Q:nde,s:rde,S:Jue,u:Wue,U:Hue,V:que,w:zue,W:Gue,x:W,X:F,y:UD,Y:BD,Z:Kue,"%":tde};w.x=A(n,w),w.X=A(r,w),w.c=A(e,w),S.x=A(n,S),S.X=A(r,S),S.c=A(e,S);function A(G,re){return function(Z){var J=[],X=-1,se=0,ce=G.length,ue,je,Be;for(Z instanceof Date||(Z=new Date(+Z));++X<ce;)G.charCodeAt(X)===37&&(J.push(G.slice(se,X)),(je=FD[ue=G.charAt(++X)])!=null?ue=G.charAt(++X):je=ue==="e"?" ":"0",(Be=re[ue])&&(ue=Be(Z,je)),J.push(ue),se=X+1);return J.push(G.slice(se,X)),J.join("")}}function j(G,re){return function(Z){var J=hy(1900,void 0,1),X=N(J,G,Z+="",0),se,ce;if(X!=Z.length)return null;if("Q"in J)return new Date(J.Q);if("s"in J)return new Date(J.s*1e3+("L"in J?J.L:0));if(re&&!("Z"in J)&&(J.Z=0),"p"in J&&(J.H=J.H%12+J.p*12),J.m===void 0&&(J.m="q"in J?J.q:0),"V"in J){if(J.V<1||J.V>53)return null;"w"in J||(J.w=1),"Z"in J?(se=kk(hy(J.y,0,1)),ce=se.getUTCDay(),se=ce>4||ce===0?F_.ceil(se):F_(se),se=WA.offset(se,(J.V-1)*7),J.y=se.getUTCFullYear(),J.m=se.getUTCMonth(),J.d=se.getUTCDate()+(J.w+6)%7):(se=jk(hy(J.y,0,1)),ce=se.getDay(),se=ce>4||ce===0?L_.ceil(se):L_(se),se=Fb.offset(se,(J.V-1)*7),J.y=se.getFullYear(),J.m=se.getMonth(),J.d=se.getDate()+(J.w+6)%7)}else("W"in J||"U"in J)&&("w"in J||(J.w="u"in J?J.u%7:"W"in J?1:0),ce="Z"in J?kk(hy(J.y,0,1)).getUTCDay():jk(hy(J.y,0,1)).getDay(),J.m=0,J.d="W"in J?(J.w+6)%7+J.W*7-(ce+5)%7:J.w+J.U*7-(ce+6)%7);return"Z"in J?(J.H+=J.Z/100|0,J.M+=J.Z%100,kk(J)):jk(J)}}function N(G,re,Z,J){for(var X=0,se=re.length,ce=Z.length,ue,je;X<se;){if(J>=ce)return-1;if(ue=re.charCodeAt(X++),ue===37){if(ue=re.charAt(X++),je=_[ue in FD?re.charAt(X++):ue],!je||(J=je(G,Z,J))<0)return-1}else if(ue!=Z.charCodeAt(J++))return-1}return J}function P(G,re,Z){var J=u.exec(re.slice(Z));return J?(G.p=d.get(J[0].toLowerCase()),Z+J[0].length):-1}function O(G,re,Z){var J=m.exec(re.slice(Z));return J?(G.w=y.get(J[0].toLowerCase()),Z+J[0].length):-1}function M(G,re,Z){var J=f.exec(re.slice(Z));return J?(G.w=p.get(J[0].toLowerCase()),Z+J[0].length):-1}function R(G,re,Z){var J=b.exec(re.slice(Z));return J?(G.m=x.get(J[0].toLowerCase()),Z+J[0].length):-1}function I(G,re,Z){var J=g.exec(re.slice(Z));return J?(G.m=v.get(J[0].toLowerCase()),Z+J[0].length):-1}function L(G,re,Z){return N(G,e,re,Z)}function W(G,re,Z){return N(G,n,re,Z)}function F(G,re,Z){return N(G,r,re,Z)}function z(G){return a[G.getDay()]}function U(G){return s[G.getDay()]}function K(G){return l[G.getMonth()]}function H(G){return o[G.getMonth()]}function Q(G){return i[+(G.getHours()>=12)]}function B(G){return 1+~~(G.getMonth()/3)}function Y(G){return a[G.getUTCDay()]}function ne(G){return s[G.getUTCDay()]}function V(G){return l[G.getUTCMonth()]}function te(G){return o[G.getUTCMonth()]}function $(G){return i[+(G.getUTCHours()>=12)]}function q(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var re=A(G+="",w);return re.toString=function(){return G},re},parse:function(G){var re=j(G+="",!1);return re.toString=function(){return G},re},utcFormat:function(G){var re=A(G+="",S);return re.toString=function(){return G},re},utcParse:function(G){var re=j(G+="",!0);return re.toString=function(){return G},re}}}var FD={"-":"",_:" ",0:"0"},Wn=/^\s*\d+/,Fue=/^%/,Bue=/[\\^$*+?|[\]().{}]/g;function Ve(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function Uue(t){return t.replace(Bue,"\\$&")}function fy(t){return new RegExp("^(?:"+t.map(Uue).join("|")+")","i")}function py(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function zue(t,e,n){var r=Wn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Wue(t,e,n){var r=Wn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Hue(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function que(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Gue(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function BD(t,e,n){var r=Wn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function UD(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Kue(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Vue(t,e,n){var r=Wn.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Yue(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function zD(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Xue(t,e,n){var r=Wn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function WD(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Que(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Jue(t,e,n){var r=Wn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Zue(t,e,n){var r=Wn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ede(t,e,n){var r=Wn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function tde(t,e,n){var r=Fue.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function nde(t,e,n){var r=Wn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function rde(t,e,n){var r=Wn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function HD(t,e){return Ve(t.getDate(),e,2)}function ide(t,e){return Ve(t.getHours(),e,2)}function sde(t,e){return Ve(t.getHours()%12||12,e,2)}function ade(t,e){return Ve(1+Fb.count(Sl(t),t),e,3)}function M6(t,e){return Ve(t.getMilliseconds(),e,3)}function ode(t,e){return M6(t,e)+"000"}function lde(t,e){return Ve(t.getMonth()+1,e,2)}function cde(t,e){return Ve(t.getMinutes(),e,2)}function ude(t,e){return Ve(t.getSeconds(),e,2)}function dde(t){var e=t.getDay();return e===0?7:e}function hde(t,e){return Ve(HA.count(Sl(t)-1,t),e,2)}function R6(t){var e=t.getDay();return e>=4||e===0?cg(t):cg.ceil(t)}function fde(t,e){return t=R6(t),Ve(cg.count(Sl(t),t)+(Sl(t).getDay()===4),e,2)}function pde(t){return t.getDay()}function mde(t,e){return Ve(L_.count(Sl(t)-1,t),e,2)}function gde(t,e){return Ve(t.getFullYear()%100,e,2)}function yde(t,e){return t=R6(t),Ve(t.getFullYear()%100,e,2)}function vde(t,e){return Ve(t.getFullYear()%1e4,e,4)}function xde(t,e){var n=t.getDay();return t=n>=4||n===0?cg(t):cg.ceil(t),Ve(t.getFullYear()%1e4,e,4)}function bde(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ve(e/60|0,"0",2)+Ve(e%60,"0",2)}function qD(t,e){return Ve(t.getUTCDate(),e,2)}function wde(t,e){return Ve(t.getUTCHours(),e,2)}function _de(t,e){return Ve(t.getUTCHours()%12||12,e,2)}function Sde(t,e){return Ve(1+WA.count(Al(t),t),e,3)}function I6(t,e){return Ve(t.getUTCMilliseconds(),e,3)}function Ade(t,e){return I6(t,e)+"000"}function jde(t,e){return Ve(t.getUTCMonth()+1,e,2)}function kde(t,e){return Ve(t.getUTCMinutes(),e,2)}function Nde(t,e){return Ve(t.getUTCSeconds(),e,2)}function Ede(t){var e=t.getUTCDay();return e===0?7:e}function Cde(t,e){return Ve(qA.count(Al(t)-1,t),e,2)}function D6(t){var e=t.getUTCDay();return e>=4||e===0?ug(t):ug.ceil(t)}function Pde(t,e){return t=D6(t),Ve(ug.count(Al(t),t)+(Al(t).getUTCDay()===4),e,2)}function Tde(t){return t.getUTCDay()}function Ode(t,e){return Ve(F_.count(Al(t)-1,t),e,2)}function Mde(t,e){return Ve(t.getUTCFullYear()%100,e,2)}function Rde(t,e){return t=D6(t),Ve(t.getUTCFullYear()%100,e,2)}function Ide(t,e){return Ve(t.getUTCFullYear()%1e4,e,4)}function Dde(t,e){var n=t.getUTCDay();return t=n>=4||n===0?ug(t):ug.ceil(t),Ve(t.getUTCFullYear()%1e4,e,4)}function $de(){return"+0000"}function GD(){return"%"}function KD(t){return+t}function VD(t){return Math.floor(+t/1e3)}var gf,$6,L6;Lde({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Lde(t){return gf=Lue(t),$6=gf.format,gf.parse,L6=gf.utcFormat,gf.utcParse,gf}function Fde(t){return new Date(t)}function Bde(t){return t instanceof Date?+t:+new Date(+t)}function pO(t,e,n,r,i,s,a,o,l,u){var d=eO(),f=d.invert,p=d.domain,m=u(".%L"),y=u(":%S"),g=u("%I:%M"),v=u("%I %p"),b=u("%a %d"),x=u("%b %d"),w=u("%B"),S=u("%Y");function _(A){return(l(A)<A?m:o(A)<A?y:a(A)<A?g:s(A)<A?v:r(A)<A?i(A)<A?b:x:n(A)<A?w:S)(A)}return d.invert=function(A){return new Date(f(A))},d.domain=function(A){return arguments.length?p(Array.from(A,Bde)):p().map(Fde)},d.ticks=function(A){var j=p();return t(j[0],j[j.length-1],A??10)},d.tickFormat=function(A,j){return j==null?_:u(j)},d.nice=function(A){var j=p();return(!A||typeof A.range!="function")&&(A=e(j[0],j[j.length-1],A??10)),A?p(A6(j,A)):d},d.copy=function(){return Lb(d,pO(t,e,n,r,i,s,a,o,l,u))},d}function Ude(){return Os.apply(pO(Due,$ue,Sl,hO,HA,Fb,uO,lO,ad,$6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function zde(){return Os.apply(pO(Rue,Iue,Al,fO,qA,WA,dO,cO,ad,L6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function GA(){var t=0,e=1,n,r,i,s,a=Ir,o=!1,l;function u(f){return f==null||isNaN(f=+f)?l:a(i===0?.5:(f=(s(f)-n)*i,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,n=s(t=+t),r=s(e=+e),i=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(a=f,u):a};function d(f){return function(p){var m,y;return arguments.length?([m,y]=p,a=f(m,y),u):[a(0),a(1)]}}return u.range=d(Vg),u.rangeRound=d(ZT),u.unknown=function(f){return arguments.length?(l=f,u):l},function(f){return s=f,n=f(t),r=f(e),i=n===r?0:1/(r-n),u}}function Eu(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function F6(){var t=Nu(GA()(Ir));return t.copy=function(){return Eu(t,F6())},Tl.apply(t,arguments)}function B6(){var t=rO(GA()).domain([1,10]);return t.copy=function(){return Eu(t,B6()).base(t.base())},Tl.apply(t,arguments)}function U6(){var t=iO(GA());return t.copy=function(){return Eu(t,U6()).constant(t.constant())},Tl.apply(t,arguments)}function mO(){var t=sO(GA());return t.copy=function(){return Eu(t,mO()).exponent(t.exponent())},Tl.apply(t,arguments)}function Wde(){return mO.apply(null,arguments).exponent(.5)}function z6(){var t=[],e=Ir;function n(r){if(r!=null&&!isNaN(r=+r))return e((Db(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let i of r)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(hu),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,i)=>e(i/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(i,s)=>Cce(t,s/r))},n.copy=function(){return z6(e).domain(t)},Tl.apply(n,arguments)}function KA(){var t=0,e=.5,n=1,r=1,i,s,a,o,l,u=Ir,d,f=!1,p;function m(g){return isNaN(g=+g)?p:(g=.5+((g=+d(g))-s)*(r*g<r*s?o:l),u(f?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([t,e,n]=g,i=d(t=+t),s=d(e=+e),a=d(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,m):[t,e,n]},m.clamp=function(g){return arguments.length?(f=!!g,m):f},m.interpolator=function(g){return arguments.length?(u=g,m):u};function y(g){return function(v){var b,x,w;return arguments.length?([b,x,w]=v,u=tue(g,[b,x,w]),m):[u(0),u(.5),u(1)]}}return m.range=y(Vg),m.rangeRound=y(ZT),m.unknown=function(g){return arguments.length?(p=g,m):p},function(g){return d=g,i=g(t),s=g(e),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,m}}function W6(){var t=Nu(KA()(Ir));return t.copy=function(){return Eu(t,W6())},Tl.apply(t,arguments)}function H6(){var t=rO(KA()).domain([.1,1,10]);return t.copy=function(){return Eu(t,H6()).base(t.base())},Tl.apply(t,arguments)}function q6(){var t=iO(KA());return t.copy=function(){return Eu(t,q6()).constant(t.constant())},Tl.apply(t,arguments)}function gO(){var t=sO(KA());return t.copy=function(){return Eu(t,gO()).exponent(t.exponent())},Tl.apply(t,arguments)}function Hde(){return gO.apply(null,arguments).exponent(.5)}const YD=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Y0,scaleDiverging:W6,scaleDivergingLog:H6,scaleDivergingPow:gO,scaleDivergingSqrt:Hde,scaleDivergingSymlog:q6,scaleIdentity:S6,scaleImplicit:HE,scaleLinear:D_,scaleLog:j6,scaleOrdinal:XT,scalePoint:p0,scalePow:aO,scaleQuantile:E6,scaleQuantize:C6,scaleRadial:N6,scaleSequential:F6,scaleSequentialLog:B6,scaleSequentialPow:mO,scaleSequentialQuantile:z6,scaleSequentialSqrt:Wde,scaleSequentialSymlog:U6,scaleSqrt:Aue,scaleSymlog:k6,scaleThreshold:P6,scaleTime:Ude,scaleUtc:zde,tickFormat:_6},Symbol.toStringTag,{value:"Module"}));var qde=Lg;function Gde(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(a!=null&&(o===void 0?a===a&&!qde(a):n(a,o)))var o=a,l=s}return l}var VA=Gde;function Kde(t,e){return t>e}var G6=Kde,Vde=VA,Yde=G6,Xde=Gg;function Qde(t){return t&&t.length?Vde(t,Xde,Yde):void 0}var Jde=Qde;const eu=at(Jde);function Zde(t,e){return t<e}var K6=Zde,ehe=VA,the=K6,nhe=Gg;function rhe(t){return t&&t.length?ehe(t,nhe,the):void 0}var ihe=rhe;const YA=at(ihe);var she=TT,ahe=oo,ohe=t6,lhe=hi;function che(t,e){var n=lhe(t)?she:ohe;return n(t,ahe(e))}var uhe=che,dhe=Z5,hhe=uhe;function fhe(t,e){return dhe(hhe(t,e),1)}var phe=fhe;const mhe=at(phe);var ghe=qT;function yhe(t,e){return ghe(t,e)}var vhe=yhe;const yu=at(vhe);var Yg=1e9,xhe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vO,Ft=!0,Ns="[DecimalError] ",Dh=Ns+"Invalid argument: ",yO=Ns+"Exponent out of range: ",Xg=Math.floor,Uu=Math.pow,bhe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ui,Fn=1e7,Ot=7,V6=9007199254740991,B_=Xg(V6/Ot),ye={};ye.absoluteValue=ye.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};ye.comparedTo=ye.cmp=function(t){var e,n,r,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};ye.decimalPlaces=ye.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Ot;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};ye.dividedBy=ye.div=function(t){return fl(this,new this.constructor(t))};ye.dividedToIntegerBy=ye.idiv=function(t){var e=this,n=e.constructor;return xt(fl(e,new n(t),0,1),n.precision)};ye.equals=ye.eq=function(t){return!this.cmp(t)};ye.exponent=function(){return gn(this)};ye.greaterThan=ye.gt=function(t){return this.cmp(t)>0};ye.greaterThanOrEqualTo=ye.gte=function(t){return this.cmp(t)>=0};ye.isInteger=ye.isint=function(){return this.e>this.d.length-2};ye.isNegative=ye.isneg=function(){return this.s<0};ye.isPositive=ye.ispos=function(){return this.s>0};ye.isZero=function(){return this.s===0};ye.lessThan=ye.lt=function(t){return this.cmp(t)<0};ye.lessThanOrEqualTo=ye.lte=function(t){return this.cmp(t)<1};ye.logarithm=ye.log=function(t){var e,n=this,r=n.constructor,i=r.precision,s=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(Ui))throw Error(Ns+"NaN");if(n.s<1)throw Error(Ns+(n.s?"NaN":"-Infinity"));return n.eq(Ui)?new r(0):(Ft=!1,e=fl(ev(n,s),ev(t,s),s),Ft=!0,xt(e,i))};ye.minus=ye.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Q6(e,t):Y6(e,(t.s=-t.s,t))};ye.modulo=ye.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(Ns+"NaN");return n.s?(Ft=!1,e=fl(n,t,0,1).times(t),Ft=!0,n.minus(e)):xt(new r(n),i)};ye.naturalExponential=ye.exp=function(){return X6(this)};ye.naturalLogarithm=ye.ln=function(){return ev(this)};ye.negated=ye.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};ye.plus=ye.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Y6(e,t):Q6(e,(t.s=-t.s,t))};ye.precision=ye.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Dh+t);if(e=gn(i)+1,r=i.d.length-1,n=r*Ot+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};ye.squareRoot=ye.sqrt=function(){var t,e,n,r,i,s,a,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Ns+"NaN")}for(t=gn(o),Ft=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=Ya(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Xg((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(i.toString()),n=l.precision,i=a=n+3;;)if(s=r,r=s.plus(fl(o,s,a+2)).times(.5),Ya(s.d).slice(0,a)===(e=Ya(r.d)).slice(0,a)){if(e=e.slice(a-3,a+1),i==a&&e=="4999"){if(xt(s,n+1,0),s.times(s).eq(o)){r=s;break}}else if(e!="9999")break;a+=4}return Ft=!0,xt(r,n)};ye.times=ye.mul=function(t){var e,n,r,i,s,a,o,l,u,d=this,f=d.constructor,p=d.d,m=(t=new f(t)).d;if(!d.s||!t.s)return new f(0);for(t.s*=d.s,n=d.e+t.e,l=p.length,u=m.length,l<u&&(s=p,p=m,m=s,a=l,l=u,u=a),s=[],a=l+u,r=a;r--;)s.push(0);for(r=u;--r>=0;){for(e=0,i=l+r;i>r;)o=s[i]+m[r]*p[i-r-1]+e,s[i--]=o%Fn|0,e=o/Fn|0;s[i]=(s[i]+e)%Fn|0}for(;!s[--a];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,Ft?xt(t,f.precision):t};ye.toDecimalPlaces=ye.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(to(t,0,Yg),e===void 0?e=r.rounding:to(e,0,8),xt(n,t+gn(n)+1,e))};ye.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Gh(r,!0):(to(t,0,Yg),e===void 0?e=i.rounding:to(e,0,8),r=xt(new i(r),t+1,e),n=Gh(r,!0,t+1)),n};ye.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?Gh(i):(to(t,0,Yg),e===void 0?e=s.rounding:to(e,0,8),r=xt(new s(i),t+gn(i)+1,e),n=Gh(r.abs(),!1,t+gn(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};ye.toInteger=ye.toint=function(){var t=this,e=t.constructor;return xt(new e(t),gn(t)+1,e.rounding)};ye.toNumber=function(){return+this};ye.toPower=ye.pow=function(t){var e,n,r,i,s,a,o=this,l=o.constructor,u=12,d=+(t=new l(t));if(!t.s)return new l(Ui);if(o=new l(o),!o.s){if(t.s<1)throw Error(Ns+"Infinity");return o}if(o.eq(Ui))return o;if(r=l.precision,t.eq(Ui))return xt(o,r);if(e=t.e,n=t.d.length-1,a=e>=n,s=o.s,a){if((n=d<0?-d:d)<=V6){for(i=new l(Ui),e=Math.ceil(r/Ot+4),Ft=!1;n%2&&(i=i.times(o),QD(i.d,e)),n=Xg(n/2),n!==0;)o=o.times(o),QD(o.d,e);return Ft=!0,t.s<0?new l(Ui).div(i):xt(i,r)}}else if(s<0)throw Error(Ns+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,o.s=1,Ft=!1,i=t.times(ev(o,r+u)),Ft=!0,i=X6(i),i.s=s,i};ye.toPrecision=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?(n=gn(i),r=Gh(i,n<=s.toExpNeg||n>=s.toExpPos)):(to(t,1,Yg),e===void 0?e=s.rounding:to(e,0,8),i=xt(new s(i),t,e),n=gn(i),r=Gh(i,t<=n||n<=s.toExpNeg,t)),r};ye.toSignificantDigits=ye.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(to(t,1,Yg),e===void 0?e=r.rounding:to(e,0,8)),xt(new r(n),t,e)};ye.toString=ye.valueOf=ye.val=ye.toJSON=ye[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=gn(t),n=t.constructor;return Gh(t,e<=n.toExpNeg||e>=n.toExpPos)};function Y6(t,e){var n,r,i,s,a,o,l,u,d=t.constructor,f=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Ft?xt(e,f):e;if(l=t.d,u=e.d,a=t.e,i=e.e,l=l.slice(),s=a-i,s){for(s<0?(r=l,s=-s,o=u.length):(r=u,i=a,o=l.length),a=Math.ceil(f/Ot),o=a>o?a+1:o+1,s>o&&(s=o,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(o=l.length,s=u.length,o-s<0&&(s=o,r=u,u=l,l=r),n=0;s;)n=(l[--s]=l[s]+u[s]+n)/Fn|0,l[s]%=Fn;for(n&&(l.unshift(n),++i),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=i,Ft?xt(e,f):e}function to(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Dh+t)}function Ya(t){var e,n,r,i=t.length-1,s="",a=t[0];if(i>0){for(s+=a,e=1;e<i;e++)r=t[e]+"",n=Ot-r.length,n&&(s+=Gl(n)),s+=r;a=t[e],r=a+"",n=Ot-r.length,n&&(s+=Gl(n))}else if(a===0)return"0";for(;a%10===0;)a/=10;return s+a}var fl=function(){function t(r,i){var s,a=0,o=r.length;for(r=r.slice();o--;)s=r[o]*i+a,r[o]=s%Fn|0,a=s/Fn|0;return a&&r.unshift(a),r}function e(r,i,s,a){var o,l;if(s!=a)l=s>a?1:-1;else for(o=l=0;o<s;o++)if(r[o]!=i[o]){l=r[o]>i[o]?1:-1;break}return l}function n(r,i,s){for(var a=0;s--;)r[s]-=a,a=r[s]<i[s]?1:0,r[s]=a*Fn+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,a){var o,l,u,d,f,p,m,y,g,v,b,x,w,S,_,A,j,N,P=r.constructor,O=r.s==i.s?1:-1,M=r.d,R=i.d;if(!r.s)return new P(r);if(!i.s)throw Error(Ns+"Division by zero");for(l=r.e-i.e,j=R.length,_=M.length,m=new P(O),y=m.d=[],u=0;R[u]==(M[u]||0);)++u;if(R[u]>(M[u]||0)&&--l,s==null?x=s=P.precision:a?x=s+(gn(r)-gn(i))+1:x=s,x<0)return new P(0);if(x=x/Ot+2|0,u=0,j==1)for(d=0,R=R[0],x++;(u<_||d)&&x--;u++)w=d*Fn+(M[u]||0),y[u]=w/R|0,d=w%R|0;else{for(d=Fn/(R[0]+1)|0,d>1&&(R=t(R,d),M=t(M,d),j=R.length,_=M.length),S=j,g=M.slice(0,j),v=g.length;v<j;)g[v++]=0;N=R.slice(),N.unshift(0),A=R[0],R[1]>=Fn/2&&++A;do d=0,o=e(R,g,j,v),o<0?(b=g[0],j!=v&&(b=b*Fn+(g[1]||0)),d=b/A|0,d>1?(d>=Fn&&(d=Fn-1),f=t(R,d),p=f.length,v=g.length,o=e(f,g,p,v),o==1&&(d--,n(f,j<p?N:R,p))):(d==0&&(o=d=1),f=R.slice()),p=f.length,p<v&&f.unshift(0),n(g,f,v),o==-1&&(v=g.length,o=e(R,g,j,v),o<1&&(d++,n(g,j<v?N:R,v))),v=g.length):o===0&&(d++,g=[0]),y[u++]=d,o&&g[0]?g[v++]=M[S]||0:(g=[M[S]],v=1);while((S++<_||g[0]!==void 0)&&x--)}return y[0]||y.shift(),m.e=l,xt(m,a?s+gn(m)+1:s)}}();function X6(t,e){var n,r,i,s,a,o,l=0,u=0,d=t.constructor,f=d.precision;if(gn(t)>16)throw Error(yO+gn(t));if(!t.s)return new d(Ui);for(Ft=!1,o=f,a=new d(.03125);t.abs().gte(.1);)t=t.times(a),u+=5;for(r=Math.log(Uu(2,u))/Math.LN10*2+5|0,o+=r,n=i=s=new d(Ui),d.precision=o;;){if(i=xt(i.times(t),o),n=n.times(++l),a=s.plus(fl(i,n,o)),Ya(a.d).slice(0,o)===Ya(s.d).slice(0,o)){for(;u--;)s=xt(s.times(s),o);return d.precision=f,e==null?(Ft=!0,xt(s,f)):s}s=a}}function gn(t){for(var e=t.e*Ot,n=t.d[0];n>=10;n/=10)e++;return e}function Nk(t,e,n){if(e>t.LN10.sd())throw Ft=!0,n&&(t.precision=n),Error(Ns+"LN10 precision limit exceeded");return xt(new t(t.LN10),e)}function Gl(t){for(var e="";t--;)e+="0";return e}function ev(t,e){var n,r,i,s,a,o,l,u,d,f=1,p=10,m=t,y=m.d,g=m.constructor,v=g.precision;if(m.s<1)throw Error(Ns+(m.s?"NaN":"-Infinity"));if(m.eq(Ui))return new g(0);if(e==null?(Ft=!1,u=v):u=e,m.eq(10))return e==null&&(Ft=!0),Nk(g,u);if(u+=p,g.precision=u,n=Ya(y),r=n.charAt(0),s=gn(m),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(t),n=Ya(m.d),r=n.charAt(0),f++;s=gn(m),r>1?(m=new g("0."+n),s++):m=new g(r+"."+n.slice(1))}else return l=Nk(g,u+2,v).times(s+""),m=ev(new g(r+"."+n.slice(1)),u-p).plus(l),g.precision=v,e==null?(Ft=!0,xt(m,v)):m;for(o=a=m=fl(m.minus(Ui),m.plus(Ui),u),d=xt(m.times(m),u),i=3;;){if(a=xt(a.times(d),u),l=o.plus(fl(a,new g(i),u)),Ya(l.d).slice(0,u)===Ya(o.d).slice(0,u))return o=o.times(2),s!==0&&(o=o.plus(Nk(g,u+2,v).times(s+""))),o=fl(o,new g(f),u),g.precision=v,e==null?(Ft=!0,xt(o,v)):o;o=l,i+=2}}function XD(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=Xg(n/Ot),t.d=[],r=(n+1)%Ot,n<0&&(r+=Ot),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Ot;r<i;)t.d.push(+e.slice(r,r+=Ot));e=e.slice(r),r=Ot-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),Ft&&(t.e>B_||t.e<-B_))throw Error(yO+n)}else t.s=0,t.e=0,t.d=[0];return t}function xt(t,e,n){var r,i,s,a,o,l,u,d,f=t.d;for(a=1,s=f[0];s>=10;s/=10)a++;if(r=e-a,r<0)r+=Ot,i=e,u=f[d=0];else{if(d=Math.ceil((r+1)/Ot),s=f.length,d>=s)return t;for(u=s=f[d],a=1;s>=10;s/=10)a++;r%=Ot,i=r-Ot+a}if(n!==void 0&&(s=Uu(10,a-i-1),o=u/s%10|0,l=e<0||f[d+1]!==void 0||u%s,l=n<4?(o||l)&&(n==0||n==(t.s<0?3:2)):o>5||o==5&&(n==4||l||n==6&&(r>0?i>0?u/Uu(10,a-i):0:f[d-1])%10&1||n==(t.s<0?8:7))),e<1||!f[0])return l?(s=gn(t),f.length=1,e=e-s-1,f[0]=Uu(10,(Ot-e%Ot)%Ot),t.e=Xg(-e/Ot)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(r==0?(f.length=d,s=1,d--):(f.length=d+1,s=Uu(10,Ot-r),f[d]=i>0?(u/Uu(10,a-i)%Uu(10,i)|0)*s:0),l)for(;;)if(d==0){(f[0]+=s)==Fn&&(f[0]=1,++t.e);break}else{if(f[d]+=s,f[d]!=Fn)break;f[d--]=0,s=1}for(r=f.length;f[--r]===0;)f.pop();if(Ft&&(t.e>B_||t.e<-B_))throw Error(yO+gn(t));return t}function Q6(t,e){var n,r,i,s,a,o,l,u,d,f,p=t.constructor,m=p.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new p(t),Ft?xt(e,m):e;if(l=t.d,f=e.d,r=e.e,u=t.e,l=l.slice(),a=u-r,a){for(d=a<0,d?(n=l,a=-a,o=f.length):(n=f,r=u,o=l.length),i=Math.max(Math.ceil(m/Ot),o)+2,a>i&&(a=i,n.length=1),n.reverse(),i=a;i--;)n.push(0);n.reverse()}else{for(i=l.length,o=f.length,d=i<o,d&&(o=i),i=0;i<o;i++)if(l[i]!=f[i]){d=l[i]<f[i];break}a=0}for(d&&(n=l,l=f,f=n,e.s=-e.s),o=l.length,i=f.length-o;i>0;--i)l[o++]=0;for(i=f.length;i>a;){if(l[--i]<f[i]){for(s=i;s&&l[--s]===0;)l[s]=Fn-1;--l[s],l[i]+=Fn}l[i]-=f[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,Ft?xt(e,m):e):new p(0)}function Gh(t,e,n){var r,i=gn(t),s=Ya(t.d),a=s.length;return e?(n&&(r=n-a)>0?s=s.charAt(0)+"."+s.slice(1)+Gl(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Gl(-i-1)+s,n&&(r=n-a)>0&&(s+=Gl(r))):i>=a?(s+=Gl(i+1-a),n&&(r=n-i-1)>0&&(s=s+"."+Gl(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(s+="."),s+=Gl(r))),t.s<0?"-"+s:s}function QD(t,e){if(t.length>e)return t.length=e,!0}function J6(t){var e,n,r;function i(s){var a=this;if(!(a instanceof i))return new i(s);if(a.constructor=i,s instanceof i){a.s=s.s,a.e=s.e,a.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Dh+s);if(s>0)a.s=1;else if(s<0)s=-s,a.s=-1;else{a.s=0,a.e=0,a.d=[0];return}if(s===~~s&&s<1e7){a.e=0,a.d=[s];return}return XD(a,s.toString())}else if(typeof s!="string")throw Error(Dh+s);if(s.charCodeAt(0)===45?(s=s.slice(1),a.s=-1):a.s=1,bhe.test(s))XD(a,s);else throw Error(Dh+s)}if(i.prototype=ye,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=J6,i.config=i.set=whe,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function whe(t){if(!t||typeof t!="object")throw Error(Ns+"Object expected");var e,n,r,i=["precision",1,Yg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(Xg(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(Dh+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Dh+n+": "+r);return this}var vO=J6(xhe);Ui=new vO(1);const ft=vO;function _he(t){return khe(t)||jhe(t)||Ahe(t)||She()}function She(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ahe(t,e){if(t){if(typeof t=="string")return VE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VE(t,e)}}function jhe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function khe(t){if(Array.isArray(t))return VE(t)}function VE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Nhe=function(e){return e},Z6={},eU=function(e){return e===Z6},JD=function(e){return function n(){return arguments.length===0||arguments.length===1&&eU(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},Ehe=function t(e,n){return e===1?n:JD(function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.filter(function(o){return o!==Z6}).length;return a>=e?n.apply(void 0,i):t(e-a,JD(function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];var d=i.map(function(f){return eU(f)?l.shift():f});return n.apply(void 0,_he(d).concat(l))}))})},XA=function(e){return Ehe(e.length,e)},YE=function(e,n){for(var r=[],i=e;i<n;++i)r[i-e]=i;return r},Che=XA(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),Phe=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return Nhe;var i=n.reverse(),s=i[0],a=i.slice(1);return function(){return a.reduce(function(o,l){return l(o)},s.apply(void 0,arguments))}},XE=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},tU=function(e){var n=null,r=null;return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n&&s.every(function(o,l){return o===n[l]})||(n=s,r=e.apply(void 0,s)),r}};function The(t){var e;return t===0?e=1:e=Math.floor(new ft(t).abs().log(10).toNumber())+1,e}function Ohe(t,e,n){for(var r=new ft(t),i=0,s=[];r.lt(e)&&i<1e5;)s.push(r.toNumber()),r=r.add(n),i++;return s}var Mhe=XA(function(t,e,n){var r=+t,i=+e;return r+n*(i-r)}),Rhe=XA(function(t,e,n){var r=e-+t;return r=r||1/0,(n-t)/r}),Ihe=XA(function(t,e,n){var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});const QA={rangeStep:Ohe,getDigitCount:The,interpolateNumber:Mhe,uninterpolateNumber:Rhe,uninterpolateTruncation:Ihe};function QE(t){return Lhe(t)||$he(t)||nU(t)||Dhe()}function Dhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $he(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Lhe(t){if(Array.isArray(t))return JE(t)}function tv(t,e){return Uhe(t)||Bhe(t,e)||nU(t,e)||Fhe()}function Fhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nU(t,e){if(t){if(typeof t=="string")return JE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JE(t,e)}}function JE(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bhe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,s=void 0;try{for(var a=t[Symbol.iterator](),o;!(r=(o=a.next()).done)&&(n.push(o.value),!(e&&n.length===e));r=!0);}catch(l){i=!0,s=l}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw s}}return n}}function Uhe(t){if(Array.isArray(t))return t}function rU(t){var e=tv(t,2),n=e[0],r=e[1],i=n,s=r;return n>r&&(i=r,s=n),[i,s]}function iU(t,e,n){if(t.lte(0))return new ft(0);var r=QA.getDigitCount(t.toNumber()),i=new ft(10).pow(r),s=t.div(i),a=r!==1?.05:.1,o=new ft(Math.ceil(s.div(a).toNumber())).add(n).mul(a),l=o.mul(i);return e?l:new ft(Math.ceil(l))}function zhe(t,e,n){var r=1,i=new ft(t);if(!i.isint()&&n){var s=Math.abs(t);s<1?(r=new ft(10).pow(QA.getDigitCount(t)-1),i=new ft(Math.floor(i.div(r).toNumber())).mul(r)):s>1&&(i=new ft(Math.floor(t)))}else t===0?i=new ft(Math.floor((e-1)/2)):n||(i=new ft(Math.floor(t)));var a=Math.floor((e-1)/2),o=Phe(Che(function(l){return i.add(new ft(l-a).mul(r)).toNumber()}),YE);return o(0,e)}function sU(t,e,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new ft(0),tickMin:new ft(0),tickMax:new ft(0)};var s=iU(new ft(e).sub(t).div(n-1),r,i),a;t<=0&&e>=0?a=new ft(0):(a=new ft(t).add(e).div(2),a=a.sub(new ft(a).mod(s)));var o=Math.ceil(a.sub(t).div(s).toNumber()),l=Math.ceil(new ft(e).sub(a).div(s).toNumber()),u=o+l+1;return u>n?sU(t,e,n,r,i+1):(u<n&&(l=e>0?l+(n-u):l,o=e>0?o:o+(n-u)),{step:s,tickMin:a.sub(new ft(o).mul(s)),tickMax:a.add(new ft(l).mul(s))})}function Whe(t){var e=tv(t,2),n=e[0],r=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(i,2),o=rU([n,r]),l=tv(o,2),u=l[0],d=l[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(QE(YE(0,i-1).map(function(){return 1/0}))):[].concat(QE(YE(0,i-1).map(function(){return-1/0})),[d]);return n>r?XE(f):f}if(u===d)return zhe(u,i,s);var p=sU(u,d,a,s),m=p.step,y=p.tickMin,g=p.tickMax,v=QA.rangeStep(y,g.add(new ft(.1).mul(m)),m);return n>r?XE(v):v}function Hhe(t,e){var n=tv(t,2),r=n[0],i=n[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=rU([r,i]),o=tv(a,2),l=o[0],u=o[1];if(l===-1/0||u===1/0)return[r,i];if(l===u)return[l];var d=Math.max(e,2),f=iU(new ft(u).sub(l).div(d-1),s,0),p=[].concat(QE(QA.rangeStep(new ft(l),new ft(u).sub(new ft(.99).mul(f)),f)),[u]);return r>i?XE(p):p}var qhe=tU(Whe),Ghe=tU(Hhe),Khe="Invariant failed";function Kh(t,e){throw new Error(Khe)}var Vhe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function dg(t){"@babel/helpers - typeof";return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dg(t)}function U_(){return U_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},U_.apply(this,arguments)}function Yhe(t,e){return Zhe(t)||Jhe(t,e)||Qhe(t,e)||Xhe()}function Xhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qhe(t,e){if(t){if(typeof t=="string")return ZD(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZD(t,e)}}function ZD(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jhe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Zhe(t){if(Array.isArray(t))return t}function efe(t,e){if(t==null)return{};var n=tfe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function tfe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function nfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rfe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lU(r.key),r)}}function ife(t,e,n){return e&&rfe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function sfe(t,e,n){return e=z_(e),afe(t,aU()?Reflect.construct(e,n||[],z_(t).constructor):e.apply(t,n))}function afe(t,e){if(e&&(dg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ofe(t)}function ofe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aU=function(){return!!t})()}function z_(t){return z_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},z_(t)}function lfe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZE(t,e)}function ZE(t,e){return ZE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ZE(t,e)}function oU(t,e,n){return e=lU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lU(t){var e=cfe(t,"string");return dg(e)=="symbol"?e:e+""}function cfe(t,e){if(dg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(dg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Qg=function(t){function e(){return nfe(this,e),sfe(this,e,arguments)}return lfe(e,t),ife(e,[{key:"render",value:function(){var r=this.props,i=r.offset,s=r.layout,a=r.width,o=r.dataKey,l=r.data,u=r.dataPointFormatter,d=r.xAxis,f=r.yAxis,p=efe(r,Vhe),m=xe(p,!1);this.props.direction==="x"&&d.type!=="number"&&Kh();var y=l.map(function(g){var v=u(g,o),b=v.x,x=v.y,w=v.value,S=v.errorVal;if(!S)return null;var _=[],A,j;if(Array.isArray(S)){var N=Yhe(S,2);A=N[0],j=N[1]}else A=j=S;if(s==="vertical"){var P=d.scale,O=x+i,M=O+a,R=O-a,I=P(w-A),L=P(w+j);_.push({x1:L,y1:M,x2:L,y2:R}),_.push({x1:I,y1:O,x2:L,y2:O}),_.push({x1:I,y1:M,x2:I,y2:R})}else if(s==="horizontal"){var W=f.scale,F=b+i,z=F-a,U=F+a,K=W(w-A),H=W(w+j);_.push({x1:z,y1:H,x2:U,y2:H}),_.push({x1:F,y1:K,x2:F,y2:H}),_.push({x1:z,y1:K,x2:U,y2:K})}return D.createElement(Re,U_({className:"recharts-errorBar",key:"bar-".concat(_.map(function(Q){return"".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))},m),_.map(function(Q){return D.createElement("line",U_({},Q,{key:"line-".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))}))});return D.createElement(Re,{className:"recharts-errorBars"},y)}}])}(D.Component);oU(Qg,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});oU(Qg,"displayName","ErrorBar");function nv(t){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(t)}function e$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Mu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?e$(Object(n),!0).forEach(function(r){ufe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ufe(t,e,n){return e=dfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dfe(t){var e=hfe(t,"string");return nv(e)=="symbol"?e:e+""}function hfe(t,e){if(nv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(nv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cU=function(e){var n=e.children,r=e.formattedGraphicalItems,i=e.legendWidth,s=e.legendContent,a=Li(n,Fr);if(!a)return null;var o=Fr.defaultProps,l=o!==void 0?Mu(Mu({},o),a.props):{},u;return a.props&&a.props.payload?u=a.props&&a.props.payload:s==="children"?u=(r||[]).reduce(function(d,f){var p=f.item,m=f.props,y=m.sectors||m.data||[];return d.concat(y.map(function(g){return{type:a.props.iconType||p.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):u=(r||[]).map(function(d){var f=d.item,p=f.type.defaultProps,m=p!==void 0?Mu(Mu({},p),f.props):{},y=m.dataKey,g=m.name,v=m.legendType,b=m.hide;return{inactive:b,dataKey:y,type:l.iconType||v||"square",color:xO(f),value:g||y,payload:m}}),Mu(Mu(Mu({},l),Fr.getWithHeight(a,i)),{},{payload:u,item:a})};function rv(t){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function t$(t){return gfe(t)||mfe(t)||pfe(t)||ffe()}function ffe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pfe(t,e){if(t){if(typeof t=="string")return eC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eC(t,e)}}function mfe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function gfe(t){if(Array.isArray(t))return eC(t)}function eC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function nn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?n$(Object(n),!0).forEach(function(r){up(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):n$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function up(t,e,n){return e=yfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yfe(t){var e=vfe(t,"string");return rv(e)=="symbol"?e:e+""}function vfe(t,e){if(rv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(rv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mt(t,e,n){return we(t)||we(e)?n:En(e)?Hi(t,e,n):_e(e)?e(t):n}function m0(t,e,n,r){var i=mhe(t,function(o){return Mt(o,e)});if(n==="number"){var s=i.filter(function(o){return oe(o)||parseFloat(o)});return s.length?[YA(s),eu(s)]:[1/0,-1/0]}var a=r?i.filter(function(o){return!we(o)}):i;return a.map(function(o){return En(o)||o instanceof Date?o:""})}var xfe=function(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=-1,o=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(o<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,u=0;u<o;u++){var d=u>0?i[u-1].coordinate:i[o-1].coordinate,f=i[u].coordinate,p=u>=o-1?i[0].coordinate:i[u+1].coordinate,m=void 0;if(Mr(f-d)!==Mr(p-f)){var y=[];if(Mr(p-f)===Mr(l[1]-l[0])){m=p;var g=f+l[1]-l[0];y[0]=Math.min(g,(g+d)/2),y[1]=Math.max(g,(g+d)/2)}else{m=d;var v=p+l[1]-l[0];y[0]=Math.min(f,(v+f)/2),y[1]=Math.max(f,(v+f)/2)}var b=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(e>b[0]&&e<=b[1]||e>=y[0]&&e<=y[1]){a=i[u].index;break}}else{var x=Math.min(d,p),w=Math.max(d,p);if(e>(x+f)/2&&e<=(w+f)/2){a=i[u].index;break}}}else for(var S=0;S<o;S++)if(S===0&&e<=(r[S].coordinate+r[S+1].coordinate)/2||S>0&&S<o-1&&e>(r[S].coordinate+r[S-1].coordinate)/2&&e<=(r[S].coordinate+r[S+1].coordinate)/2||S===o-1&&e>(r[S].coordinate+r[S-1].coordinate)/2){a=r[S].index;break}return a},xO=function(e){var n,r=e,i=r.type.displayName,s=(n=e.type)!==null&&n!==void 0&&n.defaultProps?nn(nn({},e.type.defaultProps),e.props):e.props,a=s.stroke,o=s.fill,l;switch(i){case"Line":l=a;break;case"Area":case"Radar":l=a&&a!=="none"?a:o;break;default:l=o;break}return l},bfe=function(e){var n=e.barSize,r=e.totalSize,i=e.stackGroups,s=i===void 0?{}:i;if(!s)return{};for(var a={},o=Object.keys(s),l=0,u=o.length;l<u;l++)for(var d=s[o[l]].stackGroups,f=Object.keys(d),p=0,m=f.length;p<m;p++){var y=d[f[p]],g=y.items,v=y.cateAxisId,b=g.filter(function(j){return hl(j.type).indexOf("Bar")>=0});if(b&&b.length){var x=b[0].type.defaultProps,w=x!==void 0?nn(nn({},x),b[0].props):b[0].props,S=w.barSize,_=w[v];a[_]||(a[_]=[]);var A=we(S)?n:S;a[_].push({item:b[0],stackList:b.slice(1),barSize:we(A)?void 0:Rr(A,r,0)})}}return a},wfe=function(e){var n=e.barGap,r=e.barCategoryGap,i=e.bandSize,s=e.sizeList,a=s===void 0?[]:s,o=e.maxBarSize,l=a.length;if(l<1)return null;var u=Rr(n,i,0,!0),d,f=[];if(a[0].barSize===+a[0].barSize){var p=!1,m=i/l,y=a.reduce(function(S,_){return S+_.barSize||0},0);y+=(l-1)*u,y>=i&&(y-=(l-1)*u,u=0),y>=i&&m>0&&(p=!0,m*=.9,y=l*m);var g=(i-y)/2>>0,v={offset:g-u,size:0};d=a.reduce(function(S,_){var A={item:_.item,position:{offset:v.offset+v.size+u,size:p?m:_.barSize}},j=[].concat(t$(S),[A]);return v=j[j.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(N){j.push({item:N,position:v})}),j},f)}else{var b=Rr(r,i,0,!0);i-2*b-(l-1)*u<=0&&(u=0);var x=(i-2*b-(l-1)*u)/l;x>1&&(x>>=0);var w=o===+o?Math.min(x,o):x;d=a.reduce(function(S,_,A){var j=[].concat(t$(S),[{item:_.item,position:{offset:b+(x+u)*A+(x-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(N){j.push({item:N,position:j[j.length-1].position})}),j},f)}return d},_fe=function(e,n,r,i){var s=r.children,a=r.width,o=r.margin,l=a-(o.left||0)-(o.right||0),u=cU({children:s,legendWidth:l});if(u){var d=i||{},f=d.width,p=d.height,m=u.align,y=u.verticalAlign,g=u.layout;if((g==="vertical"||g==="horizontal"&&y==="middle")&&m!=="center"&&oe(e[m]))return nn(nn({},e),{},up({},m,e[m]+(f||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&y!=="middle"&&oe(e[y]))return nn(nn({},e),{},up({},y,e[y]+(p||0)))}return e},Sfe=function(e,n,r){return we(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},uU=function(e,n,r,i,s){var a=n.props.children,o=Lr(a,Qg).filter(function(u){return Sfe(i,s,u.props.direction)});if(o&&o.length){var l=o.map(function(u){return u.props.dataKey});return e.reduce(function(u,d){var f=Mt(d,r);if(we(f))return u;var p=Array.isArray(f)?[YA(f),eu(f)]:[f,f],m=l.reduce(function(y,g){var v=Mt(d,g,0),b=p[0]-Math.abs(Array.isArray(v)?v[0]:v),x=p[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(b,y[0]),Math.max(x,y[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},Afe=function(e,n,r,i,s){var a=n.map(function(o){return uU(e,o,r,s,i)}).filter(function(o){return!we(o)});return a&&a.length?a.reduce(function(o,l){return[Math.min(o[0],l[0]),Math.max(o[1],l[1])]},[1/0,-1/0]):null},dU=function(e,n,r,i,s){var a=n.map(function(l){var u=l.props.dataKey;return r==="number"&&u&&uU(e,l,u,i)||m0(e,u,r,s)});if(r==="number")return a.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var o={};return a.reduce(function(l,u){for(var d=0,f=u.length;d<f;d++)o[u[d]]||(o[u[d]]=!0,l.push(u[d]));return l},[])},hU=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},fU=function(e,n,r,i){if(i)return e.map(function(l){return l.coordinate});var s,a,o=e.map(function(l){return l.coordinate===n&&(s=!0),l.coordinate===r&&(a=!0),l.coordinate});return s||o.push(n),a||o.push(r),o},ul=function(e,n,r){if(!e)return null;var i=e.scale,s=e.duplicateDomain,a=e.type,o=e.range,l=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,u=(n||r)&&a==="category"&&i.bandwidth?i.bandwidth()/l:0;if(u=e.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?Mr(o[0]-o[1])*2*u:u,n&&(e.ticks||e.niceTicks)){var d=(e.ticks||e.niceTicks).map(function(f){var p=s?s.indexOf(f):f;return{coordinate:i(p)+u,value:f,offset:u}});return d.filter(function(f){return!Wg(f.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(f,p){return{coordinate:i(f)+u,value:f,index:p,offset:u}}):i.ticks&&!r?i.ticks(e.tickCount).map(function(f){return{coordinate:i(f)+u,value:f,offset:u}}):i.domain().map(function(f,p){return{coordinate:i(f)+u,value:s?s[f]:f,index:p,offset:u}})},Ek=new WeakMap,Nw=function(e,n){if(typeof n!="function")return e;Ek.has(e)||Ek.set(e,new WeakMap);var r=Ek.get(e);if(r.has(n))return r.get(n);var i=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,i),i},pU=function(e,n,r){var i=e.scale,s=e.type,a=e.layout,o=e.axisType;if(i==="auto")return a==="radial"&&o==="radiusAxis"?{scale:Y0(),realScaleType:"band"}:a==="radial"&&o==="angleAxis"?{scale:D_(),realScaleType:"linear"}:s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:p0(),realScaleType:"point"}:s==="category"?{scale:Y0(),realScaleType:"band"}:{scale:D_(),realScaleType:"linear"};if(Hh(i)){var l="scale".concat(RA(i));return{scale:(YD[l]||p0)(),realScaleType:YD[l]?l:"point"}}return _e(i)?{scale:i}:{scale:p0(),realScaleType:"point"}},r$=1e-4,mU=function(e){var n=e.domain();if(!(!n||n.length<=2)){var r=n.length,i=e.range(),s=Math.min(i[0],i[1])-r$,a=Math.max(i[0],i[1])+r$,o=e(n[0]),l=e(n[r-1]);(o<s||o>a||l<s||l>a)&&e.domain([n[0],n[r-1]])}},jfe=function(e,n){if(!e)return null;for(var r=0,i=e.length;r<i;r++)if(e[r].item===n)return e[r].position;return null},kfe=function(e,n){if(!n||n.length!==2||!oe(n[0])||!oe(n[1]))return e;var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),s=[e[0],e[1]];return(!oe(e[0])||e[0]<r)&&(s[0]=r),(!oe(e[1])||e[1]>i)&&(s[1]=i),s[0]>i&&(s[0]=i),s[1]<r&&(s[1]=r),s},Nfe=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var s=0,a=0,o=0;o<n;++o){var l=Wg(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=s,e[o][r][1]=s+l,s=e[o][r][1]):(e[o][r][0]=a,e[o][r][1]=a+l,a=e[o][r][1])}},Efe=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var s=0,a=0;a<n;++a){var o=Wg(e[a][r][1])?e[a][r][0]:e[a][r][1];o>=0?(e[a][r][0]=s,e[a][r][1]=s+o,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},Cfe={sign:Nfe,expand:VZ,none:rg,silhouette:YZ,wiggle:XZ,positive:Efe},Pfe=function(e,n,r){var i=n.map(function(o){return o.props.dataKey}),s=Cfe[r],a=KZ().keys(i).value(function(o,l){return+Mt(o,l,0)}).order(jE).offset(s);return a(e)},Tfe=function(e,n,r,i,s,a){if(!e)return null;var o=a?n.reverse():n,l={},u=o.reduce(function(f,p){var m,y=(m=p.type)!==null&&m!==void 0&&m.defaultProps?nn(nn({},p.type.defaultProps),p.props):p.props,g=y.stackId,v=y.hide;if(v)return f;var b=y[r],x=f[b]||{hasStack:!1,stackGroups:{}};if(En(g)){var w=x.stackGroups[g]||{numericAxisId:r,cateAxisId:i,items:[]};w.items.push(p),x.hasStack=!0,x.stackGroups[g]=w}else x.stackGroups[ku("_stackId_")]={numericAxisId:r,cateAxisId:i,items:[p]};return nn(nn({},f),{},up({},b,x))},l),d={};return Object.keys(u).reduce(function(f,p){var m=u[p];if(m.hasStack){var y={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,v){var b=m.stackGroups[v];return nn(nn({},g),{},up({},v,{numericAxisId:r,cateAxisId:i,items:b.items,stackedData:Pfe(e,b.items,s)}))},y)}return nn(nn({},f),{},up({},p,m))},d)},gU=function(e,n){var r=n.realScaleType,i=n.type,s=n.tickCount,a=n.originalDomain,o=n.allowDecimals,l=r||n.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&i==="number"&&a&&(a[0]==="auto"||a[1]==="auto")){var u=e.domain();if(!u.length)return null;var d=qhe(u,s,o);return e.domain([YA(d),eu(d)]),{niceTicks:d}}if(s&&i==="number"){var f=e.domain(),p=Ghe(f,s,o);return{niceTicks:p}}return null};function hg(t){var e=t.axis,n=t.ticks,r=t.bandSize,i=t.entry,s=t.index,a=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!we(i[e.dataKey])){var o=m_(n,"value",i[e.dataKey]);if(o)return o.coordinate+r/2}return n[s]?n[s].coordinate+r/2:null}var l=Mt(i,we(a)?e.dataKey:a);return we(l)?null:e.scale(l)}var i$=function(e){var n=e.axis,r=e.ticks,i=e.offset,s=e.bandSize,a=e.entry,o=e.index;if(n.type==="category")return r[o]?r[o].coordinate+i:null;var l=Mt(a,n.dataKey,n.domain[o]);return we(l)?null:n.scale(l)-s/2+i},Ofe=function(e){var n=e.numericAxis,r=n.scale.domain();if(n.type==="number"){var i=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]);return i<=0&&s>=0?0:s<0?s:i}return r[0]},Mfe=function(e,n){var r,i=(r=e.type)!==null&&r!==void 0&&r.defaultProps?nn(nn({},e.type.defaultProps),e.props):e.props,s=i.stackId;if(En(s)){var a=n[s];if(a){var o=a.items.indexOf(e);return o>=0?a.stackedData[o]:null}}return null},Rfe=function(e){return e.reduce(function(n,r){return[YA(r.concat([n[0]]).filter(oe)),eu(r.concat([n[1]]).filter(oe))]},[1/0,-1/0])},yU=function(e,n,r){return Object.keys(e).reduce(function(i,s){var a=e[s],o=a.stackedData,l=o.reduce(function(u,d){var f=Rfe(d.slice(n,r+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},s$=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,a$=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tC=function(e,n,r){if(_e(e))return e(n,r);if(!Array.isArray(e))return n;var i=[];if(oe(e[0]))i[0]=r?e[0]:Math.min(e[0],n[0]);else if(s$.test(e[0])){var s=+s$.exec(e[0])[1];i[0]=n[0]-s}else _e(e[0])?i[0]=e[0](n[0]):i[0]=n[0];if(oe(e[1]))i[1]=r?e[1]:Math.max(e[1],n[1]);else if(a$.test(e[1])){var a=+a$.exec(e[1])[1];i[1]=n[1]+a}else _e(e[1])?i[1]=e[1](n[1]):i[1]=n[1];return i},W_=function(e,n,r){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!r||i>0)return i}if(e&&n&&n.length>=2){for(var s=KT(n,function(f){return f.coordinate}),a=1/0,o=1,l=s.length;o<l;o++){var u=s[o],d=s[o-1];a=Math.min((u.coordinate||0)-(d.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0},o$=function(e,n,r){return!e||!e.length||yu(e,Hi(r,"type.defaultProps.domain"))?n:e},vU=function(e,n){var r=e.type.defaultProps?nn(nn({},e.type.defaultProps),e.props):e.props,i=r.dataKey,s=r.name,a=r.unit,o=r.formatter,l=r.tooltipType,u=r.chartType,d=r.hide;return nn(nn({},xe(e,!1)),{},{dataKey:i,unit:a,formatter:o,name:s||i,color:xO(e),value:Mt(n,i),type:l,payload:n,chartType:u,hide:d})};function iv(t){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function l$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function yo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l$(Object(n),!0).forEach(function(r){xU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xU(t,e,n){return e=Ife(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ife(t){var e=Dfe(t,"string");return iv(e)=="symbol"?e:e+""}function Dfe(t,e){if(iv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(iv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $fe(t,e){return Ufe(t)||Bfe(t,e)||Ffe(t,e)||Lfe()}function Lfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ffe(t,e){if(t){if(typeof t=="string")return c$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c$(t,e)}}function c$(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bfe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Ufe(t){if(Array.isArray(t))return t}var H_=Math.PI/180,zfe=function(e){return e*180/Math.PI},Et=function(e,n,r,i){return{x:e+Math.cos(-H_*i)*r,y:n+Math.sin(-H_*i)*r}},bU=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},Wfe=function(e,n,r,i,s){var a=e.width,o=e.height,l=e.startAngle,u=e.endAngle,d=Rr(e.cx,a,a/2),f=Rr(e.cy,o,o/2),p=bU(a,o,r),m=Rr(e.innerRadius,p,0),y=Rr(e.outerRadius,p,p*.8),g=Object.keys(n);return g.reduce(function(v,b){var x=n[b],w=x.domain,S=x.reversed,_;if(we(x.range))i==="angleAxis"?_=[l,u]:i==="radiusAxis"&&(_=[m,y]),S&&(_=[_[1],_[0]]);else{_=x.range;var A=_,j=$fe(A,2);l=j[0],u=j[1]}var N=pU(x,s),P=N.realScaleType,O=N.scale;O.domain(w).range(_),mU(O);var M=gU(O,yo(yo({},x),{},{realScaleType:P})),R=yo(yo(yo({},x),M),{},{range:_,radius:y,realScaleType:P,scale:O,cx:d,cy:f,innerRadius:m,outerRadius:y,startAngle:l,endAngle:u});return yo(yo({},v),{},xU({},b,R))},{})},Hfe=function(e,n){var r=e.x,i=e.y,s=n.x,a=n.y;return Math.sqrt(Math.pow(r-s,2)+Math.pow(i-a,2))},qfe=function(e,n){var r=e.x,i=e.y,s=n.cx,a=n.cy,o=Hfe({x:r,y:i},{x:s,y:a});if(o<=0)return{radius:o};var l=(r-s)/o,u=Math.acos(l);return i>a&&(u=2*Math.PI-u),{radius:o,angle:zfe(u),angleInRadian:u}},Gfe=function(e){var n=e.startAngle,r=e.endAngle,i=Math.floor(n/360),s=Math.floor(r/360),a=Math.min(i,s);return{startAngle:n-a*360,endAngle:r-a*360}},Kfe=function(e,n){var r=n.startAngle,i=n.endAngle,s=Math.floor(r/360),a=Math.floor(i/360),o=Math.min(s,a);return e+o*360},u$=function(e,n){var r=e.x,i=e.y,s=qfe({x:r,y:i},n),a=s.radius,o=s.angle,l=n.innerRadius,u=n.outerRadius;if(a<l||a>u)return!1;if(a===0)return!0;var d=Gfe(n),f=d.startAngle,p=d.endAngle,m=o,y;if(f<=p){for(;m>p;)m-=360;for(;m<f;)m+=360;y=m>=f&&m<=p}else{for(;m>f;)m-=360;for(;m<p;)m+=360;y=m>=p&&m<=f}return y?yo(yo({},n),{},{radius:a,angle:Kfe(m,n)}):null},wU=function(e){return!T.isValidElement(e)&&!_e(e)&&typeof e!="boolean"?e.className:""};function sv(t){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sv(t)}var Vfe=["offset"];function Yfe(t){return Zfe(t)||Jfe(t)||Qfe(t)||Xfe()}function Xfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qfe(t,e){if(t){if(typeof t=="string")return nC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nC(t,e)}}function Jfe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Zfe(t){if(Array.isArray(t))return nC(t)}function nC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function epe(t,e){if(t==null)return{};var n=tpe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function tpe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function d$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function xn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d$(Object(n),!0).forEach(function(r){npe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function npe(t,e,n){return e=rpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rpe(t){var e=ipe(t,"string");return sv(e)=="symbol"?e:e+""}function ipe(t,e){if(sv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(sv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function av(){return av=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},av.apply(this,arguments)}var spe=function(e){var n=e.value,r=e.formatter,i=we(e.children)?n:e.children;return _e(r)?r(i):i},ape=function(e,n){var r=Mr(n-e),i=Math.min(Math.abs(n-e),360);return r*i},ope=function(e,n,r){var i=e.position,s=e.viewBox,a=e.offset,o=e.className,l=s,u=l.cx,d=l.cy,f=l.innerRadius,p=l.outerRadius,m=l.startAngle,y=l.endAngle,g=l.clockWise,v=(f+p)/2,b=ape(m,y),x=b>=0?1:-1,w,S;i==="insideStart"?(w=m+x*a,S=g):i==="insideEnd"?(w=y-x*a,S=!g):i==="end"&&(w=y+x*a,S=g),S=b<=0?S:!S;var _=Et(u,d,v,w),A=Et(u,d,v,w+(S?1:-1)*359),j="M".concat(_.x,",").concat(_.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(S?0:1,`,
    `).concat(A.x,",").concat(A.y),N=we(e.id)?ku("recharts-radial-line-"):e.id;return D.createElement("text",av({},r,{dominantBaseline:"central",className:Ee("recharts-radial-bar-label",o)}),D.createElement("defs",null,D.createElement("path",{id:N,d:j})),D.createElement("textPath",{xlinkHref:"#".concat(N)},n))},lpe=function(e){var n=e.viewBox,r=e.offset,i=e.position,s=n,a=s.cx,o=s.cy,l=s.innerRadius,u=s.outerRadius,d=s.startAngle,f=s.endAngle,p=(d+f)/2;if(i==="outside"){var m=Et(a,o,u+r,p),y=m.x,g=m.y;return{x:y,y:g,textAnchor:y>=a?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"end"};var v=(l+u)/2,b=Et(a,o,v,p),x=b.x,w=b.y;return{x,y:w,textAnchor:"middle",verticalAnchor:"middle"}},cpe=function(e){var n=e.viewBox,r=e.parentViewBox,i=e.offset,s=e.position,a=n,o=a.x,l=a.y,u=a.width,d=a.height,f=d>=0?1:-1,p=f*i,m=f>0?"end":"start",y=f>0?"start":"end",g=u>=0?1:-1,v=g*i,b=g>0?"end":"start",x=g>0?"start":"end";if(s==="top"){var w={x:o+u/2,y:l-f*i,textAnchor:"middle",verticalAnchor:m};return xn(xn({},w),r?{height:Math.max(l-r.y,0),width:u}:{})}if(s==="bottom"){var S={x:o+u/2,y:l+d+p,textAnchor:"middle",verticalAnchor:y};return xn(xn({},S),r?{height:Math.max(r.y+r.height-(l+d),0),width:u}:{})}if(s==="left"){var _={x:o-v,y:l+d/2,textAnchor:b,verticalAnchor:"middle"};return xn(xn({},_),r?{width:Math.max(_.x-r.x,0),height:d}:{})}if(s==="right"){var A={x:o+u+v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"};return xn(xn({},A),r?{width:Math.max(r.x+r.width-A.x,0),height:d}:{})}var j=r?{width:u,height:d}:{};return s==="insideLeft"?xn({x:o+v,y:l+d/2,textAnchor:x,verticalAnchor:"middle"},j):s==="insideRight"?xn({x:o+u-v,y:l+d/2,textAnchor:b,verticalAnchor:"middle"},j):s==="insideTop"?xn({x:o+u/2,y:l+p,textAnchor:"middle",verticalAnchor:y},j):s==="insideBottom"?xn({x:o+u/2,y:l+d-p,textAnchor:"middle",verticalAnchor:m},j):s==="insideTopLeft"?xn({x:o+v,y:l+p,textAnchor:x,verticalAnchor:y},j):s==="insideTopRight"?xn({x:o+u-v,y:l+p,textAnchor:b,verticalAnchor:y},j):s==="insideBottomLeft"?xn({x:o+v,y:l+d-p,textAnchor:x,verticalAnchor:m},j):s==="insideBottomRight"?xn({x:o+u-v,y:l+d-p,textAnchor:b,verticalAnchor:m},j):Fg(s)&&(oe(s.x)||id(s.x))&&(oe(s.y)||id(s.y))?xn({x:o+Rr(s.x,u),y:l+Rr(s.y,d),textAnchor:"end",verticalAnchor:"end"},j):xn({x:o+u/2,y:l+d/2,textAnchor:"middle",verticalAnchor:"middle"},j)},upe=function(e){return"cx"in e&&oe(e.cx)};function Un(t){var e=t.offset,n=e===void 0?5:e,r=epe(t,Vfe),i=xn({offset:n},r),s=i.viewBox,a=i.position,o=i.value,l=i.children,u=i.content,d=i.className,f=d===void 0?"":d,p=i.textBreakAll;if(!s||we(o)&&we(l)&&!T.isValidElement(u)&&!_e(u))return null;if(T.isValidElement(u))return T.cloneElement(u,i);var m;if(_e(u)){if(m=T.createElement(u,i),T.isValidElement(m))return m}else m=spe(i);var y=upe(s),g=xe(i,!0);if(y&&(a==="insideStart"||a==="insideEnd"||a==="end"))return ope(i,m,g);var v=y?lpe(i):cpe(i);return D.createElement(qh,av({className:Ee("recharts-label",f)},g,v,{breakAll:p}),m)}Un.displayName="Label";var _U=function(e){var n=e.cx,r=e.cy,i=e.angle,s=e.startAngle,a=e.endAngle,o=e.r,l=e.radius,u=e.innerRadius,d=e.outerRadius,f=e.x,p=e.y,m=e.top,y=e.left,g=e.width,v=e.height,b=e.clockWise,x=e.labelViewBox;if(x)return x;if(oe(g)&&oe(v)){if(oe(f)&&oe(p))return{x:f,y:p,width:g,height:v};if(oe(m)&&oe(y))return{x:m,y,width:g,height:v}}return oe(f)&&oe(p)?{x:f,y:p,width:0,height:0}:oe(n)&&oe(r)?{cx:n,cy:r,startAngle:s||i||0,endAngle:a||i||0,innerRadius:u||0,outerRadius:d||l||o||0,clockWise:b}:e.viewBox?e.viewBox:{}},dpe=function(e,n){return e?e===!0?D.createElement(Un,{key:"label-implicit",viewBox:n}):En(e)?D.createElement(Un,{key:"label-implicit",viewBox:n,value:e}):T.isValidElement(e)?e.type===Un?T.cloneElement(e,{key:"label-implicit",viewBox:n}):D.createElement(Un,{key:"label-implicit",content:e,viewBox:n}):_e(e)?D.createElement(Un,{key:"label-implicit",content:e,viewBox:n}):Fg(e)?D.createElement(Un,av({viewBox:n},e,{key:"label-implicit"})):null:null},hpe=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var i=e.children,s=_U(e),a=Lr(i,Un).map(function(l,u){return T.cloneElement(l,{viewBox:n||s,key:"label-".concat(u)})});if(!r)return a;var o=dpe(e.label,n||s);return[o].concat(Yfe(a))};Un.parseViewBox=_U;Un.renderCallByParent=hpe;function fpe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var ppe=fpe;const mpe=at(ppe);function ov(t){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ov(t)}var gpe=["valueAccessor"],ype=["data","dataKey","clockWise","id","textBreakAll"];function vpe(t){return _pe(t)||wpe(t)||bpe(t)||xpe()}function xpe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bpe(t,e){if(t){if(typeof t=="string")return rC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rC(t,e)}}function wpe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _pe(t){if(Array.isArray(t))return rC(t)}function rC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q_(){return q_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},q_.apply(this,arguments)}function h$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function f$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?h$(Object(n),!0).forEach(function(r){Spe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Spe(t,e,n){return e=Ape(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ape(t){var e=jpe(t,"string");return ov(e)=="symbol"?e:e+""}function jpe(t,e){if(ov(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(ov(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p$(t,e){if(t==null)return{};var n=kpe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function kpe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Npe=function(e){return Array.isArray(e.value)?mpe(e.value):e.value};function da(t){var e=t.valueAccessor,n=e===void 0?Npe:e,r=p$(t,gpe),i=r.data,s=r.dataKey,a=r.clockWise,o=r.id,l=r.textBreakAll,u=p$(r,ype);return!i||!i.length?null:D.createElement(Re,{className:"recharts-label-list"},i.map(function(d,f){var p=we(s)?n(d,f):Mt(d&&d.payload,s),m=we(o)?{}:{id:"".concat(o,"-").concat(f)};return D.createElement(Un,q_({},xe(d,!0),u,m,{parentViewBox:d.parentViewBox,value:p,textBreakAll:l,viewBox:Un.parseViewBox(we(a)?d:f$(f$({},d),{},{clockWise:a})),key:"label-".concat(f),index:f}))}))}da.displayName="LabelList";function Epe(t,e){return t?t===!0?D.createElement(da,{key:"labelList-implicit",data:e}):D.isValidElement(t)||_e(t)?D.createElement(da,{key:"labelList-implicit",data:e,content:t}):Fg(t)?D.createElement(da,q_({data:e},t,{key:"labelList-implicit"})):null:null}function Cpe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var r=t.children,i=Lr(r,da).map(function(a,o){return T.cloneElement(a,{data:e,key:"labelList-".concat(o)})});if(!n)return i;var s=Epe(t.label,e);return[s].concat(vpe(i))}da.renderCallByParent=Cpe;function lv(t){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(t)}function iC(){return iC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iC.apply(this,arguments)}function m$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function g$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m$(Object(n),!0).forEach(function(r){Ppe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ppe(t,e,n){return e=Tpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tpe(t){var e=Ope(t,"string");return lv(e)=="symbol"?e:e+""}function Ope(t,e){if(lv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(lv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mpe=function(e,n){var r=Mr(n-e),i=Math.min(Math.abs(n-e),359.999);return r*i},Ew=function(e){var n=e.cx,r=e.cy,i=e.radius,s=e.angle,a=e.sign,o=e.isExternal,l=e.cornerRadius,u=e.cornerIsExternal,d=l*(o?1:-1)+i,f=Math.asin(l/d)/H_,p=u?s:s+a*f,m=Et(n,r,d,p),y=Et(n,r,i,p),g=u?s-a*f:s,v=Et(n,r,d*Math.cos(f*H_),g);return{center:m,circleTangency:y,lineTangency:v,theta:f}},SU=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,s=e.outerRadius,a=e.startAngle,o=e.endAngle,l=Mpe(a,o),u=a+l,d=Et(n,r,s,a),f=Et(n,r,s,u),p="M ".concat(d.x,",").concat(d.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(a>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(i>0){var m=Et(n,r,i,a),y=Et(n,r,i,u);p+="L ".concat(y.x,",").concat(y.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(a<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else p+="L ".concat(n,",").concat(r," Z");return p},Rpe=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,s=e.outerRadius,a=e.cornerRadius,o=e.forceCornerRadius,l=e.cornerIsExternal,u=e.startAngle,d=e.endAngle,f=Mr(d-u),p=Ew({cx:n,cy:r,radius:s,angle:u,sign:f,cornerRadius:a,cornerIsExternal:l}),m=p.circleTangency,y=p.lineTangency,g=p.theta,v=Ew({cx:n,cy:r,radius:s,angle:d,sign:-f,cornerRadius:a,cornerIsExternal:l}),b=v.circleTangency,x=v.lineTangency,w=v.theta,S=l?Math.abs(u-d):Math.abs(u-d)-g-w;if(S<0)return o?"M ".concat(y.x,",").concat(y.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):SU({cx:n,cy:r,innerRadius:i,outerRadius:s,startAngle:u,endAngle:d});var _="M ".concat(y.x,",").concat(y.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(S>180),",").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
  `);if(i>0){var A=Ew({cx:n,cy:r,radius:i,angle:u,sign:f,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),j=A.circleTangency,N=A.lineTangency,P=A.theta,O=Ew({cx:n,cy:r,radius:i,angle:d,sign:-f,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),M=O.circleTangency,R=O.lineTangency,I=O.theta,L=l?Math.abs(u-d):Math.abs(u-d)-P-I;if(L<0&&a===0)return"".concat(_,"L").concat(n,",").concat(r,"Z");_+="L".concat(R.x,",").concat(R.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(L>180),",").concat(+(f>0),",").concat(j.x,",").concat(j.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(f<0),",").concat(N.x,",").concat(N.y,"Z")}else _+="L".concat(n,",").concat(r,"Z");return _},Ipe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},AU=function(e){var n=g$(g$({},Ipe),e),r=n.cx,i=n.cy,s=n.innerRadius,a=n.outerRadius,o=n.cornerRadius,l=n.forceCornerRadius,u=n.cornerIsExternal,d=n.startAngle,f=n.endAngle,p=n.className;if(a<s||d===f)return null;var m=Ee("recharts-sector",p),y=a-s,g=Rr(o,y,0,!0),v;return g>0&&Math.abs(d-f)<360?v=Rpe({cx:r,cy:i,innerRadius:s,outerRadius:a,cornerRadius:Math.min(g,y/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:d,endAngle:f}):v=SU({cx:r,cy:i,innerRadius:s,outerRadius:a,startAngle:d,endAngle:f}),D.createElement("path",iC({},xe(n,!0),{className:m,d:v,role:"img"}))};function cv(t){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cv(t)}function sC(){return sC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sC.apply(this,arguments)}function y$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function v$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y$(Object(n),!0).forEach(function(r){Dpe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Dpe(t,e,n){return e=$pe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $pe(t){var e=Lpe(t,"string");return cv(e)=="symbol"?e:e+""}function Lpe(t,e){if(cv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(cv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var x$={curveBasisClosed:DZ,curveBasisOpen:$Z,curveBasis:IZ,curveBumpX:wZ,curveBumpY:_Z,curveLinearClosed:LZ,curveLinear:DA,curveMonotoneX:FZ,curveMonotoneY:BZ,curveNatural:UZ,curveStep:zZ,curveStepAfter:HZ,curveStepBefore:WZ},Cw=function(e){return e.x===+e.x&&e.y===+e.y},my=function(e){return e.x},gy=function(e){return e.y},Fpe=function(e,n){if(_e(e))return e;var r="curve".concat(RA(e));return(r==="curveMonotone"||r==="curveBump")&&n?x$["".concat(r).concat(n==="vertical"?"Y":"X")]:x$[r]||DA},Bpe=function(e){var n=e.type,r=n===void 0?"linear":n,i=e.points,s=i===void 0?[]:i,a=e.baseLine,o=e.layout,l=e.connectNulls,u=l===void 0?!1:l,d=Fpe(r,o),f=u?s.filter(function(g){return Cw(g)}):s,p;if(Array.isArray(a)){var m=u?a.filter(function(g){return Cw(g)}):a,y=f.map(function(g,v){return v$(v$({},g),{},{base:m[v]})});return o==="vertical"?p=xw().y(gy).x1(my).x0(function(g){return g.base.x}):p=xw().x(my).y1(gy).y0(function(g){return g.base.y}),p.defined(Cw).curve(d),p(y)}return o==="vertical"&&oe(a)?p=xw().y(gy).x1(my).x0(a):oe(a)?p=xw().x(my).y1(gy).y0(a):p=v5().x(my).y(gy),p.defined(Cw).curve(d),p(f)},fu=function(e){var n=e.className,r=e.points,i=e.path,s=e.pathRef;if((!r||!r.length)&&!i)return null;var a=r&&r.length?Bpe(e):i;return T.createElement("path",sC({},xe(e,!1),g_(e),{className:Ee("recharts-curve",n),d:a,ref:s}))},jU={exports:{}},Upe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",zpe=Upe,Wpe=zpe;function kU(){}function NU(){}NU.resetWarningCache=kU;var Hpe=function(){function t(r,i,s,a,o,l){if(l!==Wpe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:NU,resetWarningCache:kU};return n.PropTypes=n,n};jU.exports=Hpe();var qpe=jU.exports;const Qe=at(qpe);var Gpe=Object.getOwnPropertyNames,Kpe=Object.getOwnPropertySymbols,Vpe=Object.prototype.hasOwnProperty;function b$(t,e){return function(r,i,s){return t(r,i,s)&&e(r,i,s)}}function Pw(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);var s=i.cache,a=s.get(n),o=s.get(r);if(a&&o)return a===r&&o===n;s.set(n,r),s.set(r,n);var l=t(n,r,i);return s.delete(n),s.delete(r),l}}function Ype(t){return t!=null?t[Symbol.toStringTag]:void 0}function w$(t){return Gpe(t).concat(Kpe(t))}var Xpe=Object.hasOwn||function(t,e){return Vpe.call(t,e)};function sf(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var Qpe="__v",Jpe="__o",Zpe="_owner",_$=Object.getOwnPropertyDescriptor,S$=Object.keys;function eme(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function tme(t,e){return sf(t.getTime(),e.getTime())}function nme(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function rme(t,e){return t===e}function A$(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.entries(),a,o,l=0;(a=s.next())&&!a.done;){for(var u=e.entries(),d=!1,f=0;(o=u.next())&&!o.done;){if(i[f]){f++;continue}var p=a.value,m=o.value;if(n.equals(p[0],m[0],l,f,t,e,n)&&n.equals(p[1],m[1],p[0],m[0],t,e,n)){d=i[f]=!0;break}f++}if(!d)return!1;l++}return!0}var ime=sf;function sme(t,e,n){var r=S$(t),i=r.length;if(S$(e).length!==i)return!1;for(;i-- >0;)if(!EU(t,e,n,r[i]))return!1;return!0}function yy(t,e,n){var r=w$(t),i=r.length;if(w$(e).length!==i)return!1;for(var s,a,o;i-- >0;)if(s=r[i],!EU(t,e,n,s)||(a=_$(t,s),o=_$(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function ame(t,e){return sf(t.valueOf(),e.valueOf())}function ome(t,e){return t.source===e.source&&t.flags===e.flags}function j$(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.values(),a,o;(a=s.next())&&!a.done;){for(var l=e.values(),u=!1,d=0;(o=l.next())&&!o.done;){if(!i[d]&&n.equals(a.value,o.value,a.value,o.value,t,e,n)){u=i[d]=!0;break}d++}if(!u)return!1}return!0}function lme(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function cme(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function EU(t,e,n,r){return(r===Zpe||r===Jpe||r===Qpe)&&(t.$$typeof||e.$$typeof)?!0:Xpe(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var ume="[object Arguments]",dme="[object Boolean]",hme="[object Date]",fme="[object Error]",pme="[object Map]",mme="[object Number]",gme="[object Object]",yme="[object RegExp]",vme="[object Set]",xme="[object String]",bme="[object URL]",wme=Array.isArray,k$=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,N$=Object.assign,_me=Object.prototype.toString.call.bind(Object.prototype.toString);function Sme(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,i=t.areFunctionsEqual,s=t.areMapsEqual,a=t.areNumbersEqual,o=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,u=t.areRegExpsEqual,d=t.areSetsEqual,f=t.areTypedArraysEqual,p=t.areUrlsEqual,m=t.unknownTagComparators;return function(g,v,b){if(g===v)return!0;if(g==null||v==null)return!1;var x=typeof g;if(x!==typeof v)return!1;if(x!=="object")return x==="number"?a(g,v,b):x==="function"?i(g,v,b):!1;var w=g.constructor;if(w!==v.constructor)return!1;if(w===Object)return o(g,v,b);if(wme(g))return e(g,v,b);if(k$!=null&&k$(g))return f(g,v,b);if(w===Date)return n(g,v,b);if(w===RegExp)return u(g,v,b);if(w===Map)return s(g,v,b);if(w===Set)return d(g,v,b);var S=_me(g);if(S===hme)return n(g,v,b);if(S===yme)return u(g,v,b);if(S===pme)return s(g,v,b);if(S===vme)return d(g,v,b);if(S===gme)return typeof g.then!="function"&&typeof v.then!="function"&&o(g,v,b);if(S===bme)return p(g,v,b);if(S===fme)return r(g,v,b);if(S===ume)return o(g,v,b);if(S===dme||S===mme||S===xme)return l(g,v,b);if(m){var _=m[S];if(!_){var A=Ype(g);A&&(_=m[A])}if(_)return _(g,v,b)}return!1}}function Ame(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={areArraysEqual:r?yy:eme,areDatesEqual:tme,areErrorsEqual:nme,areFunctionsEqual:rme,areMapsEqual:r?b$(A$,yy):A$,areNumbersEqual:ime,areObjectsEqual:r?yy:sme,arePrimitiveWrappersEqual:ame,areRegExpsEqual:ome,areSetsEqual:r?b$(j$,yy):j$,areTypedArraysEqual:r?yy:lme,areUrlsEqual:cme,unknownTagComparators:void 0};if(n&&(i=N$({},i,n(i))),e){var s=Pw(i.areArraysEqual),a=Pw(i.areMapsEqual),o=Pw(i.areObjectsEqual),l=Pw(i.areSetsEqual);i=N$({},i,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:l})}return i}function jme(t){return function(e,n,r,i,s,a,o){return t(e,n,o)}}function kme(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,s=t.strict;if(r)return function(l,u){var d=r(),f=d.cache,p=f===void 0?e?new WeakMap:void 0:f,m=d.meta;return n(l,u,{cache:p,equals:i,meta:m,strict:s})};if(e)return function(l,u){return n(l,u,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var a={cache:void 0,equals:i,meta:void 0,strict:s};return function(l,u){return n(l,u,a)}}var Nme=Cu();Cu({strict:!0});Cu({circular:!0});Cu({circular:!0,strict:!0});Cu({createInternalComparator:function(){return sf}});Cu({strict:!0,createInternalComparator:function(){return sf}});Cu({circular:!0,createInternalComparator:function(){return sf}});Cu({circular:!0,createInternalComparator:function(){return sf},strict:!0});function Cu(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,i=t.createState,s=t.strict,a=s===void 0?!1:s,o=Ame(t),l=Sme(o),u=r?r(l):jme(l);return kme({circular:n,comparator:l,createState:i,equals:u,strict:a})}function Eme(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function E$(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function i(s){n<0&&(n=s),s-n>e?(t(s),n=-1):Eme(i)};requestAnimationFrame(r)}function aC(t){"@babel/helpers - typeof";return aC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aC(t)}function Cme(t){return Mme(t)||Ome(t)||Tme(t)||Pme()}function Pme(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tme(t,e){if(t){if(typeof t=="string")return C$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C$(t,e)}}function C$(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ome(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Mme(t){if(Array.isArray(t))return t}function Rme(){var t={},e=function(){return null},n=!1,r=function i(s){if(!n){if(Array.isArray(s)){if(!s.length)return;var a=s,o=Cme(a),l=o[0],u=o.slice(1);if(typeof l=="number"){E$(i.bind(null,u),l);return}i(l),E$(i.bind(null,u));return}aC(s)==="object"&&(t=s,e(t)),typeof s=="function"&&s()}};return{stop:function(){n=!0},start:function(s){n=!1,r(s)},subscribe:function(s){return e=s,function(){e=function(){return null}}}}}function uv(t){"@babel/helpers - typeof";return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uv(t)}function P$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function T$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?P$(Object(n),!0).forEach(function(r){CU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function CU(t,e,n){return e=Ime(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ime(t){var e=Dme(t,"string");return uv(e)==="symbol"?e:String(e)}function Dme(t,e){if(uv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(uv(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $me=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(r,i){return r.filter(function(s){return i.includes(s)})})},Lme=function(e){return e},Fme=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},g0=function(e,n){return Object.keys(n).reduce(function(r,i){return T$(T$({},r),{},CU({},i,e(i,n[i])))},{})},O$=function(e,n,r){return e.map(function(i){return"".concat(Fme(i)," ").concat(n,"ms ").concat(r)}).join(",")};function Bme(t,e){return Wme(t)||zme(t,e)||PU(t,e)||Ume()}function Ume(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zme(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Wme(t){if(Array.isArray(t))return t}function Hme(t){return Kme(t)||Gme(t)||PU(t)||qme()}function qme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PU(t,e){if(t){if(typeof t=="string")return oC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oC(t,e)}}function Gme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kme(t){if(Array.isArray(t))return oC(t)}function oC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var G_=1e-4,TU=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},OU=function(e,n){return e.map(function(r,i){return r*Math.pow(n,i)}).reduce(function(r,i){return r+i})},M$=function(e,n){return function(r){var i=TU(e,n);return OU(i,r)}},Vme=function(e,n){return function(r){var i=TU(e,n),s=[].concat(Hme(i.map(function(a,o){return a*o}).slice(1)),[0]);return OU(s,r)}},R$=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],s=n[1],a=n[2],o=n[3];if(n.length===1)switch(n[0]){case"linear":i=0,s=0,a=1,o=1;break;case"ease":i=.25,s=.1,a=.25,o=1;break;case"ease-in":i=.42,s=0,a=1,o=1;break;case"ease-out":i=.42,s=0,a=.58,o=1;break;case"ease-in-out":i=0,s=0,a=.58,o=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),d=Bme(u,4);i=d[0],s=d[1],a=d[2],o=d[3]}}}var f=M$(i,a),p=M$(s,o),m=Vme(i,a),y=function(b){return b>1?1:b<0?0:b},g=function(b){for(var x=b>1?1:b,w=x,S=0;S<8;++S){var _=f(w)-x,A=m(w);if(Math.abs(_-x)<G_||A<G_)return p(w);w=y(w-_/A)}return p(w)};return g.isStepper=!1,g},Yme=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,r=n===void 0?100:n,i=e.damping,s=i===void 0?8:i,a=e.dt,o=a===void 0?17:a,l=function(d,f,p){var m=-(d-f)*r,y=p*s,g=p+(m-y)*o/1e3,v=p*o/1e3+d;return Math.abs(v-f)<G_&&Math.abs(g)<G_?[f,0]:[v,g]};return l.isStepper=!0,l.dt=o,l},Xme=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return R$(i);case"spring":return Yme();default:if(i.split("(")[0]==="cubic-bezier")return R$(i)}return typeof i=="function"?i:null};function dv(t){"@babel/helpers - typeof";return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dv(t)}function I$(t){return Zme(t)||Jme(t)||MU(t)||Qme()}function Qme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Zme(t){if(Array.isArray(t))return cC(t)}function D$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Xn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?D$(Object(n),!0).forEach(function(r){lC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lC(t,e,n){return e=ege(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ege(t){var e=tge(t,"string");return dv(e)==="symbol"?e:String(e)}function tge(t,e){if(dv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(dv(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nge(t,e){return sge(t)||ige(t,e)||MU(t,e)||rge()}function rge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MU(t,e){if(t){if(typeof t=="string")return cC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cC(t,e)}}function cC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ige(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function sge(t){if(Array.isArray(t))return t}var K_=function(e,n,r){return e+(n-e)*r},uC=function(e){var n=e.from,r=e.to;return n!==r},age=function t(e,n,r){var i=g0(function(s,a){if(uC(a)){var o=e(a.from,a.to,a.velocity),l=nge(o,2),u=l[0],d=l[1];return Xn(Xn({},a),{},{from:u,velocity:d})}return a},n);return r<1?g0(function(s,a){return uC(a)?Xn(Xn({},a),{},{velocity:K_(a.velocity,i[s].velocity,r),from:K_(a.from,i[s].from,r)}):a},n):t(e,i,r-1)};const oge=function(t,e,n,r,i){var s=$me(t,e),a=s.reduce(function(v,b){return Xn(Xn({},v),{},lC({},b,[t[b],e[b]]))},{}),o=s.reduce(function(v,b){return Xn(Xn({},v),{},lC({},b,{from:t[b],velocity:0,to:e[b]}))},{}),l=-1,u,d,f=function(){return null},p=function(){return g0(function(b,x){return x.from},o)},m=function(){return!Object.values(o).filter(uC).length},y=function(b){u||(u=b);var x=b-u,w=x/n.dt;o=age(n,o,w),i(Xn(Xn(Xn({},t),e),p())),u=b,m()||(l=requestAnimationFrame(f))},g=function(b){d||(d=b);var x=(b-d)/r,w=g0(function(_,A){return K_.apply(void 0,I$(A).concat([n(x)]))},a);if(i(Xn(Xn(Xn({},t),e),w)),x<1)l=requestAnimationFrame(f);else{var S=g0(function(_,A){return K_.apply(void 0,I$(A).concat([n(1)]))},a);i(Xn(Xn(Xn({},t),e),S))}};return f=n.isStepper?y:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function fg(t){"@babel/helpers - typeof";return fg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fg(t)}var lge=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function cge(t,e){if(t==null)return{};var n=uge(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function uge(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function Ck(t){return pge(t)||fge(t)||hge(t)||dge()}function dge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hge(t,e){if(t){if(typeof t=="string")return dC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dC(t,e)}}function fge(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pge(t){if(Array.isArray(t))return dC(t)}function dC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Is(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$$(Object(n),!0).forEach(function(r){My(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function My(t,e,n){return e=RU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,RU(r.key),r)}}function yge(t,e,n){return e&&gge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function RU(t){var e=vge(t,"string");return fg(e)==="symbol"?e:String(e)}function vge(t,e){if(fg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(fg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hC(t,e)}function hC(t,e){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},hC(t,e)}function bge(t){var e=wge();return function(){var r=V_(t),i;if(e){var s=V_(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return fC(this,i)}}function fC(t,e){if(e&&(fg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pC(t)}function pC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function V_(t){return V_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},V_(t)}var Es=function(t){xge(n,t);var e=bge(n);function n(r,i){var s;mge(this,n),s=e.call(this,r,i);var a=s.props,o=a.isActive,l=a.attributeName,u=a.from,d=a.to,f=a.steps,p=a.children,m=a.duration;if(s.handleStyleChange=s.handleStyleChange.bind(pC(s)),s.changeStyle=s.changeStyle.bind(pC(s)),!o||m<=0)return s.state={style:{}},typeof p=="function"&&(s.state={style:d}),fC(s);if(f&&f.length)s.state={style:f[0].style};else if(u){if(typeof p=="function")return s.state={style:u},fC(s);s.state={style:l?My({},l,u):u}}else s.state={style:{}};return s}return yge(n,[{key:"componentDidMount",value:function(){var i=this.props,s=i.isActive,a=i.canBegin;this.mounted=!0,!(!s||!a)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var s=this.props,a=s.isActive,o=s.canBegin,l=s.attributeName,u=s.shouldReAnimate,d=s.to,f=s.from,p=this.state.style;if(o){if(!a){var m={style:l?My({},l,d):d};this.state&&p&&(l&&p[l]!==d||!l&&p!==d)&&this.setState(m);return}if(!(Nme(i.to,d)&&i.canBegin&&i.isActive)){var y=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=y||u?f:i.to;if(this.state&&p){var v={style:l?My({},l,g):g};(l&&p[l]!==g||!l&&p!==g)&&this.setState(v)}this.runAnimation(Is(Is({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var s=this,a=i.from,o=i.to,l=i.duration,u=i.easing,d=i.begin,f=i.onAnimationEnd,p=i.onAnimationStart,m=oge(a,o,Xme(u),l,this.changeStyle),y=function(){s.stopJSAnimation=m()};this.manager.start([p,d,y,l,f])}},{key:"runStepAnimation",value:function(i){var s=this,a=i.steps,o=i.begin,l=i.onAnimationStart,u=a[0],d=u.style,f=u.duration,p=f===void 0?0:f,m=function(g,v,b){if(b===0)return g;var x=v.duration,w=v.easing,S=w===void 0?"ease":w,_=v.style,A=v.properties,j=v.onAnimationEnd,N=b>0?a[b-1]:v,P=A||Object.keys(_);if(typeof S=="function"||S==="spring")return[].concat(Ck(g),[s.runJSAnimation.bind(s,{from:N.style,to:_,duration:x,easing:S}),x]);var O=O$(P,x,S),M=Is(Is(Is({},N.style),_),{},{transition:O});return[].concat(Ck(g),[M,x,j]).filter(Lme)};return this.manager.start([l].concat(Ck(a.reduce(m,[d,Math.max(p,o)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=Rme());var s=i.begin,a=i.duration,o=i.attributeName,l=i.to,u=i.easing,d=i.onAnimationStart,f=i.onAnimationEnd,p=i.steps,m=i.children,y=this.manager;if(this.unSubscribe=y.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(i);return}if(p.length>1){this.runStepAnimation(i);return}var g=o?My({},o,l):l,v=O$(Object.keys(g),a,u);y.start([d,s,Is(Is({},g),{},{transition:v}),a,f])}},{key:"render",value:function(){var i=this.props,s=i.children;i.begin;var a=i.duration;i.attributeName,i.easing;var o=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var l=cge(i,lge),u=T.Children.count(s),d=this.state.style;if(typeof s=="function")return s(d);if(!o||u===0||a<=0)return s;var f=function(m){var y=m.props,g=y.style,v=g===void 0?{}:g,b=y.className,x=T.cloneElement(m,Is(Is({},l),{},{style:Is(Is({},v),d),className:b}));return x};return u===1?f(T.Children.only(s)):D.createElement("div",null,T.Children.map(s,function(p){return f(p)}))}}]),n}(T.PureComponent);Es.displayName="Animate";Es.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Es.propTypes={from:Qe.oneOfType([Qe.object,Qe.string]),to:Qe.oneOfType([Qe.object,Qe.string]),attributeName:Qe.string,duration:Qe.number,begin:Qe.number,easing:Qe.oneOfType([Qe.string,Qe.func]),steps:Qe.arrayOf(Qe.shape({duration:Qe.number.isRequired,style:Qe.object.isRequired,easing:Qe.oneOfType([Qe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Qe.func]),properties:Qe.arrayOf("string"),onAnimationEnd:Qe.func})),children:Qe.oneOfType([Qe.node,Qe.func]),isActive:Qe.bool,canBegin:Qe.bool,onAnimationEnd:Qe.func,shouldReAnimate:Qe.bool,onAnimationStart:Qe.func,onAnimationReStart:Qe.func};function hv(t){"@babel/helpers - typeof";return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(t)}function Y_(){return Y_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Y_.apply(this,arguments)}function _ge(t,e){return kge(t)||jge(t,e)||Age(t,e)||Sge()}function Sge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Age(t,e){if(t){if(typeof t=="string")return L$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L$(t,e)}}function L$(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jge(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function kge(t){if(Array.isArray(t))return t}function F$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function B$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?F$(Object(n),!0).forEach(function(r){Nge(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Nge(t,e,n){return e=Ege(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ege(t){var e=Cge(t,"string");return hv(e)=="symbol"?e:e+""}function Cge(t,e){if(hv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(hv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var U$=function(e,n,r,i,s){var a=Math.min(Math.abs(r)/2,Math.abs(i)/2),o=i>=0?1:-1,l=r>=0?1:-1,u=i>=0&&r>=0||i<0&&r<0?1:0,d;if(a>0&&s instanceof Array){for(var f=[0,0,0,0],p=0,m=4;p<m;p++)f[p]=s[p]>a?a:s[p];d="M".concat(e,",").concat(n+o*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(e+l*f[0],",").concat(n)),d+="L ".concat(e+r-l*f[1],",").concat(n),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(e+r,",").concat(n+o*f[1])),d+="L ".concat(e+r,",").concat(n+i-o*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(e+r-l*f[2],",").concat(n+i)),d+="L ".concat(e+l*f[3],",").concat(n+i),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(n+i-o*f[3])),d+="Z"}else if(a>0&&s===+s&&s>0){var y=Math.min(a,s);d="M ".concat(e,",").concat(n+o*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+l*y,",").concat(n,`
            L `).concat(e+r-l*y,",").concat(n,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+r,",").concat(n+o*y,`
            L `).concat(e+r,",").concat(n+i-o*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e+r-l*y,",").concat(n+i,`
            L `).concat(e+l*y,",").concat(n+i,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(e,",").concat(n+i-o*y," Z")}else d="M ".concat(e,",").concat(n," h ").concat(r," v ").concat(i," h ").concat(-r," Z");return d},Pge=function(e,n){if(!e||!n)return!1;var r=e.x,i=e.y,s=n.x,a=n.y,o=n.width,l=n.height;if(Math.abs(o)>0&&Math.abs(l)>0){var u=Math.min(s,s+o),d=Math.max(s,s+o),f=Math.min(a,a+l),p=Math.max(a,a+l);return r>=u&&r<=d&&i>=f&&i<=p}return!1},Tge={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},bO=function(e){var n=B$(B$({},Tge),e),r=T.useRef(),i=T.useState(-1),s=_ge(i,2),a=s[0],o=s[1];T.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var S=r.current.getTotalLength();S&&o(S)}catch{}},[]);var l=n.x,u=n.y,d=n.width,f=n.height,p=n.radius,m=n.className,y=n.animationEasing,g=n.animationDuration,v=n.animationBegin,b=n.isAnimationActive,x=n.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var w=Ee("recharts-rectangle",m);return x?D.createElement(Es,{canBegin:a>0,from:{width:d,height:f,x:l,y:u},to:{width:d,height:f,x:l,y:u},duration:g,animationEasing:y,isActive:x},function(S){var _=S.width,A=S.height,j=S.x,N=S.y;return D.createElement(Es,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:b,easing:y},D.createElement("path",Y_({},xe(n,!0),{className:w,d:U$(j,N,_,A,p),ref:r})))}):D.createElement("path",Y_({},xe(n,!0),{className:w,d:U$(l,u,d,f,p)}))},Oge=["points","className","baseLinePoints","connectNulls"];function qf(){return qf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qf.apply(this,arguments)}function Mge(t,e){if(t==null)return{};var n=Rge(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Rge(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function z$(t){return Lge(t)||$ge(t)||Dge(t)||Ige()}function Ige(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dge(t,e){if(t){if(typeof t=="string")return mC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mC(t,e)}}function $ge(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Lge(t){if(Array.isArray(t))return mC(t)}function mC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var W$=function(e){return e&&e.x===+e.x&&e.y===+e.y},Fge=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return e.forEach(function(r){W$(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),W$(e[0])&&n[n.length-1].push(e[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},y0=function(e,n){var r=Fge(e);n&&(r=[r.reduce(function(s,a){return[].concat(z$(s),z$(a))},[])]);var i=r.map(function(s){return s.reduce(function(a,o,l){return"".concat(a).concat(l===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return r.length===1?"".concat(i,"Z"):i},Bge=function(e,n,r){var i=y0(e,r);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(y0(n.reverse(),r).slice(1))},Uge=function(e){var n=e.points,r=e.className,i=e.baseLinePoints,s=e.connectNulls,a=Mge(e,Oge);if(!n||!n.length)return null;var o=Ee("recharts-polygon",r);if(i&&i.length){var l=a.stroke&&a.stroke!=="none",u=Bge(n,i,s);return D.createElement("g",{className:o},D.createElement("path",qf({},xe(a,!0),{fill:u.slice(-1)==="Z"?a.fill:"none",stroke:"none",d:u})),l?D.createElement("path",qf({},xe(a,!0),{fill:"none",d:y0(n,s)})):null,l?D.createElement("path",qf({},xe(a,!0),{fill:"none",d:y0(i,s)})):null)}var d=y0(n,s);return D.createElement("path",qf({},xe(a,!0),{fill:d.slice(-1)==="Z"?a.fill:"none",className:o,d}))};function gC(){return gC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gC.apply(this,arguments)}var Bb=function(e){var n=e.cx,r=e.cy,i=e.r,s=e.className,a=Ee("recharts-dot",s);return n===+n&&r===+r&&i===+i?T.createElement("circle",gC({},xe(e,!1),g_(e),{className:a,cx:n,cy:r,r:i})):null};function fv(t){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(t)}var zge=["x","y","top","left","width","height","className"];function yC(){return yC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yC.apply(this,arguments)}function H$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Wge(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H$(Object(n),!0).forEach(function(r){Hge(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Hge(t,e,n){return e=qge(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qge(t){var e=Gge(t,"string");return fv(e)=="symbol"?e:e+""}function Gge(t,e){if(fv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(fv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kge(t,e){if(t==null)return{};var n=Vge(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Vge(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Yge=function(e,n,r,i,s,a){return"M".concat(e,",").concat(s,"v").concat(i,"M").concat(a,",").concat(n,"h").concat(r)},Xge=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i,a=e.top,o=a===void 0?0:a,l=e.left,u=l===void 0?0:l,d=e.width,f=d===void 0?0:d,p=e.height,m=p===void 0?0:p,y=e.className,g=Kge(e,zge),v=Wge({x:r,y:s,top:o,left:u,width:f,height:m},g);return!oe(r)||!oe(s)||!oe(f)||!oe(m)||!oe(o)||!oe(u)?null:D.createElement("path",yC({},xe(v,!0),{className:Ee("recharts-cross",y),d:Yge(r,s,f,m,o,u)}))},Qge=VA,Jge=G6,Zge=oo;function eye(t,e){return t&&t.length?Qge(t,Zge(e),Jge):void 0}var tye=eye;const nye=at(tye);var rye=VA,iye=oo,sye=K6;function aye(t,e){return t&&t.length?rye(t,iye(e),sye):void 0}var oye=aye;const lye=at(oye);var cye=["cx","cy","angle","ticks","axisLine"],uye=["ticks","tick","angle","tickFormatter","stroke"];function pg(t){"@babel/helpers - typeof";return pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pg(t)}function v0(){return v0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v0.apply(this,arguments)}function q$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ru(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?q$(Object(n),!0).forEach(function(r){JA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function G$(t,e){if(t==null)return{};var n=dye(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dye(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function hye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,DU(r.key),r)}}function fye(t,e,n){return e&&K$(t.prototype,e),n&&K$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pye(t,e,n){return e=X_(e),mye(t,IU()?Reflect.construct(e,n||[],X_(t).constructor):e.apply(t,n))}function mye(t,e){if(e&&(pg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gye(t)}function gye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IU=function(){return!!t})()}function X_(t){return X_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},X_(t)}function yye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vC(t,e)}function vC(t,e){return vC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},vC(t,e)}function JA(t,e,n){return e=DU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DU(t){var e=vye(t,"string");return pg(e)=="symbol"?e:e+""}function vye(t,e){if(pg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(pg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ZA=function(t){function e(){return hye(this,e),pye(this,e,arguments)}return yye(e,t),fye(e,[{key:"getTickValueCoord",value:function(r){var i=r.coordinate,s=this.props,a=s.angle,o=s.cx,l=s.cy;return Et(o,l,i,a)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,i;switch(r){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var r=this.props,i=r.cx,s=r.cy,a=r.angle,o=r.ticks,l=nye(o,function(d){return d.coordinate||0}),u=lye(o,function(d){return d.coordinate||0});return{cx:i,cy:s,startAngle:a,endAngle:a,innerRadius:u.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.cx,s=r.cy,a=r.angle,o=r.ticks,l=r.axisLine,u=G$(r,cye),d=o.reduce(function(y,g){return[Math.min(y[0],g.coordinate),Math.max(y[1],g.coordinate)]},[1/0,-1/0]),f=Et(i,s,d[0],a),p=Et(i,s,d[1],a),m=Ru(Ru(Ru({},xe(u,!1)),{},{fill:"none"},xe(l,!1)),{},{x1:f.x,y1:f.y,x2:p.x,y2:p.y});return D.createElement("line",v0({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var r=this,i=this.props,s=i.ticks,a=i.tick,o=i.angle,l=i.tickFormatter,u=i.stroke,d=G$(i,uye),f=this.getTickTextAnchor(),p=xe(d,!1),m=xe(a,!1),y=s.map(function(g,v){var b=r.getTickValueCoord(g),x=Ru(Ru(Ru(Ru({textAnchor:f,transform:"rotate(".concat(90-o,", ").concat(b.x,", ").concat(b.y,")")},p),{},{stroke:"none",fill:u},m),{},{index:v},b),{},{payload:g});return D.createElement(Re,v0({className:Ee("recharts-polar-radius-axis-tick",wU(a)),key:"tick-".concat(g.coordinate)},gu(r.props,g,v)),e.renderTickItem(a,x,l?l(g.value,v):g.value))});return D.createElement(Re,{className:"recharts-polar-radius-axis-ticks"},y)}},{key:"render",value:function(){var r=this.props,i=r.ticks,s=r.axisLine,a=r.tick;return!i||!i.length?null:D.createElement(Re,{className:Ee("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),a&&this.renderTicks(),Un.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,i,s){var a;return D.isValidElement(r)?a=D.cloneElement(r,i):_e(r)?a=r(i):a=D.createElement(qh,v0({},i,{className:"recharts-polar-radius-axis-tick-value"}),s),a}}])}(T.PureComponent);JA(ZA,"displayName","PolarRadiusAxis");JA(ZA,"axisType","radiusAxis");JA(ZA,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function mg(t){"@babel/helpers - typeof";return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mg(t)}function Yu(){return Yu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yu.apply(this,arguments)}function V$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Iu(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V$(Object(n),!0).forEach(function(r){ej(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y$(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,LU(r.key),r)}}function bye(t,e,n){return e&&Y$(t.prototype,e),n&&Y$(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wye(t,e,n){return e=Q_(e),_ye(t,$U()?Reflect.construct(e,n||[],Q_(t).constructor):e.apply(t,n))}function _ye(t,e){if(e&&(mg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sye(t)}function Sye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $U(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($U=function(){return!!t})()}function Q_(t){return Q_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Q_(t)}function Aye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xC(t,e)}function xC(t,e){return xC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},xC(t,e)}function ej(t,e,n){return e=LU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LU(t){var e=jye(t,"string");return mg(e)=="symbol"?e:e+""}function jye(t,e){if(mg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(mg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var kye=Math.PI/180,X$=1e-5,tj=function(t){function e(){return xye(this,e),wye(this,e,arguments)}return Aye(e,t),bye(e,[{key:"getTickLineCoord",value:function(r){var i=this.props,s=i.cx,a=i.cy,o=i.radius,l=i.orientation,u=i.tickSize,d=u||8,f=Et(s,a,o,r.coordinate),p=Et(s,a,o+(l==="inner"?-1:1)*d,r.coordinate);return{x1:f.x,y1:f.y,x2:p.x,y2:p.y}}},{key:"getTickTextAnchor",value:function(r){var i=this.props.orientation,s=Math.cos(-r.coordinate*kye),a;return s>X$?a=i==="outer"?"start":"end":s<-X$?a=i==="outer"?"end":"start":a="middle",a}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.cx,s=r.cy,a=r.radius,o=r.axisLine,l=r.axisLineType,u=Iu(Iu({},xe(this.props,!1)),{},{fill:"none"},xe(o,!1));if(l==="circle")return D.createElement(Bb,Yu({className:"recharts-polar-angle-axis-line"},u,{cx:i,cy:s,r:a}));var d=this.props.ticks,f=d.map(function(p){return Et(i,s,a,p.coordinate)});return D.createElement(Uge,Yu({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var r=this,i=this.props,s=i.ticks,a=i.tick,o=i.tickLine,l=i.tickFormatter,u=i.stroke,d=xe(this.props,!1),f=xe(a,!1),p=Iu(Iu({},d),{},{fill:"none"},xe(o,!1)),m=s.map(function(y,g){var v=r.getTickLineCoord(y),b=r.getTickTextAnchor(y),x=Iu(Iu(Iu({textAnchor:b},d),{},{stroke:"none",fill:u},f),{},{index:g,payload:y,x:v.x2,y:v.y2});return D.createElement(Re,Yu({className:Ee("recharts-polar-angle-axis-tick",wU(a)),key:"tick-".concat(y.coordinate)},gu(r.props,y,g)),o&&D.createElement("line",Yu({className:"recharts-polar-angle-axis-tick-line"},p,v)),a&&e.renderTickItem(a,x,l?l(y.value,g):y.value))});return D.createElement(Re,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var r=this.props,i=r.ticks,s=r.radius,a=r.axisLine;return s<=0||!i||!i.length?null:D.createElement(Re,{className:Ee("recharts-polar-angle-axis",this.props.className)},a&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,i,s){var a;return D.isValidElement(r)?a=D.cloneElement(r,i):_e(r)?a=r(i):a=D.createElement(qh,Yu({},i,{className:"recharts-polar-angle-axis-tick-value"}),s),a}}])}(T.PureComponent);ej(tj,"displayName","PolarAngleAxis");ej(tj,"axisType","angleAxis");ej(tj,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Nye=z5,Eye=Nye(Object.getPrototypeOf,Object),Cye=Eye,Pye=El,Tye=Cye,Oye=Cl,Mye="[object Object]",Rye=Function.prototype,Iye=Object.prototype,FU=Rye.toString,Dye=Iye.hasOwnProperty,$ye=FU.call(Object);function Lye(t){if(!Oye(t)||Pye(t)!=Mye)return!1;var e=Tye(t);if(e===null)return!0;var n=Dye.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&FU.call(n)==$ye}var Fye=Lye;const Bye=at(Fye);var Uye=El,zye=Cl,Wye="[object Boolean]";function Hye(t){return t===!0||t===!1||zye(t)&&Uye(t)==Wye}var qye=Hye;const Gye=at(qye);function pv(t){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pv(t)}function J_(){return J_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},J_.apply(this,arguments)}function Kye(t,e){return Qye(t)||Xye(t,e)||Yye(t,e)||Vye()}function Vye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yye(t,e){if(t){if(typeof t=="string")return Q$(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q$(t,e)}}function Q$(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xye(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Qye(t){if(Array.isArray(t))return t}function J$(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Z$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?J$(Object(n),!0).forEach(function(r){Jye(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J$(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jye(t,e,n){return e=Zye(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zye(t){var e=e0e(t,"string");return pv(e)=="symbol"?e:e+""}function e0e(t,e){if(pv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(pv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eL=function(e,n,r,i,s){var a=r-i,o;return o="M ".concat(e,",").concat(n),o+="L ".concat(e+r,",").concat(n),o+="L ".concat(e+r-a/2,",").concat(n+s),o+="L ".concat(e+r-a/2-i,",").concat(n+s),o+="L ".concat(e,",").concat(n," Z"),o},t0e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},n0e=function(e){var n=Z$(Z$({},t0e),e),r=T.useRef(),i=T.useState(-1),s=Kye(i,2),a=s[0],o=s[1];T.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var w=r.current.getTotalLength();w&&o(w)}catch{}},[]);var l=n.x,u=n.y,d=n.upperWidth,f=n.lowerWidth,p=n.height,m=n.className,y=n.animationEasing,g=n.animationDuration,v=n.animationBegin,b=n.isUpdateAnimationActive;if(l!==+l||u!==+u||d!==+d||f!==+f||p!==+p||d===0&&f===0||p===0)return null;var x=Ee("recharts-trapezoid",m);return b?D.createElement(Es,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:p,x:l,y:u},to:{upperWidth:d,lowerWidth:f,height:p,x:l,y:u},duration:g,animationEasing:y,isActive:b},function(w){var S=w.upperWidth,_=w.lowerWidth,A=w.height,j=w.x,N=w.y;return D.createElement(Es,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:y},D.createElement("path",J_({},xe(n,!0),{className:x,d:eL(j,N,S,_,A),ref:r})))}):D.createElement("g",null,D.createElement("path",J_({},xe(n,!0),{className:x,d:eL(l,u,d,f,p)})))},r0e=["option","shapeType","propTransformer","activeClassName","isActive"];function mv(t){"@babel/helpers - typeof";return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mv(t)}function i0e(t,e){if(t==null)return{};var n=s0e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function s0e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function tL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Z_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tL(Object(n),!0).forEach(function(r){a0e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function a0e(t,e,n){return e=o0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o0e(t){var e=l0e(t,"string");return mv(e)=="symbol"?e:e+""}function l0e(t,e){if(mv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(mv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c0e(t,e){return Z_(Z_({},e),t)}function u0e(t,e){return t==="symbols"}function nL(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return D.createElement(bO,n);case"trapezoid":return D.createElement(n0e,n);case"sector":return D.createElement(AU,n);case"symbols":if(u0e(e))return D.createElement(LA,n);break;default:return null}}function d0e(t){return T.isValidElement(t)?t.props:t}function eS(t){var e=t.option,n=t.shapeType,r=t.propTransformer,i=r===void 0?c0e:r,s=t.activeClassName,a=s===void 0?"recharts-active-shape":s,o=t.isActive,l=i0e(t,r0e),u;if(T.isValidElement(e))u=T.cloneElement(e,Z_(Z_({},l),d0e(e)));else if(_e(e))u=e(l);else if(Bye(e)&&!Gye(e)){var d=i(e,l);u=D.createElement(nL,{shapeType:n,elementProps:d})}else{var f=l;u=D.createElement(nL,{shapeType:n,elementProps:f})}return o?D.createElement(Re,{className:a},u):u}function nj(t,e){return e!=null&&"trapezoids"in t.props}function rj(t,e){return e!=null&&"sectors"in t.props}function gv(t,e){return e!=null&&"points"in t.props}function h0e(t,e){var n,r,i=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,s=t.y===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.y)||t.y===e.y;return i&&s}function f0e(t,e){var n=t.endAngle===e.endAngle,r=t.startAngle===e.startAngle;return n&&r}function p0e(t,e){var n=t.x===e.x,r=t.y===e.y,i=t.z===e.z;return n&&r&&i}function m0e(t,e){var n;return nj(t,e)?n=h0e:rj(t,e)?n=f0e:gv(t,e)&&(n=p0e),n}function g0e(t,e){var n;return nj(t,e)?n="trapezoids":rj(t,e)?n="sectors":gv(t,e)&&(n="points"),n}function y0e(t,e){if(nj(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(rj(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return gv(t,e)?e.payload:{}}function v0e(t){var e=t.activeTooltipItem,n=t.graphicalItem,r=t.itemData,i=g0e(n,e),s=y0e(n,e),a=r.filter(function(l,u){var d=yu(s,l),f=n.props[i].filter(function(y){var g=m0e(n,e);return g(y,e)}),p=n.props[i].indexOf(f[f.length-1]),m=u===p;return d&&m}),o=r.indexOf(a[a.length-1]);return o}var i1;function gg(t){"@babel/helpers - typeof";return gg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gg(t)}function Gf(){return Gf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gf.apply(this,arguments)}function rL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rL(Object(n),!0).forEach(function(r){ys(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function x0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,UU(r.key),r)}}function b0e(t,e,n){return e&&iL(t.prototype,e),n&&iL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function w0e(t,e,n){return e=tS(e),_0e(t,BU()?Reflect.construct(e,n||[],tS(t).constructor):e.apply(t,n))}function _0e(t,e){if(e&&(gg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S0e(t)}function S0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function BU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BU=function(){return!!t})()}function tS(t){return tS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tS(t)}function A0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bC(t,e)}function bC(t,e){return bC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},bC(t,e)}function ys(t,e,n){return e=UU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UU(t){var e=j0e(t,"string");return gg(e)=="symbol"?e:e+""}function j0e(t,e){if(gg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(gg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Ol=function(t){function e(n){var r;return x0e(this,e),r=w0e(this,e,[n]),ys(r,"pieRef",null),ys(r,"sectorRefs",[]),ys(r,"id",ku("recharts-pie-")),ys(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),_e(i)&&i()}),ys(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),_e(i)&&i()}),r.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},r}return A0e(e,t),b0e(e,[{key:"isActiveIndex",value:function(r){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(r)!==-1:r===i}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var s=this.props,a=s.label,o=s.labelLine,l=s.dataKey,u=s.valueKey,d=xe(this.props,!1),f=xe(a,!1),p=xe(o,!1),m=a&&a.offsetRadius||20,y=r.map(function(g,v){var b=(g.startAngle+g.endAngle)/2,x=Et(g.cx,g.cy,g.outerRadius+m,b),w=At(At(At(At({},d),g),{},{stroke:"none"},f),{},{index:v,textAnchor:e.getTextAnchor(x.x,g.cx)},x),S=At(At(At(At({},d),g),{},{fill:"none",stroke:g.fill},p),{},{index:v,points:[Et(g.cx,g.cy,g.outerRadius,b),x]}),_=l;return we(l)&&we(u)?_="value":we(l)&&(_=u),D.createElement(Re,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(v)},o&&e.renderLabelLineItem(o,S,"line"),e.renderLabelItem(a,w,Mt(g,_)))});return D.createElement(Re,{className:"recharts-pie-labels"},y)}},{key:"renderSectorsStatically",value:function(r){var i=this,s=this.props,a=s.activeShape,o=s.blendStroke,l=s.inactiveShape;return r.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&r.length!==1)return null;var f=i.isActiveIndex(d),p=l&&i.hasActiveIndex()?l:null,m=f?a:p,y=At(At({},u),{},{stroke:o?u.fill:u.stroke,tabIndex:-1});return D.createElement(Re,Gf({ref:function(v){v&&!i.sectorRefs.includes(v)&&i.sectorRefs.push(v)},tabIndex:-1,className:"recharts-pie-sector"},gu(i.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),D.createElement(eS,Gf({option:m,isActive:f,shapeType:"sector"},y)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,i=this.props,s=i.sectors,a=i.isAnimationActive,o=i.animationBegin,l=i.animationDuration,u=i.animationEasing,d=i.animationId,f=this.state,p=f.prevSectors,m=f.prevIsAnimationActive;return D.createElement(Es,{begin:o,duration:l,isActive:a,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(y){var g=y.t,v=[],b=s&&s[0],x=b.startAngle;return s.forEach(function(w,S){var _=p&&p[S],A=S>0?Hi(w,"paddingAngle",0):0;if(_){var j=Ht(_.endAngle-_.startAngle,w.endAngle-w.startAngle),N=At(At({},w),{},{startAngle:x+A,endAngle:x+j(g)+A});v.push(N),x=N.endAngle}else{var P=w.endAngle,O=w.startAngle,M=Ht(0,P-O),R=M(g),I=At(At({},w),{},{startAngle:x+A,endAngle:x+R+A});v.push(I),x=I.endAngle}}),D.createElement(Re,null,r.renderSectorsStatically(v))})}},{key:"attachKeyboardHandlers",value:function(r){var i=this;r.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var a=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[a].focus(),i.setState({sectorToFocus:a});break}case"ArrowRight":{var o=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[o].focus(),i.setState({sectorToFocus:o});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,i=r.sectors,s=r.isAnimationActive,a=this.state.prevSectors;return s&&i&&i.length&&(!a||!yu(a,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,i=this.props,s=i.hide,a=i.sectors,o=i.className,l=i.label,u=i.cx,d=i.cy,f=i.innerRadius,p=i.outerRadius,m=i.isAnimationActive,y=this.state.isAnimationFinished;if(s||!a||!a.length||!oe(u)||!oe(d)||!oe(f)||!oe(p))return null;var g=Ee("recharts-pie",o);return D.createElement(Re,{tabIndex:this.props.rootTabIndex,className:g,ref:function(b){r.pieRef=b}},this.renderSectors(),l&&this.renderLabels(a),Un.renderCallByParent(this.props,null,!1),(!m||y)&&da.renderCallByParent(this.props,a,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return i.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:r.sectors!==i.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,i){return r>i?"start":r<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,i,s){if(D.isValidElement(r))return D.cloneElement(r,i);if(_e(r))return r(i);var a=Ee("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return D.createElement(fu,Gf({},i,{key:s,type:"linear",className:a}))}},{key:"renderLabelItem",value:function(r,i,s){if(D.isValidElement(r))return D.cloneElement(r,i);var a=s;if(_e(r)&&(a=r(i),D.isValidElement(a)))return a;var o=Ee("recharts-pie-label-text",typeof r!="boolean"&&!_e(r)?r.className:"");return D.createElement(qh,Gf({},i,{alignmentBaseline:"middle",className:o}),a)}}])}(T.PureComponent);i1=Ol;ys(Ol,"displayName","Pie");ys(Ol,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Pl.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});ys(Ol,"parseDeltaAngle",function(t,e){var n=Mr(e-t),r=Math.min(Math.abs(e-t),360);return n*r});ys(Ol,"getRealPieData",function(t){var e=t.data,n=t.children,r=xe(t,!1),i=Lr(n,Kg);return e&&e.length?e.map(function(s,a){return At(At(At({payload:s},r),s),i&&i[a]&&i[a].props)}):i&&i.length?i.map(function(s){return At(At({},r),s.props)}):[]});ys(Ol,"parseCoordinateOfPie",function(t,e){var n=e.top,r=e.left,i=e.width,s=e.height,a=bU(i,s),o=r+Rr(t.cx,i,i/2),l=n+Rr(t.cy,s,s/2),u=Rr(t.innerRadius,a,0),d=Rr(t.outerRadius,a,a*.8),f=t.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:o,cy:l,innerRadius:u,outerRadius:d,maxRadius:f}});ys(Ol,"getComposedData",function(t){var e=t.item,n=t.offset,r=e.type.defaultProps!==void 0?At(At({},e.type.defaultProps),e.props):e.props,i=i1.getRealPieData(r);if(!i||!i.length)return null;var s=r.cornerRadius,a=r.startAngle,o=r.endAngle,l=r.paddingAngle,u=r.dataKey,d=r.nameKey,f=r.valueKey,p=r.tooltipType,m=Math.abs(r.minAngle),y=i1.parseCoordinateOfPie(r,n),g=i1.parseDeltaAngle(a,o),v=Math.abs(g),b=u;we(u)&&we(f)?(ua(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b="value"):we(u)&&(ua(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),b=f);var x=i.filter(function(N){return Mt(N,b,0)!==0}).length,w=(v>=360?x:x-1)*l,S=v-x*m-w,_=i.reduce(function(N,P){var O=Mt(P,b,0);return N+(oe(O)?O:0)},0),A;if(_>0){var j;A=i.map(function(N,P){var O=Mt(N,b,0),M=Mt(N,d,P),R=(oe(O)?O:0)/_,I;P?I=j.endAngle+Mr(g)*l*(O!==0?1:0):I=a;var L=I+Mr(g)*((O!==0?m:0)+R*S),W=(I+L)/2,F=(y.innerRadius+y.outerRadius)/2,z=[{name:M,value:O,payload:N,dataKey:b,type:p}],U=Et(y.cx,y.cy,F,W);return j=At(At(At({percent:R,cornerRadius:s,name:M,tooltipPayload:z,midAngle:W,middleRadius:F,tooltipPosition:U},N),y),{},{value:Mt(N,b),startAngle:I,endAngle:L,payload:N,paddingAngle:Mr(g)*l}),j})}return At(At({},y),{},{sectors:A,data:i})});var k0e=Math.ceil,N0e=Math.max;function E0e(t,e,n,r){for(var i=-1,s=N0e(k0e((e-t)/(n||1)),0),a=Array(s);s--;)a[r?s:++i]=t,t+=n;return a}var C0e=E0e,P0e=o6,sL=1/0,T0e=17976931348623157e292;function O0e(t){if(!t)return t===0?t:0;if(t=P0e(t),t===sL||t===-sL){var e=t<0?-1:1;return e*T0e}return t===t?t:0}var zU=O0e,M0e=C0e,R0e=UA,Pk=zU;function I0e(t){return function(e,n,r){return r&&typeof r!="number"&&R0e(e,n,r)&&(n=r=void 0),e=Pk(e),n===void 0?(n=e,e=0):n=Pk(n),r=r===void 0?e<n?1:-1:Pk(r),M0e(e,n,r,t)}}var D0e=I0e,$0e=D0e,L0e=$0e(),F0e=L0e;const nS=at(F0e);function yv(t){"@babel/helpers - typeof";return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yv(t)}function aL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function oL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aL(Object(n),!0).forEach(function(r){WU(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function WU(t,e,n){return e=B0e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B0e(t){var e=U0e(t,"string");return yv(e)=="symbol"?e:e+""}function U0e(t,e){if(yv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(yv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z0e=["Webkit","Moz","O","ms"],W0e=function(e,n){var r=e.replace(/(\w)/,function(s){return s.toUpperCase()}),i=z0e.reduce(function(s,a){return oL(oL({},s),{},WU({},a+r,n))},{});return i[e]=n,i};function yg(t){"@babel/helpers - typeof";return yg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yg(t)}function rS(){return rS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rS.apply(this,arguments)}function lL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Tk(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?lL(Object(n),!0).forEach(function(r){yi(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function H0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qU(r.key),r)}}function q0e(t,e,n){return e&&cL(t.prototype,e),n&&cL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function G0e(t,e,n){return e=iS(e),K0e(t,HU()?Reflect.construct(e,n||[],iS(t).constructor):e.apply(t,n))}function K0e(t,e){if(e&&(yg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V0e(t)}function V0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HU=function(){return!!t})()}function iS(t){return iS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},iS(t)}function Y0e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wC(t,e)}function wC(t,e){return wC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},wC(t,e)}function yi(t,e,n){return e=qU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qU(t){var e=X0e(t,"string");return yg(e)=="symbol"?e:e+""}function X0e(t,e){if(yg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(yg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Q0e=function(e){var n=e.data,r=e.startIndex,i=e.endIndex,s=e.x,a=e.width,o=e.travellerWidth;if(!n||!n.length)return{};var l=n.length,u=p0().domain(nS(0,l)).range([s,s+a-o]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(r),endX:u(i),scale:u,scaleValues:d}},uL=function(e){return e.changedTouches&&!!e.changedTouches.length},vg=function(t){function e(n){var r;return H0e(this,e),r=G0e(this,e,[n]),yi(r,"handleDrag",function(i){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(i):r.state.isSlideMoving&&r.handleSlideDrag(i)}),yi(r,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&r.handleDrag(i.changedTouches[0])}),yi(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=r.props,s=i.endIndex,a=i.onDragEnd,o=i.startIndex;a==null||a({endIndex:s,startIndex:o})}),r.detachDragEndListener()}),yi(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),yi(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),yi(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),yi(r,"handleSlideDragStart",function(i){var s=uL(i)?i.changedTouches[0]:i;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return Y0e(e,t),q0e(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var i=r.startX,s=r.endX,a=this.state.scaleValues,o=this.props,l=o.gap,u=o.data,d=u.length-1,f=Math.min(i,s),p=Math.max(i,s),m=e.getIndexInRange(a,f),y=e.getIndexInRange(a,p);return{startIndex:m-m%l,endIndex:y===d?d:y-y%l}}},{key:"getTextOfTick",value:function(r){var i=this.props,s=i.data,a=i.tickFormatter,o=i.dataKey,l=Mt(s[r],o,r);return _e(a)?a(l,r):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var i=this.state,s=i.slideMoveStartX,a=i.startX,o=i.endX,l=this.props,u=l.x,d=l.width,f=l.travellerWidth,p=l.startIndex,m=l.endIndex,y=l.onChange,g=r.pageX-s;g>0?g=Math.min(g,u+d-f-o,u+d-f-a):g<0&&(g=Math.max(g,u-a,u-o));var v=this.getIndex({startX:a+g,endX:o+g});(v.startIndex!==p||v.endIndex!==m)&&y&&y(v),this.setState({startX:a+g,endX:o+g,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,i){var s=uL(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var i=this.state,s=i.brushMoveStartX,a=i.movingTravellerId,o=i.endX,l=i.startX,u=this.state[a],d=this.props,f=d.x,p=d.width,m=d.travellerWidth,y=d.onChange,g=d.gap,v=d.data,b={startX:this.state.startX,endX:this.state.endX},x=r.pageX-s;x>0?x=Math.min(x,f+p-m-u):x<0&&(x=Math.max(x,f-u)),b[a]=u+x;var w=this.getIndex(b),S=w.startIndex,_=w.endIndex,A=function(){var N=v.length-1;return a==="startX"&&(o>l?S%g===0:_%g===0)||o<l&&_===N||a==="endX"&&(o>l?_%g===0:S%g===0)||o>l&&_===N};this.setState(yi(yi({},a,u+x),"brushMoveStartX",r.pageX),function(){y&&A()&&y(w)})}},{key:"handleTravellerMoveKeyboard",value:function(r,i){var s=this,a=this.state,o=a.scaleValues,l=a.startX,u=a.endX,d=this.state[i],f=o.indexOf(d);if(f!==-1){var p=f+r;if(!(p===-1||p>=o.length)){var m=o[p];i==="startX"&&m>=u||i==="endX"&&m<=l||this.setState(yi({},i,m),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.fill,u=r.stroke;return D.createElement("rect",{stroke:u,fill:l,x:i,y:s,width:a,height:o})}},{key:"renderPanorama",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.data,u=r.children,d=r.padding,f=T.Children.only(u);return f?D.cloneElement(f,{x:i,y:s,width:a,height:o,margin:d,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(r,i){var s,a,o=this,l=this.props,u=l.y,d=l.travellerWidth,f=l.height,p=l.traveller,m=l.ariaLabel,y=l.data,g=l.startIndex,v=l.endIndex,b=Math.max(r,this.props.x),x=Tk(Tk({},xe(this.props,!1)),{},{x:b,y:u,width:d,height:f}),w=m||"Min value: ".concat((s=y[g])===null||s===void 0?void 0:s.name,", Max value: ").concat((a=y[v])===null||a===void 0?void 0:a.name);return D.createElement(Re,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),o.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,i))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(p,x))}},{key:"renderSlide",value:function(r,i){var s=this.props,a=s.y,o=s.height,l=s.stroke,u=s.travellerWidth,d=Math.min(r,i)+u,f=Math.max(Math.abs(i-r)-u,0);return D.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:d,y:a,width:f,height:o})}},{key:"renderText",value:function(){var r=this.props,i=r.startIndex,s=r.endIndex,a=r.y,o=r.height,l=r.travellerWidth,u=r.stroke,d=this.state,f=d.startX,p=d.endX,m=5,y={pointerEvents:"none",fill:u};return D.createElement(Re,{className:"recharts-brush-texts"},D.createElement(qh,rS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,p)-m,y:a+o/2},y),this.getTextOfTick(i)),D.createElement(qh,rS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,p)+l+m,y:a+o/2},y),this.getTextOfTick(s)))}},{key:"render",value:function(){var r=this.props,i=r.data,s=r.className,a=r.children,o=r.x,l=r.y,u=r.width,d=r.height,f=r.alwaysShowText,p=this.state,m=p.startX,y=p.endX,g=p.isTextActive,v=p.isSlideMoving,b=p.isTravellerMoving,x=p.isTravellerFocused;if(!i||!i.length||!oe(o)||!oe(l)||!oe(u)||!oe(d)||u<=0||d<=0)return null;var w=Ee("recharts-brush",s),S=D.Children.count(a)===1,_=W0e("userSelect","none");return D.createElement(Re,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),S&&this.renderPanorama(),this.renderSlide(m,y),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(y,"endX"),(g||v||b||x||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var i=r.x,s=r.y,a=r.width,o=r.height,l=r.stroke,u=Math.floor(s+o/2)-1;return D.createElement(D.Fragment,null,D.createElement("rect",{x:i,y:s,width:a,height:o,fill:l,stroke:"none"}),D.createElement("line",{x1:i+1,y1:u,x2:i+a-1,y2:u,fill:"none",stroke:"#fff"}),D.createElement("line",{x1:i+1,y1:u+2,x2:i+a-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,i){var s;return D.isValidElement(r)?s=D.cloneElement(r,i):_e(r)?s=r(i):s=e.renderDefaultTraveller(i),s}},{key:"getDerivedStateFromProps",value:function(r,i){var s=r.data,a=r.width,o=r.x,l=r.travellerWidth,u=r.updateId,d=r.startIndex,f=r.endIndex;if(s!==i.prevData||u!==i.prevUpdateId)return Tk({prevData:s,prevTravellerWidth:l,prevUpdateId:u,prevX:o,prevWidth:a},s&&s.length?Q0e({data:s,width:a,x:o,travellerWidth:l,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(i.scale&&(a!==i.prevWidth||o!==i.prevX||l!==i.prevTravellerWidth)){i.scale.range([o,o+a-l]);var p=i.scale.domain().map(function(m){return i.scale(m)});return{prevData:s,prevTravellerWidth:l,prevUpdateId:u,prevX:o,prevWidth:a,startX:i.scale(r.startIndex),endX:i.scale(r.endIndex),scaleValues:p}}return null}},{key:"getIndexInRange",value:function(r,i){for(var s=r.length,a=0,o=s-1;o-a>1;){var l=Math.floor((a+o)/2);r[l]>i?o=l:a=l}return i>=r[o]?o:a}}])}(T.PureComponent);yi(vg,"displayName","Brush");yi(vg,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var J0e=GT;function Z0e(t,e){var n;return J0e(t,function(r,i,s){return n=e(r,i,s),!n}),!!n}var eve=Z0e,tve=R5,nve=oo,rve=eve,ive=hi,sve=UA;function ave(t,e,n){var r=ive(t)?tve:rve;return n&&sve(t,e,n)&&(e=void 0),r(t,nve(e))}var ove=ave;const lve=at(ove);var eo=function(e,n){var r=e.alwaysShow,i=e.ifOverflow;return r&&(i="extendDomain"),i===n},dL=n6;function cve(t,e,n){e=="__proto__"&&dL?dL(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var uve=cve,dve=uve,hve=e6,fve=oo;function pve(t,e){var n={};return e=fve(e),hve(t,function(r,i,s){dve(n,i,e(r,i,s))}),n}var mve=pve;const gve=at(mve);function yve(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}var vve=yve,xve=GT;function bve(t,e){var n=!0;return xve(t,function(r,i,s){return n=!!e(r,i,s),n}),n}var wve=bve,_ve=vve,Sve=wve,Ave=oo,jve=hi,kve=UA;function Nve(t,e,n){var r=jve(t)?_ve:Sve;return n&&kve(t,e,n)&&(e=void 0),r(t,Ave(e))}var Eve=Nve;const GU=at(Eve);var Cve=["x","y"];function vv(t){"@babel/helpers - typeof";return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vv(t)}function _C(){return _C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_C.apply(this,arguments)}function hL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hL(Object(n),!0).forEach(function(r){Pve(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Pve(t,e,n){return e=Tve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tve(t){var e=Ove(t,"string");return vv(e)=="symbol"?e:e+""}function Ove(t,e){if(vv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(vv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mve(t,e){if(t==null)return{};var n=Rve(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Rve(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Ive(t,e){var n=t.x,r=t.y,i=Mve(t,Cve),s="".concat(n),a=parseInt(s,10),o="".concat(r),l=parseInt(o,10),u="".concat(e.height||i.height),d=parseInt(u,10),f="".concat(e.width||i.width),p=parseInt(f,10);return vy(vy(vy(vy(vy({},e),i),a?{x:a}:{}),l?{y:l}:{}),{},{height:d,width:p,name:e.name,radius:e.radius})}function fL(t){return D.createElement(eS,_C({shapeType:"rectangle",propTransformer:Ive,activeClassName:"recharts-active-bar"},t))}var Dve=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,i){if(typeof e=="number")return e;var s=oe(r)||aJ(r);return s?e(r,i):(s||Kh(),n)}},$ve=["value","background"],KU;function xg(t){"@babel/helpers - typeof";return xg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xg(t)}function Lve(t,e){if(t==null)return{};var n=Fve(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Fve(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function sS(){return sS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sS.apply(this,arguments)}function pL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function hn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pL(Object(n),!0).forEach(function(r){tu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,YU(r.key),r)}}function Uve(t,e,n){return e&&mL(t.prototype,e),n&&mL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zve(t,e,n){return e=aS(e),Wve(t,VU()?Reflect.construct(e,n||[],aS(t).constructor):e.apply(t,n))}function Wve(t,e){if(e&&(xg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hve(t)}function Hve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VU(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VU=function(){return!!t})()}function aS(t){return aS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},aS(t)}function qve(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SC(t,e)}function SC(t,e){return SC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},SC(t,e)}function tu(t,e,n){return e=YU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YU(t){var e=Gve(t,"string");return xg(e)=="symbol"?e:e+""}function Gve(t,e){if(xg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(xg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var br=function(t){function e(){var n;Bve(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=zve(this,e,[].concat(i)),tu(n,"state",{isAnimationFinished:!1}),tu(n,"id",ku("recharts-bar-")),tu(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),a&&a()}),tu(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),a&&a()}),n}return qve(e,t),Uve(e,[{key:"renderRectanglesStatically",value:function(r){var i=this,s=this.props,a=s.shape,o=s.dataKey,l=s.activeIndex,u=s.activeBar,d=xe(this.props,!1);return r&&r.map(function(f,p){var m=p===l,y=m?u:a,g=hn(hn(hn({},d),f),{},{isActive:m,option:y,index:p,dataKey:o,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return D.createElement(Re,sS({className:"recharts-bar-rectangle"},gu(i.props,f,p),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(p)}),D.createElement(fL,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,i=this.props,s=i.data,a=i.layout,o=i.isAnimationActive,l=i.animationBegin,u=i.animationDuration,d=i.animationEasing,f=i.animationId,p=this.state.prevData;return D.createElement(Es,{begin:l,duration:u,isActive:o,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var y=m.t,g=s.map(function(v,b){var x=p&&p[b];if(x){var w=Ht(x.x,v.x),S=Ht(x.y,v.y),_=Ht(x.width,v.width),A=Ht(x.height,v.height);return hn(hn({},v),{},{x:w(y),y:S(y),width:_(y),height:A(y)})}if(a==="horizontal"){var j=Ht(0,v.height),N=j(y);return hn(hn({},v),{},{y:v.y+v.height-N,height:N})}var P=Ht(0,v.width),O=P(y);return hn(hn({},v),{},{width:O})});return D.createElement(Re,null,r.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var r=this.props,i=r.data,s=r.isAnimationActive,a=this.state.prevData;return s&&i&&i.length&&(!a||!yu(a,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var r=this,i=this.props,s=i.data,a=i.dataKey,o=i.activeIndex,l=xe(this.props.background,!1);return s.map(function(u,d){u.value;var f=u.background,p=Lve(u,$ve);if(!f)return null;var m=hn(hn(hn(hn(hn({},p),{},{fill:"#eee"},f),l),gu(r.props,u,d)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:a,index:d,className:"recharts-bar-background-rectangle"});return D.createElement(fL,sS({key:"background-bar-".concat(d),option:r.props.background,isActive:d===o},m))})}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,a=s.data,o=s.xAxis,l=s.yAxis,u=s.layout,d=s.children,f=Lr(d,Qg);if(!f)return null;var p=u==="vertical"?a[0].height/2:a[0].width/2,m=function(v,b){var x=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:x,errorVal:Mt(v,b)}},y={clipPath:r?"url(#clipPath-".concat(i,")"):null};return D.createElement(Re,y,f.map(function(g){return D.cloneElement(g,{key:"error-bar-".concat(i,"-").concat(g.props.dataKey),data:a,xAxis:o,yAxis:l,layout:u,offset:p,dataPointFormatter:m})}))}},{key:"render",value:function(){var r=this.props,i=r.hide,s=r.data,a=r.className,o=r.xAxis,l=r.yAxis,u=r.left,d=r.top,f=r.width,p=r.height,m=r.isAnimationActive,y=r.background,g=r.id;if(i||!s||!s.length)return null;var v=this.state.isAnimationFinished,b=Ee("recharts-bar",a),x=o&&o.allowDataOverflow,w=l&&l.allowDataOverflow,S=x||w,_=we(g)?this.id:g;return D.createElement(Re,{className:b},x||w?D.createElement("defs",null,D.createElement("clipPath",{id:"clipPath-".concat(_)},D.createElement("rect",{x:x?u:u-f/2,y:w?d:d-p/2,width:x?f:f*2,height:w?p:p*2}))):null,D.createElement(Re,{className:"recharts-bar-rectangles",clipPath:S?"url(#clipPath-".concat(_,")"):null},y?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(S,_),(!m||v)&&da.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:i.curData}:r.data!==i.curData?{curData:r.data}:null}}])}(T.PureComponent);KU=br;tu(br,"displayName","Bar");tu(br,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Pl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});tu(br,"getComposedData",function(t){var e=t.props,n=t.item,r=t.barPosition,i=t.bandSize,s=t.xAxis,a=t.yAxis,o=t.xAxisTicks,l=t.yAxisTicks,u=t.stackedData,d=t.dataStartIndex,f=t.displayedData,p=t.offset,m=jfe(r,n);if(!m)return null;var y=e.layout,g=n.type.defaultProps,v=g!==void 0?hn(hn({},g),n.props):n.props,b=v.dataKey,x=v.children,w=v.minPointSize,S=y==="horizontal"?a:s,_=u?S.scale.domain():null,A=Ofe({numericAxis:S}),j=Lr(x,Kg),N=f.map(function(P,O){var M,R,I,L,W,F;u?M=kfe(u[d+O],_):(M=Mt(P,b),Array.isArray(M)||(M=[A,M]));var z=Dve(w,KU.defaultProps.minPointSize)(M[1],O);if(y==="horizontal"){var U,K=[a.scale(M[0]),a.scale(M[1])],H=K[0],Q=K[1];R=i$({axis:s,ticks:o,bandSize:i,offset:m.offset,entry:P,index:O}),I=(U=Q??H)!==null&&U!==void 0?U:void 0,L=m.size;var B=H-Q;if(W=Number.isNaN(B)?0:B,F={x:R,y:a.y,width:L,height:a.height},Math.abs(z)>0&&Math.abs(W)<Math.abs(z)){var Y=Mr(W||z)*(Math.abs(z)-Math.abs(W));I-=Y,W+=Y}}else{var ne=[s.scale(M[0]),s.scale(M[1])],V=ne[0],te=ne[1];if(R=V,I=i$({axis:a,ticks:l,bandSize:i,offset:m.offset,entry:P,index:O}),L=te-V,W=m.size,F={x:s.x,y:I,width:s.width,height:W},Math.abs(z)>0&&Math.abs(L)<Math.abs(z)){var $=Mr(L||z)*(Math.abs(z)-Math.abs(L));L+=$}}return hn(hn(hn({},P),{},{x:R,y:I,width:L,height:W,value:u?M:M[1],payload:P,background:F},j&&j[O]&&j[O].props),{},{tooltipPayload:[vU(n,P)],tooltipPosition:{x:R+L/2,y:I+W/2}})});return hn({data:N,layout:y},p)});function xv(t){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(t)}function Kve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XU(r.key),r)}}function Vve(t,e,n){return e&&gL(t.prototype,e),n&&gL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function na(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yL(Object(n),!0).forEach(function(r){ij(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ij(t,e,n){return e=XU(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XU(t){var e=Yve(t,"string");return xv(e)=="symbol"?e:e+""}function Yve(t,e){if(xv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(xv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sj=function(e,n,r,i,s){var a=e.width,o=e.height,l=e.layout,u=e.children,d=Object.keys(n),f={left:r.left,leftMirror:r.left,right:a-r.right,rightMirror:a-r.right,top:r.top,topMirror:r.top,bottom:o-r.bottom,bottomMirror:o-r.bottom},p=!!Li(u,br);return d.reduce(function(m,y){var g=n[y],v=g.orientation,b=g.domain,x=g.padding,w=x===void 0?{}:x,S=g.mirror,_=g.reversed,A="".concat(v).concat(S?"Mirror":""),j,N,P,O,M;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var R=b[1]-b[0],I=1/0,L=g.categoricalDomain.sort(uJ);if(L.forEach(function(ne,V){V>0&&(I=Math.min((ne||0)-(L[V-1]||0),I))}),Number.isFinite(I)){var W=I/R,F=g.layout==="vertical"?r.height:r.width;if(g.padding==="gap"&&(j=W*F/2),g.padding==="no-gap"){var z=Rr(e.barCategoryGap,W*F),U=W*F/2;j=U-z-(U-z)/F*z}}}i==="xAxis"?N=[r.left+(w.left||0)+(j||0),r.left+r.width-(w.right||0)-(j||0)]:i==="yAxis"?N=l==="horizontal"?[r.top+r.height-(w.bottom||0),r.top+(w.top||0)]:[r.top+(w.top||0)+(j||0),r.top+r.height-(w.bottom||0)-(j||0)]:N=g.range,_&&(N=[N[1],N[0]]);var K=pU(g,s,p),H=K.scale,Q=K.realScaleType;H.domain(b).range(N),mU(H);var B=gU(H,na(na({},g),{},{realScaleType:Q}));i==="xAxis"?(M=v==="top"&&!S||v==="bottom"&&S,P=r.left,O=f[A]-M*g.height):i==="yAxis"&&(M=v==="left"&&!S||v==="right"&&S,P=f[A]-M*g.width,O=r.top);var Y=na(na(na({},g),B),{},{realScaleType:Q,x:P,y:O,scale:H,width:i==="xAxis"?r.width:g.width,height:i==="yAxis"?r.height:g.height});return Y.bandSize=W_(Y,B),!g.hide&&i==="xAxis"?f[A]+=(M?-1:1)*Y.height:g.hide||(f[A]+=(M?-1:1)*Y.width),na(na({},m),{},ij({},y,Y))},{})},QU=function(e,n){var r=e.x,i=e.y,s=n.x,a=n.y;return{x:Math.min(r,s),y:Math.min(i,a),width:Math.abs(s-r),height:Math.abs(a-i)}},Xve=function(e){var n=e.x1,r=e.y1,i=e.x2,s=e.y2;return QU({x:n,y:r},{x:i,y:s})},JU=function(){function t(e){Kve(this,t),this.scale=e}return Vve(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.bandAware,s=r.position;if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+a}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(n)+o}default:return this.scale(n)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),i=r[0],s=r[r.length-1];return i<=s?n>=i&&n<=s:n>=s&&n<=i}}],[{key:"create",value:function(n){return new t(n)}}])}();ij(JU,"EPS",1e-4);var wO=function(e){var n=Object.keys(e).reduce(function(r,i){return na(na({},r),{},ij({},i,JU.create(e[i])))},{});return na(na({},n),{},{apply:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,o=s.position;return gve(i,function(l,u){return n[u].apply(l,{bandAware:a,position:o})})},isInRange:function(i){return GU(i,function(s,a){return n[a].isInRange(s)})}})};function Qve(t){return(t%180+180)%180}var Jve=function(e){var n=e.width,r=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=Qve(i),a=s*Math.PI/180,o=Math.atan(r/n),l=a>o&&a<Math.PI-o?r/Math.sin(a):n/Math.cos(a);return Math.abs(l)},Zve=oo,exe=Ib,txe=FA;function nxe(t){return function(e,n,r){var i=Object(e);if(!exe(e)){var s=Zve(n);e=txe(e),n=function(o){return s(i[o],o,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:void 0}}var rxe=nxe,ixe=zU;function sxe(t){var e=ixe(t),n=e%1;return e===e?n?e-n:e:0}var axe=sxe,oxe=V5,lxe=oo,cxe=axe,uxe=Math.max;function dxe(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:cxe(n);return i<0&&(i=uxe(r+i,0)),oxe(t,lxe(e),i)}var hxe=dxe,fxe=rxe,pxe=hxe,mxe=fxe(pxe),gxe=mxe;const yxe=at(gxe);var vxe=hQ(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),_O=T.createContext(void 0),SO=T.createContext(void 0),ZU=T.createContext(void 0),e8=T.createContext({}),t8=T.createContext(void 0),n8=T.createContext(0),r8=T.createContext(0),vL=function(e){var n=e.state,r=n.xAxisMap,i=n.yAxisMap,s=n.offset,a=e.clipPathId,o=e.children,l=e.width,u=e.height,d=vxe(s);return D.createElement(_O.Provider,{value:r},D.createElement(SO.Provider,{value:i},D.createElement(e8.Provider,{value:s},D.createElement(ZU.Provider,{value:d},D.createElement(t8.Provider,{value:a},D.createElement(n8.Provider,{value:u},D.createElement(r8.Provider,{value:l},o)))))))},xxe=function(){return T.useContext(t8)},i8=function(e){var n=T.useContext(_O);n==null&&Kh();var r=n[e];return r==null&&Kh(),r},bxe=function(){var e=T.useContext(_O);return Xl(e)},wxe=function(){var e=T.useContext(SO),n=yxe(e,function(r){return GU(r.domain,Number.isFinite)});return n||Xl(e)},s8=function(e){var n=T.useContext(SO);n==null&&Kh();var r=n[e];return r==null&&Kh(),r},_xe=function(){var e=T.useContext(ZU);return e},Sxe=function(){return T.useContext(e8)},AO=function(){return T.useContext(r8)},jO=function(){return T.useContext(n8)};function bg(t){"@babel/helpers - typeof";return bg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bg(t)}function Axe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jxe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o8(r.key),r)}}function kxe(t,e,n){return e&&jxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nxe(t,e,n){return e=oS(e),Exe(t,a8()?Reflect.construct(e,n||[],oS(t).constructor):e.apply(t,n))}function Exe(t,e){if(e&&(bg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cxe(t)}function Cxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a8=function(){return!!t})()}function oS(t){return oS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},oS(t)}function Pxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AC(t,e)}function AC(t,e){return AC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},AC(t,e)}function xL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function bL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xL(Object(n),!0).forEach(function(r){kO(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kO(t,e,n){return e=o8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){var e=Txe(t,"string");return bg(e)=="symbol"?e:e+""}function Txe(t,e){if(bg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(bg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Oxe(t,e){return Dxe(t)||Ixe(t,e)||Rxe(t,e)||Mxe()}function Mxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rxe(t,e){if(t){if(typeof t=="string")return wL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wL(t,e)}}function wL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ixe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function Dxe(t){if(Array.isArray(t))return t}function jC(){return jC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jC.apply(this,arguments)}var $xe=function(e,n){var r;return D.isValidElement(e)?r=D.cloneElement(e,n):_e(e)?r=e(n):r=D.createElement("line",jC({},n,{className:"recharts-reference-line-line"})),r},Lxe=function(e,n,r,i,s,a,o,l,u){var d=s.x,f=s.y,p=s.width,m=s.height;if(r){var y=u.y,g=e.y.apply(y,{position:a});if(eo(u,"discard")&&!e.y.isInRange(g))return null;var v=[{x:d+p,y:g},{x:d,y:g}];return l==="left"?v.reverse():v}if(n){var b=u.x,x=e.x.apply(b,{position:a});if(eo(u,"discard")&&!e.x.isInRange(x))return null;var w=[{x,y:f+m},{x,y:f}];return o==="top"?w.reverse():w}if(i){var S=u.segment,_=S.map(function(A){return e.apply(A,{position:a})});return eo(u,"discard")&&lve(_,function(A){return!e.isInRange(A)})?null:_}return null};function Fxe(t){var e=t.x,n=t.y,r=t.segment,i=t.xAxisId,s=t.yAxisId,a=t.shape,o=t.className,l=t.alwaysShow,u=xxe(),d=i8(i),f=s8(s),p=_xe();if(!u||!p)return null;ua(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=wO({x:d.scale,y:f.scale}),y=En(e),g=En(n),v=r&&r.length===2,b=Lxe(m,y,g,v,p,t.position,d.orientation,f.orientation,t);if(!b)return null;var x=Oxe(b,2),w=x[0],S=w.x,_=w.y,A=x[1],j=A.x,N=A.y,P=eo(t,"hidden")?"url(#".concat(u,")"):void 0,O=bL(bL({clipPath:P},xe(t,!0)),{},{x1:S,y1:_,x2:j,y2:N});return D.createElement(Re,{className:Ee("recharts-reference-line",o)},$xe(a,O),Un.renderCallByParent(t,Xve({x1:S,y1:_,x2:j,y2:N})))}var Ub=function(t){function e(){return Axe(this,e),Nxe(this,e,arguments)}return Pxe(e,t),kxe(e,[{key:"render",value:function(){return D.createElement(Fxe,this.props)}}])}(D.Component);kO(Ub,"displayName","ReferenceLine");kO(Ub,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function kC(){return kC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kC.apply(this,arguments)}function wg(t){"@babel/helpers - typeof";return wg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wg(t)}function _L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function SL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_L(Object(n),!0).forEach(function(r){aj(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_L(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uxe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c8(r.key),r)}}function zxe(t,e,n){return e&&Uxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wxe(t,e,n){return e=lS(e),Hxe(t,l8()?Reflect.construct(e,n||[],lS(t).constructor):e.apply(t,n))}function Hxe(t,e){if(e&&(wg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qxe(t)}function qxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(l8=function(){return!!t})()}function lS(t){return lS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lS(t)}function Gxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&NC(t,e)}function NC(t,e){return NC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},NC(t,e)}function aj(t,e,n){return e=c8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c8(t){var e=Kxe(t,"string");return wg(e)=="symbol"?e:e+""}function Kxe(t,e){if(wg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(wg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Vxe=function(e){var n=e.x,r=e.y,i=e.xAxis,s=e.yAxis,a=wO({x:i.scale,y:s.scale}),o=a.apply({x:n,y:r},{bandAware:!0});return eo(e,"discard")&&!a.isInRange(o)?null:o},oj=function(t){function e(){return Bxe(this,e),Wxe(this,e,arguments)}return Gxe(e,t),zxe(e,[{key:"render",value:function(){var r=this.props,i=r.x,s=r.y,a=r.r,o=r.alwaysShow,l=r.clipPathId,u=En(i),d=En(s);if(ua(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=Vxe(this.props);if(!f)return null;var p=f.x,m=f.y,y=this.props,g=y.shape,v=y.className,b=eo(this.props,"hidden")?"url(#".concat(l,")"):void 0,x=SL(SL({clipPath:b},xe(this.props,!0)),{},{cx:p,cy:m});return D.createElement(Re,{className:Ee("recharts-reference-dot",v)},e.renderDot(g,x),Un.renderCallByParent(this.props,{x:p-a,y:m-a,width:2*a,height:2*a}))}}])}(D.Component);aj(oj,"displayName","ReferenceDot");aj(oj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});aj(oj,"renderDot",function(t,e){var n;return D.isValidElement(t)?n=D.cloneElement(t,e):_e(t)?n=t(e):n=D.createElement(Bb,kC({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function EC(){return EC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},EC.apply(this,arguments)}function _g(t){"@babel/helpers - typeof";return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_g(t)}function AL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function jL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AL(Object(n),!0).forEach(function(r){lj(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Yxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xxe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d8(r.key),r)}}function Qxe(t,e,n){return e&&Xxe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jxe(t,e,n){return e=cS(e),Zxe(t,u8()?Reflect.construct(e,n||[],cS(t).constructor):e.apply(t,n))}function Zxe(t,e){if(e&&(_g(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ebe(t)}function ebe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u8=function(){return!!t})()}function cS(t){return cS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},cS(t)}function tbe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CC(t,e)}function CC(t,e){return CC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},CC(t,e)}function lj(t,e,n){return e=d8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d8(t){var e=nbe(t,"string");return _g(e)=="symbol"?e:e+""}function nbe(t,e){if(_g(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(_g(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var rbe=function(e,n,r,i,s){var a=s.x1,o=s.x2,l=s.y1,u=s.y2,d=s.xAxis,f=s.yAxis;if(!d||!f)return null;var p=wO({x:d.scale,y:f.scale}),m={x:e?p.x.apply(a,{position:"start"}):p.x.rangeMin,y:r?p.y.apply(l,{position:"start"}):p.y.rangeMin},y={x:n?p.x.apply(o,{position:"end"}):p.x.rangeMax,y:i?p.y.apply(u,{position:"end"}):p.y.rangeMax};return eo(s,"discard")&&(!p.isInRange(m)||!p.isInRange(y))?null:QU(m,y)},cj=function(t){function e(){return Yxe(this,e),Jxe(this,e,arguments)}return tbe(e,t),Qxe(e,[{key:"render",value:function(){var r=this.props,i=r.x1,s=r.x2,a=r.y1,o=r.y2,l=r.className,u=r.alwaysShow,d=r.clipPathId;ua(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=En(i),p=En(s),m=En(a),y=En(o),g=this.props.shape;if(!f&&!p&&!m&&!y&&!g)return null;var v=rbe(f,p,m,y,this.props);if(!v&&!g)return null;var b=eo(this.props,"hidden")?"url(#".concat(d,")"):void 0;return D.createElement(Re,{className:Ee("recharts-reference-area",l)},e.renderRect(g,jL(jL({clipPath:b},xe(this.props,!0)),v)),Un.renderCallByParent(this.props,v))}}])}(D.Component);lj(cj,"displayName","ReferenceArea");lj(cj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});lj(cj,"renderRect",function(t,e){var n;return D.isValidElement(t)?n=D.cloneElement(t,e):_e(t)?n=t(e):n=D.createElement(bO,EC({},e,{className:"recharts-reference-area-rect"})),n});function h8(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],i=0;i<t.length;i+=e)r.push(t[i]);return r}function ibe(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return Jve(r,n)}function sbe(t,e,n){var r=n==="width",i=t.x,s=t.y,a=t.width,o=t.height;return e===1?{start:r?i:s,end:r?i+a:s+o}:{start:r?i+a:s+o,end:r?i:s}}function uS(t,e,n,r,i){if(t*e<t*r||t*e>t*i)return!1;var s=n();return t*(e-t*s/2-r)>=0&&t*(e+t*s/2-i)<=0}function abe(t,e){return h8(t,e+1)}function obe(t,e,n,r,i){for(var s=(r||[]).slice(),a=e.start,o=e.end,l=0,u=1,d=a,f=function(){var y=r==null?void 0:r[l];if(y===void 0)return{v:h8(r,u)};var g=l,v,b=function(){return v===void 0&&(v=n(y,g)),v},x=y.coordinate,w=l===0||uS(t,x,b,d,o);w||(l=0,d=a,u+=1),w&&(d=x+t*(b()/2+i),l+=u)},p;u<=s.length;)if(p=f(),p)return p.v;return[]}function bv(t){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(t)}function kL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function gr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kL(Object(n),!0).forEach(function(r){lbe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lbe(t,e,n){return e=cbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cbe(t){var e=ube(t,"string");return bv(e)=="symbol"?e:e+""}function ube(t,e){if(bv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(bv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dbe(t,e,n,r,i){for(var s=(r||[]).slice(),a=s.length,o=e.start,l=e.end,u=function(p){var m=s[p],y,g=function(){return y===void 0&&(y=n(m,p)),y};if(p===a-1){var v=t*(m.coordinate+t*g()/2-l);s[p]=m=gr(gr({},m),{},{tickCoord:v>0?m.coordinate-v*t:m.coordinate})}else s[p]=m=gr(gr({},m),{},{tickCoord:m.coordinate});var b=uS(t,m.tickCoord,g,o,l);b&&(l=m.tickCoord-t*(g()/2+i),s[p]=gr(gr({},m),{},{isShow:!0}))},d=a-1;d>=0;d--)u(d);return s}function hbe(t,e,n,r,i,s){var a=(r||[]).slice(),o=a.length,l=e.start,u=e.end;if(s){var d=r[o-1],f=n(d,o-1),p=t*(d.coordinate+t*f/2-u);a[o-1]=d=gr(gr({},d),{},{tickCoord:p>0?d.coordinate-p*t:d.coordinate});var m=uS(t,d.tickCoord,function(){return f},l,u);m&&(u=d.tickCoord-t*(f/2+i),a[o-1]=gr(gr({},d),{},{isShow:!0}))}for(var y=s?o-1:o,g=function(x){var w=a[x],S,_=function(){return S===void 0&&(S=n(w,x)),S};if(x===0){var A=t*(w.coordinate-t*_()/2-l);a[x]=w=gr(gr({},w),{},{tickCoord:A<0?w.coordinate-A*t:w.coordinate})}else a[x]=w=gr(gr({},w),{},{tickCoord:w.coordinate});var j=uS(t,w.tickCoord,_,l,u);j&&(l=w.tickCoord+t*(_()/2+i),a[x]=gr(gr({},w),{},{isShow:!0}))},v=0;v<y;v++)g(v);return a}function NO(t,e,n){var r=t.tick,i=t.ticks,s=t.viewBox,a=t.minTickGap,o=t.orientation,l=t.interval,u=t.tickFormatter,d=t.unit,f=t.angle;if(!i||!i.length||!r)return[];if(oe(l)||Pl.isSsr)return abe(i,typeof l=="number"&&oe(l)?l:0);var p=[],m=o==="top"||o==="bottom"?"width":"height",y=d&&m==="width"?f0(d,{fontSize:e,letterSpacing:n}):{width:0,height:0},g=function(w,S){var _=_e(u)?u(w.value,S):w.value;return m==="width"?ibe(f0(_,{fontSize:e,letterSpacing:n}),y,f):f0(_,{fontSize:e,letterSpacing:n})[m]},v=i.length>=2?Mr(i[1].coordinate-i[0].coordinate):1,b=sbe(s,v,m);return l==="equidistantPreserveStart"?obe(v,b,g,i,a):(l==="preserveStart"||l==="preserveStartEnd"?p=hbe(v,b,g,i,a,l==="preserveStartEnd"):p=dbe(v,b,g,i,a),p.filter(function(x){return x.isShow}))}var fbe=["viewBox"],pbe=["viewBox"],mbe=["ticks"];function Sg(t){"@babel/helpers - typeof";return Sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sg(t)}function Kf(){return Kf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kf.apply(this,arguments)}function NL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NL(Object(n),!0).forEach(function(r){EO(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ok(t,e){if(t==null)return{};var n=gbe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function gbe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function ybe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,p8(r.key),r)}}function vbe(t,e,n){return e&&EL(t.prototype,e),n&&EL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xbe(t,e,n){return e=dS(e),bbe(t,f8()?Reflect.construct(e,n||[],dS(t).constructor):e.apply(t,n))}function bbe(t,e){if(e&&(Sg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wbe(t)}function wbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f8=function(){return!!t})()}function dS(t){return dS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},dS(t)}function _be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&PC(t,e)}function PC(t,e){return PC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},PC(t,e)}function EO(t,e,n){return e=p8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p8(t){var e=Sbe(t,"string");return Sg(e)=="symbol"?e:e+""}function Sbe(t,e){if(Sg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Sg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Jg=function(t){function e(n){var r;return ybe(this,e),r=xbe(this,e,[n]),r.state={fontSize:"",letterSpacing:""},r}return _be(e,t),vbe(e,[{key:"shouldComponentUpdate",value:function(r,i){var s=r.viewBox,a=Ok(r,fbe),o=this.props,l=o.viewBox,u=Ok(o,pbe);return!lp(s,l)||!lp(a,u)||!lp(i,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var i=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,u=i.orientation,d=i.tickSize,f=i.mirror,p=i.tickMargin,m,y,g,v,b,x,w=f?-1:1,S=r.tickSize||d,_=oe(r.tickCoord)?r.tickCoord:r.coordinate;switch(u){case"top":m=y=r.coordinate,v=a+ +!f*l,g=v-w*S,x=g-w*p,b=_;break;case"left":g=v=r.coordinate,y=s+ +!f*o,m=y-w*S,b=m-w*p,x=_;break;case"right":g=v=r.coordinate,y=s+ +f*o,m=y+w*S,b=m+w*p,x=_;break;default:m=y=r.coordinate,v=a+ +f*l,g=v+w*S,x=g+w*p,b=_;break}return{line:{x1:m,y1:g,x2:y,y2:v},tick:{x:b,y:x}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,i=r.orientation,s=r.mirror,a;switch(i){case"left":a=s?"start":"end";break;case"right":a=s?"end":"start";break;default:a="middle";break}return a}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,i=r.orientation,s=r.mirror,a="end";switch(i){case"left":case"right":a="middle";break;case"top":a=s?"start":"end";break;default:a=s?"end":"start";break}return a}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.orientation,u=r.mirror,d=r.axisLine,f=vn(vn(vn({},xe(this.props,!1)),xe(d,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var p=+(l==="top"&&!u||l==="bottom"&&u);f=vn(vn({},f),{},{x1:i,y1:s+p*o,x2:i+a,y2:s+p*o})}else{var m=+(l==="left"&&!u||l==="right"&&u);f=vn(vn({},f),{},{x1:i+m*a,y1:s,x2:i+m*a,y2:s+o})}return D.createElement("line",Kf({},f,{className:Ee("recharts-cartesian-axis-line",Hi(d,"className"))}))}},{key:"renderTicks",value:function(r,i,s){var a=this,o=this.props,l=o.tickLine,u=o.stroke,d=o.tick,f=o.tickFormatter,p=o.unit,m=NO(vn(vn({},this.props),{},{ticks:r}),i,s),y=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=xe(this.props,!1),b=xe(d,!1),x=vn(vn({},v),{},{fill:"none"},xe(l,!1)),w=m.map(function(S,_){var A=a.getTickLineCoord(S),j=A.line,N=A.tick,P=vn(vn(vn(vn({textAnchor:y,verticalAnchor:g},v),{},{stroke:"none",fill:u},b),N),{},{index:_,payload:S,visibleTicksCount:m.length,tickFormatter:f});return D.createElement(Re,Kf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},gu(a.props,S,_)),l&&D.createElement("line",Kf({},x,j,{className:Ee("recharts-cartesian-axis-tick-line",Hi(l,"className"))})),d&&e.renderTickItem(d,P,"".concat(_e(f)?f(S.value,_):S.value).concat(p||"")))});return D.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var r=this,i=this.props,s=i.axisLine,a=i.width,o=i.height,l=i.ticksGenerator,u=i.className,d=i.hide;if(d)return null;var f=this.props,p=f.ticks,m=Ok(f,mbe),y=p;return _e(l)&&(y=p&&p.length>0?l(this.props):l(m)),a<=0||o<=0||!y||!y.length?null:D.createElement(Re,{className:Ee("recharts-cartesian-axis",u),ref:function(v){r.layerReference=v}},s&&this.renderAxisLine(),this.renderTicks(y,this.state.fontSize,this.state.letterSpacing),Un.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,i,s){var a,o=Ee(i.className,"recharts-cartesian-axis-tick-value");return D.isValidElement(r)?a=D.cloneElement(r,vn(vn({},i),{},{className:o})):_e(r)?a=r(vn(vn({},i),{},{className:o})):a=D.createElement(qh,Kf({},i,{className:"recharts-cartesian-axis-tick-value"}),s),a}}])}(T.Component);EO(Jg,"displayName","CartesianAxis");EO(Jg,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Abe=["x1","y1","x2","y2","key"],jbe=["offset"];function Vh(t){"@babel/helpers - typeof";return Vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vh(t)}function CL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CL(Object(n),!0).forEach(function(r){kbe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kbe(t,e,n){return e=Nbe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nbe(t){var e=Ebe(t,"string");return Vh(e)=="symbol"?e:e+""}function Ebe(t,e){if(Vh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Vh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function od(){return od=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},od.apply(this,arguments)}function PL(t,e){if(t==null)return{};var n=Cbe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Cbe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Pbe=function(e){var n=e.fill;if(!n||n==="none")return null;var r=e.fillOpacity,i=e.x,s=e.y,a=e.width,o=e.height,l=e.ry;return D.createElement("rect",{x:i,y:s,ry:l,width:a,height:o,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function m8(t,e){var n;if(D.isValidElement(t))n=D.cloneElement(t,e);else if(_e(t))n=t(e);else{var r=e.x1,i=e.y1,s=e.x2,a=e.y2,o=e.key,l=PL(e,Abe),u=xe(l,!1);u.offset;var d=PL(u,jbe);n=D.createElement("line",od({},d,{x1:r,y1:i,x2:s,y2:a,fill:"none",key:o}))}return n}function Tbe(t){var e=t.x,n=t.width,r=t.horizontal,i=r===void 0?!0:r,s=t.horizontalPoints;if(!i||!s||!s.length)return null;var a=s.map(function(o,l){var u=vr(vr({},t),{},{x1:e,y1:o,x2:e+n,y2:o,key:"line-".concat(l),index:l});return m8(i,u)});return D.createElement("g",{className:"recharts-cartesian-grid-horizontal"},a)}function Obe(t){var e=t.y,n=t.height,r=t.vertical,i=r===void 0?!0:r,s=t.verticalPoints;if(!i||!s||!s.length)return null;var a=s.map(function(o,l){var u=vr(vr({},t),{},{x1:o,y1:e,x2:o,y2:e+n,key:"line-".concat(l),index:l});return m8(i,u)});return D.createElement("g",{className:"recharts-cartesian-grid-vertical"},a)}function Mbe(t){var e=t.horizontalFill,n=t.fillOpacity,r=t.x,i=t.y,s=t.width,a=t.height,o=t.horizontalPoints,l=t.horizontal,u=l===void 0?!0:l;if(!u||!e||!e.length)return null;var d=o.map(function(p){return Math.round(p+i-i)}).sort(function(p,m){return p-m});i!==d[0]&&d.unshift(0);var f=d.map(function(p,m){var y=!d[m+1],g=y?i+a-p:d[m+1]-p;if(g<=0)return null;var v=m%e.length;return D.createElement("rect",{key:"react-".concat(m),y:p,x:r,height:g,width:s,stroke:"none",fill:e[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return D.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Rbe(t){var e=t.vertical,n=e===void 0?!0:e,r=t.verticalFill,i=t.fillOpacity,s=t.x,a=t.y,o=t.width,l=t.height,u=t.verticalPoints;if(!n||!r||!r.length)return null;var d=u.map(function(p){return Math.round(p+s-s)}).sort(function(p,m){return p-m});s!==d[0]&&d.unshift(0);var f=d.map(function(p,m){var y=!d[m+1],g=y?s+o-p:d[m+1]-p;if(g<=0)return null;var v=m%r.length;return D.createElement("rect",{key:"react-".concat(m),x:p,y:a,width:g,height:l,stroke:"none",fill:r[v],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return D.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Ibe=function(e,n){var r=e.xAxis,i=e.width,s=e.height,a=e.offset;return fU(NO(vr(vr(vr({},Jg.defaultProps),r),{},{ticks:ul(r,!0),viewBox:{x:0,y:0,width:i,height:s}})),a.left,a.left+a.width,n)},Dbe=function(e,n){var r=e.yAxis,i=e.width,s=e.height,a=e.offset;return fU(NO(vr(vr(vr({},Jg.defaultProps),r),{},{ticks:ul(r,!0),viewBox:{x:0,y:0,width:i,height:s}})),a.top,a.top+a.height,n)},yf={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Cs(t){var e,n,r,i,s,a,o=AO(),l=jO(),u=Sxe(),d=vr(vr({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:yf.stroke,fill:(n=t.fill)!==null&&n!==void 0?n:yf.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:yf.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:yf.horizontalFill,vertical:(s=t.vertical)!==null&&s!==void 0?s:yf.vertical,verticalFill:(a=t.verticalFill)!==null&&a!==void 0?a:yf.verticalFill,x:oe(t.x)?t.x:u.left,y:oe(t.y)?t.y:u.top,width:oe(t.width)?t.width:u.width,height:oe(t.height)?t.height:u.height}),f=d.x,p=d.y,m=d.width,y=d.height,g=d.syncWithTicks,v=d.horizontalValues,b=d.verticalValues,x=bxe(),w=wxe();if(!oe(m)||m<=0||!oe(y)||y<=0||!oe(f)||f!==+f||!oe(p)||p!==+p)return null;var S=d.verticalCoordinatesGenerator||Ibe,_=d.horizontalCoordinatesGenerator||Dbe,A=d.horizontalPoints,j=d.verticalPoints;if((!A||!A.length)&&_e(_)){var N=v&&v.length,P=_({yAxis:w?vr(vr({},w),{},{ticks:N?v:w.ticks}):void 0,width:o,height:l,offset:u},N?!0:g);ua(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Vh(P),"]")),Array.isArray(P)&&(A=P)}if((!j||!j.length)&&_e(S)){var O=b&&b.length,M=S({xAxis:x?vr(vr({},x),{},{ticks:O?b:x.ticks}):void 0,width:o,height:l,offset:u},O?!0:g);ua(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Vh(M),"]")),Array.isArray(M)&&(j=M)}return D.createElement("g",{className:"recharts-cartesian-grid"},D.createElement(Pbe,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),D.createElement(Tbe,od({},d,{offset:u,horizontalPoints:A,xAxis:x,yAxis:w})),D.createElement(Obe,od({},d,{offset:u,verticalPoints:j,xAxis:x,yAxis:w})),D.createElement(Mbe,od({},d,{horizontalPoints:A})),D.createElement(Rbe,od({},d,{verticalPoints:j})))}Cs.displayName="CartesianGrid";var $be=["type","layout","connectNulls","ref"],Lbe=["key"];function Ag(t){"@babel/helpers - typeof";return Ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ag(t)}function TL(t,e){if(t==null)return{};var n=Fbe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Fbe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function x0(){return x0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},x0.apply(this,arguments)}function OL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function pi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OL(Object(n),!0).forEach(function(r){ra(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function vf(t){return Wbe(t)||zbe(t)||Ube(t)||Bbe()}function Bbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ube(t,e){if(t){if(typeof t=="string")return TC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TC(t,e)}}function zbe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wbe(t){if(Array.isArray(t))return TC(t)}function TC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Hbe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ML(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y8(r.key),r)}}function qbe(t,e,n){return e&&ML(t.prototype,e),n&&ML(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gbe(t,e,n){return e=hS(e),Kbe(t,g8()?Reflect.construct(e,n||[],hS(t).constructor):e.apply(t,n))}function Kbe(t,e){if(e&&(Ag(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vbe(t)}function Vbe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g8=function(){return!!t})()}function hS(t){return hS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hS(t)}function Ybe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OC(t,e)}function OC(t,e){return OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},OC(t,e)}function ra(t,e,n){return e=y8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y8(t){var e=Xbe(t,"string");return Ag(e)=="symbol"?e:e+""}function Xbe(t,e){if(Ag(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ag(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var di=function(t){function e(){var n;Hbe(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=Gbe(this,e,[].concat(i)),ra(n,"state",{isAnimationFinished:!0,totalLength:0}),ra(n,"generateSimpleStrokeDasharray",function(a,o){return"".concat(o,"px ").concat(a-o,"px")}),ra(n,"getStrokeDasharray",function(a,o,l){var u=l.reduce(function(b,x){return b+x});if(!u)return n.generateSimpleStrokeDasharray(o,a);for(var d=Math.floor(a/u),f=a%u,p=o-a,m=[],y=0,g=0;y<l.length;g+=l[y],++y)if(g+l[y]>f){m=[].concat(vf(l.slice(0,y)),[f-g]);break}var v=m.length%2===0?[0,p]:[p];return[].concat(vf(e.repeat(l,d)),vf(m),v).map(function(b){return"".concat(b,"px")}).join(", ")}),ra(n,"id",ku("recharts-line-")),ra(n,"pathRef",function(a){n.mainCurve=a}),ra(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),ra(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Ybe(e,t),qbe(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,a=s.points,o=s.xAxis,l=s.yAxis,u=s.layout,d=s.children,f=Lr(d,Qg);if(!f)return null;var p=function(g,v){return{x:g.x,y:g.y,value:g.value,errorVal:Mt(g.payload,v)}},m={clipPath:r?"url(#clipPath-".concat(i,")"):null};return D.createElement(Re,m,f.map(function(y){return D.cloneElement(y,{key:"bar-".concat(y.props.dataKey),data:a,xAxis:o,yAxis:l,layout:u,dataPointFormatter:p})}))}},{key:"renderDots",value:function(r,i,s){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.dot,u=o.points,d=o.dataKey,f=xe(this.props,!1),p=xe(l,!0),m=u.map(function(g,v){var b=pi(pi(pi({key:"dot-".concat(v),r:3},f),p),{},{index:v,cx:g.x,cy:g.y,value:g.value,dataKey:d,payload:g.payload,points:u});return e.renderDotItem(l,b)}),y={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(s,")"):null};return D.createElement(Re,x0({className:"recharts-line-dots",key:"dots"},y),m)}},{key:"renderCurveStatically",value:function(r,i,s,a){var o=this.props,l=o.type,u=o.layout,d=o.connectNulls;o.ref;var f=TL(o,$be),p=pi(pi(pi({},xe(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(s,")"):null,points:r},a),{},{type:l,layout:u,connectNulls:d});return D.createElement(fu,x0({},p,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,i){var s=this,a=this.props,o=a.points,l=a.strokeDasharray,u=a.isAnimationActive,d=a.animationBegin,f=a.animationDuration,p=a.animationEasing,m=a.animationId,y=a.animateNewValues,g=a.width,v=a.height,b=this.state,x=b.prevPoints,w=b.totalLength;return D.createElement(Es,{begin:d,duration:f,isActive:u,easing:p,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var _=S.t;if(x){var A=x.length/o.length,j=o.map(function(R,I){var L=Math.floor(I*A);if(x[L]){var W=x[L],F=Ht(W.x,R.x),z=Ht(W.y,R.y);return pi(pi({},R),{},{x:F(_),y:z(_)})}if(y){var U=Ht(g*2,R.x),K=Ht(v/2,R.y);return pi(pi({},R),{},{x:U(_),y:K(_)})}return pi(pi({},R),{},{x:R.x,y:R.y})});return s.renderCurveStatically(j,r,i)}var N=Ht(0,w),P=N(_),O;if(l){var M="".concat(l).split(/[,\s]+/gim).map(function(R){return parseFloat(R)});O=s.getStrokeDasharray(P,w,M)}else O=s.generateSimpleStrokeDasharray(w,P);return s.renderCurveStatically(o,r,i,{strokeDasharray:O})})}},{key:"renderCurve",value:function(r,i){var s=this.props,a=s.points,o=s.isAnimationActive,l=this.state,u=l.prevPoints,d=l.totalLength;return o&&a&&a.length&&(!u&&d>0||!yu(u,a))?this.renderCurveWithAnimation(r,i):this.renderCurveStatically(a,r,i)}},{key:"render",value:function(){var r,i=this.props,s=i.hide,a=i.dot,o=i.points,l=i.className,u=i.xAxis,d=i.yAxis,f=i.top,p=i.left,m=i.width,y=i.height,g=i.isAnimationActive,v=i.id;if(s||!o||!o.length)return null;var b=this.state.isAnimationFinished,x=o.length===1,w=Ee("recharts-line",l),S=u&&u.allowDataOverflow,_=d&&d.allowDataOverflow,A=S||_,j=we(v)?this.id:v,N=(r=xe(a,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},P=N.r,O=P===void 0?3:P,M=N.strokeWidth,R=M===void 0?2:M,I=s5(a)?a:{},L=I.clipDot,W=L===void 0?!0:L,F=O*2+R;return D.createElement(Re,{className:w},S||_?D.createElement("defs",null,D.createElement("clipPath",{id:"clipPath-".concat(j)},D.createElement("rect",{x:S?p:p-m/2,y:_?f:f-y/2,width:S?m:m*2,height:_?y:y*2})),!W&&D.createElement("clipPath",{id:"clipPath-dots-".concat(j)},D.createElement("rect",{x:p-F/2,y:f-F/2,width:m+F,height:y+F}))):null,!x&&this.renderCurve(A,j),this.renderErrorBar(A,j),(x||a)&&this.renderDots(A,W,j),(!g||b)&&da.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,i){for(var s=r.length%2!==0?[].concat(vf(r),[0]):r,a=[],o=0;o<i;++o)a=[].concat(vf(a),vf(s));return a}},{key:"renderDotItem",value:function(r,i){var s;if(D.isValidElement(r))s=D.cloneElement(r,i);else if(_e(r))s=r(i);else{var a=i.key,o=TL(i,Lbe),l=Ee("recharts-line-dot",typeof r!="boolean"?r.className:"");s=D.createElement(Bb,x0({key:a},o,{className:l}))}return s}}])}(T.PureComponent);ra(di,"displayName","Line");ra(di,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Pl.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});ra(di,"getComposedData",function(t){var e=t.props,n=t.xAxis,r=t.yAxis,i=t.xAxisTicks,s=t.yAxisTicks,a=t.dataKey,o=t.bandSize,l=t.displayedData,u=t.offset,d=e.layout,f=l.map(function(p,m){var y=Mt(p,a);return d==="horizontal"?{x:hg({axis:n,ticks:i,bandSize:o,entry:p,index:m}),y:we(y)?null:r.scale(y),value:y,payload:p}:{x:we(y)?null:n.scale(y),y:hg({axis:r,ticks:s,bandSize:o,entry:p,index:m}),value:y,payload:p}});return pi({points:f,layout:d},u)});var Qbe=["layout","type","stroke","connectNulls","isRange","ref"],Jbe=["key"],v8;function jg(t){"@babel/helpers - typeof";return jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jg(t)}function x8(t,e){if(t==null)return{};var n=Zbe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Zbe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function ld(){return ld=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ld.apply(this,arguments)}function RL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function zl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RL(Object(n),!0).forEach(function(r){Xa(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ewe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IL(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w8(r.key),r)}}function twe(t,e,n){return e&&IL(t.prototype,e),n&&IL(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function nwe(t,e,n){return e=fS(e),rwe(t,b8()?Reflect.construct(e,n||[],fS(t).constructor):e.apply(t,n))}function rwe(t,e){if(e&&(jg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iwe(t)}function iwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b8=function(){return!!t})()}function fS(t){return fS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fS(t)}function swe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MC(t,e)}function MC(t,e){return MC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},MC(t,e)}function Xa(t,e,n){return e=w8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w8(t){var e=awe(t,"string");return jg(e)=="symbol"?e:e+""}function awe(t,e){if(jg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(jg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var no=function(t){function e(){var n;ewe(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=nwe(this,e,[].concat(i)),Xa(n,"state",{isAnimationFinished:!0}),Xa(n,"id",ku("recharts-area-")),Xa(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),_e(a)&&a()}),Xa(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),_e(a)&&a()}),n}return swe(e,t),twe(e,[{key:"renderDots",value:function(r,i,s){var a=this.props.isAnimationActive,o=this.state.isAnimationFinished;if(a&&!o)return null;var l=this.props,u=l.dot,d=l.points,f=l.dataKey,p=xe(this.props,!1),m=xe(u,!0),y=d.map(function(v,b){var x=zl(zl(zl({key:"dot-".concat(b),r:3},p),m),{},{index:b,cx:v.x,cy:v.y,dataKey:f,value:v.value,payload:v.payload,points:d});return e.renderDotItem(u,x)}),g={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(s,")"):null};return D.createElement(Re,ld({className:"recharts-area-dots"},g),y)}},{key:"renderHorizontalRect",value:function(r){var i=this.props,s=i.baseLine,a=i.points,o=i.strokeWidth,l=a[0].x,u=a[a.length-1].x,d=r*Math.abs(l-u),f=eu(a.map(function(p){return p.y||0}));return oe(s)&&typeof s=="number"?f=Math.max(s,f):s&&Array.isArray(s)&&s.length&&(f=Math.max(eu(s.map(function(p){return p.y||0})),f)),oe(f)?D.createElement("rect",{x:l<u?l:l-d,y:0,width:d,height:Math.floor(f+(o?parseInt("".concat(o),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var i=this.props,s=i.baseLine,a=i.points,o=i.strokeWidth,l=a[0].y,u=a[a.length-1].y,d=r*Math.abs(l-u),f=eu(a.map(function(p){return p.x||0}));return oe(s)&&typeof s=="number"?f=Math.max(s,f):s&&Array.isArray(s)&&s.length&&(f=Math.max(eu(s.map(function(p){return p.x||0})),f)),oe(f)?D.createElement("rect",{x:0,y:l<u?l:l-d,width:f+(o?parseInt("".concat(o),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(r){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,i,s,a){var o=this.props,l=o.layout,u=o.type,d=o.stroke,f=o.connectNulls,p=o.isRange;o.ref;var m=x8(o,Qbe);return D.createElement(Re,{clipPath:s?"url(#clipPath-".concat(a,")"):null},D.createElement(fu,ld({},xe(m,!0),{points:r,connectNulls:f,type:u,baseLine:i,layout:l,stroke:"none",className:"recharts-area-area"})),d!=="none"&&D.createElement(fu,ld({},xe(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:r})),d!=="none"&&p&&D.createElement(fu,ld({},xe(this.props,!1),{className:"recharts-area-curve",layout:l,type:u,connectNulls:f,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(r,i){var s=this,a=this.props,o=a.points,l=a.baseLine,u=a.isAnimationActive,d=a.animationBegin,f=a.animationDuration,p=a.animationEasing,m=a.animationId,y=this.state,g=y.prevPoints,v=y.prevBaseLine;return D.createElement(Es,{begin:d,duration:f,isActive:u,easing:p,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var x=b.t;if(g){var w=g.length/o.length,S=o.map(function(N,P){var O=Math.floor(P*w);if(g[O]){var M=g[O],R=Ht(M.x,N.x),I=Ht(M.y,N.y);return zl(zl({},N),{},{x:R(x),y:I(x)})}return N}),_;if(oe(l)&&typeof l=="number"){var A=Ht(v,l);_=A(x)}else if(we(l)||Wg(l)){var j=Ht(v,0);_=j(x)}else _=l.map(function(N,P){var O=Math.floor(P*w);if(v[O]){var M=v[O],R=Ht(M.x,N.x),I=Ht(M.y,N.y);return zl(zl({},N),{},{x:R(x),y:I(x)})}return N});return s.renderAreaStatically(S,_,r,i)}return D.createElement(Re,null,D.createElement("defs",null,D.createElement("clipPath",{id:"animationClipPath-".concat(i)},s.renderClipRect(x))),D.createElement(Re,{clipPath:"url(#animationClipPath-".concat(i,")")},s.renderAreaStatically(o,l,r,i)))})}},{key:"renderArea",value:function(r,i){var s=this.props,a=s.points,o=s.baseLine,l=s.isAnimationActive,u=this.state,d=u.prevPoints,f=u.prevBaseLine,p=u.totalLength;return l&&a&&a.length&&(!d&&p>0||!yu(d,a)||!yu(f,o))?this.renderAreaWithAnimation(r,i):this.renderAreaStatically(a,o,r,i)}},{key:"render",value:function(){var r,i=this.props,s=i.hide,a=i.dot,o=i.points,l=i.className,u=i.top,d=i.left,f=i.xAxis,p=i.yAxis,m=i.width,y=i.height,g=i.isAnimationActive,v=i.id;if(s||!o||!o.length)return null;var b=this.state.isAnimationFinished,x=o.length===1,w=Ee("recharts-area",l),S=f&&f.allowDataOverflow,_=p&&p.allowDataOverflow,A=S||_,j=we(v)?this.id:v,N=(r=xe(a,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},P=N.r,O=P===void 0?3:P,M=N.strokeWidth,R=M===void 0?2:M,I=s5(a)?a:{},L=I.clipDot,W=L===void 0?!0:L,F=O*2+R;return D.createElement(Re,{className:w},S||_?D.createElement("defs",null,D.createElement("clipPath",{id:"clipPath-".concat(j)},D.createElement("rect",{x:S?d:d-m/2,y:_?u:u-y/2,width:S?m:m*2,height:_?y:y*2})),!W&&D.createElement("clipPath",{id:"clipPath-dots-".concat(j)},D.createElement("rect",{x:d-F/2,y:u-F/2,width:m+F,height:y+F}))):null,x?null:this.renderArea(A,j),(a||x)&&this.renderDots(A,W,j),(!g||b)&&da.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:r.points!==i.curPoints||r.baseLine!==i.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(T.PureComponent);v8=no;Xa(no,"displayName","Area");Xa(no,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Pl.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Xa(no,"getBaseValue",function(t,e,n,r){var i=t.layout,s=t.baseValue,a=e.props.baseValue,o=a??s;if(oe(o)&&typeof o=="number")return o;var l=i==="horizontal"?r:n,u=l.scale.domain();if(l.type==="number"){var d=Math.max(u[0],u[1]),f=Math.min(u[0],u[1]);return o==="dataMin"?f:o==="dataMax"||d<0?d:Math.max(Math.min(u[0],u[1]),0)}return o==="dataMin"?u[0]:o==="dataMax"?u[1]:u[0]});Xa(no,"getComposedData",function(t){var e=t.props,n=t.item,r=t.xAxis,i=t.yAxis,s=t.xAxisTicks,a=t.yAxisTicks,o=t.bandSize,l=t.dataKey,u=t.stackedData,d=t.dataStartIndex,f=t.displayedData,p=t.offset,m=e.layout,y=u&&u.length,g=v8.getBaseValue(e,n,r,i),v=m==="horizontal",b=!1,x=f.map(function(S,_){var A;y?A=u[d+_]:(A=Mt(S,l),Array.isArray(A)?b=!0:A=[g,A]);var j=A[1]==null||y&&Mt(S,l)==null;return v?{x:hg({axis:r,ticks:s,bandSize:o,entry:S,index:_}),y:j?null:i.scale(A[1]),value:A,payload:S}:{x:j?null:r.scale(A[1]),y:hg({axis:i,ticks:a,bandSize:o,entry:S,index:_}),value:A,payload:S}}),w;return y||b?w=x.map(function(S){var _=Array.isArray(S.value)?S.value[0]:null;return v?{x:S.x,y:_!=null&&S.y!=null?i.scale(_):null}:{x:_!=null?r.scale(_):null,y:S.y}}):w=v?i.scale(g):r.scale(g),zl({points:x,baseLine:w,layout:m,isRange:b},p)});Xa(no,"renderDotItem",function(t,e){var n;if(D.isValidElement(t))n=D.cloneElement(t,e);else if(_e(t))n=t(e);else{var r=Ee("recharts-area-dot",typeof t!="boolean"?t.className:""),i=e.key,s=x8(e,Jbe);n=D.createElement(Bb,ld({},s,{key:i,className:r}))}return n});function kg(t){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kg(t)}function owe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lwe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,A8(r.key),r)}}function cwe(t,e,n){return e&&lwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function uwe(t,e,n){return e=pS(e),dwe(t,_8()?Reflect.construct(e,n||[],pS(t).constructor):e.apply(t,n))}function dwe(t,e){if(e&&(kg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hwe(t)}function hwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_8=function(){return!!t})()}function pS(t){return pS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pS(t)}function fwe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RC(t,e)}function RC(t,e){return RC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},RC(t,e)}function S8(t,e,n){return e=A8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A8(t){var e=pwe(t,"string");return kg(e)=="symbol"?e:e+""}function pwe(t,e){if(kg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(kg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var uj=function(t){function e(){return owe(this,e),uwe(this,e,arguments)}return fwe(e,t),cwe(e,[{key:"render",value:function(){return null}}])}(T.Component);S8(uj,"displayName","ZAxis");S8(uj,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var mwe=["option","isActive"];function b0(){return b0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b0.apply(this,arguments)}function gwe(t,e){if(t==null)return{};var n=ywe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ywe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function vwe(t){var e=t.option,n=t.isActive,r=gwe(t,mwe);return typeof e=="string"?T.createElement(eS,b0({option:T.createElement(LA,b0({type:e},r)),isActive:n,shapeType:"symbols"},r)):T.createElement(eS,b0({option:e,isActive:n,shapeType:"symbols"},r))}function Ng(t){"@babel/helpers - typeof";return Ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ng(t)}function w0(){return w0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},w0.apply(this,arguments)}function DL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function es(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?DL(Object(n),!0).forEach(function(r){nu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):DL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function xwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,k8(r.key),r)}}function bwe(t,e,n){return e&&$L(t.prototype,e),n&&$L(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function wwe(t,e,n){return e=mS(e),_we(t,j8()?Reflect.construct(e,n||[],mS(t).constructor):e.apply(t,n))}function _we(t,e){if(e&&(Ng(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Swe(t)}function Swe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j8=function(){return!!t})()}function mS(t){return mS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mS(t)}function Awe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IC(t,e)}function IC(t,e){return IC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},IC(t,e)}function nu(t,e,n){return e=k8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k8(t){var e=jwe(t,"string");return Ng(e)=="symbol"?e:e+""}function jwe(t,e){if(Ng(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ng(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var dj=function(t){function e(){var n;xwe(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=wwe(this,e,[].concat(i)),nu(n,"state",{isAnimationFinished:!1}),nu(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),nu(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),nu(n,"id",ku("recharts-scatter-")),n}return Awe(e,t),bwe(e,[{key:"renderSymbolsStatically",value:function(r){var i=this,s=this.props,a=s.shape,o=s.activeShape,l=s.activeIndex,u=xe(this.props,!1);return r.map(function(d,f){var p=l===f,m=p?o:a,y=es(es({},u),d);return D.createElement(Re,w0({className:"recharts-scatter-symbol",key:"symbol-".concat(d==null?void 0:d.cx,"-").concat(d==null?void 0:d.cy,"-").concat(d==null?void 0:d.size,"-").concat(f)},gu(i.props,d,f),{role:"img"}),D.createElement(vwe,w0({option:m,isActive:p,key:"symbol-".concat(f)},y)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,i=this.props,s=i.points,a=i.isAnimationActive,o=i.animationBegin,l=i.animationDuration,u=i.animationEasing,d=i.animationId,f=this.state.prevPoints;return D.createElement(Es,{begin:o,duration:l,isActive:a,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var m=p.t,y=s.map(function(g,v){var b=f&&f[v];if(b){var x=Ht(b.cx,g.cx),w=Ht(b.cy,g.cy),S=Ht(b.size,g.size);return es(es({},g),{},{cx:x(m),cy:w(m),size:S(m)})}var _=Ht(0,g.size);return es(es({},g),{},{size:_(m)})});return D.createElement(Re,null,r.renderSymbolsStatically(y))})}},{key:"renderSymbols",value:function(){var r=this.props,i=r.points,s=r.isAnimationActive,a=this.state.prevPoints;return s&&i&&i.length&&(!a||!yu(a,i))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(i)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,a=i.xAxis,o=i.yAxis,l=i.children,u=Lr(l,Qg);return u?u.map(function(d,f){var p=d.props,m=p.direction,y=p.dataKey;return D.cloneElement(d,{key:"".concat(m,"-").concat(y,"-").concat(s[f]),data:s,xAxis:a,yAxis:o,layout:m==="x"?"vertical":"horizontal",dataPointFormatter:function(v,b){return{x:v.cx,y:v.cy,value:m==="x"?+v.node.x:+v.node.y,errorVal:Mt(v,b)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,i=r.points,s=r.line,a=r.lineType,o=r.lineJointType,l=xe(this.props,!1),u=xe(s,!1),d,f;if(a==="joint")d=i.map(function(w){return{x:w.cx,y:w.cy}});else if(a==="fitting"){var p=cJ(i),m=p.xmin,y=p.xmax,g=p.a,v=p.b,b=function(S){return g*S+v};d=[{x:m,y:b(m)},{x:y,y:b(y)}]}var x=es(es(es({},l),{},{fill:"none",stroke:l&&l.fill},u),{},{points:d});return D.isValidElement(s)?f=D.cloneElement(s,x):_e(s)?f=s(x):f=D.createElement(fu,w0({},x,{type:o})),D.createElement(Re,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var r=this.props,i=r.hide,s=r.points,a=r.line,o=r.className,l=r.xAxis,u=r.yAxis,d=r.left,f=r.top,p=r.width,m=r.height,y=r.id,g=r.isAnimationActive;if(i||!s||!s.length)return null;var v=this.state.isAnimationFinished,b=Ee("recharts-scatter",o),x=l&&l.allowDataOverflow,w=u&&u.allowDataOverflow,S=x||w,_=we(y)?this.id:y;return D.createElement(Re,{className:b,clipPath:S?"url(#clipPath-".concat(_,")"):null},x||w?D.createElement("defs",null,D.createElement("clipPath",{id:"clipPath-".concat(_)},D.createElement("rect",{x:x?d:d-p/2,y:w?f:f-m/2,width:x?p:p*2,height:w?m:m*2}))):null,a&&this.renderLine(),this.renderErrorBar(),D.createElement(Re,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!g||v)&&da.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:i.curPoints}:r.points!==i.curPoints?{curPoints:r.points}:null}}])}(T.PureComponent);nu(dj,"displayName","Scatter");nu(dj,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Pl.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});nu(dj,"getComposedData",function(t){var e=t.xAxis,n=t.yAxis,r=t.zAxis,i=t.item,s=t.displayedData,a=t.xAxisTicks,o=t.yAxisTicks,l=t.offset,u=i.props.tooltipType,d=Lr(i.props.children,Kg),f=we(e.dataKey)?i.props.dataKey:e.dataKey,p=we(n.dataKey)?i.props.dataKey:n.dataKey,m=r&&r.dataKey,y=r?r.range:uj.defaultProps.range,g=y&&y[0],v=e.scale.bandwidth?e.scale.bandwidth():0,b=n.scale.bandwidth?n.scale.bandwidth():0,x=s.map(function(w,S){var _=Mt(w,f),A=Mt(w,p),j=!we(m)&&Mt(w,m)||"-",N=[{name:we(e.dataKey)?i.props.name:e.name||e.dataKey,unit:e.unit||"",value:_,payload:w,dataKey:f,type:u},{name:we(n.dataKey)?i.props.name:n.name||n.dataKey,unit:n.unit||"",value:A,payload:w,dataKey:p,type:u}];j!=="-"&&N.push({name:r.name||r.dataKey,unit:r.unit||"",value:j,payload:w,dataKey:m,type:u});var P=hg({axis:e,ticks:a,bandSize:v,entry:w,index:S,dataKey:f}),O=hg({axis:n,ticks:o,bandSize:b,entry:w,index:S,dataKey:p}),M=j!=="-"?r.scale(j):g,R=Math.sqrt(Math.max(M,0)/Math.PI);return es(es({},w),{},{cx:P,cy:O,x:P-R,y:O-R,xAxis:e,yAxis:n,zAxis:r,width:2*R,height:2*R,size:M,node:{x:_,y:A,z:j},tooltipPayload:N,tooltipPosition:{x:P,y:O},payload:w},d&&d[S]&&d[S].props)});return es({points:x},l)});function Eg(t){"@babel/helpers - typeof";return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eg(t)}function kwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nwe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C8(r.key),r)}}function Ewe(t,e,n){return e&&Nwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cwe(t,e,n){return e=gS(e),Pwe(t,N8()?Reflect.construct(e,n||[],gS(t).constructor):e.apply(t,n))}function Pwe(t,e){if(e&&(Eg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Twe(t)}function Twe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(N8=function(){return!!t})()}function gS(t){return gS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gS(t)}function Owe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&DC(t,e)}function DC(t,e){return DC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},DC(t,e)}function E8(t,e,n){return e=C8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C8(t){var e=Mwe(t,"string");return Eg(e)=="symbol"?e:e+""}function Mwe(t,e){if(Eg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Eg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function $C(){return $C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$C.apply(this,arguments)}function Rwe(t){var e=t.xAxisId,n=AO(),r=jO(),i=i8(e);return i==null?null:T.createElement(Jg,$C({},i,{className:Ee("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(a){return ul(a,!0)}}))}var ir=function(t){function e(){return kwe(this,e),Cwe(this,e,arguments)}return Owe(e,t),Ewe(e,[{key:"render",value:function(){return T.createElement(Rwe,this.props)}}])}(T.Component);E8(ir,"displayName","XAxis");E8(ir,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Cg(t){"@babel/helpers - typeof";return Cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cg(t)}function Iwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dwe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O8(r.key),r)}}function $we(t,e,n){return e&&Dwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lwe(t,e,n){return e=yS(e),Fwe(t,P8()?Reflect.construct(e,n||[],yS(t).constructor):e.apply(t,n))}function Fwe(t,e){if(e&&(Cg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bwe(t)}function Bwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P8=function(){return!!t})()}function yS(t){return yS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yS(t)}function Uwe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LC(t,e)}function LC(t,e){return LC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},LC(t,e)}function T8(t,e,n){return e=O8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O8(t){var e=zwe(t,"string");return Cg(e)=="symbol"?e:e+""}function zwe(t,e){if(Cg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Cg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function FC(){return FC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FC.apply(this,arguments)}var Wwe=function(e){var n=e.yAxisId,r=AO(),i=jO(),s=s8(n);return s==null?null:T.createElement(Jg,FC({},s,{className:Ee("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(o){return ul(o,!0)}}))},sr=function(t){function e(){return Iwe(this,e),Lwe(this,e,arguments)}return Uwe(e,t),$we(e,[{key:"render",value:function(){return T.createElement(Wwe,this.props)}}])}(T.Component);T8(sr,"displayName","YAxis");T8(sr,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function LL(t){return Kwe(t)||Gwe(t)||qwe(t)||Hwe()}function Hwe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qwe(t,e){if(t){if(typeof t=="string")return BC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BC(t,e)}}function Gwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kwe(t){if(Array.isArray(t))return BC(t)}function BC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var UC=function(e,n,r,i,s){var a=Lr(e,Ub),o=Lr(e,oj),l=[].concat(LL(a),LL(o)),u=Lr(e,cj),d="".concat(i,"Id"),f=i[0],p=n;if(l.length&&(p=l.reduce(function(g,v){if(v.props[d]===r&&eo(v.props,"extendDomain")&&oe(v.props[f])){var b=v.props[f];return[Math.min(g[0],b),Math.max(g[1],b)]}return g},p)),u.length){var m="".concat(f,"1"),y="".concat(f,"2");p=u.reduce(function(g,v){if(v.props[d]===r&&eo(v.props,"extendDomain")&&oe(v.props[m])&&oe(v.props[y])){var b=v.props[m],x=v.props[y];return[Math.min(g[0],b,x),Math.max(g[1],b,x)]}return g},p)}return s&&s.length&&(p=s.reduce(function(g,v){return oe(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},p)),p},M8={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function s(l,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new i(d,f||l,p),y=n?n+u:u;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=n?n+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,m=f.length,y=new Array(m);p<m;p++)y[p]=f[p].fn;return y},o.prototype.listenerCount=function(u){var d=n?n+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,p,m,y){var g=n?n+u:u;if(!this._events[g])return!1;var v=this._events[g],b=arguments.length,x,w;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),b){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,p),!0;case 5:return v.fn.call(v.context,d,f,p,m),!0;case 6:return v.fn.call(v.context,d,f,p,m,y),!0}for(w=1,x=new Array(b-1);w<b;w++)x[w-1]=arguments[w];v.fn.apply(v.context,x)}else{var S=v.length,_;for(w=0;w<S;w++)switch(v[w].once&&this.removeListener(u,v[w].fn,void 0,!0),b){case 1:v[w].fn.call(v[w].context);break;case 2:v[w].fn.call(v[w].context,d);break;case 3:v[w].fn.call(v[w].context,d,f);break;case 4:v[w].fn.call(v[w].context,d,f,p);break;default:if(!x)for(_=1,x=new Array(b-1);_<b;_++)x[_-1]=arguments[_];v[w].fn.apply(v[w].context,x)}}return!0},o.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,p){var m=n?n+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===d&&(!p||y.once)&&(!f||y.context===f)&&a(this,m);else{for(var g=0,v=[],b=y.length;g<b;g++)(y[g].fn!==d||p&&!y[g].once||f&&y[g].context!==f)&&v.push(y[g]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&a(this,d)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(M8);var Vwe=M8.exports;const Ywe=at(Vwe);var Mk=new Ywe,Rk="recharts.syncMouseEvents";function wv(t){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wv(t)}function Xwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qwe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R8(r.key),r)}}function Jwe(t,e,n){return e&&Qwe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ik(t,e,n){return e=R8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R8(t){var e=Zwe(t,"string");return wv(e)=="symbol"?e:e+""}function Zwe(t,e){if(wv(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(wv(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var e1e=function(){function t(){Xwe(this,t),Ik(this,"activeIndex",0),Ik(this,"coordinateList",[]),Ik(this,"layout","horizontal")}return Jwe(t,[{key:"setDetails",value:function(n){var r,i=n.coordinateList,s=i===void 0?null:i,a=n.container,o=a===void 0?null:a,l=n.layout,u=l===void 0?null:l,d=n.offset,f=d===void 0?null:d,p=n.mouseHandlerCallback,m=p===void 0?null:p;this.coordinateList=(r=s??this.coordinateList)!==null&&r!==void 0?r:[],this.container=o??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),s=i.x,a=i.y,o=i.height,l=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,d=((r=window)===null||r===void 0?void 0:r.scrollY)||0,f=s+l+u,p=a+this.offset.top+o/2+d;this.mouseHandlerCallback({pageX:f,pageY:p})}}}])}();function t1e(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var r=t==null?void 0:t[0],i=t==null?void 0:t[1];if(r&&i&&oe(r)&&oe(i))return!0}return!1}function n1e(t,e,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-i,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function I8(t){var e=t.cx,n=t.cy,r=t.radius,i=t.startAngle,s=t.endAngle,a=Et(e,n,r,i),o=Et(e,n,r,s);return{points:[a,o],cx:e,cy:n,radius:r,startAngle:i,endAngle:s}}function r1e(t,e,n){var r,i,s,a;if(t==="horizontal")r=e.x,s=r,i=n.top,a=n.top+n.height;else if(t==="vertical")i=e.y,a=i,r=n.left,s=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var o=e.cx,l=e.cy,u=e.innerRadius,d=e.outerRadius,f=e.angle,p=Et(o,l,u,f),m=Et(o,l,d,f);r=p.x,i=p.y,s=m.x,a=m.y}else return I8(e);return[{x:r,y:i},{x:s,y:a}]}function _v(t){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_v(t)}function FL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Tw(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FL(Object(n),!0).forEach(function(r){i1e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function i1e(t,e,n){return e=s1e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s1e(t){var e=a1e(t,"string");return _v(e)=="symbol"?e:e+""}function a1e(t,e){if(_v(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(_v(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o1e(t){var e,n,r=t.element,i=t.tooltipEventType,s=t.isActive,a=t.activeCoordinate,o=t.activePayload,l=t.offset,u=t.activeTooltipIndex,d=t.tooltipAxisBandSize,f=t.layout,p=t.chartName,m=(e=r.props.cursor)!==null&&e!==void 0?e:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!m||!s||!a||p!=="ScatterChart"&&i!=="axis")return null;var y,g=fu;if(p==="ScatterChart")y=a,g=Xge;else if(p==="BarChart")y=n1e(f,a,l,d),g=bO;else if(f==="radial"){var v=I8(a),b=v.cx,x=v.cy,w=v.radius,S=v.startAngle,_=v.endAngle;y={cx:b,cy:x,startAngle:S,endAngle:_,innerRadius:w,outerRadius:w},g=AU}else y={points:r1e(f,a,l)},g=fu;var A=Tw(Tw(Tw(Tw({stroke:"#ccc",pointerEvents:"none"},l),y),xe(m,!1)),{},{payload:o,payloadIndex:u,className:Ee("recharts-tooltip-cursor",m.className)});return T.isValidElement(m)?T.cloneElement(m,A):T.createElement(g,A)}var l1e=["item"],c1e=["children","className","width","height","style","compact","title","desc"];function Pg(t){"@babel/helpers - typeof";return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pg(t)}function Vf(){return Vf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vf.apply(this,arguments)}function BL(t,e){return h1e(t)||d1e(t,e)||$8(t,e)||u1e()}function u1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d1e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(d){u=!0,i=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return o}}function h1e(t){if(Array.isArray(t))return t}function UL(t,e){if(t==null)return{};var n=f1e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function f1e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function p1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m1e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L8(r.key),r)}}function g1e(t,e,n){return e&&m1e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function y1e(t,e,n){return e=vS(e),v1e(t,D8()?Reflect.construct(e,n||[],vS(t).constructor):e.apply(t,n))}function v1e(t,e){if(e&&(Pg(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x1e(t)}function x1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function D8(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(D8=function(){return!!t})()}function vS(t){return vS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},vS(t)}function b1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zC(t,e)}function zC(t,e){return zC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},zC(t,e)}function Tg(t){return S1e(t)||_1e(t)||$8(t)||w1e()}function w1e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $8(t,e){if(t){if(typeof t=="string")return WC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WC(t,e)}}function _1e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function S1e(t){if(Array.isArray(t))return WC(t)}function WC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function zL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zL(Object(n),!0).forEach(function(r){Ae(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ae(t,e,n){return e=L8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L8(t){var e=A1e(t,"string");return Pg(e)=="symbol"?e:e+""}function A1e(t,e){if(Pg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Pg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var j1e={xAxis:["bottom","top"],yAxis:["left","right"]},k1e={width:"100%",height:"100%"},F8={x:0,y:0};function Ow(t){return t}var N1e=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},E1e=function(e,n,r,i){var s=n.find(function(d){return d&&d.index===r});if(s){if(e==="horizontal")return{x:s.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,o=i.radius;return ee(ee(ee({},i),Et(i.cx,i.cy,o,a)),{},{angle:a,radius:o})}var l=s.coordinate,u=i.angle;return ee(ee(ee({},i),Et(i.cx,i.cy,l,u)),{},{angle:u,radius:l})}return F8},hj=function(e,n){var r=n.graphicalItems,i=n.dataStartIndex,s=n.dataEndIndex,a=(r??[]).reduce(function(o,l){var u=l.props.data;return u&&u.length?[].concat(Tg(o),Tg(u)):o},[]);return a.length>0?a:e&&e.length&&oe(i)&&oe(s)?e.slice(i,s+1):[]};function B8(t){return t==="number"?[0,"auto"]:void 0}var HC=function(e,n,r,i){var s=e.graphicalItems,a=e.tooltipAxis,o=hj(n,e);return r<0||!s||!s.length||r>=o.length?null:s.reduce(function(l,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:n;f&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(f=f.slice(e.dataStartIndex,e.dataEndIndex+1));var p;if(a.dataKey&&!a.allowDuplicatedCategory){var m=f===void 0?o:f;p=m_(m,a.dataKey,i)}else p=f&&f[r]||o[r];return p?[].concat(Tg(l),[vU(u,p)]):l},[])},WL=function(e,n,r,i){var s=i||{x:e.chartX,y:e.chartY},a=N1e(s,r),o=e.orderedTooltipTicks,l=e.tooltipAxis,u=e.tooltipTicks,d=xfe(a,o,u,l);if(d>=0&&u){var f=u[d]&&u[d].value,p=HC(e,n,d,f),m=E1e(r,o,d,s);return{activeTooltipIndex:d,activeLabel:f,activePayload:p,activeCoordinate:m}}return null},C1e=function(e,n){var r=n.axes,i=n.graphicalItems,s=n.axisType,a=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,d=e.layout,f=e.children,p=e.stackOffset,m=hU(d,s);return r.reduce(function(y,g){var v,b=g.type.defaultProps!==void 0?ee(ee({},g.type.defaultProps),g.props):g.props,x=b.type,w=b.dataKey,S=b.allowDataOverflow,_=b.allowDuplicatedCategory,A=b.scale,j=b.ticks,N=b.includeHidden,P=b[a];if(y[P])return y;var O=hj(e.data,{graphicalItems:i.filter(function(B){var Y,ne=a in B.props?B.props[a]:(Y=B.type.defaultProps)===null||Y===void 0?void 0:Y[a];return ne===P}),dataStartIndex:l,dataEndIndex:u}),M=O.length,R,I,L;t1e(b.domain,S,x)&&(R=tC(b.domain,null,S),m&&(x==="number"||A!=="auto")&&(L=m0(O,w,"category")));var W=B8(x);if(!R||R.length===0){var F,z=(F=b.domain)!==null&&F!==void 0?F:W;if(w){if(R=m0(O,w,x),x==="category"&&m){var U=lJ(R);_&&U?(I=R,R=nS(0,M)):_||(R=o$(z,R,g).reduce(function(B,Y){return B.indexOf(Y)>=0?B:[].concat(Tg(B),[Y])},[]))}else if(x==="category")_?R=R.filter(function(B){return B!==""&&!we(B)}):R=o$(z,R,g).reduce(function(B,Y){return B.indexOf(Y)>=0||Y===""||we(Y)?B:[].concat(Tg(B),[Y])},[]);else if(x==="number"){var K=Afe(O,i.filter(function(B){var Y,ne,V=a in B.props?B.props[a]:(Y=B.type.defaultProps)===null||Y===void 0?void 0:Y[a],te="hide"in B.props?B.props.hide:(ne=B.type.defaultProps)===null||ne===void 0?void 0:ne.hide;return V===P&&(N||!te)}),w,s,d);K&&(R=K)}m&&(x==="number"||A!=="auto")&&(L=m0(O,w,"category"))}else m?R=nS(0,M):o&&o[P]&&o[P].hasStack&&x==="number"?R=p==="expand"?[0,1]:yU(o[P].stackGroups,l,u):R=dU(O,i.filter(function(B){var Y=a in B.props?B.props[a]:B.type.defaultProps[a],ne="hide"in B.props?B.props.hide:B.type.defaultProps.hide;return Y===P&&(N||!ne)}),x,d,!0);if(x==="number")R=UC(f,R,P,s,j),z&&(R=tC(z,R,S));else if(x==="category"&&z){var H=z,Q=R.every(function(B){return H.indexOf(B)>=0});Q&&(R=H)}}return ee(ee({},y),{},Ae({},P,ee(ee({},b),{},{axisType:s,domain:R,categoricalDomain:L,duplicateDomain:I,originalDomain:(v=b.domain)!==null&&v!==void 0?v:W,isCategorical:m,layout:d})))},{})},P1e=function(e,n){var r=n.graphicalItems,i=n.Axis,s=n.axisType,a=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,d=e.layout,f=e.children,p=hj(e.data,{graphicalItems:r,dataStartIndex:l,dataEndIndex:u}),m=p.length,y=hU(d,s),g=-1;return r.reduce(function(v,b){var x=b.type.defaultProps!==void 0?ee(ee({},b.type.defaultProps),b.props):b.props,w=x[a],S=B8("number");if(!v[w]){g++;var _;return y?_=nS(0,m):o&&o[w]&&o[w].hasStack?(_=yU(o[w].stackGroups,l,u),_=UC(f,_,w,s)):(_=tC(S,dU(p,r.filter(function(A){var j,N,P=a in A.props?A.props[a]:(j=A.type.defaultProps)===null||j===void 0?void 0:j[a],O="hide"in A.props?A.props.hide:(N=A.type.defaultProps)===null||N===void 0?void 0:N.hide;return P===w&&!O}),"number",d),i.defaultProps.allowDataOverflow),_=UC(f,_,w,s)),ee(ee({},v),{},Ae({},w,ee(ee({axisType:s},i.defaultProps),{},{hide:!0,orientation:Hi(j1e,"".concat(s,".").concat(g%2),null),domain:_,originalDomain:S,isCategorical:y,layout:d})))}return v},{})},T1e=function(e,n){var r=n.axisType,i=r===void 0?"xAxis":r,s=n.AxisComp,a=n.graphicalItems,o=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,d=e.children,f="".concat(i,"Id"),p=Lr(d,s),m={};return p&&p.length?m=C1e(e,{axes:p,graphicalItems:a,axisType:i,axisIdKey:f,stackGroups:o,dataStartIndex:l,dataEndIndex:u}):a&&a.length&&(m=P1e(e,{Axis:s,graphicalItems:a,axisType:i,axisIdKey:f,stackGroups:o,dataStartIndex:l,dataEndIndex:u})),m},O1e=function(e){var n=Xl(e),r=ul(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:KT(r,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:W_(n,r)}},HL=function(e){var n=e.children,r=e.defaultShowTooltip,i=Li(n,vg),s=0,a=0;return e.data&&e.data.length!==0&&(a=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(s=i.props.startIndex),i.props.endIndex>=0&&(a=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:a,activeTooltipIndex:-1,isTooltipActive:!!r}},M1e=function(e){return!e||!e.length?!1:e.some(function(n){var r=hl(n&&n.type);return r&&r.indexOf("Bar")>=0})},qL=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},R1e=function(e,n){var r=e.props,i=e.graphicalItems,s=e.xAxisMap,a=s===void 0?{}:s,o=e.yAxisMap,l=o===void 0?{}:o,u=r.width,d=r.height,f=r.children,p=r.margin||{},m=Li(f,vg),y=Li(f,Fr),g=Object.keys(l).reduce(function(_,A){var j=l[A],N=j.orientation;return!j.mirror&&!j.hide?ee(ee({},_),{},Ae({},N,_[N]+j.width)):_},{left:p.left||0,right:p.right||0}),v=Object.keys(a).reduce(function(_,A){var j=a[A],N=j.orientation;return!j.mirror&&!j.hide?ee(ee({},_),{},Ae({},N,Hi(_,"".concat(N))+j.height)):_},{top:p.top||0,bottom:p.bottom||0}),b=ee(ee({},v),g),x=b.bottom;m&&(b.bottom+=m.props.height||vg.defaultProps.height),y&&n&&(b=_fe(b,i,r,n));var w=u-b.left-b.right,S=d-b.top-b.bottom;return ee(ee({brushBottom:x},b),{},{width:Math.max(w,0),height:Math.max(S,0)})},I1e=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},zb=function(e){var n=e.chartName,r=e.GraphicalChild,i=e.defaultTooltipEventType,s=i===void 0?"axis":i,a=e.validateTooltipEventTypes,o=a===void 0?["axis"]:a,l=e.axisComponents,u=e.legendContent,d=e.formatAxisMap,f=e.defaultProps,p=function(b,x){var w=x.graphicalItems,S=x.stackGroups,_=x.offset,A=x.updateId,j=x.dataStartIndex,N=x.dataEndIndex,P=b.barSize,O=b.layout,M=b.barGap,R=b.barCategoryGap,I=b.maxBarSize,L=qL(O),W=L.numericAxisName,F=L.cateAxisName,z=M1e(w),U=[];return w.forEach(function(K,H){var Q=hj(b.data,{graphicalItems:[K],dataStartIndex:j,dataEndIndex:N}),B=K.type.defaultProps!==void 0?ee(ee({},K.type.defaultProps),K.props):K.props,Y=B.dataKey,ne=B.maxBarSize,V=B["".concat(W,"Id")],te=B["".concat(F,"Id")],$={},q=l.reduce(function(fi,Pu){var jj=x["".concat(Pu.axisType,"Map")],YO=B["".concat(Pu.axisType,"Id")];jj&&jj[YO]||Pu.axisType==="zAxis"||Kh();var XO=jj[YO];return ee(ee({},fi),{},Ae(Ae({},Pu.axisType,XO),"".concat(Pu.axisType,"Ticks"),ul(XO)))},$),G=q[F],re=q["".concat(F,"Ticks")],Z=S&&S[V]&&S[V].hasStack&&Mfe(K,S[V].stackGroups),J=hl(K.type).indexOf("Bar")>=0,X=W_(G,re),se=[],ce=z&&bfe({barSize:P,stackGroups:S,totalSize:I1e(q,F)});if(J){var ue,je,Be=we(ne)?I:ne,mt=(ue=(je=W_(G,re,!0))!==null&&je!==void 0?je:Be)!==null&&ue!==void 0?ue:0;se=wfe({barGap:M,barCategoryGap:R,bandSize:mt!==X?mt:X,sizeList:ce[te],maxBarSize:Be}),mt!==X&&(se=se.map(function(fi){return ee(ee({},fi),{},{position:ee(ee({},fi.position),{},{offset:fi.position.offset-mt/2})})}))}var Hr=K&&K.type&&K.type.getComposedData;Hr&&U.push({props:ee(ee({},Hr(ee(ee({},q),{},{displayedData:Q,props:b,dataKey:Y,item:K,bandSize:X,barPosition:se,offset:_,stackedData:Z,layout:O,dataStartIndex:j,dataEndIndex:N}))),{},Ae(Ae(Ae({key:K.key||"item-".concat(H)},W,q[W]),F,q[F]),"animationId",A)),childIndex:wJ(K,b.children),item:K})}),U},m=function(b,x){var w=b.props,S=b.dataStartIndex,_=b.dataEndIndex,A=b.updateId;if(!tI({props:w}))return null;var j=w.children,N=w.layout,P=w.stackOffset,O=w.data,M=w.reverseStackOrder,R=qL(N),I=R.numericAxisName,L=R.cateAxisName,W=Lr(j,r),F=Tfe(O,W,"".concat(I,"Id"),"".concat(L,"Id"),P,M),z=l.reduce(function(B,Y){var ne="".concat(Y.axisType,"Map");return ee(ee({},B),{},Ae({},ne,T1e(w,ee(ee({},Y),{},{graphicalItems:W,stackGroups:Y.axisType===I&&F,dataStartIndex:S,dataEndIndex:_}))))},{}),U=R1e(ee(ee({},z),{},{props:w,graphicalItems:W}),x==null?void 0:x.legendBBox);Object.keys(z).forEach(function(B){z[B]=d(w,z[B],U,B.replace("Map",""),n)});var K=z["".concat(L,"Map")],H=O1e(K),Q=p(w,ee(ee({},z),{},{dataStartIndex:S,dataEndIndex:_,updateId:A,graphicalItems:W,stackGroups:F,offset:U}));return ee(ee({formattedGraphicalItems:Q,graphicalItems:W,offset:U,stackGroups:F},H),z)},y=function(v){function b(x){var w,S,_;return p1e(this,b),_=y1e(this,b,[x]),Ae(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ae(_,"accessibilityManager",new e1e),Ae(_,"handleLegendBBoxUpdate",function(A){if(A){var j=_.state,N=j.dataStartIndex,P=j.dataEndIndex,O=j.updateId;_.setState(ee({legendBBox:A},m({props:_.props,dataStartIndex:N,dataEndIndex:P,updateId:O},ee(ee({},_.state),{},{legendBBox:A}))))}}),Ae(_,"handleReceiveSyncEvent",function(A,j,N){if(_.props.syncId===A){if(N===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(j)}}),Ae(_,"handleBrushChange",function(A){var j=A.startIndex,N=A.endIndex;if(j!==_.state.dataStartIndex||N!==_.state.dataEndIndex){var P=_.state.updateId;_.setState(function(){return ee({dataStartIndex:j,dataEndIndex:N},m({props:_.props,dataStartIndex:j,dataEndIndex:N,updateId:P},_.state))}),_.triggerSyncEvent({dataStartIndex:j,dataEndIndex:N})}}),Ae(_,"handleMouseEnter",function(A){var j=_.getMouseInfo(A);if(j){var N=ee(ee({},j),{},{isTooltipActive:!0});_.setState(N),_.triggerSyncEvent(N);var P=_.props.onMouseEnter;_e(P)&&P(N,A)}}),Ae(_,"triggeredAfterMouseMove",function(A){var j=_.getMouseInfo(A),N=j?ee(ee({},j),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(N),_.triggerSyncEvent(N);var P=_.props.onMouseMove;_e(P)&&P(N,A)}),Ae(_,"handleItemMouseEnter",function(A){_.setState(function(){return{isTooltipActive:!0,activeItem:A,activePayload:A.tooltipPayload,activeCoordinate:A.tooltipPosition||{x:A.cx,y:A.cy}}})}),Ae(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),Ae(_,"handleMouseMove",function(A){A.persist(),_.throttleTriggeredAfterMouseMove(A)}),Ae(_,"handleMouseLeave",function(A){_.throttleTriggeredAfterMouseMove.cancel();var j={isTooltipActive:!1};_.setState(j),_.triggerSyncEvent(j);var N=_.props.onMouseLeave;_e(N)&&N(j,A)}),Ae(_,"handleOuterEvent",function(A){var j=bJ(A),N=Hi(_.props,"".concat(j));if(j&&_e(N)){var P,O;/.*touch.*/i.test(j)?O=_.getMouseInfo(A.changedTouches[0]):O=_.getMouseInfo(A),N((P=O)!==null&&P!==void 0?P:{},A)}}),Ae(_,"handleClick",function(A){var j=_.getMouseInfo(A);if(j){var N=ee(ee({},j),{},{isTooltipActive:!0});_.setState(N),_.triggerSyncEvent(N);var P=_.props.onClick;_e(P)&&P(N,A)}}),Ae(_,"handleMouseDown",function(A){var j=_.props.onMouseDown;if(_e(j)){var N=_.getMouseInfo(A);j(N,A)}}),Ae(_,"handleMouseUp",function(A){var j=_.props.onMouseUp;if(_e(j)){var N=_.getMouseInfo(A);j(N,A)}}),Ae(_,"handleTouchMove",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(A.changedTouches[0])}),Ae(_,"handleTouchStart",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&_.handleMouseDown(A.changedTouches[0])}),Ae(_,"handleTouchEnd",function(A){A.changedTouches!=null&&A.changedTouches.length>0&&_.handleMouseUp(A.changedTouches[0])}),Ae(_,"handleDoubleClick",function(A){var j=_.props.onDoubleClick;if(_e(j)){var N=_.getMouseInfo(A);j(N,A)}}),Ae(_,"handleContextMenu",function(A){var j=_.props.onContextMenu;if(_e(j)){var N=_.getMouseInfo(A);j(N,A)}}),Ae(_,"triggerSyncEvent",function(A){_.props.syncId!==void 0&&Mk.emit(Rk,_.props.syncId,A,_.eventEmitterSymbol)}),Ae(_,"applySyncEvent",function(A){var j=_.props,N=j.layout,P=j.syncMethod,O=_.state.updateId,M=A.dataStartIndex,R=A.dataEndIndex;if(A.dataStartIndex!==void 0||A.dataEndIndex!==void 0)_.setState(ee({dataStartIndex:M,dataEndIndex:R},m({props:_.props,dataStartIndex:M,dataEndIndex:R,updateId:O},_.state)));else if(A.activeTooltipIndex!==void 0){var I=A.chartX,L=A.chartY,W=A.activeTooltipIndex,F=_.state,z=F.offset,U=F.tooltipTicks;if(!z)return;if(typeof P=="function")W=P(U,A);else if(P==="value"){W=-1;for(var K=0;K<U.length;K++)if(U[K].value===A.activeLabel){W=K;break}}var H=ee(ee({},z),{},{x:z.left,y:z.top}),Q=Math.min(I,H.x+H.width),B=Math.min(L,H.y+H.height),Y=U[W]&&U[W].value,ne=HC(_.state,_.props.data,W),V=U[W]?{x:N==="horizontal"?U[W].coordinate:Q,y:N==="horizontal"?B:U[W].coordinate}:F8;_.setState(ee(ee({},A),{},{activeLabel:Y,activeCoordinate:V,activePayload:ne,activeTooltipIndex:W}))}else _.setState(A)}),Ae(_,"renderCursor",function(A){var j,N=_.state,P=N.isTooltipActive,O=N.activeCoordinate,M=N.activePayload,R=N.offset,I=N.activeTooltipIndex,L=N.tooltipAxisBandSize,W=_.getTooltipEventType(),F=(j=A.props.active)!==null&&j!==void 0?j:P,z=_.props.layout,U=A.key||"_recharts-cursor";return D.createElement(o1e,{key:U,activeCoordinate:O,activePayload:M,activeTooltipIndex:I,chartName:n,element:A,isActive:F,layout:z,offset:R,tooltipAxisBandSize:L,tooltipEventType:W})}),Ae(_,"renderPolarAxis",function(A,j,N){var P=Hi(A,"type.axisType"),O=Hi(_.state,"".concat(P,"Map")),M=A.type.defaultProps,R=M!==void 0?ee(ee({},M),A.props):A.props,I=O&&O[R["".concat(P,"Id")]];return T.cloneElement(A,ee(ee({},I),{},{className:Ee(P,I.className),key:A.key||"".concat(j,"-").concat(N),ticks:ul(I,!0)}))}),Ae(_,"renderPolarGrid",function(A){var j=A.props,N=j.radialLines,P=j.polarAngles,O=j.polarRadius,M=_.state,R=M.radiusAxisMap,I=M.angleAxisMap,L=Xl(R),W=Xl(I),F=W.cx,z=W.cy,U=W.innerRadius,K=W.outerRadius;return T.cloneElement(A,{polarAngles:Array.isArray(P)?P:ul(W,!0).map(function(H){return H.coordinate}),polarRadius:Array.isArray(O)?O:ul(L,!0).map(function(H){return H.coordinate}),cx:F,cy:z,innerRadius:U,outerRadius:K,key:A.key||"polar-grid",radialLines:N})}),Ae(_,"renderLegend",function(){var A=_.state.formattedGraphicalItems,j=_.props,N=j.children,P=j.width,O=j.height,M=_.props.margin||{},R=P-(M.left||0)-(M.right||0),I=cU({children:N,formattedGraphicalItems:A,legendWidth:R,legendContent:u});if(!I)return null;var L=I.item,W=UL(I,l1e);return T.cloneElement(L,ee(ee({},W),{},{chartWidth:P,chartHeight:O,margin:M,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),Ae(_,"renderTooltip",function(){var A,j=_.props,N=j.children,P=j.accessibilityLayer,O=Li(N,on);if(!O)return null;var M=_.state,R=M.isTooltipActive,I=M.activeCoordinate,L=M.activePayload,W=M.activeLabel,F=M.offset,z=(A=O.props.active)!==null&&A!==void 0?A:R;return T.cloneElement(O,{viewBox:ee(ee({},F),{},{x:F.left,y:F.top}),active:z,label:W,payload:z?L:[],coordinate:I,accessibilityLayer:P})}),Ae(_,"renderBrush",function(A){var j=_.props,N=j.margin,P=j.data,O=_.state,M=O.offset,R=O.dataStartIndex,I=O.dataEndIndex,L=O.updateId;return T.cloneElement(A,{key:A.key||"_recharts-brush",onChange:Nw(_.handleBrushChange,A.props.onChange),data:P,x:oe(A.props.x)?A.props.x:M.left,y:oe(A.props.y)?A.props.y:M.top+M.height+M.brushBottom-(N.bottom||0),width:oe(A.props.width)?A.props.width:M.width,startIndex:R,endIndex:I,updateId:"brush-".concat(L)})}),Ae(_,"renderReferenceElement",function(A,j,N){if(!A)return null;var P=_,O=P.clipPathId,M=_.state,R=M.xAxisMap,I=M.yAxisMap,L=M.offset,W=A.type.defaultProps||{},F=A.props,z=F.xAxisId,U=z===void 0?W.xAxisId:z,K=F.yAxisId,H=K===void 0?W.yAxisId:K;return T.cloneElement(A,{key:A.key||"".concat(j,"-").concat(N),xAxis:R[U],yAxis:I[H],viewBox:{x:L.left,y:L.top,width:L.width,height:L.height},clipPathId:O})}),Ae(_,"renderActivePoints",function(A){var j=A.item,N=A.activePoint,P=A.basePoint,O=A.childIndex,M=A.isRange,R=[],I=j.props.key,L=j.item.type.defaultProps!==void 0?ee(ee({},j.item.type.defaultProps),j.item.props):j.item.props,W=L.activeDot,F=L.dataKey,z=ee(ee({index:O,dataKey:F,cx:N.x,cy:N.y,r:4,fill:xO(j.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},xe(W,!1)),g_(W));return R.push(b.renderActiveDot(W,z,"".concat(I,"-activePoint-").concat(O))),P?R.push(b.renderActiveDot(W,ee(ee({},z),{},{cx:P.x,cy:P.y}),"".concat(I,"-basePoint-").concat(O))):M&&R.push(null),R}),Ae(_,"renderGraphicChild",function(A,j,N){var P=_.filterFormatItem(A,j,N);if(!P)return null;var O=_.getTooltipEventType(),M=_.state,R=M.isTooltipActive,I=M.tooltipAxis,L=M.activeTooltipIndex,W=M.activeLabel,F=_.props.children,z=Li(F,on),U=P.props,K=U.points,H=U.isRange,Q=U.baseLine,B=P.item.type.defaultProps!==void 0?ee(ee({},P.item.type.defaultProps),P.item.props):P.item.props,Y=B.activeDot,ne=B.hide,V=B.activeBar,te=B.activeShape,$=!!(!ne&&R&&z&&(Y||V||te)),q={};O!=="axis"&&z&&z.props.trigger==="click"?q={onClick:Nw(_.handleItemMouseEnter,A.props.onClick)}:O!=="axis"&&(q={onMouseLeave:Nw(_.handleItemMouseLeave,A.props.onMouseLeave),onMouseEnter:Nw(_.handleItemMouseEnter,A.props.onMouseEnter)});var G=T.cloneElement(A,ee(ee({},P.props),q));function re(Pu){return typeof I.dataKey=="function"?I.dataKey(Pu.payload):null}if($)if(L>=0){var Z,J;if(I.dataKey&&!I.allowDuplicatedCategory){var X=typeof I.dataKey=="function"?re:"payload.".concat(I.dataKey.toString());Z=m_(K,X,W),J=H&&Q&&m_(Q,X,W)}else Z=K==null?void 0:K[L],J=H&&Q&&Q[L];if(te||V){var se=A.props.activeIndex!==void 0?A.props.activeIndex:L;return[T.cloneElement(A,ee(ee(ee({},P.props),q),{},{activeIndex:se})),null,null]}if(!we(Z))return[G].concat(Tg(_.renderActivePoints({item:P,activePoint:Z,basePoint:J,childIndex:L,isRange:H})))}else{var ce,ue=(ce=_.getItemByXY(_.state.activeCoordinate))!==null&&ce!==void 0?ce:{graphicalItem:G},je=ue.graphicalItem,Be=je.item,mt=Be===void 0?A:Be,Hr=je.childIndex,fi=ee(ee(ee({},P.props),q),{},{activeIndex:Hr});return[T.cloneElement(mt,fi),null,null]}return H?[G,null,null]:[G,null]}),Ae(_,"renderCustomized",function(A,j,N){return T.cloneElement(A,ee(ee({key:"recharts-customized-".concat(N)},_.props),_.state))}),Ae(_,"renderMap",{CartesianGrid:{handler:Ow,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:Ow},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:Ow},YAxis:{handler:Ow},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=x.id)!==null&&w!==void 0?w:ku("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=l6(_.triggeredAfterMouseMove,(S=x.throttleDelay)!==null&&S!==void 0?S:1e3/60),_.state={},_}return b1e(b,v),g1e(b,[{key:"componentDidMount",value:function(){var w,S;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,S=w.children,_=w.data,A=w.height,j=w.layout,N=Li(S,on);if(N){var P=N.props.defaultIndex;if(!(typeof P!="number"||P<0||P>this.state.tooltipTicks.length-1)){var O=this.state.tooltipTicks[P]&&this.state.tooltipTicks[P].value,M=HC(this.state,_,P,O),R=this.state.tooltipTicks[P].coordinate,I=(this.state.offset.top+A)/2,L=j==="horizontal",W=L?{x:R,y:I}:{y:R,x:I},F=this.state.formattedGraphicalItems.find(function(U){var K=U.item;return K.type.name==="Scatter"});F&&(W=ee(ee({},W),F.props.points[P].tooltipPosition),M=F.props.points[P].tooltipPayload);var z={activeTooltipIndex:P,isTooltipActive:!0,activeLabel:O,activePayload:M,activeCoordinate:W};this.setState(z),this.renderCursor(N),this.accessibilityManager.setIndex(P)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,S){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==S.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,A;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(A=this.props.margin.top)!==null&&A!==void 0?A:0}})}return null}},{key:"componentDidUpdate",value:function(w){gE([Li(w.children,on)],[Li(this.props.children,on)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=Li(this.props.children,on);if(w&&typeof w.props.shared=="boolean"){var S=w.props.shared?"axis":"item";return o.indexOf(S)>=0?S:s}return s}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var S=this.container,_=S.getBoundingClientRect(),A=Kle(_),j={chartX:Math.round(w.pageX-A.left),chartY:Math.round(w.pageY-A.top)},N=_.width/S.offsetWidth||1,P=this.inRange(j.chartX,j.chartY,N);if(!P)return null;var O=this.state,M=O.xAxisMap,R=O.yAxisMap,I=this.getTooltipEventType(),L=WL(this.state,this.props.data,this.props.layout,P);if(I!=="axis"&&M&&R){var W=Xl(M).scale,F=Xl(R).scale,z=W&&W.invert?W.invert(j.chartX):null,U=F&&F.invert?F.invert(j.chartY):null;return ee(ee({},j),{},{xValue:z,yValue:U},L)}return L?ee(ee({},j),L):null}},{key:"inRange",value:function(w,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=this.props.layout,j=w/_,N=S/_;if(A==="horizontal"||A==="vertical"){var P=this.state.offset,O=j>=P.left&&j<=P.left+P.width&&N>=P.top&&N<=P.top+P.height;return O?{x:j,y:N}:null}var M=this.state,R=M.angleAxisMap,I=M.radiusAxisMap;if(R&&I){var L=Xl(R);return u$({x:j,y:N},L)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,S=this.getTooltipEventType(),_=Li(w,on),A={};_&&S==="axis"&&(_.props.trigger==="click"?A={onClick:this.handleClick}:A={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var j=g_(this.props,this.handleOuterEvent);return ee(ee({},j),A)}},{key:"addListener",value:function(){Mk.on(Rk,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Mk.removeListener(Rk,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,S,_){for(var A=this.state.formattedGraphicalItems,j=0,N=A.length;j<N;j++){var P=A[j];if(P.item===w||P.props.key===w.key||S===hl(P.item.type)&&_===P.childIndex)return P}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,S=this.state.offset,_=S.left,A=S.top,j=S.height,N=S.width;return D.createElement("defs",null,D.createElement("clipPath",{id:w},D.createElement("rect",{x:_,y:A,height:j,width:N})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(S,_){var A=BL(_,2),j=A[0],N=A[1];return ee(ee({},S),{},Ae({},j,N.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(S,_){var A=BL(_,2),j=A[0],N=A[1];return ee(ee({},S),{},Ae({},j,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var S;return(S=this.state.xAxisMap)===null||S===void 0||(S=S[w])===null||S===void 0?void 0:S.scale}},{key:"getYScaleByAxisId",value:function(w){var S;return(S=this.state.yAxisMap)===null||S===void 0||(S=S[w])===null||S===void 0?void 0:S.scale}},{key:"getItemByXY",value:function(w){var S=this.state,_=S.formattedGraphicalItems,A=S.activeItem;if(_&&_.length)for(var j=0,N=_.length;j<N;j++){var P=_[j],O=P.props,M=P.item,R=M.type.defaultProps!==void 0?ee(ee({},M.type.defaultProps),M.props):M.props,I=hl(M.type);if(I==="Bar"){var L=(O.data||[]).find(function(U){return Pge(w,U)});if(L)return{graphicalItem:P,payload:L}}else if(I==="RadialBar"){var W=(O.data||[]).find(function(U){return u$(w,U)});if(W)return{graphicalItem:P,payload:W}}else if(nj(P,A)||rj(P,A)||gv(P,A)){var F=v0e({graphicalItem:P,activeTooltipItem:A,itemData:R.data}),z=R.activeIndex===void 0?F:R.activeIndex;return{graphicalItem:ee(ee({},P),{},{childIndex:z}),payload:gv(P,A)?R.data[F]:P.props.data[F]}}}return null}},{key:"render",value:function(){var w=this;if(!tI(this))return null;var S=this.props,_=S.children,A=S.className,j=S.width,N=S.height,P=S.style,O=S.compact,M=S.title,R=S.desc,I=UL(S,c1e),L=xe(I,!1);if(O)return D.createElement(vL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},D.createElement(vE,Vf({},L,{width:j,height:N,title:M,desc:R}),this.renderClipPath(),rI(_,this.renderMap)));if(this.props.accessibilityLayer){var W,F;L.tabIndex=(W=this.props.tabIndex)!==null&&W!==void 0?W:0,L.role=(F=this.props.role)!==null&&F!==void 0?F:"application",L.onKeyDown=function(U){w.accessibilityManager.keyboardEvent(U)},L.onFocus=function(){w.accessibilityManager.focus()}}var z=this.parseEventsOfWrapper();return D.createElement(vL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},D.createElement("div",Vf({className:Ee("recharts-wrapper",A),style:ee({position:"relative",cursor:"default",width:j,height:N},P)},z,{ref:function(K){w.container=K}}),D.createElement(vE,Vf({},L,{width:j,height:N,title:M,desc:R,style:k1e}),this.renderClipPath(),rI(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(T.Component);Ae(y,"displayName",n),Ae(y,"defaultProps",ee({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Ae(y,"getDerivedStateFromProps",function(v,b){var x=v.dataKey,w=v.data,S=v.children,_=v.width,A=v.height,j=v.layout,N=v.stackOffset,P=v.margin,O=b.dataStartIndex,M=b.dataEndIndex;if(b.updateId===void 0){var R=HL(v);return ee(ee(ee({},R),{},{updateId:0},m(ee(ee({props:v},R),{},{updateId:0}),b)),{},{prevDataKey:x,prevData:w,prevWidth:_,prevHeight:A,prevLayout:j,prevStackOffset:N,prevMargin:P,prevChildren:S})}if(x!==b.prevDataKey||w!==b.prevData||_!==b.prevWidth||A!==b.prevHeight||j!==b.prevLayout||N!==b.prevStackOffset||!lp(P,b.prevMargin)){var I=HL(v),L={chartX:b.chartX,chartY:b.chartY,isTooltipActive:b.isTooltipActive},W=ee(ee({},WL(b,w,j)),{},{updateId:b.updateId+1}),F=ee(ee(ee({},I),L),W);return ee(ee(ee({},F),m(ee({props:v},F),b)),{},{prevDataKey:x,prevData:w,prevWidth:_,prevHeight:A,prevLayout:j,prevStackOffset:N,prevMargin:P,prevChildren:S})}if(!gE(S,b.prevChildren)){var z,U,K,H,Q=Li(S,vg),B=Q&&(z=(U=Q.props)===null||U===void 0?void 0:U.startIndex)!==null&&z!==void 0?z:O,Y=Q&&(K=(H=Q.props)===null||H===void 0?void 0:H.endIndex)!==null&&K!==void 0?K:M,ne=B!==O||Y!==M,V=!we(w),te=V&&!ne?b.updateId:b.updateId+1;return ee(ee({updateId:te},m(ee(ee({props:v},b),{},{updateId:te,dataStartIndex:B,dataEndIndex:Y}),b)),{},{prevChildren:S,dataStartIndex:B,dataEndIndex:Y})}return null}),Ae(y,"renderActiveDot",function(v,b,x){var w;return T.isValidElement(v)?w=T.cloneElement(v,b):_e(v)?w=v(b):w=D.createElement(Bb,b),D.createElement(Re,{className:"recharts-active-dot",key:x},w)});var g=T.forwardRef(function(b,x){return D.createElement(y,Vf({},b,{ref:x}))});return g.displayName=y.displayName,g},Zg=zb({chartName:"LineChart",GraphicalChild:di,axisComponents:[{axisType:"xAxis",AxisComp:ir},{axisType:"yAxis",AxisComp:sr}],formatAxisMap:sj}),fj=zb({chartName:"BarChart",GraphicalChild:br,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:ir},{axisType:"yAxis",AxisComp:sr}],formatAxisMap:sj}),D1e=zb({chartName:"PieChart",GraphicalChild:Ol,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:tj},{axisType:"radiusAxis",AxisComp:ZA}],formatAxisMap:Wfe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),$1e=zb({chartName:"AreaChart",GraphicalChild:no,axisComponents:[{axisType:"xAxis",AxisComp:ir},{axisType:"yAxis",AxisComp:sr}],formatAxisMap:sj}),L1e=zb({chartName:"ComposedChart",GraphicalChild:[di,no,br,dj],axisComponents:[{axisType:"xAxis",AxisComp:ir},{axisType:"yAxis",AxisComp:sr},{axisType:"zAxis",AxisComp:uj}],formatAxisMap:sj});function Wr(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function ro(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function F1e(t,e){const n=Wr(t);return isNaN(e)?ro(t,NaN):(n.setDate(n.getDate()+e),n)}function U8(t,e){const n=Wr(t);if(isNaN(e))return ro(t,NaN);if(!e)return n;const r=n.getDate(),i=ro(t,n.getTime());i.setMonth(n.getMonth()+e+1,0);const s=i.getDate();return r>=s?i:(n.setFullYear(i.getFullYear(),i.getMonth(),r),n)}const z8=6048e5,B1e=864e5;let U1e={};function pj(){return U1e}function Sv(t,e){var o,l,u,d;const n=pj(),r=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,i=Wr(t),s=i.getDay(),a=(s<r?7:0)+s-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function xS(t){return Sv(t,{weekStartsOn:1})}function W8(t){const e=Wr(t),n=e.getFullYear(),r=ro(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const i=xS(r),s=ro(t,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const a=xS(s);return e.getTime()>=i.getTime()?n+1:e.getTime()>=a.getTime()?n:n-1}function GL(t){const e=Wr(t);return e.setHours(0,0,0,0),e}function KL(t){const e=Wr(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function z1e(t,e){const n=GL(t),r=GL(e),i=+n-KL(n),s=+r-KL(r);return Math.round((i-s)/B1e)}function W1e(t){const e=W8(t),n=ro(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),xS(n)}function H1e(t,e){return U8(t,e*12)}function q1e(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function G1e(t){if(!q1e(t)&&typeof t!="number")return!1;const e=Wr(t);return!isNaN(Number(e))}function H8(t){const e=Wr(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function Av(t){const e=Wr(t);return e.setDate(1),e.setHours(0,0,0,0),e}function q8(t){const e=Wr(t),n=ro(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}const K1e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},V1e=(t,e,n)=>{let r;const i=K1e[t];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Dk(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Y1e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},X1e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Q1e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},J1e={date:Dk({formats:Y1e,defaultWidth:"full"}),time:Dk({formats:X1e,defaultWidth:"full"}),dateTime:Dk({formats:Q1e,defaultWidth:"full"})},Z1e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e_e=(t,e,n,r)=>Z1e[t];function xy(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,o=n!=null&&n.width?String(n.width):a;i=t.formattingValues[o]||t.formattingValues[a]}else{const a=t.defaultWidth,o=n!=null&&n.width?String(n.width):t.defaultWidth;i=t.values[o]||t.values[a]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}const t_e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},n_e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r_e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},i_e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},s_e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},a_e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},o_e=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},l_e={ordinalNumber:o_e,era:xy({values:t_e,defaultWidth:"wide"}),quarter:xy({values:n_e,defaultWidth:"wide",argumentCallback:t=>t-1}),month:xy({values:r_e,defaultWidth:"wide"}),day:xy({values:i_e,defaultWidth:"wide"}),dayPeriod:xy({values:s_e,defaultWidth:"wide",formattingValues:a_e,defaultFormattingWidth:"wide"})};function by(t){return(e,n={})=>{const r=n.width,i=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],o=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?u_e(o,f=>f.test(a)):c_e(o,f=>f.test(a));let u;u=t.valueCallback?t.valueCallback(l):l,u=n.valueCallback?n.valueCallback(u):u;const d=e.slice(a.length);return{value:u,rest:d}}}function c_e(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function u_e(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function d_e(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const i=r[0],s=e.match(t.parsePattern);if(!s)return null;let a=t.valueCallback?t.valueCallback(s[0]):s[0];a=n.valueCallback?n.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const h_e=/^(\d+)(th|st|nd|rd)?/i,f_e=/\d+/i,p_e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},m_e={any:[/^b/i,/^(a|c)/i]},g_e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},y_e={any:[/1/i,/2/i,/3/i,/4/i]},v_e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},x_e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},b_e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},w_e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},__e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},S_e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},A_e={ordinalNumber:d_e({matchPattern:h_e,parsePattern:f_e,valueCallback:t=>parseInt(t,10)}),era:by({matchPatterns:p_e,defaultMatchWidth:"wide",parsePatterns:m_e,defaultParseWidth:"any"}),quarter:by({matchPatterns:g_e,defaultMatchWidth:"wide",parsePatterns:y_e,defaultParseWidth:"any",valueCallback:t=>t+1}),month:by({matchPatterns:v_e,defaultMatchWidth:"wide",parsePatterns:x_e,defaultParseWidth:"any"}),day:by({matchPatterns:b_e,defaultMatchWidth:"wide",parsePatterns:w_e,defaultParseWidth:"any"}),dayPeriod:by({matchPatterns:__e,defaultMatchWidth:"any",parsePatterns:S_e,defaultParseWidth:"any"})},j_e={code:"en-US",formatDistance:V1e,formatLong:J1e,formatRelative:e_e,localize:l_e,match:A_e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function k_e(t){const e=Wr(t);return z1e(e,q8(e))+1}function N_e(t){const e=Wr(t),n=+xS(e)-+W1e(e);return Math.round(n/z8)+1}function G8(t,e){var d,f,p,m;const n=Wr(t),r=n.getFullYear(),i=pj(),s=(e==null?void 0:e.firstWeekContainsDate)??((f=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??i.firstWeekContainsDate??((m=(p=i.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,a=ro(t,0);a.setFullYear(r+1,0,s),a.setHours(0,0,0,0);const o=Sv(a,e),l=ro(t,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const u=Sv(l,e);return n.getTime()>=o.getTime()?r+1:n.getTime()>=u.getTime()?r:r-1}function E_e(t,e){var o,l,u,d;const n=pj(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,i=G8(t,e),s=ro(t,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),Sv(s,e)}function C_e(t,e){const n=Wr(t),r=+Sv(n,e)-+E_e(n,e);return Math.round(r/z8)+1}function it(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const $l={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return it(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):it(n+1,2)},d(t,e){return it(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return it(t.getHours()%12||12,e.length)},H(t,e){return it(t.getHours(),e.length)},m(t,e){return it(t.getMinutes(),e.length)},s(t,e){return it(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return it(i,e.length)}},xf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},VL={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return $l.y(t,e)},Y:function(t,e,n,r){const i=G8(t,r),s=i>0?i:1-i;if(e==="YY"){const a=s%100;return it(a,2)}return e==="Yo"?n.ordinalNumber(s,{unit:"year"}):it(s,e.length)},R:function(t,e){const n=W8(t);return it(n,e.length)},u:function(t,e){const n=t.getFullYear();return it(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return it(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return it(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return $l.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return it(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const i=C_e(t,r);return e==="wo"?n.ordinalNumber(i,{unit:"week"}):it(i,e.length)},I:function(t,e,n){const r=N_e(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):it(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):$l.d(t,e)},D:function(t,e,n){const r=k_e(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):it(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const i=t.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return it(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const i=t.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return it(s,e.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return it(i,e.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let i;switch(r===12?i=xf.noon:r===0?i=xf.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let i;switch(r>=17?i=xf.evening:r>=12?i=xf.afternoon:r>=4?i=xf.morning:i=xf.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return $l.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):$l.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):it(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):it(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):$l.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):$l.s(t,e)},S:function(t,e){return $l.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return XL(r);case"XXXX":case"XX":return zu(r);case"XXXXX":case"XXX":default:return zu(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return XL(r);case"xxxx":case"xx":return zu(r);case"xxxxx":case"xxx":default:return zu(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+YL(r,":");case"OOOO":default:return"GMT"+zu(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+YL(r,":");case"zzzz":default:return"GMT"+zu(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return it(r,e.length)},T:function(t,e,n){const r=t.getTime();return it(r,e.length)}};function YL(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),i=Math.trunc(r/60),s=r%60;return s===0?n+String(i):n+String(i)+e+it(s,2)}function XL(t,e){return t%60===0?(t>0?"-":"+")+it(Math.abs(t)/60,2):zu(t,e)}function zu(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),i=it(Math.trunc(r/60),2),s=it(r%60,2);return n+i+e+s}const QL=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},K8=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},P_e=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return QL(t,e);let s;switch(r){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",QL(r,e)).replace("{{time}}",K8(i,e))},T_e={p:K8,P:P_e},O_e=/^D+$/,M_e=/^Y+$/,R_e=["D","DD","YY","YYYY"];function I_e(t){return O_e.test(t)}function D_e(t){return M_e.test(t)}function $_e(t,e,n){const r=L_e(t,e,n);if(console.warn(r),R_e.includes(t))throw new RangeError(r)}function L_e(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const F_e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,B_e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,U_e=/^'([^]*?)'?$/,z_e=/''/g,W_e=/[a-zA-Z]/;function Je(t,e,n){var d,f,p,m;const r=pj(),i=r.locale??j_e,s=r.firstWeekContainsDate??((f=(d=r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,a=r.weekStartsOn??((m=(p=r.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??0,o=Wr(t);if(!G1e(o))throw new RangeError("Invalid time value");let l=e.match(B_e).map(y=>{const g=y[0];if(g==="p"||g==="P"){const v=T_e[g];return v(y,i.formatLong)}return y}).join("").match(F_e).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const g=y[0];if(g==="'")return{isToken:!1,value:H_e(y)};if(VL[g])return{isToken:!0,value:y};if(g.match(W_e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(y=>{if(!y.isToken)return y.value;const g=y.value;(D_e(g)||I_e(g))&&$_e(g,e,String(t));const v=VL[g[0]];return v(o,g,i.localize,u)}).join("")}function H_e(t){const e=t.match(U_e);return e?e[1].replace(z_e,"'"):t}function JL(t,e){return F1e(t,-30)}function $k(t,e){return U8(t,-e)}function ie(t,e){if(e!=null&&e.compact)return q_e(t);const n=t<0,r=Math.abs(t),i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(r);return n?`- ${i}`:i}function wa(t){if(typeof t=="string"){const s=t.split("T")[0].split("-");if(s.length===3){const[a,o,l]=s;return`${o}/${l}/${a}`}}const e=typeof t=="string"?new Date(t):t,n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=e.getFullYear();return`${n}/${r}/${i}`}function q_e(t){return Math.abs(t)>=1e6?`$${(t/1e6).toFixed(1)}M`:Math.abs(t)>=1e3?`$${(t/1e3).toFixed(1)}K`:ie(t)}function V8({title:t,yearsToFI:e,fiNumber:n,remainingNeeded:r,currentProgress:i,projectionData:s,annualSavings:a,successProbability:o,onTrackStatus:l,isLoading:u,error:d}){if(u)return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[c.jsx("p",{className:"text-gray-500",children:"Calculating your projection..."}),c.jsx("div",{className:"mt-4 h-32 w-full bg-gray-200 rounded animate-pulse"})]});if(d)return c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[c.jsx("p",{className:"text-red-700 font-semibold",children:"Error calculating projection"}),c.jsx("p",{className:"text-red-600 text-sm mt-1",children:d.message})]});const f=H1e(new Date,e),p=v=>v<=0?"text-green-600":v<=10?"text-green-500":v<=20?"text-yellow-500":v<=30?"text-orange-500":"text-gray-500",m=v=>v>=100?"bg-green-600":v>=75?"bg-green-500":v>=50?"bg-yellow-500":v>=25?"bg-orange-500":"bg-gray-400",y=v=>v>=80?{bg:"bg-green-100",text:"text-green-800",border:"border-green-200"}:v>=50?{bg:"bg-yellow-100",text:"text-yellow-800",border:"border-yellow-200"}:{bg:"bg-red-100",text:"text-red-800",border:"border-red-200"},g=v=>{switch(v){case"ahead":return{icon:"",text:"Ahead of Plan",color:"text-green-600"};case"behind":return{icon:"",text:"Behind Plan",color:"text-red-600"};default:return{icon:"",text:"On Track",color:"text-blue-600"}}};return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t}),o!==null&&typeof o<"u"&&c.jsxs("div",{className:`px-2 py-1 rounded text-xs font-semibold border ${y(o).bg} ${y(o).text} ${y(o).border}`,children:[o.toFixed(0),"% Success"]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Years to FI"}),c.jsxs("div",{className:"flex items-end gap-4",children:[c.jsx("p",{className:`text-4xl font-bold ${p(e)}`,children:e===1/0?"":e<=0?"FI!":e.toFixed(1)}),s.length>0&&c.jsx("div",{className:"flex-1",style:{height:"60px"},children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsx(Zg,{data:s,children:c.jsx(di,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:2,dot:!1,isAnimationActive:!1})})})})]}),e>0&&e<1/0&&c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Expected: ",Je(f,"MMMM yyyy")]})]}),l&&c.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[c.jsx("span",{className:"text-2xl",children:g(l.status).icon}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:`text-sm font-semibold ${g(l.status).color}`,children:g(l.status).text}),c.jsxs("p",{className:"text-xs text-gray-600",children:[l.variance>=0?"+":"",ie(l.variance)," vs scenario"]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[c.jsx("span",{children:"Progress"}),c.jsxs("span",{children:[i.toFixed(1),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`${m(i)} h-2 rounded-full transition-all`,style:{width:`${Math.min(i,100)}%`}})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-600",children:"FI Number"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:ie(n)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-600",children:"Remaining Needed"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:ie(r)})]})]}),a<=0&&i<100&&c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:c.jsxs("p",{className:"text-sm text-yellow-800",children:[" You need to save money to reach FI. Current savings: ",ie(a)]})})]})]})}function G_e(){var u,d,f,p;const{data:t,isLoading:e,error:n}=CV(),r=(t==null?void 0:t.projection.map(m=>({year:m.year,value:m.netWorth})))??[],i=(t==null?void 0:t.fiNumber)??0,s=((d=(u=t==null?void 0:t.projection)==null?void 0:u[0])==null?void 0:d.netWorth)??0,a=Math.max(0,i-s),o=i>0?s/i*100:0,l=((p=(f=t==null?void 0:t.projection)==null?void 0:f[0])==null?void 0:p.savings)??0;return c.jsx(V8,{title:"Data-Driven FI Projection",yearsToFI:(t==null?void 0:t.yearsToFI)??0,fiNumber:i,remainingNeeded:a,currentProgress:o,projectionData:r,annualSavings:l,successProbability:null,onTrackStatus:null,isLoading:e,error:n})}function K_e(t){const n=new Date().getFullYear()-t.current_age,r=n+t.retirement_age,i=n+t.life_expectancy;return{name:t.name,retirement_date:t.retirement_age>t.current_age?`${r}-01-01`:null,death_date:`${i}-01-01`,mean_return_real:t.expected_return_mean,stdev_return_real:t.expected_return_stdev,inflation:t.inflation_rate,swr:.04,withdrawal_rule:t.withdrawal_strategy,use_monte_carlo:!0,use_historical:!1,portfolio_value_now:t.current_savings,savings:t.annual_contribution,expenses:t.annual_expenses,portfolio_stocks:t.portfolio_stock_pct,current_age:t.current_age,retirement_age:t.retirement_age,life_expectancy:t.life_expectancy,notes:t.notes||null}}function V_e(t){const n=new Date().getFullYear()-t.current_age,r=n+t.retirement_age,i=n+t.life_expectancy;return{name:t.name,retirement_date:t.retirement_age>t.current_age?`${r}-01-01`:null,death_date:`${i}-01-01`,mean_return_real:t.expected_return_mean,stdev_return_real:t.expected_return_stdev,inflation:t.inflation_rate,swr:.04,withdrawal_rule:t.withdrawal_strategy,use_monte_carlo:!0,use_historical:!1,portfolio_value_now:t.current_savings,savings:t.annual_contribution,expenses:t.annual_expenses,portfolio_stocks:t.portfolio_stock_pct,current_age:t.current_age,retirement_age:t.retirement_age,life_expectancy:t.life_expectancy,notes:t.notes||null}}function Y8(t){var l;const e=t.current_age||35,n=t.retirement_age||65,r=t.life_expectancy||95,i=t.notes||null,s=((l=t.withdrawal_rule)==null?void 0:l.trim())||"fixed",o=["fixed","percentage","guardrails"].includes(s)?s:"fixed";return{id:t.id,name:t.name||"Unnamed Scenario",current_age:e,retirement_age:n,life_expectancy:r,current_savings:t.portfolio_value_now||0,annual_contribution:t.savings||0,annual_expenses:t.expenses||0,portfolio_stock_pct:t.portfolio_stocks||.6,expected_return_mean:t.mean_return_real||.05,expected_return_stdev:t.stdev_return_real||.12,inflation_rate:t.inflation||.02,withdrawal_strategy:o,notes:i,created_at:t.created_at||new Date().toISOString()}}async function X8(){const t=await He(),{data:e,error:n}=await he.from("settings").select("selected_scenario_id").eq("created_by",t).single();return n?(console.error("Error fetching selected scenario ID:",n),null):(e==null?void 0:e.selected_scenario_id)||null}async function Y_e(){const t=await X8();if(!t)return null;const{data:e,error:n}=await he.from("scenarios").select("*").eq("id",t).single();return n?(console.error("Error fetching selected scenario:",n),null):e?Y8(e):null}async function X_e(t){const e=await He(),{error:n}=await he.from("settings").update({selected_scenario_id:t}).eq("created_by",e);if(n)throw new Error(`Failed to update selected scenario: ${n.message}`)}function CO(){const t=Xe(),{data:e,isLoading:n}=Bt({queryKey:["selectedScenarioId"],queryFn:X8,staleTime:5*60*1e3}),{data:r,isLoading:i}=Bt({queryKey:["selectedScenario",e],queryFn:Y_e,enabled:!!e,staleTime:5*60*1e3}),s=et({mutationFn:X_e,onSuccess:()=>{t.invalidateQueries({queryKey:["selectedScenarioId"]}),t.invalidateQueries({queryKey:["selectedScenario"]}),t.invalidateQueries({queryKey:["dashboardMetrics"]})}});return{selectedScenarioId:e,selectedScenario:r,isLoading:n||i,setSelectedScenario:s.mutate,isUpdating:s.isPending}}function ar(){return Bt({queryKey:["accounts"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("accounts").select(`
          *,
          account_group:account_groups(*)
        `).eq("created_by",t).order("name");if(n)throw n;return e}})}function lo(t=50){return Bt({queryKey:["transactions",t],queryFn:async()=>{const e=await He(),{data:n,error:r}=await he.from("transactions").select("*").eq("created_by",e).order("updated_at",{ascending:!1}).limit(t);if(r)throw r;return n},staleTime:0,refetchOnMount:"always",gcTime:t===5?0:5*60*1e3})}function mj(){const t=Xe();return et({mutationFn:async e=>{if(!e.account_id)throw new Error("Account ID is required");if(!e.date)throw new Error("Date is required");if(e.amount===void 0||e.amount===null)throw new Error("Amount is required");if(Math.abs(e.amount)>1e9)throw new Error("Amount is unrealistically large");if(Math.abs(e.amount)===0)throw new Error("Amount cannot be zero");const n={...e,transaction_type:e.transaction_type||(e.amount<0?"expense":"income")};return await ks("transactions",n)},onSuccess:async()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]}),t.invalidateQueries({queryKey:["income-expenses"]}),t.invalidateQueries({queryKey:["net-worth-history"]})}})}function Q8(){const t=Xe();return et({mutationFn:async({id:e,updates:n})=>{const r=await He(),{data:i,error:s}=await he.from("transactions").update(n).eq("id",e).eq("created_by",r).select().single();if(s)throw s;return i},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]}),t.invalidateQueries({queryKey:["income-expenses"]}),t.invalidateQueries({queryKey:["net-worth-history"]})}})}function J8(){const t=Xe();return et({mutationFn:async e=>{const n=await He(),{error:r}=await he.from("transactions").delete().eq("id",e).eq("created_by",n);if(r)throw r},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]}),t.invalidateQueries({queryKey:["income-expenses"]}),t.invalidateQueries({queryKey:["net-worth-history"]})}})}function Q_e(){const t=Xe();return et({mutationFn:async e=>{const n=await He(),{error:r}=await he.from("transactions").delete().in("id",e).eq("created_by",n);if(r)throw r;return e.length},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]}),t.invalidateQueries({queryKey:["income-expenses"]}),t.invalidateQueries({queryKey:["net-worth-history"]})}})}function J_e(){const t=Xe();return et({mutationFn:async({ids:e,updates:n})=>{const r=await He(),i=await Promise.all(e.map(a=>he.from("transactions").update(n).eq("id",a).eq("created_by",r).select().single())),s=i.filter(a=>a.error);if(s.length>0)throw new Error(`Failed to update ${s.length} transaction(s)`);return i.map(a=>a.data)},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]}),t.invalidateQueries({queryKey:["income-expenses"]}),t.invalidateQueries({queryKey:["net-worth-history"]})}})}function gj(){const{data:t=[]}=ar(),{data:e=[]}=lo(100);return T.useMemo(()=>{const r=t.reduce((y,g)=>{const v=g.current_balance||0;return["credit","mortgage"].includes(g.type)?y-Math.abs(v):y+v},0),i=new Date,s=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`,a=e.filter(y=>y.date.startsWith(s)),o=a.reduce((y,g)=>g.amount<0?y+Math.abs(g.amount):y,0),l=a.reduce((y,g)=>g.amount>0?y+g.amount:y,0),u=l>0?(l-o)/l*100:0,f=o*12*25,p=f>0?r/f*100:0;let m=0;if(l>o&&l>0){const y=l-o,g=Math.max(0,f-r);y>0&&(m=g/(y*12))}return{netWorth:r,monthlySpending:o,monthlyIncome:l,savingsRate:u,fireNumber:f,progressToFire:p,yearsToFire:m>0&&m<100?m:null,transactionCount:e.length,accountCount:t.length}},[t,e])}function Z8(t){const{currentNetWorth:e,annualExpenses:n,annualSavings:r,expectedReturn:i,withdrawalRate:s,safetyMargin:a=1}=t,o=n/s*a,l=o>0?Math.min(e/o*100,100):0,u=Math.max(0,o-e);if(e>=o)return{yearsToFI:0,fiNumber:o,currentProgress:100,projectedFIDate:new Date,remainingNeeded:0};if(r<=0)return{yearsToFI:1/0,fiNumber:o,currentProgress:l,projectedFIDate:new Date(9999,11,31),remainingNeeded:u};const d=i-s;if(Math.abs(d)<1e-4){const m=u/r;return{yearsToFI:m,fiNumber:o,currentProgress:l,projectedFIDate:ZL(new Date,m),remainingNeeded:u}}const f=1+u*d/r;if(f<=0)return{yearsToFI:1/0,fiNumber:o,currentProgress:l,projectedFIDate:new Date(9999,11,31),remainingNeeded:u};const p=Math.log(f)/Math.log(1+i);return{yearsToFI:Math.max(0,p),fiNumber:o,currentProgress:l,projectedFIDate:ZL(new Date,p),remainingNeeded:u}}function ZL(t,e){const n=new Date(t);return n.setFullYear(n.getFullYear()+e),n}function Z_e(t,e,n,r,i){const{initialWithdrawalRate:s,prosperityGuardband:a,capitalPreservationGuardband:o,annualAdjustmentCap:l,inflationRate:u}=i,d=n*Math.pow(1+u,r),f=d*(1+a),p=d*(1-o),m=e/t;let y=e,g="none",v=0;if(e<p&&m<s*1.5){const b=p-e,x=Math.min(b,e*l);y=e+x,g="increase",v=x}else if(e>f||m>s*1.5){const b=e-f,x=Math.min(Math.abs(b),e*l);y=e-x,g="decrease",v=-x}else y=e*(1+u),v=y-e;return{year:r,portfolioValue:t,withdrawal:y,withdrawalRate:y/t,inflationAdjustedBaseline:d,upperGuardband:f,lowerGuardband:p,adjustment:g,adjustmentAmount:v}}function eSe(t,e,n,r){const{initialWithdrawalRate:i}=r,s=[];let a=t,o=t*i,l=o;for(let u=0;u<e&&u<n.length;u++){const d=Z_e(a,l,o,u,r);if(s.push(d),a=(a-d.withdrawal)*(1+n[u]),l=d.withdrawal,a<=0)break}return s}const tSe={initialWithdrawalRate:.04,prosperityGuardband:.1,capitalPreservationGuardband:.1,annualAdjustmentCap:.2,inflationRate:.02};function nSe(t,e){const n=Math.random(),r=Math.random(),i=Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r);return t+i*e}function rSe(t,e,n){const r=[];for(let i=0;i<t;i++)r.push(nSe(e,n));return r}function iSe(t,e,n,r){let i=t,s=e,a=0,o=0;for(let l=0;l<n.length;l++){if(l>0&&(s=s*(1+r)),i-=s,a+=s,i<=0)return o=l+1,{runId:0,success:!1,finalPortfolio:0,yearsLasted:o,totalWithdrawn:a,returns:n.slice(0,l+1)};i=i*(1+n[l]),o=l+1}return{runId:0,success:!0,finalPortfolio:i,yearsLasted:o,totalWithdrawn:a,returns:n}}function sSe(t,e,n){let r=t,i=0,s=0;for(let a=0;a<n.length;a++){const o=r*e;if(r-=o,i+=o,r<=0)return s=a+1,{runId:0,success:!1,finalPortfolio:0,yearsLasted:s,totalWithdrawn:i,returns:n.slice(0,a+1)};r=r*(1+n[a]),s=a+1}return{runId:0,success:!0,finalPortfolio:r,yearsLasted:s,totalWithdrawn:i,returns:n}}function aSe(t,e,n){const r=eSe(t,e.length,e,n),i=r.length===e.length&&r[r.length-1].portfolioValue>0,s=r.length>0?r[r.length-1].portfolioValue:0,a=r.reduce((o,l)=>o+l.withdrawal,0);return{runId:0,success:i,finalPortfolio:s,yearsLasted:r.length,totalWithdrawn:a,returns:e.slice(0,r.length)}}function jv(t){const{numSimulations:e,retirementYears:n,initialPortfolio:r,annualWithdrawal:i,withdrawalRate:s,withdrawalStrategy:a,guardrailsConfig:o,expectedReturnMean:l,expectedReturnStdev:u,inflationRate:d}=t,f=[];for(let x=0;x<e;x++){const w=rSe(n,l,u);let S;switch(a){case"fixed":if(!i)throw new Error("annualWithdrawal is required for fixed withdrawal strategy");S=iSe(r,i,w,d);break;case"percentage":if(!s)throw new Error("withdrawalRate is required for percentage withdrawal strategy");S=sSe(r,s,w);break;case"guardrails":S=aSe(r,w,o||tSe);break;default:throw new Error(`Unknown withdrawal strategy: ${a}`)}S.runId=x,f.push(S)}const m=f.filter(x=>x.success).length/e,y=f.map(x=>x.finalPortfolio).sort((x,w)=>x-w),g=y[Math.floor(e/2)],v=y[Math.floor(e*.1)],b=y[Math.floor(e*.9)];return{successRate:m,medianFinalPortfolio:g,percentile10FinalPortfolio:v,percentile90FinalPortfolio:b,simulations:f,config:t}}function oSe(t,e,n){const r=1-n;return t*n+e*r}function lSe(t,e,n){const r=Math.max(0,t.length-e),i=Math.floor(Math.random()*(r+1)),s=t[i].year,a=[],o=[];for(let l=0;l<e&&i+l<t.length;l++){const u=t[i+l],d=oSe(u.stockReturn,u.bondReturn,n);a.push(d),o.push(u.inflationRate)}return{returns:a,inflationRates:o,startYear:s}}function cSe(t,e,n,r,i,s){let a=t,o=e,l=0,u=0;for(let d=0;d<n.length;d++){if(d>0&&(o=o*(1+r[d-1])),a-=o,l+=o,a<=0)return u=d+1,{runId:0,startYear:s,success:!1,finalPortfolio:0,yearsLasted:u,totalWithdrawn:l,returns:n.slice(0,d+1)};a=a*(1+n[d]),u=d+1}return{runId:0,startYear:s,success:!0,finalPortfolio:a,yearsLasted:u,totalWithdrawn:l,returns:n}}function uSe(t){const{numSimulations:e,retirementYears:n,initialPortfolio:r,annualWithdrawal:i,stockAllocation:s,historicalData:a,inflationAdjusted:o}=t;if(a.length<n)throw new Error(`Insufficient historical data. Need at least ${n} years, have ${a.length}`);const l=[];for(let x=0;x<e;x++){const{returns:w,inflationRates:S,startYear:_}=lSe(a,n,s),A=cSe(r,i,w,S,o,_);A.runId=x,l.push(A)}const d=l.filter(x=>x.success).length/e,f=l.map(x=>x.finalPortfolio).sort((x,w)=>x-w),p=f[Math.floor(e/2)],m=f[Math.floor(e*.1)],y=f[Math.floor(e*.9)],g=[...l].sort((x,w)=>x.finalPortfolio-w.finalPortfolio),v=g[0].startYear,b=g[g.length-1].startYear;return{successRate:d,medianFinalPortfolio:p,percentile10FinalPortfolio:m,percentile90FinalPortfolio:y,worstCaseStartYear:v,bestCaseStartYear:b,simulations:l}}const dSe=[{year:1926,stockReturn:.1162,bondReturn:.0774,inflationRate:-.0149},{year:1927,stockReturn:.3749,bondReturn:.0893,inflationRate:-.0208},{year:1928,stockReturn:.4361,bondReturn:.001,inflationRate:-.0097},{year:1929,stockReturn:-.0842,bondReturn:.0484,inflationRate:.0019},{year:1930,stockReturn:-.249,bondReturn:.0466,inflationRate:-.0603},{year:1931,stockReturn:-.4334,bondReturn:-.0256,inflationRate:-.0952},{year:1932,stockReturn:-.0819,bondReturn:.0888,inflationRate:-.103},{year:1933,stockReturn:.5399,bondReturn:.0196,inflationRate:.0051},{year:1934,stockReturn:-.0144,bondReturn:.102,inflationRate:.0203},{year:1935,stockReturn:.4767,bondReturn:.0498,inflationRate:.0299},{year:1936,stockReturn:.3392,bondReturn:.0751,inflationRate:.0121},{year:1937,stockReturn:-.3503,bondReturn:.0123,inflationRate:.0291},{year:1938,stockReturn:.2928,bondReturn:.0521,inflationRate:-.0278},{year:1939,stockReturn:-.011,bondReturn:.0594,inflationRate:0},{year:1940,stockReturn:-.1067,bondReturn:.0555,inflationRate:.0096},{year:1941,stockReturn:-.1277,bondReturn:.0053,inflationRate:.0993},{year:1942,stockReturn:.1917,bondReturn:.0273,inflationRate:.0929},{year:1943,stockReturn:.255,bondReturn:.0249,inflationRate:.0316},{year:1944,stockReturn:.1946,bondReturn:.0273,inflationRate:.0232},{year:1945,stockReturn:.3582,bondReturn:.0373,inflationRate:.0225},{year:1946,stockReturn:-.0843,bondReturn:.0028,inflationRate:.1817},{year:1947,stockReturn:.052,bondReturn:-.001,inflationRate:.0901},{year:1948,stockReturn:.057,bondReturn:.034,inflationRate:.029},{year:1949,stockReturn:.1879,bondReturn:.0645,inflationRate:-.018},{year:1950,stockReturn:.3171,bondReturn:.0043,inflationRate:.0579},{year:1951,stockReturn:.2402,bondReturn:-.0069,inflationRate:.0587},{year:1952,stockReturn:.1837,bondReturn:.0288,inflationRate:.0088},{year:1953,stockReturn:-.0099,bondReturn:.0349,inflationRate:.0062},{year:1954,stockReturn:.5262,bondReturn:.0542,inflationRate:-.005},{year:1955,stockReturn:.3156,bondReturn:-.0046,inflationRate:.0037},{year:1956,stockReturn:.0656,bondReturn:-.029,inflationRate:.0286},{year:1957,stockReturn:-.1078,bondReturn:.0823,inflationRate:.0302},{year:1958,stockReturn:.4336,bondReturn:-.0226,inflationRate:.0176},{year:1959,stockReturn:.1196,bondReturn:-.0097,inflationRate:.015},{year:1960,stockReturn:.0047,bondReturn:.1378,inflationRate:.0148},{year:1961,stockReturn:.2689,bondReturn:.0251,inflationRate:.0067},{year:1962,stockReturn:-.0873,bondReturn:.073,inflationRate:.0122},{year:1963,stockReturn:.228,bondReturn:.0206,inflationRate:.0165},{year:1964,stockReturn:.1648,bondReturn:.0435,inflationRate:.0119},{year:1965,stockReturn:.1245,bondReturn:.0046,inflationRate:.0192},{year:1966,stockReturn:-.1006,bondReturn:.0362,inflationRate:.0335},{year:1967,stockReturn:.2398,bondReturn:-.0119,inflationRate:.0304},{year:1968,stockReturn:.1106,bondReturn:.0051,inflationRate:.0472},{year:1969,stockReturn:-.085,bondReturn:-.0507,inflationRate:.0611},{year:1970,stockReturn:.0401,bondReturn:.1653,inflationRate:.0549},{year:1971,stockReturn:.1431,bondReturn:.1323,inflationRate:.0336},{year:1972,stockReturn:.1898,bondReturn:.0568,inflationRate:.0341},{year:1973,stockReturn:-.1466,bondReturn:.0129,inflationRate:.088},{year:1974,stockReturn:-.2647,bondReturn:.0535,inflationRate:.122},{year:1975,stockReturn:.3723,bondReturn:.0919,inflationRate:.0694},{year:1976,stockReturn:.2384,bondReturn:.1675,inflationRate:.0486},{year:1977,stockReturn:-.0718,bondReturn:.0077,inflationRate:.067},{year:1978,stockReturn:.0656,bondReturn:.0012,inflationRate:.0903},{year:1979,stockReturn:.1844,bondReturn:.0067,inflationRate:.1329},{year:1980,stockReturn:.3242,bondReturn:-.0395,inflationRate:.1252},{year:1981,stockReturn:-.0491,bondReturn:.0185,inflationRate:.0894},{year:1982,stockReturn:.2155,bondReturn:.3297,inflationRate:.0387},{year:1983,stockReturn:.2256,bondReturn:.0041,inflationRate:.038},{year:1984,stockReturn:.0627,bondReturn:.1543,inflationRate:.0395},{year:1985,stockReturn:.3216,bondReturn:.309,inflationRate:.0328},{year:1986,stockReturn:.1847,bondReturn:.2446,inflationRate:.0113},{year:1987,stockReturn:.0525,bondReturn:-.0046,inflationRate:.0441},{year:1988,stockReturn:.1661,bondReturn:.0867,inflationRate:.0442},{year:1989,stockReturn:.3169,bondReturn:.1811,inflationRate:.0465},{year:1990,stockReturn:-.031,bondReturn:.0618,inflationRate:.0661},{year:1991,stockReturn:.3055,bondReturn:.193,inflationRate:.0306},{year:1992,stockReturn:.0762,bondReturn:.0846,inflationRate:.029},{year:1993,stockReturn:.1008,bondReturn:.1445,inflationRate:.0275},{year:1994,stockReturn:.0132,bondReturn:-.0777,inflationRate:.0267},{year:1995,stockReturn:.3758,bondReturn:.2337,inflationRate:.0254},{year:1996,stockReturn:.2296,bondReturn:.0013,inflationRate:.0333},{year:1997,stockReturn:.3336,bondReturn:.097,inflationRate:.017},{year:1998,stockReturn:.2858,bondReturn:.1449,inflationRate:.0155},{year:1999,stockReturn:.2104,bondReturn:-.0751,inflationRate:.0268},{year:2e3,stockReturn:-.091,bondReturn:.1722,inflationRate:.0339},{year:2001,stockReturn:-.1189,bondReturn:.0551,inflationRate:.0155},{year:2002,stockReturn:-.221,bondReturn:.1515,inflationRate:.024},{year:2003,stockReturn:.2869,bondReturn:.0201,inflationRate:.0188},{year:2004,stockReturn:.1088,bondReturn:.0481,inflationRate:.0327},{year:2005,stockReturn:.0491,bondReturn:.0343,inflationRate:.0336},{year:2006,stockReturn:.1579,bondReturn:.0197,inflationRate:.0254},{year:2007,stockReturn:.0549,bondReturn:.0984,inflationRate:.0407},{year:2008,stockReturn:-.37,bondReturn:.2034,inflationRate:9e-4},{year:2009,stockReturn:.2646,bondReturn:-.0826,inflationRate:.0272},{year:2010,stockReturn:.1506,bondReturn:.0854,inflationRate:.0164},{year:2011,stockReturn:.0211,bondReturn:.1675,inflationRate:.03},{year:2012,stockReturn:.16,bondReturn:.0297,inflationRate:.0177},{year:2013,stockReturn:.3239,bondReturn:-.0901,inflationRate:.015},{year:2014,stockReturn:.1369,bondReturn:.1086,inflationRate:.008},{year:2015,stockReturn:.0138,bondReturn:.0087,inflationRate:.0073},{year:2016,stockReturn:.1196,bondReturn:.0069,inflationRate:.0224},{year:2017,stockReturn:.2183,bondReturn:.0241,inflationRate:.0221},{year:2018,stockReturn:-.0438,bondReturn:2e-4,inflationRate:.0181},{year:2019,stockReturn:.3149,bondReturn:.0867,inflationRate:.0228},{year:2020,stockReturn:.184,bondReturn:.1104,inflationRate:.0123},{year:2021,stockReturn:.2871,bondReturn:-.0254,inflationRate:.07},{year:2022,stockReturn:-.1811,bondReturn:-.1731,inflationRate:.0652},{year:2023,stockReturn:.2638,bondReturn:.0463,inflationRate:.0324}];function hSe(){const{selectedScenario:t}=CO(),e=gj(),n=T.useMemo(()=>{if(!t)return null;const o=Math.max(0,t.retirement_age-t.current_age);let l=e.netWorth;for(let y=0;y<o;y++){const g=(e.monthlyIncome-e.monthlySpending)*12;l=(l+g)*(1+t.expected_return_mean)}const u=t.life_expectancy-t.retirement_age,d=t.annual_expenses/l||.04,f={numSimulations:100,retirementYears:u,initialPortfolio:l,annualWithdrawal:t.withdrawal_strategy==="percentage"?void 0:t.annual_expenses,withdrawalRate:t.withdrawal_strategy==="percentage"?d:void 0,withdrawalStrategy:t.withdrawal_strategy,expectedReturnMean:t.expected_return_mean,expectedReturnStdev:t.expected_return_stdev,inflationRate:t.inflation_rate},p=jv(f);return p.simulations.filter(y=>y.finalPortfolio>0).length/p.simulations.length*100},[t,e]),r=T.useMemo(()=>{if(!t)return[];const o=[],l=t.current_savings-e.netWorth,u=t.current_savings>0?l/t.current_savings*100:0;Math.abs(u)>10&&(u>0?o.push({id:"pace-behind",category:"pace",priority:"high",title:"Behind Target Savings",description:`Your current net worth ($${(e.netWorth/1e3).toFixed(0)}K) is ${Math.abs(u).toFixed(0)}% below your scenario target ($${(t.current_savings/1e3).toFixed(0)}K). Consider increasing your savings rate or adjusting your timeline.`,icon:""}):o.push({id:"pace-ahead",category:"pace",priority:"low",title:"Ahead of Target!",description:`Excellent progress! You're ${Math.abs(u).toFixed(0)}% ahead of your scenario target. You might be able to retire earlier or increase your retirement spending.`,icon:""}));const d=t.annual_contribution/12,f=e.monthlyIncome-e.monthlySpending,p=f-d;p<-500?o.push({id:"savings-low",category:"action",priority:"high",title:"Increase Monthly Savings",description:`You're saving $${f.toFixed(0)}/month but your scenario requires $${d.toFixed(0)}/month. Find ways to save an additional $${Math.abs(p).toFixed(0)}/month.`,icon:""}):p>500&&o.push({id:"savings-high",category:"optimization",priority:"medium",title:"Extra Savings Available",description:`You're saving $${Math.abs(p).toFixed(0)}/month more than your scenario requires. Consider updating your scenario to reflect faster FI progress.`,icon:""}),n!==null&&(n<70?o.push({id:"risk-low-success",category:"risk",priority:"high",title:"Low Success Probability",description:`Your scenario has only a ${n.toFixed(0)}% success rate. Consider increasing savings, reducing expenses, or adjusting your retirement timeline for better odds.`,icon:""}):n<85?o.push({id:"risk-moderate-success",category:"risk",priority:"medium",title:"Moderate Risk Level",description:`Your scenario has a ${n.toFixed(0)}% success rate. This is acceptable, but consider stress-testing with lower returns or higher expenses.`,icon:""}):o.push({id:"risk-high-success",category:"risk",priority:"low",title:"Strong Success Rate",description:`Excellent! Your scenario has a ${n.toFixed(0)}% success rate. Your plan is well-positioned for success.`,icon:""}));const m=t.retirement_age-t.current_age;m>20&&e.savingsRate>50&&o.push({id:"optimize-timeline",category:"optimization",priority:"medium",title:"Consider Earlier Retirement",description:`With a ${e.savingsRate.toFixed(0)}% savings rate, you might reach FI sooner than ${m} years. Run scenarios with earlier retirement dates.`,icon:""}),t.portfolio_stock_pct<.6&&t.current_age<50&&o.push({id:"optimize-allocation",category:"optimization",priority:"low",title:"Low Stock Allocation",description:`At ${t.current_age} years old with ${m} years to FI, you have a conservative ${(t.portfolio_stock_pct*100).toFixed(0)}% stock allocation. Consider increasing for potentially higher returns.`,icon:""});const y=e.monthlySpending*12,g=y-t.annual_expenses,v=t.annual_expenses>0?g/t.annual_expenses*100:0;v>15?o.push({id:"expense-high",category:"action",priority:"high",title:"Spending Above Plan",description:`Your actual spending ($${(y/1e3).toFixed(0)}K/year) is ${v.toFixed(0)}% higher than your scenario ($${(t.annual_expenses/1e3).toFixed(0)}K/year). Update your scenario or reduce spending.`,icon:""}):v<-15&&o.push({id:"expense-low",category:"optimization",priority:"low",title:"Spending Below Plan",description:`You're spending ${Math.abs(v).toFixed(0)}% less than your scenario assumes. You could update your scenario to reflect lower expenses and potentially retire sooner.`,icon:""});const b={high:3,medium:2,low:1};return o.sort((x,w)=>b[w.priority]-b[x.priority]).slice(0,5)},[t,e,n]);if(!t)return c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-xl",children:""})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Smart Insights"})]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Select a FIRE scenario to see personalized insights and recommendations."})]});if(r.length===0)return c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-xl",children:""})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Smart Insights"})]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Your plan looks good! Keep monitoring your progress."})]});const i=o=>{switch(o){case"pace":return"bg-blue-50 border-blue-200";case"risk":return"bg-red-50 border-red-200";case"optimization":return"bg-green-50 border-green-200";case"action":return"bg-orange-50 border-orange-200"}},s=o=>{switch(o){case"pace":return"bg-blue-100 text-blue-800";case"risk":return"bg-red-100 text-red-800";case"optimization":return"bg-green-100 text-green-800";case"action":return"bg-orange-100 text-orange-800"}},a=o=>{switch(o){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-gray-100 text-gray-800 border-gray-200"}};return c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:c.jsx("span",{className:"text-xl",children:""})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Smart Insights"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Personalized recommendations for ",t.name]})]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[r.length," insight",r.length!==1?"s":""]})]}),c.jsx("div",{className:"space-y-3",children:r.map(o=>c.jsx("div",{className:`border rounded-lg p-4 ${i(o.category)}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"text-2xl mt-0.5",children:o.icon}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[c.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:o.title}),c.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${s(o.category)}`,children:o.category}),c.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium border ${a(o.priority)}`,children:o.priority})]}),c.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:o.description}),o.action&&c.jsxs("button",{onClick:o.action.onClick,className:"mt-2 text-xs font-medium text-primary hover:text-primary/80 transition-colors",children:[o.action.label," "]})]})]})},o.id))}),c.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:c.jsx("p",{className:"text-xs text-gray-500",children:" Insights update automatically as you track transactions and update scenarios."})})]})}function Ms(){return Bt({queryKey:["categories"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("categories").select("*").eq("created_by",t).order("path");if(n)throw n;return e}})}function PO(){return Bt({queryKey:["categories","budgetable"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("categories").select("*").eq("created_by",t).eq("is_budgetable",!0).order("path");if(n)throw n;const r=e,i=new Set(r.map(a=>a.parent_id).filter(a=>a!==null));return r.filter(a=>!i.has(a.id))}})}function ez(){const t=Xe();return et({mutationFn:async e=>(await ks("categories",e))[0],onSuccess:()=>{t.invalidateQueries({queryKey:["categories"]})}})}function fSe(){const t=Xe();return et({mutationFn:async e=>{await He();const{data:n,error:r}=await he.from("categories").select("id").eq("parent_id",e).limit(1);if(r)throw r;if(n&&n.length>0)throw new Error("Cannot delete a parent category with subcategories. Delete subcategories first.");const{error:i}=await he.from("categories").delete().eq("id",e);if(i)throw i;return e},onSuccess:e=>{t.setQueryData(["categories"],n=>n&&n.filter(r=>r.id!==e))}})}function pSe(){const t=Xe();return et({mutationFn:async e=>{await He();const{data:n,error:r}=await he.from("categories").select("id, path").eq("id",e).limit(1);if(r)throw r;const i=n==null?void 0:n[0];if(!i)throw new Error("Category not found");const{data:s,error:a}=await he.from("categories").select("id, path");if(a)throw a;const l=(s||[]).filter(d=>{var f;return d.path===i.path||((f=d.path)==null?void 0:f.startsWith(i.path+">"))}).map(d=>d.id);if(l.length===0)return[];const{error:u}=await he.from("categories").delete().in("id",l);if(u)throw u;return l},onSuccess:e=>{t.setQueryData(["categories"],n=>n&&n.filter(r=>!e.includes(r.id)))}})}function mSe(){const t=Xe();return et({mutationFn:async e=>{await He();const{data:n,error:r}=await he.from("categories").select("*").eq("id",e.id).limit(1);if(r)throw r;const i=n==null?void 0:n[0];if(!i)throw new Error("Category not found");let s;if(e.parentId){const{data:o,error:l}=await he.from("categories").select("id, name, path").eq("id",e.parentId).limit(1);if(l)throw l;const u=o==null?void 0:o[0];if(!u)throw new Error("Parent category not found");s=`${u.name}>${e.name}`}else s=e.name;const{error:a}=await he.from("categories").update({name:e.name,parent_id:e.parentId,path:s,is_budgetable:e.isBudgetable}).eq("id",e.id);if(a)throw a;if(i.path&&i.path!==s){const{data:o,error:l}=await he.from("categories").select("id, path");if(l)throw l;const u=(o||[]).filter(d=>{var f;return(f=d.path)==null?void 0:f.startsWith(i.path+">")});for(const d of u){if(!d.path)continue;const f=d.path.replace(i.path+">",s+">"),{error:p}=await he.from("categories").update({path:f}).eq("id",d.id);if(p)throw p}}return e.id},onSuccess:()=>{t.invalidateQueries({queryKey:["categories"]})}})}function gSe(t=6){const{data:e=[]}=lo(t*100),{data:n=[]}=Ms();return T.useMemo(()=>{const r=new Date,i=[];for(let f=t-1;f>=0;f--){const p=new Date(r.getFullYear(),r.getMonth()-f,1);i.push(Je(p,"yyyy-MM"))}const s=new Map;e.forEach(f=>{if(f.amount<0&&f.category_id){const p=f.date.slice(0,7);s.has(f.category_id)||s.set(f.category_id,new Map);const m=s.get(f.category_id);m.set(p,(m.get(p)||0)+Math.abs(f.amount))}});const a=Array.from(s.entries()).map(([f,p])=>{var S,_;const m=n.find(A=>A.id===f),y=i.map(A=>({month:A,amount:p.get(A)||0})),g=((S=y[t-2])==null?void 0:S.amount)||0,v=((_=y[t-1])==null?void 0:_.amount)||0,b=v-g,x=g>0?b/g*100:0;let w="flat";return x>10?w="up":x<-10&&(w="down"),{categoryId:f,categoryName:(m==null?void 0:m.name)||"Unknown",monthly:y,lastMonthAmount:g,thisMonthAmount:v,change:b,percentChange:x,trend:w}}),o=a.filter(f=>f.trend==="up"&&f.thisMonthAmount>50).sort((f,p)=>p.percentChange-f.percentChange).slice(0,3),l=a.filter(f=>f.trend==="down"&&f.lastMonthAmount>50).sort((f,p)=>f.percentChange-p.percentChange).slice(0,3),u=a.filter(f=>f.trend==="flat"&&f.thisMonthAmount>50).sort((f,p)=>p.thisMonthAmount-f.thisMonthAmount).slice(0,3);let d="";return o.length>0&&(d+=`Biggest increases: ${o.map(f=>`${f.categoryName} (+${f.percentChange.toFixed(0)}%)`).join(", ")}. `),l.length>0&&(d+=`Biggest decreases: ${l.map(f=>`${f.categoryName} (${f.percentChange.toFixed(0)}%)`).join(", ")}. `),d||(d="Spending patterns are stable this month."),{topIncreases:o,topDecreases:l,stableCategories:u,summary:d}},[e,n,t])}function ySe(){const{data:t=[]}=lo(500),e=gSe(6),n=T.useMemo(()=>{const i=new Date,s=[];for(let a=5;a>=0;a--){const o=new Date(i.getFullYear(),i.getMonth()-a,1),l=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`,u=o.toLocaleDateString("en-US",{month:"short",year:"numeric"}),d=t.filter(m=>m.date.startsWith(l)),f=d.reduce((m,y)=>y.amount<0?m+Math.abs(y.amount):m,0),p=d.reduce((m,y)=>y.amount>0?m+y.amount:m,0);s.push({month:u,spending:f,income:p,savings:p-f})}return s},[t]);return n.some(i=>i.spending>0||i.income>0)?c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Spending Trends"}),c.jsx("div",{className:"mb-4",children:c.jsx("div",{className:"text-sm text-gray-700 font-medium",children:e.summary})}),c.jsx("div",{className:"h-80 mb-6",children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(Zg,{data:n,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),c.jsx(ir,{dataKey:"month",stroke:"#6B7280",style:{fontSize:"12px"}}),c.jsx(sr,{stroke:"#6B7280",style:{fontSize:"12px"},tickFormatter:i=>`$${(i/1e3).toFixed(0)}k`}),c.jsx(on,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px"},formatter:i=>ie(i)}),c.jsx(Fr,{wrapperStyle:{fontSize:"12px"},iconType:"line"}),c.jsx(di,{type:"monotone",dataKey:"income",stroke:"#2BB673",strokeWidth:2,dot:{fill:"#2BB673",r:4},activeDot:{r:6},name:"Income"}),c.jsx(di,{type:"monotone",dataKey:"spending",stroke:"#D64550",strokeWidth:2,dot:{fill:"#D64550",r:4},activeDot:{r:6},name:"Spending"}),c.jsx(di,{type:"monotone",dataKey:"savings",stroke:"#2E86AB",strokeWidth:2,dot:{fill:"#2E86AB",r:4},activeDot:{r:6},name:"Savings"})]})})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Top Increases"}),e.topIncreases.length===0?c.jsx("div",{className:"text-xs text-gray-400",children:"No significant increases."}):c.jsx("ul",{className:"space-y-2",children:e.topIncreases.map(i=>c.jsxs("li",{className:"bg-red-50 border-l-4 border-red-400 rounded p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-medium text-red-800",children:i.categoryName}),c.jsxs("span",{className:"text-xs font-semibold text-red-600",children:["+",i.percentChange.toFixed(0),"%"]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[ie(i.thisMonthAmount)," this month"]})]},i.categoryId))})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Top Decreases"}),e.topDecreases.length===0?c.jsx("div",{className:"text-xs text-gray-400",children:"No significant decreases."}):c.jsx("ul",{className:"space-y-2",children:e.topDecreases.map(i=>c.jsxs("li",{className:"bg-green-50 border-l-4 border-green-400 rounded p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"font-medium text-green-800",children:i.categoryName}),c.jsxs("span",{className:"text-xs font-semibold text-green-600",children:[i.percentChange.toFixed(0),"%"]})]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[ie(i.thisMonthAmount)," this month"]})]},i.categoryId))})]})]})]}):c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Spending Trends"}),c.jsx("div",{className:"flex items-center justify-center h-64 text-gray-400",children:c.jsx("p",{children:"No transaction data yet. Add some transactions to see trends!"})})]})}function vSe(t,e){return Bt({queryKey:["net-worth-history",t==null?void 0:t.toISOString(),e==null?void 0:e.toISOString()],queryFn:async()=>{try{const n=await He();let r=he.from("net_worth_snapshots").select("*").eq("created_by",n).order("snapshot_date",{ascending:!0});t&&(r=r.gte("snapshot_date",t.toISOString().split("T")[0])),e&&(r=r.lte("snapshot_date",e.toISOString().split("T")[0]));const{data:i,error:s}=await r;if(s)throw console.error("Net Worth History Query Error:",s),s;return(i||[]).map(o=>({date:o.snapshot_date,netWorth:Number(o.net_worth),assets:Number(o.total_assets),liabilities:Number(o.total_liabilities)}))}catch(n){throw console.error("Net Worth History Error:",n),n}},staleTime:1e3*60*5,retry:1,retryDelay:1e3})}function xSe(){return Bt({queryKey:["net-worth-latest"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("net_worth_snapshots").select("snapshot_date").eq("created_by",t).order("snapshot_date",{ascending:!1}).limit(1);if(n)throw n;return e&&e.length>0?e[0].snapshot_date:void 0},staleTime:1e3*60*5})}function bSe(){const{data:t=[]}=ar(),e={assets:0,liabilities:0,netWorth:0};return t.forEach(n=>{const r=n.current_balance||0;["credit","mortgage"].includes(n.type)?e.liabilities+=Math.abs(r):r>0?e.assets+=r:e.liabilities+=Math.abs(r)}),e.netWorth=e.assets-e.liabilities,e}function wSe(){const t=Xe(),e=bSe(),{data:n=[]}=ar();return et({mutationFn:async(r=new Date)=>{const s={created_by:await He(),snapshot_date:r.toISOString().split("T")[0],total_assets:e.assets,total_liabilities:e.liabilities,net_worth:e.netWorth,account_count:n.length},{data:a,error:o}=await he.from("net_worth_snapshots").upsert(s,{onConflict:"created_by,snapshot_date"}).select().single();if(o)throw o;return a},onSuccess:()=>{t.invalidateQueries({queryKey:["net-worth-history"]}),t.invalidateQueries({queryKey:["net-worth-latest"]})}})}function _Se(){const t=Xe();return et({mutationFn:async({startDate:e,endDate:n,interval:r="monthly"})=>{const i=await He(),{data:s,error:a}=await he.from("accounts").select("*").eq("created_by",i);if(a)throw a;const{data:o,error:l}=await he.from("transactions").select("*").eq("created_by",i).order("date",{ascending:!0});if(l)throw l;const u=[];let d=new Date(e);for(;d<=n;)u.push(new Date(d)),r==="daily"?d.setDate(d.getDate()+1):r==="weekly"?d.setDate(d.getDate()+7):d.setMonth(d.getMonth()+1);const f=u.map(y=>{let g=0,v=0;return s==null||s.forEach(b=>{let x=Number(b.opening_balance||0);((o==null?void 0:o.filter(_=>_.account_id===b.id&&new Date(_.date)<=y))||[]).forEach(_=>{x+=Number(_.amount)}),["credit","mortgage"].includes(b.type)?v+=Math.abs(x):x>0?g+=x:v+=Math.abs(x)}),{created_by:i,snapshot_date:y.toISOString().split("T")[0],total_assets:g,total_liabilities:v,net_worth:g-v,account_count:(s==null?void 0:s.length)||0}}),{data:p,error:m}=await he.from("net_worth_snapshots").upsert(f,{onConflict:"created_by,snapshot_date"}).select();if(m)throw m;return p},onSuccess:()=>{t.invalidateQueries({queryKey:["net-worth-history"]}),t.invalidateQueries({queryKey:["net-worth-latest"]})}})}function yj(){const[t,e]=T.useState({isOpen:!1,initialType:"help",initialTitle:"",initialDescription:""}),n=T.useCallback((p="help",m="",y="")=>{e({isOpen:!0,initialType:p,initialTitle:m,initialDescription:y})},[]),r=T.useCallback(()=>{e(p=>({...p,isOpen:!1}))},[]),i=T.useCallback((p,m)=>{n("bug",p,m)},[n]),s=T.useCallback((p,m)=>{n("feature",p,m)},[n]),a=T.useCallback((p,m)=>{n("help",p,m)},[n]),o=T.useCallback((p,m)=>{n("feedback",p,m)},[n]),l=T.useCallback((p,m)=>{n("data",p,m)},[n]),u=T.useCallback((p,m,y)=>{const g=`Calculation Error: ${p}`,v=m&&y?`Expected: ${m}
Actual: ${y}

Calculation type: ${p}`:`Issue with ${p} calculation`;l(g,v)},[l]),d=T.useCallback((p,m)=>{const y=`UI Issue: ${p}`,g=`Component: ${p}
Issue: ${m}`;i(y,g)},[i]),f=T.useCallback((p,m)=>{const y=`Mobile UX: ${p}`,g=`Area: ${p}
Suggestion: ${m}`;s(y,g)},[s]);return{modalState:t,openModal:n,closeModal:r,reportBug:i,requestFeature:s,getHelp:a,giveFeedback:o,reportDataIssue:l,reportCalculationError:u,reportUIIssue:d,requestMobileImprovement:f}}const eF={"net-worth":{title:"Net Worth History & Snapshots",description:"See how your net worth changes over time. Snapshots capture todays assets and liabilities; Backfill generates historical points from your transaction history.",tips:["Use Snapshot to save todays net worth after updating account balances","Backfill monthly to populate the chart from past transactions","Switch between Net Worth and Assets/Liabilities breakdown"],relatedTopics:["accounts","transactions","dashboard"],commonIssues:[{issue:"No data shown",solution:"Take your first snapshot or use Backfill to generate history from transactions"},{issue:"Totals look off",solution:"Confirm account opening balances and recent transactions are accurate"}]},dashboard:{title:"Dashboard Overview",description:"Your financial independence dashboard shows key metrics and progress toward your FIRE goals.",tips:["Green indicators show you're on track","Use scenarios to compare different strategies","Charts update automatically as you add data"],relatedTopics:["scenarios","accounts","fire-basics"],commonIssues:[{issue:"Charts not updating",solution:"Make sure you have recent transactions and account balances"}]},scenarios:{title:"FIRE Scenarios",description:"Scenarios let you model different retirement strategies and see which approach works best for your goals.",tips:['Start with the "Conservative" scenario template',"Adjust withdrawal rates based on your risk tolerance","Compare multiple scenarios to find your optimal path"],relatedTopics:["withdrawal-strategies","monte-carlo","fire-basics"],commonIssues:[{issue:"Unrealistic projections",solution:"Check your assumptions: growth rates, inflation, and withdrawal rates"}]},accounts:{title:"Account Management",description:"Track all your financial accounts in one place to get a complete picture of your net worth.",tips:["Include all account types: checking, savings, investment, retirement","Update balances regularly for accurate projections","Use account groups to organize similar accounts"],relatedTopics:["transactions","net-worth","budgets"],commonIssues:[{issue:"Missing account types",solution:'Use "Other" category for specialty accounts, then contact support'}]},transactions:{title:"Transaction Tracking",description:"Record your income and expenses to track spending patterns and cash flow.",tips:['Use the quick-add feature (press "N") for fast entry',"Categorize transactions for better insights","Regular entry gives better projections"],relatedTopics:["budgets","accounts","categories"],commonIssues:[{issue:"Duplicate transactions",solution:"Check the date and amount before adding similar transactions"}]},budgets:{title:"Budget Planning",description:"Set spending targets and track your progress to stay on your FIRE path.",tips:["Start with actual spending, then optimize","Include both fixed and variable expenses","Review and adjust monthly"],relatedTopics:["transactions","categories","fire-basics"],commonIssues:[{issue:"Budget vs actual mismatch",solution:"Review your transaction categories and ensure consistent tracking"}]},"fire-basics":{title:"FIRE Basics",description:"Financial Independence, Retire Early (FIRE) is about saving and investing to achieve financial freedom.",tips:["FIRE typically requires saving 25x your annual expenses","The 4% withdrawal rule is a common starting point","Higher savings rates dramatically reduce time to FIRE"],relatedTopics:["scenarios","withdrawal-strategies","investment-allocation"],commonIssues:[{issue:"FIRE seems impossible",solution:"Start small, increase savings gradually, and use scenarios to find your path"}]},"withdrawal-strategies":{title:"Withdrawal Strategies",description:"Different approaches to withdrawing money in retirement, each with trade-offs.",tips:["4% rule: Withdraw 4% of initial portfolio annually","Dynamic withdrawal: Adjust based on market performance","Bond tent: Reduce risk as you approach retirement"],relatedTopics:["scenarios","fire-basics","investment-allocation"]},"monte-carlo":{title:"Monte Carlo Simulation",description:"A method that runs thousands of scenarios to estimate the probability of your plan succeeding.",tips:["Higher success rates (80%+) indicate more robust plans","Accounts for market volatility and sequence of returns risk","Use multiple scenarios to stress-test your approach"],relatedTopics:["scenarios","withdrawal-strategies","investment-allocation"]}};function SSe({topic:t,children:e,position:n="bottom",size:r="md"}){const[i,s]=T.useState(!1),[a,o]=T.useState(!1),l=T.useRef(null),{getHelp:u}=yj(),d=eF[t];if(!d)return c.jsx(c.Fragment,{children:e});const f=()=>{u(`Help with ${d.title}`,`I need help with: ${t}

Specific question: `),o(!1)},p={top:"bottom-full mb-2",bottom:"top-full mt-2",left:"right-full mr-2",right:"left-full ml-2"},m={sm:"max-w-xs",md:"max-w-sm",lg:"max-w-md"};return c.jsxs("div",{className:"relative inline-block",children:[c.jsx("div",{onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onClick:()=>o(!0),className:"cursor-help",children:e}),i&&!a&&c.jsxs("div",{ref:l,className:`absolute z-50 ${p[n]} ${m[r]} bg-gray-900 text-white text-sm rounded-lg px-3 py-2 pointer-events-none animate-in fade-in-0 duration-200`,children:[c.jsx("div",{className:"font-medium mb-1",children:d.title}),c.jsx("div",{className:"text-gray-200",children:d.description}),c.jsx("div",{className:"text-xs text-gray-300 mt-2",children:"Click for detailed help"})]}),a&&c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>o(!1)}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:d.title}),c.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsx("div",{children:c.jsx("p",{className:"text-gray-700",children:d.description})}),d.tips&&d.tips.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:" Tips & Best Practices"}),c.jsx("ul",{className:"space-y-2",children:d.tips.map((y,g)=>c.jsxs("li",{className:"flex items-start space-x-2",children:[c.jsx("div",{className:"w-1.5 h-1.5 bg-primary rounded-full mt-2 flex-shrink-0"}),c.jsx("span",{className:"text-gray-700",children:y})]},g))})]}),d.commonIssues&&d.commonIssues.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:" Common Issues & Solutions"}),c.jsx("div",{className:"space-y-3",children:d.commonIssues.map((y,g)=>c.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[c.jsxs("div",{className:"font-medium text-yellow-800 mb-1",children:["Issue: ",y.issue]}),c.jsx("div",{className:"text-yellow-700",children:y.solution})]},g))})]}),d.relatedTopics&&d.relatedTopics.length>0&&c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:" Related Topics"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:d.relatedTopics.map(y=>{const g=eF[y];return g?c.jsx("button",{onClick:()=>{o(!1),setTimeout(()=>{u(`Help with ${g.title}`,`I need help with: ${y}`)},100)},className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm hover:bg-blue-200 transition-colors",children:g.title},y):null})})]}),c.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-gray-200",children:[c.jsx("button",{onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Close"}),c.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Get More Help"})]})]})]})})]})]})}function tF({active:t,payload:e,label:n}){return t&&e&&e.length?c.jsxs("div",{className:"bg-white p-3 rounded shadow text-xs",children:[c.jsx("div",{className:"font-semibold mb-1",children:Je(new Date(n),"MMM yyyy")}),e.map(r=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{children:[r.name,":"]}),c.jsx("span",{className:"font-bold ml-2",children:ie(r.value)})]},r.dataKey))]}):null}function ASe(){const[t,e]=T.useState("1Y"),[n,r]=T.useState(!1),{startDate:i,endDate:s}=T.useMemo(()=>{const v=new Date;let b;switch(t){case"3M":{const x=new Date(v);x.setMonth(x.getMonth()-3),b=x;break}case"6M":{const x=new Date(v);x.setMonth(x.getMonth()-6),b=x;break}case"1Y":{const x=new Date(v);x.setFullYear(x.getFullYear()-1),b=x;break}case"2Y":{const x=new Date(v);x.setFullYear(x.getFullYear()-2),b=x;break}case"ALL":default:b=void 0}return{startDate:b,endDate:v}},[t]),{data:a,isLoading:o,error:l}=vSe(i,s),u=wSe(),d=_Se(),{data:f}=xSe(),p=a||[],m=p.length>0,y=()=>{u.mutate(new Date)},g=()=>{const v=i??new Date(new Date().setFullYear(s.getFullYear()-2));d.mutate({startDate:v,endDate:s,interval:"monthly"})};return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx(SSe,{topic:"net-worth",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-900 cursor-help",children:"Net Worth History"})}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Track your wealth accumulation over time"}),c.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Last snapshot: ",f?Je(new Date(f),"MMM d, yyyy"):"None"]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["3M","6M","1Y","2Y","ALL"].map(v=>c.jsx("button",{onClick:()=>e(v),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${t===v?"bg-white text-primary shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:v},v))}),c.jsx("button",{onClick:()=>r(!n),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${n?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Breakdown"}),c.jsxs("button",{onClick:y,disabled:u.isPending,className:"px-3 py-1.5 text-sm font-medium bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50 inline-flex items-center gap-1",title:"Save today's net worth","aria-label":"Take snapshot",children:[u.isPending?"...":"",c.jsx("span",{className:"hidden sm:inline",children:"Snapshot"})]}),c.jsxs("button",{onClick:g,disabled:d.isPending,className:"px-3 py-1.5 text-sm font-medium bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 disabled:opacity-50 inline-flex items-center gap-1",title:"Backfill historical snapshots","aria-label":"Backfill history",children:[d.isPending?"...":"",c.jsx("span",{className:"hidden sm:inline",children:"Backfill"})]})]})]}),o?c.jsx("div",{className:"h-80 flex items-center justify-center",children:c.jsx("div",{className:"text-gray-400",children:"Loading..."})}):l?c.jsx("div",{className:"h-80 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-sm mb-2",children:"Failed to load net worth history"}),c.jsx("div",{className:"text-gray-500 text-xs",children:l instanceof Error?l.message:"Unknown error"})]})}):m?c.jsxs("div",{className:"h-80",children:[c.jsx(_s,{width:"100%",height:"100%",children:n?c.jsxs($1e,{data:p,children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),c.jsx(ir,{dataKey:"date",tickFormatter:v=>Je(new Date(v),"MMM yyyy"),style:{fontSize:"12px"}}),c.jsx(sr,{tickFormatter:v=>ie(v,{compact:!0}),style:{fontSize:"12px"}}),c.jsx(on,{content:c.jsx(tF,{})}),c.jsx(Fr,{}),c.jsx(no,{type:"monotone",dataKey:"assets",stackId:"1",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Assets"}),c.jsx(no,{type:"monotone",dataKey:"liabilities",stackId:"2",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Liabilities"})]}):c.jsxs(Zg,{data:p,children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),c.jsx(ir,{dataKey:"date",tickFormatter:v=>Je(new Date(v),"MMM yyyy"),style:{fontSize:"12px"}}),c.jsx(sr,{tickFormatter:v=>ie(v,{compact:!0}),style:{fontSize:"12px"}}),c.jsx(on,{content:c.jsx(tF,{})}),c.jsx(Fr,{}),c.jsx(di,{type:"monotone",dataKey:"netWorth",stroke:"#2E86AB",strokeWidth:2,dot:{fill:"#2E86AB",r:4},activeDot:{r:6},name:"Net Worth"})]})}),m&&p.length>1&&c.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Current"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:ie(p[p.length-1].netWorth)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Change"}),c.jsx("p",{className:`text-lg font-semibold mt-1 ${p[p.length-1].netWorth>=p[0].netWorth?"text-green-600":"text-red-600"}`,children:ie(p[p.length-1].netWorth-p[0].netWorth)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Growth"}),c.jsx("p",{className:`text-lg font-semibold mt-1 ${p[p.length-1].netWorth>=p[0].netWorth?"text-green-600":"text-red-600"}`,children:p[0].netWorth!==0?`${((p[p.length-1].netWorth-p[0].netWorth)/Math.abs(p[0].netWorth)*100).toFixed(1)}%`:"N/A"})]})]})})]}):c.jsxs("div",{className:"h-80 flex flex-col items-center justify-center",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No historical data yet"}),c.jsx("p",{className:"text-sm text-gray-500 max-w-md",children:"Start tracking your net worth by taking snapshots. You can also generate historical data based on your transaction history."})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:y,disabled:u.isPending,className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50",children:u.isPending?"Saving...":"Take First Snapshot"}),c.jsx("button",{onClick:g,disabled:d.isPending,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 disabled:opacity-50",children:d.isPending?"Generating...":"Generate Historical Data"})]})]})]})}function jSe(){return Bt({queryKey:["income-expenses"],queryFn:async()=>{const t=await He(),e=Av($k(new Date,11)),n=H8(new Date),{data:r,error:i}=await he.from("transactions").select("date, amount, category_id").eq("created_by",t).gte("date",Je(e,"yyyy-MM-dd")).lte("date",Je(n,"yyyy-MM-dd")).order("date",{ascending:!0});if(i)throw i;const s=new Map;(r||[]).forEach(x=>{const w=x.date.substring(0,7);s.has(w)||s.set(w,{income:0,expenses:0,count:0});const S=s.get(w);S.count++,x.amount>0?S.income+=x.amount:S.expenses+=Math.abs(x.amount)});const a=x=>{const w=s.get(x)||{income:0,expenses:0,count:0},S=w.income-w.expenses,_=w.income>0?S/w.income*100:0,[A,j]=x.split("-"),N=new Date(parseInt(A),parseInt(j)-1,1),P=Je(N,"MMM yyyy");return{month:x,monthLabel:P,income:w.income,expenses:w.expenses,netIncome:S,savingsRate:_,transactionCount:w.count}},o=new Date,l=Je(o,"yyyy-MM"),u=Je($k(o,1),"yyyy-MM"),d=[];for(let x=5;x>=0;x--){const w=Je($k(o,x),"yyyy-MM");d.push(a(w))}const f=o.getMonth()+1;let p=0,m=0;for(let x=0;x<f;x++){const w=Je(new Date(o.getFullYear(),x,1),"yyyy-MM"),S=s.get(w)||{income:0,expenses:0};p+=S.income,m+=S.expenses}const y=p-m,g=p>0?y/p*100:0,v=f>0?y/f:0;return{currentMonth:a(l),previousMonth:a(u),last6Months:d,yearToDate:{income:p,expenses:m,netIncome:y,savingsRate:g,avgMonthlySavings:v}}},staleTime:60*1e3})}/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kSe=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NSe=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),nF=t=>{const e=NSe(t);return e.charAt(0).toUpperCase()+e.slice(1)},tz=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),ESe=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CSe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PSe=T.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>T.createElement("svg",{ref:l,...CSe,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:tz("lucide",i),...!s&&!ESe(o)&&{"aria-hidden":"true"},...o},[...a.map(([u,d])=>T.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=(t,e)=>{const n=T.forwardRef(({className:r,...i},s)=>T.createElement(PSe,{ref:s,iconNode:e,className:tz(`lucide-${kSe(nF(t))}`,`lucide-${t}`,r),...i}));return n.displayName=nF(t),n};/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TSe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],OSe=Ml("arrow-left",TSe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MSe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],RSe=Ml("circle-alert",MSe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ISe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],DSe=Ml("loader-circle",ISe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $Se=[["path",{d:"M5 12h14",key:"1ays0h"}]],LSe=Ml("minus",$Se);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FSe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],BSe=Ml("pen",FSe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const USe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zSe=Ml("trash-2",USe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WSe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],HSe=Ml("trending-down",WSe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qSe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],GSe=Ml("trending-up",qSe);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KSe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nz=Ml("x",KSe);function VSe(){const{data:t,isLoading:e,error:n}=jSe(),r=T.useMemo(()=>{if(!t)return[];const o=new Date,l=[];for(let u=11;u>=0;u--){const d=new Date(o.getFullYear(),o.getMonth()-u,1),f=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,p=d.toLocaleDateString("en-US",{month:"short",year:"numeric"}),m=t.last6Months.find(y=>y.month===f)||{income:0,expenses:0,netIncome:0};l.push({month:p,income:m.income,expenses:m.expenses,net:m.netIncome})}return l},[t]),i=T.useMemo(()=>{if(!t)return{income:0,expenses:0,netIncome:0};const o=t.currentMonth,l=t.previousMonth;return{income:l.income>0?(o.income-l.income)/l.income*100:0,expenses:l.expenses>0?(o.expenses-l.expenses)/l.expenses*100:0,netIncome:o.netIncome-l.netIncome}},[t]),s=({active:o,payload:l})=>{if(!o||!l||!l.length)return null;const u=l[0].payload;return c.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:u.month}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("p",{className:"text-sm text-green-600",children:[c.jsx("span",{className:"font-medium",children:"Income:"})," ",ie(u.income)]}),c.jsxs("p",{className:"text-sm text-red-600",children:[c.jsx("span",{className:"font-medium",children:"Expenses:"})," ",ie(u.expenses)]}),c.jsxs("p",{className:"text-sm font-semibold border-t border-gray-200 pt-1 mt-1",children:[c.jsx("span",{className:"font-medium",children:"Net:"})," ",c.jsx("span",{className:u.net>=0?"text-green-600":"text-red-600",children:ie(u.net)})]})]})]})},a=({value:o,type:l})=>{const u=l==="income"?o>0:o<0;return Math.abs(o)<1?c.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-500",children:[c.jsx(LSe,{className:"w-3 h-3"}),c.jsx("span",{className:"text-xs",children:""})]}):c.jsxs("span",{className:`inline-flex items-center gap-1 ${u?"text-green-600":"text-red-600"}`,children:[u?c.jsx(GSe,{className:"w-3 h-3"}):c.jsx(HSe,{className:"w-3 h-3"}),c.jsxs("span",{className:"text-xs font-medium",children:[Math.abs(o).toFixed(1),"%"]})]})};return n?c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsx("div",{className:"text-center text-red-600",children:c.jsx("p",{children:"Error loading income/expenses data"})})}):e||!t?c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"animate-pulse",children:[c.jsx("div",{className:"h-6 bg-gray-200 rounded w-48 mb-4"}),c.jsx("div",{className:"h-64 bg-gray-100 rounded"})]})}):c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Income vs Expenses"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Monthly cash flow comparison"})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-green-700 font-medium uppercase",children:"This Month Income"}),c.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:ie(t.currentMonth.income)})]}),c.jsx(a,{value:i.income,type:"income"})]})}),c.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-red-700 font-medium uppercase",children:"This Month Expenses"}),c.jsx("p",{className:"text-2xl font-bold text-red-900 mt-1",children:ie(t.currentMonth.expenses)})]}),c.jsx(a,{value:i.expenses,type:"expenses"})]})}),c.jsx("div",{className:`rounded-lg p-4 ${t.currentMonth.netIncome>=0?"bg-blue-50":"bg-orange-50"}`,children:c.jsxs("div",{children:[c.jsx("p",{className:`text-xs font-medium uppercase ${t.currentMonth.netIncome>=0?"text-blue-700":"text-orange-700"}`,children:"Net Savings"}),c.jsx("p",{className:`text-2xl font-bold mt-1 ${t.currentMonth.netIncome>=0?"text-blue-900":"text-orange-900"}`,children:ie(t.currentMonth.netIncome)}),c.jsxs("p",{className:`text-sm mt-1 ${t.currentMonth.netIncome>=0?"text-blue-600":"text-orange-600"}`,children:[t.currentMonth.savingsRate.toFixed(1),"% savings rate"]})]})})]}),c.jsx("div",{className:"h-80",children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(L1e,{data:r,children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),c.jsx(ir,{dataKey:"month",style:{fontSize:"12px"}}),c.jsx(sr,{tickFormatter:o=>ie(o,{compact:!0}),style:{fontSize:"12px"}}),c.jsx(on,{content:c.jsx(s,{})}),c.jsx(Fr,{}),c.jsx(br,{dataKey:"income",fill:"#10b981",name:"Income",radius:[4,4,0,0]}),c.jsx(br,{dataKey:"expenses",fill:"#ef4444",name:"Expenses",radius:[4,4,0,0]}),c.jsx(di,{type:"monotone",dataKey:"net",stroke:"#2E86AB",strokeWidth:2,dot:{fill:"#2E86AB",r:4},name:"Net Income"})]})})}),c.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Year-to-Date Totals"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"YTD Income"}),c.jsx("p",{className:"text-lg font-semibold text-green-600 mt-1",children:ie(t.yearToDate.income)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"YTD Expenses"}),c.jsx("p",{className:"text-lg font-semibold text-red-600 mt-1",children:ie(t.yearToDate.expenses)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"YTD Net Savings"}),c.jsx("p",{className:`text-lg font-semibold mt-1 ${t.yearToDate.netIncome>=0?"text-blue-600":"text-orange-600"}`,children:ie(t.yearToDate.netIncome)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"YTD Savings Rate"}),c.jsxs("p",{className:"text-lg font-semibold text-emerald-700 mt-1",children:[t.yearToDate.savingsRate.toFixed(1),"%"]})]})]})]})]})}function rz(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`}function iz(t=rz()){return Bt({queryKey:["budgets",t],queryFn:async()=>{const e=await He(),{data:n,error:r}=await he.from("budgets").select("*").eq("created_by",e).eq("month",t);if(r)throw r;return n}})}function YSe(){const t=Xe();return et({mutationFn:async e=>await ks("budgets",e),onSuccess:(e,n)=>{t.invalidateQueries({queryKey:["budgets",n.month]})}})}function XSe(){const t=Xe();return et({mutationFn:async({id:e,target:n})=>{const{data:r,error:i}=await he.from("budgets").update({target:n}).eq("id",e).select();if(i)throw i;return r},onSuccess:()=>{t.invalidateQueries({queryKey:["budgets"]})}})}function QSe(t){const{data:e=[]}=lo(500);return T.useMemo(()=>{const r=new Map;return e.filter(s=>s.date.startsWith(t)&&s.category_id).forEach(s=>{if(s.category_id&&s.amount<0){const a=r.get(s.category_id)||0;r.set(s.category_id,a+Math.abs(s.amount))}}),r},[e,t])}function JSe({budget:t,categoryName:e,spent:n,onUpdateTarget:r}){const[i,s]=T.useState(!1),[a,o]=T.useState(t.target.toString()),{target:l}=t,u=l-n,d=l>0?n/l*100:0,f=()=>d>=100?"bg-danger":d>=90?"bg-warning":d>=75?"bg-yellow-500":"bg-success",p=()=>{const y=parseFloat(a);!isNaN(y)&&y>0&&r&&r(t.id,y),s(!1)},m=()=>{o(t.target.toString()),s(!1)};return c.jsxs("div",{className:"py-4 border-b border-gray-200 last:border-0",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"flex-1",children:c.jsx("h4",{className:"text-sm font-medium text-gray-900",children:e})}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Spent"}),c.jsx("div",{className:"text-sm font-semibold text-gray-900",children:ie(n)})]}),c.jsxs("div",{className:"text-right min-w-[100px]",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Budget"}),i?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",step:"0.01",value:a,onChange:y=>o(y.target.value),onKeyDown:y=>{y.key==="Enter"&&p(),y.key==="Escape"&&m()},className:"w-20 px-2 py-1 text-sm border border-primary rounded focus:outline-none focus:ring-1 focus:ring-primary",autoFocus:!0}),c.jsx("button",{onClick:p,className:"text-success hover:text-success/80",title:"Save",children:""}),c.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",title:"Cancel",children:""})]}):c.jsx("button",{onClick:()=>s(!0),className:"text-sm font-semibold text-gray-900 hover:text-primary",children:ie(l)})]}),c.jsxs("div",{className:"text-right min-w-[100px]",children:[c.jsx("div",{className:"text-xs text-gray-500",children:"Remaining"}),c.jsx("div",{className:`text-sm font-semibold ${u>=0?"text-success":"text-danger"}`,children:ie(u)})]})]})]}),c.jsxs("div",{className:"mt-2",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[c.jsxs("span",{children:[Math.min(d,100).toFixed(0),"% used"]}),d>100&&c.jsxs("span",{className:"text-danger font-medium",children:[ie(n-l)," over budget"]})]}),c.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-300 ${f()}`,style:{width:`${Math.min(d,100)}%`}})})]})]})}function ZSe({budgets:t}){const e=T.useMemo(()=>t.map(r=>({name:r.category.length>20?r.category.substring(0,20)+"...":r.category,fullName:r.category,budgeted:r.budgeted,spent:r.spent,percentUsed:r.budgeted>0?r.spent/r.budgeted*100:0})).sort((r,i)=>i.percentUsed-r.percentUsed),[t]);if(e.length===0)return null;const n=r=>r>=100?"#D64550":r>=90?"#F2C14E":r>=75?"#F59E0B":"#2BB673";return c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Budget Overview"}),c.jsx("div",{className:"h-80",children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(fj,{data:e,layout:"vertical",margin:{top:5,right:30,left:100,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#E5E7EB",horizontal:!1}),c.jsx(ir,{type:"number",stroke:"#6B7280",style:{fontSize:"12px"},tickFormatter:r=>`$${(r/1e3).toFixed(0)}k`}),c.jsx(sr,{type:"category",dataKey:"name",stroke:"#6B7280",style:{fontSize:"12px"},width:90}),c.jsx(on,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px"},formatter:(r,i,s)=>{if(i==="spent"){const a=s.payload.percentUsed.toFixed(1);return[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{children:[ie(r)," spent"]}),c.jsxs("div",{className:"text-gray-500",children:[ie(s.payload.budgeted)," budgeted"]}),c.jsxs("div",{className:"font-semibold",children:[a,"% used"]})]},"tooltip"),""]}return[ie(r),i]},labelFormatter:(r,i)=>i&&i[0]?i[0].payload.fullName:r}),c.jsx(br,{dataKey:"spent",radius:[0,4,4,0],children:e.map((r,i)=>c.jsx(Kg,{fill:n(r.percentUsed)},`cell-${i}`))})]})})}),c.jsxs("div",{className:"mt-4 flex items-center justify-center gap-6 text-xs",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:"#2BB673"}}),c.jsx("span",{className:"text-gray-600",children:"On track (<75%)"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:"#F59E0B"}}),c.jsx("span",{className:"text-gray-600",children:"Caution (75-90%)"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:"#F2C14E"}}),c.jsx("span",{className:"text-gray-600",children:"Warning (90-100%)"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:"#D64550"}}),c.jsx("span",{className:"text-gray-600",children:"Over budget (100%)"})]})]})]})}function eAe(){const[t,e]=T.useState(rz()),[n,r]=T.useState(!1),[i,s]=T.useState(""),[a,o]=T.useState(""),{data:l=[],isLoading:u}=iz(t),{data:d=[]}=PO(),f=QSe(t),p=YSe(),m=XSe(),y=new Map(d.map(j=>[j.id,j.path||j.name])),g=d.filter(j=>!l.find(N=>N.category_id===j.id)),v=l.reduce((j,N)=>j+N.target,0),b=l.reduce((j,N)=>{const P=f.get(N.category_id)||0;return j+P},0),x=v-b,w=async j=>{if(j.preventDefault(),!i||!a){alert("Please select a category and enter a target amount");return}const N=parseFloat(a);if(isNaN(N)||N<=0){alert("Please enter a valid target amount");return}try{await p.mutateAsync({month:t,category_id:i,target:N,model:"monthlyTarget",carry:0}),s(""),o(""),r(!1)}catch(P){Me.error("Failed to create budget",P),alert("Failed to create budget")}},S=async(j,N)=>{try{await m.mutateAsync({id:j,target:N})}catch(P){Me.error("Failed to update budget",P),alert("Failed to update budget")}},_=j=>{const[N,P]=t.split("-").map(Number),O=new Date(N,P-1,1);j==="prev"?O.setMonth(O.getMonth()-1):O.setMonth(O.getMonth()+1);const M=`${O.getFullYear()}-${String(O.getMonth()+1).padStart(2,"0")}`;e(M)},A=j=>{const[N,P]=j.split("-");return new Date(parseInt(N),parseInt(P)-1,1).toLocaleDateString("en-US",{month:"long",year:"numeric"})};return u?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"}),c.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading budgets..."})]})}):c.jsxs("div",{children:[c.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Monthly Budgets"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Track spending against your budget targets"})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>_("prev"),className:"p-2 hover:bg-gray-100 rounded-md",title:"Previous month",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),c.jsx("div",{className:"text-lg font-semibold text-gray-900 min-w-[160px] text-center",children:A(t)}),c.jsx("button",{onClick:()=>_("next"),className:"p-2 hover:bg-gray-100 rounded-md",title:"Next month",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),g.length>0&&c.jsx("button",{onClick:()=>r(!n),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 text-sm",children:n?"Cancel":"+ Add Budget"})]})]}),n&&c.jsx("form",{onSubmit:w,className:"mb-6 bg-gray-50 border border-gray-200 rounded-lg p-4",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),c.jsxs("select",{value:i,onChange:j=>s(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[c.jsx("option",{value:"",children:"Select category..."}),g.map(j=>c.jsx("option",{value:j.id,children:j.path||j.name},j.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Target"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",step:"0.01",value:a,onChange:j=>o(j.target.value),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"0.00",required:!0})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsx("button",{type:"submit",disabled:p.isPending,className:"w-full px-4 py-2 bg-success text-white rounded-md hover:bg-success/90 disabled:opacity-50",children:p.isPending?"Adding...":"Add Budget"})})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Total Budgeted"}),c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ie(v)})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Total Spent"}),c.jsx("p",{className:"text-2xl font-bold text-danger",children:ie(b)})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Remaining"}),c.jsx("p",{className:`text-2xl font-bold ${x>=0?"text-success":"text-danger"}`,children:ie(x)})]})]}),l.length>0&&c.jsx(ZSe,{budgets:l.map(j=>({category:y.get(j.category_id)||"Unknown",budgeted:j.target,spent:f.get(j.category_id)||0,remaining:j.target-(f.get(j.category_id)||0)}))}),l.length===0?c.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[c.jsx("p",{className:"text-gray-600",children:"No budgets set for this month."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'Click "Add Budget" to set spending targets for your categories.'})]}):c.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:l.map(j=>c.jsx(JSe,{budget:j,categoryName:y.get(j.category_id)||"Unknown",spent:f.get(j.category_id)||0,onUpdateTarget:S},j.id))})]})}function tAe(t=Je(new Date,"yyyy-MM")){return Bt({queryKey:["budget-performance",t],queryFn:async()=>{const e=await He(),n=Je(Av(new Date(t+"-01")),"yyyy-MM-dd"),r=Je(H8(new Date(t+"-01")),"yyyy-MM-dd"),{data:i,error:s}=await he.from("budgets").select("*, category:categories(name)").eq("created_by",e).eq("month",t);if(s)throw s;const{data:a,error:o}=await he.from("transactions").select("category_id, amount").eq("created_by",e).gte("date",n).lte("date",r).lt("amount",0);if(o)throw o;const l=new Map;(a||[]).forEach(p=>{if(p.category_id){const m=l.get(p.category_id)||0;l.set(p.category_id,m+Math.abs(p.amount))}});const u=(i||[]).map(p=>{var x;const m=p.target,y=l.get(p.category_id)||0,g=m-y,v=m>0?y/m*100:0;let b;return v>100?b="over":v>80?b="near":b="under",{category_id:p.category_id,category_name:((x=p.category)==null?void 0:x.name)||"Unknown",budgeted:m,actual:y,remaining:g,percentUsed:v,status:b}}),d=u.reduce((p,m)=>({budgeted:p.budgeted+m.budgeted,actual:p.actual+m.actual,remaining:p.remaining+m.remaining,percentUsed:0}),{budgeted:0,actual:0,remaining:0,percentUsed:0});return d.percentUsed=d.budgeted>0?d.actual/d.budgeted*100:0,{month:t,categories:u.sort((p,m)=>m.percentUsed-p.percentUsed),totals:d}},staleTime:60*1e3})}function nAe({month:t=Je(new Date,"yyyy-MM")}){const{data:e,isLoading:n,error:r}=tAe(t);return n?c.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:c.jsx("div",{className:"text-center text-gray-500",children:"Loading budget performance..."})}):r?c.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:c.jsx("div",{className:"text-center text-red-600",children:"Error loading budget performance"})}):!e||e.categories.length===0?c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Budget Performance"}),c.jsxs("div",{className:"text-center text-gray-500 py-8",children:[c.jsx("p",{children:"No budgets set for this month."}),c.jsx("p",{className:"text-sm mt-2",children:"Create budgets to track your spending performance."})]})]}):c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Budget Performance"}),c.jsx("div",{className:"text-sm text-gray-600",children:Je(new Date(t+"-01"),"MMMM yyyy")})]}),c.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Budgeted"}),c.jsx("div",{className:"text-lg font-bold text-gray-900",children:ie(e.totals.budgeted)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Spent"}),c.jsx("div",{className:"text-lg font-bold text-gray-900",children:ie(e.totals.actual)})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Remaining"}),c.jsx("div",{className:`text-lg font-bold ${e.totals.remaining>=0?"text-green-600":"text-red-600"}`,children:ie(e.totals.remaining)})]})]}),c.jsxs("div",{className:"mt-3",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[c.jsx("span",{children:"Overall Progress"}),c.jsxs("span",{children:[e.totals.percentUsed.toFixed(0),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all ${e.totals.percentUsed>100?"bg-red-500":e.totals.percentUsed>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(e.totals.percentUsed,100)}%`}})})]})]}),c.jsx("div",{className:"space-y-4",children:e.categories.map(i=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"font-medium text-gray-900",children:i.category_name}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:[ie(i.actual)," / ",ie(i.budgeted)]}),c.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.status==="over"?"bg-red-100 text-red-700":i.status==="near"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:[i.percentUsed.toFixed(0),"%"]})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all ${i.status==="over"?"bg-red-500":i.status==="near"?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(i.percentUsed,100)}%`}})}),c.jsx("div",{className:"mt-2 text-xs text-gray-600",children:i.remaining>=0?c.jsxs("span",{className:"text-green-600",children:[ie(i.remaining)," remaining"]}):c.jsxs("span",{className:"text-red-600",children:[ie(Math.abs(i.remaining))," over budget"]})})]},i.category_id))})]})}function rAe(){const{data:t=[]}=lo(500),{data:e=[]}=Ms(),n=Je(Av(new Date),"yyyy-MM"),{data:r=[]}=iz(n);return T.useMemo(()=>{const i=t.filter(g=>g.date.startsWith(n)),s=i.reduce((g,v)=>v.amount>0?g+v.amount:g,0),a=i.reduce((g,v)=>v.amount<0?g+Math.abs(v.amount):g,0),o=s-a,l=s>0?o/s*100:0,u=new Map;i.forEach(g=>{if(g.amount<0&&g.category_id){const v=u.get(g.category_id)||0;u.set(g.category_id,v+Math.abs(g.amount))}});const d=Array.from(u.entries()).map(([g,v])=>{const b=e.find(w=>w.id===g),x=r.find(w=>w.category_id===g);return{categoryId:g,categoryName:(b==null?void 0:b.name)||"Unknown",amount:v,percentOfTotal:a>0?v/a*100:0,hasbudget:!!x,budgetAmount:x==null?void 0:x.target,overBudget:x?v>x.target:!1}}).sort((g,v)=>v.amount-g.amount),f=[];d.forEach(g=>{g.percentOfTotal>20&&g.amount>100&&f.push({type:"high-spending",title:`High spending in ${g.categoryName}`,description:`This category represents ${g.percentOfTotal.toFixed(1)}% of your total spending. Even a 10% reduction could save you $${(g.amount*.1).toFixed(0)}/month.`,categoryName:g.categoryName,amount:g.amount,potentialSavings:g.amount*.1,priority:"high"})}),d.forEach(g=>{if(g.overBudget&&g.budgetAmount){const v=g.amount-g.budgetAmount;f.push({type:"over-budget",title:`Over budget in ${g.categoryName}`,description:`You've spent $${v.toFixed(0)} more than your budget of $${g.budgetAmount.toFixed(0)}. Staying on budget would increase your savings rate.`,categoryName:g.categoryName,amount:v,potentialSavings:v,priority:"high"})}}),d.filter(g=>!g.hasbudget&&g.amount>50).slice(0,3).forEach(g=>{f.push({type:"no-budget",title:`No budget set for ${g.categoryName}`,description:`You spent $${g.amount.toFixed(0)} in this category this month. Setting a budget could help control spending.`,categoryName:g.categoryName,amount:g.amount,priority:"medium"})}),l<10?f.push({type:"savings-opportunity",title:"Low savings rate detected",description:`Your current savings rate is ${l.toFixed(1)}%. Consider reviewing your top spending categories to find areas to cut back.`,priority:"high"}):l<20?f.push({type:"savings-opportunity",title:"Room for improvement",description:`Your savings rate of ${l.toFixed(1)}% is decent, but increasing it to 20%+ would significantly accelerate your FIRE journey.`,priority:"medium"}):l>=50&&f.push({type:"savings-opportunity",title:"Excellent savings rate!",description:`Your ${l.toFixed(1)}% savings rate is fantastic! You're on track for an early FIRE.`,priority:"low"});const m=f.filter(g=>g.potentialSavings).reduce((g,v)=>g+(v.potentialSavings||0),0),y=s>0?(o+m)/s*100:l;return f.sort((g,v)=>{const b={high:0,medium:1,low:2};return b[g.priority]-b[v.priority]}),{currentSavingsRate:l,monthlyIncome:s,monthlySpending:a,monthlySavings:o,categorySpending:d,insights:f,potentialSavingsRate:y,totalPotentialSavings:m}},[t,e,r,n])}function iAe(){const t=rAe(),{currentSavingsRate:e,monthlyIncome:n,monthlySpending:r,monthlySavings:i,categorySpending:s,insights:a,potentialSavingsRate:o,totalPotentialSavings:l}=t;return c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:" Savings Rate Optimization"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Personalized recommendations to improve your savings"})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Current Rate"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[e.toFixed(1),"%"]})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600 font-medium mb-1",children:"Monthly Income"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ie(n)})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600 font-medium mb-1",children:"Monthly Spending"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ie(r)})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-green-600 font-medium mb-1",children:"Monthly Savings"}),c.jsx("div",{className:"text-2xl font-bold text-green-900",children:ie(i)})]})]}),l>0&&c.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-green-800 mb-1",children:" Potential Improvement"}),c.jsxs("div",{className:"text-lg font-semibold text-green-900",children:["Save an additional ",ie(l),"/month"]}),c.jsxs("div",{className:"text-sm text-green-700 mt-1",children:["This would increase your savings rate to"," ",c.jsxs("span",{className:"font-semibold",children:[o.toFixed(1),"%"]})]})]}),c.jsx("div",{className:"text-4xl",children:""})]})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3",children:"Recommendations"}),a.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx("div",{className:"text-4xl mb-2",children:""}),c.jsx("p",{className:"text-sm",children:"Great job! No specific optimization recommendations at this time."}),c.jsx("p",{className:"text-xs mt-1",children:"Keep tracking your spending to get personalized insights."})]}):a.map((u,d)=>c.jsx("div",{className:`border-l-4 rounded-lg p-4 ${u.priority==="high"?"bg-red-50 border-red-400":u.priority==="medium"?"bg-yellow-50 border-yellow-400":"bg-green-50 border-green-400"}`,children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("h5",{className:`font-semibold ${u.priority==="high"?"text-red-900":u.priority==="medium"?"text-yellow-900":"text-green-900"}`,children:u.title}),c.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${u.priority==="high"?"bg-red-200 text-red-800":u.priority==="medium"?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"}`,children:u.priority})]}),c.jsx("p",{className:`text-sm ${u.priority==="high"?"text-red-700":u.priority==="medium"?"text-yellow-700":"text-green-700"}`,children:u.description})]}),u.potentialSavings&&c.jsxs("div",{className:"ml-4 text-right",children:[c.jsx("div",{className:`text-sm font-medium ${u.priority==="high"?"text-red-600":"text-yellow-600"}`,children:"Save"}),c.jsx("div",{className:`text-lg font-bold ${u.priority==="high"?"text-red-900":"text-yellow-900"}`,children:ie(u.potentialSavings)})]})]})},d))]}),s.length>0&&c.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3",children:"Top Spending Categories This Month"}),c.jsx("div",{className:"space-y-2",children:s.slice(0,5).map(u=>c.jsxs("div",{className:"flex items-center justify-between py-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"font-medium text-gray-900",children:u.categoryName}),u.overBudget&&c.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-100 text-red-700 rounded-full font-medium",children:"Over Budget"}),!u.hasbudget&&c.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full font-medium",children:"No Budget"})]}),c.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full ${u.overBudget?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(u.percentOfTotal,100)}%`}})}),c.jsxs("span",{className:"text-xs text-gray-500 min-w-[3rem] text-right",children:[u.percentOfTotal.toFixed(0),"%"]})]})]}),c.jsxs("div",{className:"ml-4 text-right",children:[c.jsx("div",{className:"font-semibold text-gray-900",children:ie(u.amount)}),u.budgetAmount&&c.jsxs("div",{className:"text-xs text-gray-500",children:["of ",ie(u.budgetAmount)]})]})]},u.categoryId))})]})]})}const sAe=()=>({data:null});function aAe(t,e){const n=t.filter(m=>{var y,g;return((y=m.account_group)==null?void 0:y.name)==="Investment"||((g=m.account_group)==null?void 0:g.name)==="Retirement"||m.type==="investment"||m.type==="retirement"}),r=n.reduce((m,y)=>m+(y.current_balance||0),0),i=n.filter(m=>{var y;return((y=m.account_group)==null?void 0:y.name)==="Retirement"||m.type==="retirement"}),s=n.filter(m=>{var y;return((y=m.account_group)==null?void 0:y.name)==="Investment"||m.type==="investment"}),a=i.reduce((m,y)=>m+(y.current_balance||0),0),o=s.reduce((m,y)=>m+(y.current_balance||0),0),l=r>0?(a*e*.8+o*e)/r:e,u=1-e,d=1-l,f=.05,p=Math.max(0,1-l-d);return{totalValue:r,stockValue:r*l,bondValue:r*d,cashValue:r*p,currentStockAllocation:l,currentBondAllocation:d,currentCashAllocation:p,targetStockAllocation:e,targetBondAllocation:u,targetCashAllocation:f,allocationDrift:{stock:l-e,bond:d-u,cash:p-f}}}function oAe(){return Bt({queryKey:["last-investment-contribution"],queryFn:async()=>{const e=new Date;return e.setDate(e.getDate()-45),e.toISOString()},staleTime:1e3*60*60})}function lAe(){const{data:t}=sAe();return T.useMemo(()=>{try{return((t==null?void 0:t.feature_flags)||{}).dismissed_reminders||{}}catch{return{}}},[t==null?void 0:t.feature_flags])}function cAe(){const{data:t=[]}=ar(),{selectedScenario:e}=CO(),{data:n}=oAe(),r=lAe(),i=T.useMemo(()=>{if(!e||t.length===0)return[];const s=e.portfolio_stock_pct,a=aAe(t,s),o=[],l=Math.abs(a.allocationDrift.stock),u=.05;if(l>u&&a.totalValue>1e3){const g=a.allocationDrift.stock>0?"overweight":"underweight",v=(s*100).toFixed(0),b=(a.currentStockAllocation*100).toFixed(0);o.push({id:"portfolio-rebalancing",type:"rebalancing",priority:l>.1?"high":"medium",title:"Portfolio Needs Rebalancing",description:`Your stock allocation is ${b}% (target: ${v}%). You're ${g} in stocks by ${(l*100).toFixed(1)}%.`,actionText:"Review Allocation",value:l*100,threshold:u*100,icon:"",color:l>.1?"red":"yellow",dismissible:!0,lastDismissed:r["portfolio-rebalancing"]})}if(n){const g=Math.floor((new Date().getTime()-new Date(n).getTime())/864e5),v=60;g>v&&o.push({id:"contribution-reminder",type:"contribution",priority:g>90?"high":"medium",title:"Consider Making Investment Contribution",description:`It's been ${g} days since your last investment contribution. Regular contributions help maintain your FIRE timeline.`,actionText:"Add Transaction",value:g,threshold:v,icon:"",color:g>90?"red":"blue",dismissible:!0,lastDismissed:r["contribution-reminder"]})}if(a.totalValue<e.current_savings*.8){const g=e.current_savings>0?a.totalValue/e.current_savings:0;o.push({id:"low-investment-allocation",type:"allocation",priority:"medium",title:"Low Investment Account Balance",description:`Only ${(g*100).toFixed(0)}% of your portfolio is in investment accounts. Consider moving cash to investments for better growth potential.`,actionText:"Review Accounts",value:g*100,threshold:80,icon:"",color:"yellow",dismissible:!0,lastDismissed:r["low-investment-allocation"]})}const d=e.current_age||30,f=Math.max(.2,(100-d)/100);s-f>.15&&d>50&&o.push({id:"aggressive-allocation-warning",type:"allocation",priority:"low",title:"Consider Age-Appropriate Allocation",description:`At age ${d}, a ${(s*100).toFixed(0)}% stock allocation may be aggressive. Consider gradually reducing to ${(f*100).toFixed(0)}%.`,actionText:"Review Strategy",value:s*100,threshold:f*100,icon:"",color:"blue",dismissible:!0,lastDismissed:r["aggressive-allocation-warning"]});const m=e.expected_return_mean||.07;m>.1&&o.push({id:"optimistic-returns-warning",type:"performance",priority:"low",title:"Review Return Expectations",description:`Your scenario assumes ${(m*100).toFixed(1)}% annual returns. Market historical averages suggest 7-9% may be more realistic.`,actionText:"Edit Scenario",value:m*100,threshold:10,icon:"",color:"blue",dismissible:!0,lastDismissed:r["optimistic-returns-warning"]});const y=new Date;return y.setDate(y.getDate()-7),o.filter(g=>!g.dismissible||!g.lastDismissed?!0:new Date(g.lastDismissed)<y)},[t,e,n,r]);return{reminders:i,hasHighPriorityReminders:i.some(s=>s.priority==="high"),hasMediumPriorityReminders:i.some(s=>s.priority==="medium"),totalReminders:i.length}}function uAe({onNavigate:t}){const{reminders:e,hasHighPriorityReminders:n,totalReminders:r}=cAe();if(r===0)return c.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg cursor-pointer hover:bg-green-100 transition-colors",onClick:()=>t==null?void 0:t("accounts"),children:c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"text-green-500 mr-3",children:""}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-green-800",children:"Portfolio Balanced"}),c.jsx("p",{className:"text-xs text-green-600",children:"No actions needed"})]})]})})});const i=e.find(s=>s.priority==="high")||e[0];return c.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${n?"bg-red-50 border-red-200 hover:bg-red-100":"bg-yellow-50 border-yellow-200 hover:bg-yellow-100"}`,onClick:()=>t==null?void 0:t("accounts"),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"text-lg mr-3",children:(i==null?void 0:i.icon)||""}),c.jsxs("div",{children:[c.jsxs("p",{className:`text-sm font-medium ${n?"text-red-800":"text-yellow-800"}`,children:[r," Investment ",r===1?"Reminder":"Reminders"]}),c.jsx("p",{className:`text-xs ${n?"text-red-600":"text-yellow-600"}`,children:(i==null?void 0:i.title)||"Portfolio optimization available"})]})]}),c.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${n?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:r})]})})}function rF({onNavigate:t}={}){const e=gj();return c.jsxs("div",{children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Your FIRE journey at a glance"})]}),c.jsx("div",{className:"mb-6",children:c.jsx(G_e,{})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsx(ok,{title:"Net Worth",value:ie(e.netWorth),subtitle:`Across ${e.accountCount} accounts`,color:"primary",icon:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c.jsx(ok,{title:"This Month's Spending",value:ie(e.monthlySpending),subtitle:`Income: ${ie(e.monthlyIncome)}`,color:"danger",icon:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),c.jsx(ok,{title:"Savings Rate",value:`${e.savingsRate.toFixed(1)}%`,subtitle:"This month",color:e.savingsRate>=50?"success":e.savingsRate>=25?"warning":"danger",icon:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}),c.jsx("div",{className:"mt-6",children:c.jsx(hSe,{})}),c.jsx("div",{className:"mt-6",children:c.jsx(VSe,{})}),c.jsx("div",{className:"mt-6",children:c.jsx(nAe,{})}),c.jsx("div",{className:"mt-6",children:c.jsx(iAe,{})}),c.jsx("div",{className:"mt-6",children:c.jsx(ASe,{})}),"      ",c.jsx("div",{className:"mt-6",children:c.jsx(ySe,{})}),c.jsx("div",{className:"mt-6",children:c.jsx(uAe,{onNavigate:t})})]})}function dAe(){const[t,e]=T.useState("6m"),{data:n=[]}=lo(1e3),{data:r=[]}=Ms(),{data:i=[]}=ar(),s=T.useMemo(()=>{const m=new Map;return i.forEach(y=>m.set(y.id,{id:y.id,type:y.type})),m},[i]),a=T.useMemo(()=>{const m=new Date;let y;switch(t){case"3m":y=new Date(m.getFullYear(),m.getMonth()-3,1);break;case"6m":y=new Date(m.getFullYear(),m.getMonth()-6,1);break;case"12m":y=new Date(m.getFullYear(),m.getMonth()-12,1);break;case"ytd":y=new Date(m.getFullYear(),0,1);break;case"all":return n.filter(g=>!g.transfer_id)}return n.filter(g=>new Date(g.date)>=y&&!g.transfer_id)},[n,t]),o=T.useMemo(()=>{const m=a.filter(x=>x.transaction_type==="expense").reduce((x,w)=>x+Math.abs(w.amount),0),y=a.filter(x=>x.transaction_type==="income").reduce((x,w)=>x+w.amount,0),g=x=>["credit","credit_card"].includes(x||""),b=a.filter(x=>x.transaction_type==="debt_payment"&&x.amount<0).filter(x=>{var _;const w=a.find(A=>A.id===x.transfer_id),S=w?(_=s.get(w.account_id))==null?void 0:_.type:void 0;return!g(S)}).reduce((x,w)=>x+Math.abs(w.amount),0);return[{name:"Expenses",value:m,color:"#EF4444"},{name:"Income",value:y,color:"#10B981"},{name:"Debt Payments",value:b,color:"#8B5CF6"}].filter(x=>x.value>0)},[a]),l=T.useMemo(()=>{const m=new Map;return a.forEach(y=>{var x;if(y.transaction_type==="transfer")return;const g=new Date(y.date),v=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`;m.has(v)||m.set(v,{income:0,expenses:0,debtPayments:0,net:0});const b=m.get(v);if(y.transaction_type==="income")b.income+=y.amount;else if(y.transaction_type==="expense")b.expenses+=Math.abs(y.amount);else if(y.transaction_type==="debt_payment"&&y.amount<0){const w=a.find(_=>_.id===y.transfer_id),S=w?(x=s.get(w.account_id))==null?void 0:x.type:void 0;["credit","credit_card"].includes(S||"")||(b.debtPayments+=Math.abs(y.amount))}}),Array.from(m.entries()).map(([y,g])=>({month:new Date(y+"-01").toLocaleDateString("en-US",{month:"short",year:"2-digit"}),income:g.income,expenses:g.expenses,debtPayments:g.debtPayments,net:g.income-g.expenses-g.debtPayments,savings:g.income>0?(g.income-g.expenses-g.debtPayments)/g.income*100:0})).sort((y,g)=>y.month.localeCompare(g.month)).slice(-12)},[a]),u=T.useMemo(()=>{const m=new Map,y=new Map(r.map(g=>[g.id,g.name]));return a.filter(g=>g.transaction_type==="expense"&&g.category_id).forEach(g=>{const v=y.get(g.category_id)||"Uncategorized";m.set(v,(m.get(v)||0)+Math.abs(g.amount))}),Array.from(m.entries()).map(([g,v])=>({name:g,amount:v})).sort((g,v)=>v.amount-g.amount).slice(0,10)},[a,r]),d=T.useMemo(()=>{const m=a.filter(x=>x.transaction_type==="debt_payment"&&x.amount<0).filter(x=>{var _;const w=a.find(A=>A.id===x.transfer_id),S=w?(_=s.get(w.account_id))==null?void 0:_.type:void 0;return!["credit","credit_card"].includes(S||"")}),y=m.reduce((x,w)=>x+Math.abs(w.amount),0),g=m.length,v=new Map;m.forEach(x=>{const S=new Date(x.date).toLocaleDateString("en-US",{month:"short",year:"2-digit"});v.set(S,(v.get(S)||0)+Math.abs(x.amount))});const b=Array.from(v.entries()).map(([x,w])=>({month:x,amount:w})).sort((x,w)=>x.month.localeCompare(w.month)).slice(-6);return{total:y,count:g,average:g>0?y/g:0,monthlyData:b}},[a]),f=T.useMemo(()=>{const m=a.filter(x=>x.transaction_type==="income").reduce((x,w)=>x+w.amount,0),y=a.filter(x=>x.transaction_type==="expense").reduce((x,w)=>x+Math.abs(w.amount),0),g=a.filter(x=>x.transaction_type==="debt_payment"&&x.amount<0).filter(x=>{var _;const w=a.find(A=>A.id===x.transfer_id),S=w?(_=s.get(w.account_id))==null?void 0:_.type:void 0;return!["credit","credit_card"].includes(S||"")}).reduce((x,w)=>x+Math.abs(w.amount),0),v=m-y-g,b=m>0?v/m*100:0;return{totalIncome:m,totalExpenses:y,totalDebtPayments:g,netSavings:v,savingsRate:b,avgMonthlyIncome:m/Math.max(l.length,1),avgMonthlyExpenses:y/Math.max(l.length,1)}},[a,l,s]),p=[{value:"3m",label:"3 Months"},{value:"6m",label:"6 Months"},{value:"12m",label:"12 Months"},{value:"ytd",label:"Year to Date"},{value:"all",label:"All Time"}];return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Financial Analytics"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Deep insights into your spending and income patterns"})]}),c.jsx("div",{className:"flex gap-2",children:p.map(m=>c.jsx("button",{onClick:()=>e(m.value),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${t===m.value?"bg-primary text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:m.label},m.value))})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm font-medium text-green-800 mb-1",children:"Total Income"}),c.jsx("div",{className:"text-2xl font-bold text-green-900",children:ie(f.totalIncome)}),c.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Avg: ",ie(f.avgMonthlyIncome),"/mo"]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 border border-red-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm font-medium text-red-800 mb-1",children:"Total Expenses"}),c.jsx("div",{className:"text-2xl font-bold text-red-900",children:ie(f.totalExpenses)}),c.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Avg: ",ie(f.avgMonthlyExpenses),"/mo"]})]}),c.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Debt Payments"}),c.jsx("div",{className:"text-2xl font-bold text-purple-900",children:ie(f.totalDebtPayments)}),c.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:[d.count," payment",d.count!==1?"s":""]})]}),c.jsxs("div",{className:`bg-gradient-to-br border rounded-lg p-4 ${f.savingsRate>=50?"from-green-50 to-emerald-50 border-green-200":f.savingsRate>=25?"from-yellow-50 to-amber-50 border-yellow-200":"from-red-50 to-rose-50 border-red-200"}`,children:[c.jsx("div",{className:`text-sm font-medium mb-1 ${f.savingsRate>=50?"text-green-800":f.savingsRate>=25?"text-yellow-800":"text-red-800"}`,children:"Savings Rate"}),c.jsxs("div",{className:`text-2xl font-bold ${f.savingsRate>=50?"text-green-900":f.savingsRate>=25?"text-yellow-900":"text-red-900"}`,children:[f.savingsRate.toFixed(1),"%"]}),c.jsxs("div",{className:`text-xs mt-1 ${f.savingsRate>=50?"text-green-600":f.savingsRate>=25?"text-yellow-600":"text-red-600"}`,children:["Net: ",ie(f.netSavings)]})]})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Income, Expenses & Debt Payments"}),c.jsx("div",{className:"h-80",children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(fj,{data:l,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),c.jsx(ir,{dataKey:"month",stroke:"#6B7280",style:{fontSize:"12px"}}),c.jsx(sr,{stroke:"#6B7280",style:{fontSize:"12px"},tickFormatter:m=>`$${(m/1e3).toFixed(0)}k`}),c.jsx(on,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px"},formatter:m=>ie(m)}),c.jsx(Fr,{wrapperStyle:{fontSize:"12px"}}),c.jsx(br,{dataKey:"income",fill:"#10B981",name:"Income",radius:[4,4,0,0]}),c.jsx(br,{dataKey:"expenses",fill:"#EF4444",name:"Expenses",radius:[4,4,0,0]}),c.jsx(br,{dataKey:"debtPayments",fill:"#8B5CF6",name:"Debt Payments",radius:[4,4,0,0]})]})})})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Savings Rate Trend"}),c.jsx("div",{className:"h-64",children:c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(Zg,{data:l,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),c.jsx(ir,{dataKey:"month",stroke:"#6B7280",style:{fontSize:"12px"}}),c.jsx(sr,{stroke:"#6B7280",style:{fontSize:"12px"},tickFormatter:m=>`${m.toFixed(0)}%`,domain:[0,100]}),c.jsx(on,{contentStyle:{backgroundColor:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:"8px",fontSize:"12px"},formatter:m=>`${m.toFixed(1)}%`}),c.jsx(di,{type:"monotone",dataKey:"savings",stroke:"#2563EB",strokeWidth:3,dot:{fill:"#2563EB",r:4},activeDot:{r:6},name:"Savings Rate"})]})})})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Money Flow Breakdown"}),c.jsx("div",{className:"h-64",children:o.length>0?c.jsx(_s,{width:"100%",height:"100%",children:c.jsxs(D1e,{children:[c.jsx(Ol,{data:o,cx:"50%",cy:"50%",labelLine:!1,label:({name:m,percent:y})=>`${m} ${(y*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:o.map((m,y)=>c.jsx(Kg,{fill:m.color},`cell-${y}`))}),c.jsx(on,{formatter:m=>ie(m)})]})}):c.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No data available"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Spending Categories"}),c.jsx("div",{className:"space-y-3",children:u.length>0?u.map((m,y)=>{const g=u[0].amount,v=m.amount/g*100;return c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[c.jsx("span",{className:"font-medium text-gray-900",children:m.name}),c.jsx("span",{className:"text-gray-600",children:ie(m.amount)})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-gradient-to-r from-red-500 to-rose-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]},y)}):c.jsx("div",{className:"text-center text-gray-400 py-8",children:"No expense data available"})})]}),d.total>0&&c.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-200 rounded-xl p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[c.jsx("span",{children:""}),"Debt Payment Progress"]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[c.jsx("div",{className:"text-xs text-gray-600",children:"Total Paid"}),c.jsx("div",{className:"text-lg font-bold text-purple-900",children:ie(d.total)})]}),c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[c.jsx("div",{className:"text-xs text-gray-600",children:"Payments"}),c.jsx("div",{className:"text-lg font-bold text-gray-900",children:d.count})]}),c.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-100",children:[c.jsx("div",{className:"text-xs text-gray-600",children:"Average"}),c.jsx("div",{className:"text-lg font-bold text-gray-900",children:ie(d.average)})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Recent Months"}),d.monthlyData.map((m,y)=>{const g=Math.max(...d.monthlyData.map(b=>b.amount)),v=m.amount/g*100;return c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[c.jsx("span",{className:"text-gray-700 font-medium",children:m.month}),c.jsx("span",{className:"font-semibold text-purple-600",children:ie(m.amount)})]}),c.jsx("div",{className:"w-full bg-white rounded-full h-2 border border-purple-200",children:c.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-violet-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]},y)})]})]})]})]}),a.length===0&&c.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-12 text-center",children:[c.jsx("div",{className:"text-4xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Yet"}),c.jsx("p",{className:"text-gray-600",children:"Add some transactions to see beautiful analytics and insights!"})]})]})}function hAe(){return Bt({queryKey:["account-groups"],queryFn:async()=>{const{data:t,error:e}=await he.from("account_groups").select("*").order("sort_order",{ascending:!0});if(e)throw e;return t}})}function fAe(){const t=Xe();return et({mutationFn:async({id:e,updates:n})=>{const{data:r,error:i}=await he.from("accounts").update(n).eq("id",e).select();if(i)throw i;return r},onSuccess:()=>{t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]})}})}function pAe(){const t=Xe();return et({mutationFn:async e=>{const{error:n}=await he.from("accounts").delete().eq("id",e);if(n)throw n},onSuccess:()=>{t.invalidateQueries({queryKey:["accounts"]})}})}function mAe(){const t=Xe();return et({mutationFn:async e=>await ks("account_groups",e),onSuccess:()=>{t.invalidateQueries({queryKey:["account-groups"]})}})}function iF({isOpen:t,onClose:e,account:n}){const[r,i]=T.useState(""),[s,a]=T.useState(""),[o,l]=T.useState(""),[u,d]=T.useState(""),[f,p]=T.useState(""),[m,y]=T.useState(""),[g,v]=T.useState(""),[b,x]=T.useState(""),[w,S]=T.useState(""),[_,A]=T.useState(""),[j,N]=T.useState(""),[P,O]=T.useState(""),[M,R]=T.useState(""),[I,L]=T.useState(""),[W,F]=T.useState(!1),[z,U]=T.useState(!1),[K,H]=T.useState(""),{data:Q}=hAe(),B=fAe(),Y=pAe(),ne=mAe(),V={Checking:"checking",Savings:"savings","Credit Card":"credit",Investment:"investment",Retirement:"retirement",HSA:"hsa",Mortgage:"mortgage",Cash:"cash",Asset:"asset"},te=Q==null?void 0:Q.find(Z=>Z.id===s),$=te&&V[te.name]||"checking";T.useEffect(()=>{n&&(i(n.name),a(n.account_group_id||""),l((n.opening_balance??0).toString()),F(!1),U(!1),d(n.interest_rate!==void 0&&n.interest_rate!==null?n.interest_rate.toString():""),p(n.payment_due_day!==void 0&&n.payment_due_day!==null?n.payment_due_day.toString():""),y(n.statement_close_day!==void 0&&n.statement_close_day!==null?n.statement_close_day.toString():""),v(n.credit_limit!==void 0&&n.credit_limit!==null?n.credit_limit.toString():""),x(n.mortgage_interest_rate!==void 0&&n.mortgage_interest_rate!==null?n.mortgage_interest_rate.toString():""),S(n.mortgage_start_date||""),A(n.mortgage_term_months!==void 0&&n.mortgage_term_months!==null?n.mortgage_term_months.toString():""),N(n.mortgage_original_amount!==void 0&&n.mortgage_original_amount!==null?n.mortgage_original_amount.toString():""),O(n.property_address||""),R(n.escrow_amount!==void 0&&n.escrow_amount!==null?n.escrow_amount.toString():""),L(n.next_payment_due_date||""))},[n]);const q=async Z=>{if(Z.preventDefault(),!n||!r.trim()){alert("Please enter an account name");return}if(!s){alert("Please select an account group");return}const J=parseFloat(o);if(isNaN(J)){alert("Please enter a valid balance");return}const X=Q==null?void 0:Q.find(je=>je.id===s),ce=X&&{Checking:"checking",Savings:"savings","Credit Card":"credit",Investment:"investment",Retirement:"retirement",HSA:"hsa",Mortgage:"mortgage",Cash:"cash",Asset:"asset"}[X.name]||"checking",ue={name:r.trim(),type:ce,account_group_id:s,opening_balance:J,updated_at:new Date().toISOString()};ce==="credit"&&(ue.interest_rate=u?parseFloat(u):null,ue.payment_due_day=f?parseInt(f):null,ue.statement_close_day=m?parseInt(m):null,ue.credit_limit=g?parseFloat(g):null),ce==="mortgage"&&(ue.mortgage_interest_rate=b?parseFloat(b):null,ue.mortgage_start_date=w||null,ue.mortgage_term_months=_?parseInt(_):null,ue.mortgage_original_amount=j?parseFloat(j):null,ue.property_address=P||null,ue.escrow_amount=M?parseFloat(M):null,ue.next_payment_due_date=I||null);try{await B.mutateAsync({id:n.id,updates:ue}),e()}catch(je){Me.error("Failed to update account",je),alert("Failed to update account")}},G=async Z=>{if(Z.preventDefault(),!K.trim()){alert("Please enter a group name");return}try{const J=await ne.mutateAsync({name:K.trim(),is_system:!1,sort_order:((Q==null?void 0:Q.length)||0)+1});a(J.id),H(""),U(!1)}catch(J){Me.error("Failed to create group",J),alert("Failed to create account group")}},re=async()=>{if(n)try{await Y.mutateAsync(n.id),e()}catch(Z){Me.error("Failed to delete account",Z),alert("Failed to delete account. It may have transactions.")}};return!t||!n?null:c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Account"}),c.jsxs("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),W?c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-6 h-6 text-danger flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-danger mb-1",children:"Delete Account?"}),c.jsxs("p",{className:"text-sm text-gray-700",children:["Are you sure you want to delete ",c.jsx("strong",{children:n.name}),"? This will also delete all transactions in this account."]}),c.jsx("p",{className:"text-sm text-danger font-medium mt-2",children:"This action cannot be undone."})]})]})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>F(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{onClick:re,disabled:Y.isPending,className:"flex-1 px-4 py-2 bg-danger text-white rounded-md hover:bg-danger/90 disabled:opacity-50",children:Y.isPending?"Deleting...":"Delete Account"})]})]}):c.jsxs("form",{onSubmit:q,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Account Name ",c.jsx("span",{className:"text-danger",children:"*"})]}),c.jsx("input",{type:"text",value:r,onChange:Z=>i(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,autoFocus:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Account Group ",c.jsx("span",{className:"text-danger",children:"*"})]}),z?c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:K,onChange:Z=>H(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g., Business Checking, Kids Savings",autoFocus:!0}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:G,disabled:ne.isPending,className:"flex-1 px-3 py-1.5 text-sm bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50",children:ne.isPending?"Creating...":"Create Group"}),c.jsx("button",{type:"button",onClick:()=>{U(!1),H("")},className:"flex-1 px-3 py-1.5 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsxs("select",{value:s,onChange:Z=>a(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[c.jsx("option",{value:"",children:"Select a group..."}),Q==null?void 0:Q.map(Z=>c.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),c.jsxs("button",{type:"button",onClick:()=>U(!0),className:"text-sm text-primary hover:underline flex items-center gap-1",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create new group"]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beginning Balance"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",step:"0.01",value:o,onChange:Z=>l(Z.target.value),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Current balance (auto-calculated): $",((n==null?void 0:n.current_balance)??0).toFixed(2)]})]}),$==="credit"&&c.jsxs("div",{className:"space-y-4 pt-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interest Rate (APR %)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",max:"99",value:u,onChange:Z=>d(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 19.99"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Due Day"}),c.jsx("input",{type:"number",min:"1",max:"31",value:f,onChange:Z=>p(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 15"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Statement Close Day (optional)"}),c.jsx("input",{type:"number",min:"1",max:"31",value:m,onChange:Z=>y(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 10"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Limit (optional)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:g,onChange:Z=>v(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 5000"})]})]}),$==="mortgage"&&c.jsxs("div",{className:"space-y-4 pt-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interest Rate (APR %)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",max:"99",value:b,onChange:Z=>x(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 3.5"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Start Date"}),c.jsx("input",{type:"date",value:w,onChange:Z=>S(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Loan Term (months)"}),c.jsx("input",{type:"number",min:"1",value:_,onChange:Z=>A(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 360 (30 years)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Loan Amount"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:j,onChange:Z=>N(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 250000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property Address (optional)"}),c.jsx("input",{type:"text",value:P,onChange:Z=>O(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 123 Main St"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monthly Escrow Amount (optional)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:M,onChange:Z=>R(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"e.g. 500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Payment Due Date (optional)"}),c.jsx("input",{type:"date",value:I,onChange:Z=>L(Z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:()=>F(!0),className:"px-4 py-2 border border-danger text-danger rounded-md hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-danger",children:"Delete"}),c.jsxs("div",{className:"flex-1 flex gap-3",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:B.isPending,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50",children:B.isPending?"Saving...":"Save Changes"})]})]})]})]})})]})}function Rl(){return Bt({queryKey:["payees"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("payees").select("*").eq("created_by",t).order("name");if(n)throw n;return e}})}function sz(){const t=Xe();return et({mutationFn:async e=>await ks("payees",e),onSuccess:()=>{t.invalidateQueries({queryKey:["payees"]})}})}function TO(){const t=Xe();return et({mutationFn:async e=>await ks("payees",e),onSuccess:()=>{t.invalidateQueries({queryKey:["payees"]})}})}function az(){const t=Xe();return et({mutationFn:async e=>{const n=await He(),{date:r,fromAccountId:i,toAccountId:s,amount:a,notes:o,isDebtPayment:l=!1}=e;if(a<=0)throw new Error("Transfer amount must be positive");if(i===s)throw new Error("Cannot transfer to the same account");const u=l?"debt_payment":"transfer",{data:d,error:f}=await he.from("transactions").insert({created_by:n,date:r,account_id:i,amount:-Math.abs(a),payee_id:null,category_id:null,notes:o||(l?"Debt payment":"Transfer to account"),is_pending:!1,transaction_type:u,transfer_id:null}).select().single();if(f)throw f;const p=d,{data:m,error:y}=await he.from("transactions").insert({created_by:n,date:r,account_id:s,amount:Math.abs(a),payee_id:null,category_id:null,notes:o||(l?"Debt payment received":"Transfer from account"),is_pending:!1,transaction_type:u,transfer_id:p.id}).select().single();if(y)throw await he.from("transactions").delete().eq("id",p.id),y;const g=m,{error:v}=await he.from("transactions").update({transfer_id:g.id}).eq("id",p.id);if(v)throw await he.from("transactions").delete().in("id",[p.id,g.id]),v;return{withdrawal:p,deposit:g}},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]})}})}function oz(){const t=Xe();return et({mutationFn:async e=>{const n=await He(),{data:r,error:i}=await he.from("transactions").select("*").eq("id",e).eq("created_by",n).single();if(i)throw i;const s=r;if(!s.transfer_id)throw new Error("This is not a transfer transaction");const{error:a}=await he.from("transactions").delete().in("id",[e,s.transfer_id]);if(a)throw a;return{deletedIds:[e,s.transfer_id]}},onSuccess:()=>{t.invalidateQueries({queryKey:["transactions"]}),t.invalidateQueries({queryKey:["accounts"]}),t.invalidateQueries({queryKey:["account-transactions"]})}})}function gAe(){return Bt({queryKey:["payee-usage-stats"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("transactions").select("payee_id, date").eq("created_by",t).order("date",{ascending:!1});if(n)throw n;const r=new Map;return e.forEach(i=>{if(!i.payee_id)return;const s=r.get(i.payee_id);s?(s.usage_count++,i.date>s.last_used&&(s.last_used=i.date)):r.set(i.payee_id,{payee_id:i.payee_id,usage_count:1,last_used:i.date})}),Array.from(r.values())},staleTime:5*60*1e3})}function yAe(t,e,n,r){let i=0;if(i+=Math.min(t*5,50),e){const s=(Date.now()-new Date(e).getTime())/864e5;s<=7?i+=30:s<=30?i+=20:s<=90&&(i+=10)}if(n){const s=n.toLowerCase(),a=r.toLowerCase();a.startsWith(s)?i+=20:a.includes(s)?i+=15:a.split(" ").filter(u=>u.includes(s)).length>0&&(i+=10)}else i+=t>10?15:t>5?10:5;return i}function lz(t="",e=10){const{data:n=[]}=Rl(),{data:r=[]}=gAe();return{suggestions:T.useMemo(()=>{const s=new Map;r.forEach(l=>s.set(l.payee_id,l));const a=n.map(l=>{const u=s.get(l.id),d=(u==null?void 0:u.usage_count)||0,f=(u==null?void 0:u.last_used)||null,p=yAe(d,f,t,l.name);return{id:l.id,name:l.name,default_category_id:l.default_category_id,default_account_id:l.default_account_id,usage_count:d,last_used:f,score:p}});return(t?a.filter(l=>{const u=t.toLowerCase(),d=l.name.toLowerCase();return d.includes(u)||d.startsWith(u)||d.split(" ").some(f=>f.includes(u))}):a).sort((l,u)=>u.score-l.score).slice(0,e)},[n,r,t,e]),isLoading:!1,hasUsageData:r.length>0}}function vAe(t=5){const{suggestions:e}=lz("",t);return{topPayees:e.filter(n=>n.usage_count>0),isLoading:!1}}function OO({value:t,onChange:e,placeholder:n="Enter or select payee...",required:r=!1,autoFocus:i=!1,disabled:s=!1,className:a=""}){const[o,l]=T.useState(!1),[u,d]=T.useState(t),[f,p]=T.useState(-1),m=T.useRef(null),y=T.useRef(null),{suggestions:g}=lz(u,8),{topPayees:v}=vAe(5);T.useEffect(()=>{function N(P){y.current&&!y.current.contains(P.target)&&(l(!1),p(-1))}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),T.useEffect(()=>{d(t)},[t]);const b=N=>{d(N),e(N),l(!0),p(-1)},x=N=>{var P;d(N.name),e(N.name,N),l(!1),(P=m.current)==null||P.blur()},w=()=>{l(!0)},S=N=>{var P;if(N.key==="Escape"&&(l(!1),(P=m.current)==null||P.blur(),p(-1)),N.key==="ArrowDown"||N.key==="Down"){o||l(!0),N.preventDefault();const O=Math.min(f+1,_.length-1);p(O<0?0:O);return}if(N.key==="ArrowUp"||N.key==="Up"){o||l(!0),N.preventDefault();const O=Math.max(f-1,0);p(O);return}if(N.key==="Enter"){if(f>=0&&f<_.length){N.preventDefault(),x(_[f]);return}_.length===1&&(N.preventDefault(),x(_[0]))}},_=T.useMemo(()=>u?g:v,[u,g,v]),A=f>=0&&f<_.length?`payee-option-${_[f].id}`:void 0,j=!u&&v.length>0;return c.jsxs("div",{ref:y,className:"relative",children:[c.jsx("input",{ref:m,type:"text",value:u,onChange:N=>b(N.target.value),onFocus:w,onKeyDown:S,placeholder:n,required:r,disabled:s,autoFocus:i,role:"combobox","aria-autocomplete":"list","aria-expanded":o,"aria-controls":"payee-suggestions-list","aria-activedescendant":A,className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${a}`}),j&&o&&c.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50",children:[c.jsxs("div",{className:"p-2 border-b border-gray-100",children:[c.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"Quick Access"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:v.slice(0,3).map(N=>c.jsxs("button",{type:"button",onClick:()=>x(N),className:"inline-flex items-center px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[c.jsx("span",{children:N.name}),N.usage_count>0&&c.jsxs("span",{className:"ml-1 text-gray-500",children:["(",N.usage_count,")"]})]},N.id))})]}),c.jsx("div",{className:"max-h-48 overflow-y-auto",children:v.map(N=>c.jsxs("button",{type:"button",onClick:()=>x(N),className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center justify-between group",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900",children:N.name}),N.last_used&&c.jsxs("div",{className:"text-xs text-gray-500",children:["Last used: ",new Date(N.last_used).toLocaleDateString()]})]}),c.jsx("div",{className:"flex items-center text-xs text-gray-400",children:N.usage_count>0&&c.jsx("span",{className:"bg-gray-100 px-1.5 py-0.5 rounded-full",children:N.usage_count})})]},N.id))})]}),o&&_.length>0&&c.jsx("div",{id:"payee-suggestions-list",role:"listbox",className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-md shadow-lg z-50 max-h-64 overflow-y-auto",children:_.map((N,P)=>{const O=P===f;return c.jsxs("button",{id:`payee-option-${N.id}`,role:"option","aria-selected":O,type:"button",onClick:()=>x(N),onMouseEnter:()=>p(P),className:`w-full px-3 py-2 text-left flex items-center justify-between ${O?"bg-gray-100":"hover:bg-gray-50"}`,children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900",children:xAe(N.name,u)}),N.last_used&&c.jsxs("div",{className:"text-xs text-gray-500",children:["Used ",N.usage_count," times  Last: ",new Date(N.last_used).toLocaleDateString()]})]}),N.usage_count>0&&c.jsx("div",{className:"text-xs text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded-full",children:N.usage_count})]},N.id)})}),u&&!g.find(N=>N.name.toLowerCase()===u.toLowerCase())&&c.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 px-3 py-2 bg-green-50 border border-green-200 rounded-md text-sm text-green-700",children:[' New payee "',u,'" will be created']}),u&&o&&_.length===0&&c.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-500",children:"No matching payees found"})]})}function xAe(t,e){if(!e)return t;const n=t.toLowerCase(),r=e.toLowerCase(),i=n.indexOf(r);return i===-1?t:c.jsxs(c.Fragment,{children:[t.substring(0,i),c.jsx("mark",{className:"bg-yellow-200 px-0.5 rounded",children:t.substring(i,i+e.length)}),t.substring(i+e.length)]})}function MO({value:t,onChange:e,placeholder:n="Search categories...",required:r=!1,className:i="",error:s}){const{data:a=[]}=PO(),{data:o=[]}=Ms(),l=ez(),[u,d]=T.useState(""),[f,p]=T.useState(!1),[m,y]=T.useState(0),[g,v]=T.useState(!1),b=T.useRef(null),x=T.useRef(null),w=a.find(I=>I.id===t),S=(w==null?void 0:w.path)||"",_=a.filter(I=>{var L;return(L=I.path)==null?void 0:L.toLowerCase().includes(u.toLowerCase())}),A=_.reduce((I,L)=>{var z;const W=((z=L.path)==null?void 0:z.split(">"))||[],F=W.length>1?W[0]:"Other";return I[F]||(I[F]=[]),I[F].push(L),I},{}),j=Object.keys(A).sort();T.useEffect(()=>{const I=L=>{var W;x.current&&!x.current.contains(L.target)&&!((W=b.current)!=null&&W.contains(L.target))&&p(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const N=I=>{if(!f){I.key==="ArrowDown"&&(I.preventDefault(),p(!0));return}switch(I.key){case"Tab":p(!1);break;case"ArrowDown":I.preventDefault(),y(L=>Math.min(L+1,_.length-1));break;case"ArrowUp":I.preventDefault(),y(L=>Math.max(L-1,0));break;case"Enter":I.preventDefault(),_[m]?P(_[m]):u.trim()&&O();break;case"Escape":p(!1);break}},P=I=>{e(I.id,I),d(""),p(!1),y(0)},O=async()=>{if(!(!u.trim()||g)){v(!0);try{const I=u.trim(),L=I.split(">").map(K=>K.trim());let W=null,F,z;if(L.length>1){const K=L[0],H=L[1],Q=o.find(B=>B.name.toLowerCase()===K.toLowerCase()&&B.parent_id===null);Q?W=Q.id:W=(await l.mutateAsync({name:K,path:K,parent_id:null,is_budgetable:!1})).id,F=H,z=`${K}>${H}`}else F=I,z=I;const U=await l.mutateAsync({name:F,path:z,parent_id:W,is_budgetable:!0});e(U.id,U),d(""),p(!1),y(0)}catch(I){console.error("Failed to create category:",I),alert("Failed to create category. Please try again.")}finally{v(!1)}}},M=I=>{d(I.target.value),p(!0),y(0)},R=()=>{p(!0),d("")};return c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:b,type:"text",value:f?u:S,onChange:M,onFocus:R,onKeyDown:N,placeholder:n,required:r,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${s?"border-red-500":"border-gray-300"} ${i}`}),f&&c.jsxs("div",{ref:x,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-96 overflow-y-auto",children:[j.length===0?c.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"No categories found"}):c.jsx("div",{children:j.map(I=>{const L=A[I];return c.jsxs("div",{children:[c.jsx("div",{className:"px-3 py-2 bg-gray-100 border-b border-gray-300",children:c.jsx("div",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wide",children:I})}),L.map(W=>{var H;const z=_.indexOf(W)===m,U=((H=W.path)==null?void 0:H.split(">"))||[],K=U[U.length-1];return c.jsx("button",{type:"button",onClick:()=>P(W),tabIndex:-1,className:`w-full text-left px-4 py-2.5 text-sm transition-colors ${z?"bg-primary text-white":"text-gray-900 hover:bg-gray-100"} ${t===W.id?"bg-blue-50 font-medium":""}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{children:K}),W.is_envelope&&c.jsx("span",{className:`text-xs ${z?"text-white":"text-gray-500"}`,children:""})]})},W.id)})]},I)})}),u.trim()&&c.jsx("div",{className:"border-t border-gray-200",children:c.jsxs("button",{type:"button",onClick:O,disabled:g,tabIndex:-1,className:"w-full text-left px-4 py-3 text-sm text-primary hover:bg-blue-50 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:g?"Creating...":`Create "${u}"`}),c.jsx("div",{className:"text-xs text-gray-500",children:u.includes(">")?"Creates parent and child category":'Tip: Use "Parent>Child" format for subcategories'})]})]})})]})]})}function qC({transaction:t,isOpen:e,onClose:n}){const r=Xe(),{data:i=[]}=ar(),{data:s=[]}=Rl(),{data:a=[]}=lo(100),{data:o=[]}=PO(),l=Q8(),u=J8(),d=oz(),f=TO();T.useEffect(()=>{e&&r.invalidateQueries({queryKey:["transactions",100]})},[e,r]);const p=!!t.transfer_id,m=t.transaction_type==="debt_payment",y=p?a.find($=>$.id===t.transfer_id):null,g=D.useMemo(()=>{if(!a.length||!o.length)return[];const $=new Map;return a.forEach(G=>{if(G.category_id&&!G.transfer_id){const re=G.updated_at??G.created_at??new Date().toISOString(),Z=$.get(G.category_id);if(!Z||re>Z.lastUsed){const J=o.find(X=>X.id===G.category_id);J&&$.set(G.category_id,{category:J,lastUsed:re})}}}),Array.from($.values()).sort((G,re)=>re.lastUsed.localeCompare(G.lastUsed)).map(G=>G.category).slice(0,10)},[a,o,e]),[v,b]=T.useState(t.date),[x,w]=T.useState(Math.abs(t.amount).toString()),[S,_]=T.useState(t.notes||""),[A,j]=T.useState(m),[N,P]=T.useState(t.amount<0?"expense":"income"),[O,M]=T.useState(t.account_id),[R,I]=T.useState(""),[L,W]=T.useState(t.category_id||""),[F,z]=T.useState({}),[U,K]=T.useState(!1),H=T.useRef(null);T.useEffect(()=>{if(t.payee_id&&s.length>0){const $=s.find(q=>q.id===t.payee_id);$&&I($.name)}},[t.payee_id,s]),T.useEffect(()=>{if(!e)return;const $=q=>{const G=q.target,re=G.tagName==="INPUT"||G.tagName==="SELECT"||G.tagName==="TEXTAREA";(q.key==="t"||q.key==="T")&&document.activeElement===H.current&&(q.preventDefault(),b(new Date().toISOString().split("T")[0])),(q.key==="i"||q.key==="I")&&!re&&(q.preventDefault(),P("income")),(q.key==="e"||q.key==="E")&&!re&&(q.preventDefault(),P("expense")),q.key==="Escape"&&n()};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[e,n]);const Q=($,q)=>{I($),F.payeeName&&z(G=>({...G,payeeName:""})),q&&q.default_category_id&&W(q.default_category_id)},B=()=>{const $={};return O||($.accountId="Account is required"),R.trim()||($.payeeName="Payee is required"),L||($.categoryId="Category is required"),(!x||parseFloat(x)<=0)&&($.amount="Valid amount is required"),v||($.date="Date is required"),z($),Object.keys($).length===0},Y=async $=>{var re,Z;if($.preventDefault(),p){if(!x||parseFloat(x)<=0){alert("Valid amount is required");return}if(!v){alert("Date is required");return}const J=parseFloat(x),X=A?"debt_payment":"transfer";try{await l.mutateAsync({id:t.id,updates:{date:v,amount:-Math.abs(J),notes:S||null,transaction_type:X}}),y&&await l.mutateAsync({id:y.id,updates:{date:v,amount:Math.abs(J),notes:S||null,transaction_type:X}}),n()}catch(se){Me.error("Failed to update transfer",se),alert("Failed to update transfer")}return}if(!B())return;const q=parseFloat(x),G=N==="expense"?-Math.abs(q):Math.abs(q);try{let J=(re=s.find(X=>X.name===R))==null?void 0:re.id;if(!J){const X=await f.mutateAsync({name:R,default_category_id:L||null,default_account_id:O||null});J=Array.isArray(X)?(Z=X[0])==null?void 0:Z.id:X==null?void 0:X.id}await l.mutateAsync({id:t.id,updates:{date:v,account_id:O,payee_id:J,category_id:L,amount:G,notes:S||null}}),await new Promise(X=>setTimeout(X,100)),n()}catch(J){Me.error("Failed to update transaction",J),alert("Failed to update transaction")}},ne=async()=>{try{p?await d.mutateAsync(t.id):await u.mutateAsync(t.id),n()}catch($){Me.error("Failed to delete transaction",$),alert("Failed to delete transaction")}};if(!e)return null;const V=i.find($=>$.id===t.account_id),te=y?i.find($=>$.id===y.account_id):null;return p?c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:n}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-lg w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:A?" Edit Debt Payment":" Edit Transfer"}),c.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[c.jsx("div",{className:`p-3 rounded-lg text-sm ${A?"bg-green-50 border border-green-200 text-green-800":"bg-blue-50 border border-blue-200 text-blue-800"}`,children:c.jsxs("p",{className:"flex items-center gap-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Editing will update both linked transactions"})]})}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"From Account:"}),c.jsx("span",{className:"font-medium",children:(V==null?void 0:V.name)||"Unknown"})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"To Account:"}),c.jsx("span",{className:"font-medium",children:(te==null?void 0:te.name)||"Unknown"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"transfer-date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),c.jsx("input",{type:"date",id:"transfer-date",value:v,onChange:$=>b($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"transfer-amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),c.jsx("input",{type:"number",id:"transfer-amount",value:x,onChange:$=>w($.target.value),placeholder:"0.00",step:"0.01",min:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"transfer-notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),c.jsx("textarea",{id:"transfer-notes",value:S,onChange:$=>_($.target.value),placeholder:"Add a note...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),((te==null?void 0:te.type)==="credit_card"||(te==null?void 0:te.type)==="loan"||A)&&c.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-md",children:[c.jsx("input",{type:"checkbox",id:"is-debt-payment-edit",checked:A,onChange:$=>j($.target.checked),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),c.jsxs("label",{htmlFor:"is-debt-payment-edit",className:"text-sm text-gray-700 flex-1",children:[c.jsx("span",{className:"font-medium",children:"Track as debt payment"}),c.jsx("span",{className:"block text-xs text-gray-600 mt-0.5",children:"Counts toward debt payoff progress in analytics"})]})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:l.isPending,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:l.isPending?"Saving...":"Save Changes"}),c.jsx("button",{type:"button",onClick:()=>K(!0),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Delete"})]}),U&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 space-y-3",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Delete this ",A?"debt payment":"transfer","? This will remove both linked transactions."]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{type:"button",onClick:()=>K(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{type:"button",onClick:ne,disabled:d.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:d.isPending?"Deleting...":"Yes, Delete"})]})]})]})]})})]}):c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:n}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit Transaction"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Press ",c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"I"})," for Income,",c.jsx("kbd",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"E"})," for Expense"]})]}),c.jsxs("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{type:"button",onClick:()=>P("expense"),className:`flex-1 px-4 py-2.5 rounded-lg font-medium transition-all ${N==="expense"?"bg-red-100 text-red-700 border-2 border-red-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Expense"})]})}),c.jsx("button",{type:"button",onClick:()=>P("income"),className:`flex-1 px-4 py-2.5 rounded-lg font-medium transition-all ${N==="income"?"bg-green-100 text-green-700 border-2 border-green-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Income"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Date"})}),c.jsx("input",{ref:H,type:"date",value:v,onChange:$=>{b($.target.value),F.date&&z(q=>({...q,date:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${F.date?"border-red-500":"border-gray-300"}`,required:!0}),F.date&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:F.date})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Account"})}),c.jsxs("select",{value:O,onChange:$=>{M($.target.value),F.accountId&&z(q=>({...q,accountId:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${F.accountId?"border-red-500":"border-gray-300"}`,required:!0,children:[c.jsx("option",{value:"",children:"Select..."}),i.map($=>c.jsx("option",{value:$.id,children:$.name},$.id))]}),F.accountId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:F.accountId})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Payee"})}),c.jsx(OO,{value:R,onChange:Q,placeholder:"Enter or select payee...",required:!0}),F.payeeName&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:F.payeeName})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Category"})}),c.jsx(MO,{value:L,onChange:$=>{W($),F.categoryId&&z(q=>({...q,categoryId:""}))},placeholder:"Search or select category...",required:!0,error:F.categoryId}),F.categoryId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:F.categoryId})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Amount"})}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",step:"0.01",value:x,onChange:$=>{w($.target.value),F.amount&&z(q=>({...q,amount:""}))},className:`w-full pl-8 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${F.amount?"border-red-500":"border-gray-300"}`,placeholder:"0.00",required:!0})]}),F.amount&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:F.amount})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsxs("span",{className:"flex items-center gap-1",children:[" Notes ",c.jsx("span",{className:"text-gray-400 font-normal",children:"(optional)"})]})}),c.jsx("input",{type:"text",value:S,onChange:$=>_($.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Add a note..."})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[U?c.jsx("button",{type:"button",onClick:ne,disabled:u.isPending,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 transition-colors",children:u.isPending?"Deleting...":"Confirm Delete"}):c.jsx("button",{type:"button",onClick:()=>K(!0),className:"px-4 py-2 border border-red-300 text-red-600 rounded-md hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Delete"}),c.jsxs("div",{className:"flex-1 flex gap-3",children:[c.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:l.isPending,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 transition-colors font-medium",children:l.isPending?"Saving...":"Save Changes"})]})]})]})}),c.jsx("div",{className:"space-y-4",children:g.length>0&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recent Categories"}),c.jsx("div",{className:"space-y-2",children:g.map($=>c.jsxs("button",{type:"button",onClick:()=>W($.id),className:`w-full text-left px-3 py-2 text-xs rounded transition-colors ${L===$.id?"bg-primary text-white":"bg-white border border-gray-200 hover:bg-gray-100"}`,children:[c.jsx("div",{className:"font-medium truncate",children:$.name}),c.jsx("div",{className:"text-xs opacity-75 truncate",children:$.path})]},$.id))})]})})]})]})})]})}function bAe(t){return[...t].sort((e,n)=>{if(e.date!==n.date)return e.date<n.date?-1:1;const r=e.created_at||"",i=n.created_at||"";return r<i?-1:r>i?1:0})}function wAe(t,e,n){let r=e||0;return t.map(i=>(r+=n?-i.amount:i.amount,{...i,runningBalance:r}))}function _Ae({account:t,onClose:e,variant:n="modal",startDate:r,endDate:i}){const[s,a]=T.useState(null),[o,l]=T.useState(new Set),[u,d]=T.useState("date"),[f,p]=T.useState("asc"),[m,y]=T.useState(!1),[g,v]=T.useState(""),[b,x]=T.useState(!1),w=Q_e(),S=J_e(),{data:_=[]}=ar(),{data:A=[]}=Ms(),j=$=>{const q=new Date,G=q.getFullYear(),re=q.getMonth(),Z=q.getDate();let J=new Date(G,re,$);return Z>=$&&(J=new Date(G,re+1,$)),J};T.useEffect(()=>{const $=localStorage.getItem(`register-sort:${t.id}`);if($)try{const q=JSON.parse($);q!=null&&q.field&&(q!=null&&q.dir)&&(d(q.field),p(q.dir))}catch{}},[t.id]),T.useEffect(()=>{localStorage.setItem(`register-sort:${t.id}`,JSON.stringify({field:u,dir:f}))},[t.id,u,f]);const N=["credit","mortgage"].includes(t.type),{data:P=[]}=Bt({queryKey:["account-transactions",t.id,r??null,i??null],queryFn:async()=>{const $=await He(),{data:q,error:G}=await he.from("transactions").select(`
          *,
          payee:payees(name),
          category:categories(name)
        `).eq("created_by",$).eq("account_id",t.id).gte("date",r||"0001-01-01").lte("date",i||"9999-12-31").order("date",{ascending:!0}).order("created_at",{ascending:!0});if(G)throw G;return q}}),{data:O=[]}=Bt({queryKey:["account-transactions-prior",t.id,r??null],queryFn:async()=>{if(!r)return[];const $=await He(),{data:q,error:G}=await he.from("transactions").select("date, created_at, amount").eq("created_by",$).eq("account_id",t.id).lt("date",r).order("date",{ascending:!0}).order("created_at",{ascending:!0});if(G)throw G;return q}}),M=T.useMemo(()=>{if(!r||O.length===0)return t.opening_balance||0;let $=t.opening_balance||0;for(const q of O)$+=N?-q.amount:q.amount;return $},[r,O,t.opening_balance,N]),R=bAe(P),I=wAe(R,M,N),L=Array.from(new Set(I.filter($=>$.transfer_id).map($=>$.transfer_id))).filter(Boolean),{data:W=[]}=Bt({queryKey:["transfer-counterparts",t.id,L.join(",")],queryFn:async()=>{if(L.length===0)return[];const $=await He(),{data:q,error:G}=await he.from("transactions").select("id, account_id, transfer_id, account:accounts(name)").in("id",L).neq("account_id",t.id).eq("created_by",$);if(G)throw G;return q||[]},staleTime:1e3*60*5}),F=T.useMemo(()=>{const $={};return W.forEach(q=>{var G;!q||!q.id||($[q.id]={accountId:q.account_id,accountName:((G=q.account)==null?void 0:G.name)||"Account"})}),$},[W,t.id]),z=T.useMemo(()=>{let $=[...I];if(g.trim()){const G=g.toLowerCase();$=$.filter(re=>{var ue,je,Be,mt,Hr;const Z=((je=(ue=re.payee)==null?void 0:ue.name)==null?void 0:je.toLowerCase())||"",J=((mt=(Be=re.category)==null?void 0:Be.name)==null?void 0:mt.toLowerCase())||"",X=((Hr=re.notes)==null?void 0:Hr.toLowerCase())||"",se=Math.abs(re.amount).toString(),ce=re.date||"";return Z.includes(G)||J.includes(G)||X.includes(G)||se.includes(G)||ce.includes(G)})}const q=f==="asc"?1:-1;return $.sort((G,re)=>{var X,se,ce,ue;let Z,J;switch(u){case"date":if(Z=G.date,J=re.date,Z===J){const je=G.created_at||"",Be=re.created_at||"";return je<Be?-1*q:1*q}return Z<J?-1*q:1*q;case"description":return Z=(((X=G.payee)==null?void 0:X.name)||"").toLowerCase(),J=(((se=re.payee)==null?void 0:se.name)||"").toLowerCase(),Z.localeCompare(J)*q;case"category":return Z=(((ce=G.category)==null?void 0:ce.name)||"").toLowerCase(),J=(((ue=re.category)==null?void 0:ue.name)||"").toLowerCase(),Z.localeCompare(J)*q;case"amount":return Z=G.amount,J=re.amount,(Z===J?0:Z<J?-1:1)*q;default:return 0}}),$},[I,u,f,g]);function U($){u===$?p(q=>q==="asc"?"desc":"asc"):(d($),p("asc"))}const K=($,q)=>{q==null||q.stopPropagation(),l(G=>{const re=new Set(G);return re.has($)?re.delete($):re.add($),re})},H=()=>{l(new Set(z.map($=>$.id)))},Q=()=>{l(new Set)},B=($,q)=>{if(q.metaKey||q.ctrlKey)K($,q);else if(q.shiftKey&&o.size>0){const G=z.findIndex(X=>X.id===$),re=Array.from(o),Z=re[re.length-1],J=z.findIndex(X=>X.id===Z);if(G!==-1&&J!==-1){const X=Math.min(G,J),se=Math.max(G,J),ce=z.slice(X,se+1).map(ue=>ue.id);l(new Set([...o,...ce]))}}else o.size>0?K($,q):a($)},Y=async()=>{const $=o.size;if(confirm(`Delete ${$} transaction${$!==1?"s":""}?

This action cannot be undone.`))try{await w.mutateAsync(Array.from(o)),Q()}catch(q){console.error("Bulk delete failed:",q),alert("Failed to delete transactions. Please try again.")}},ne=async $=>{try{await S.mutateAsync({ids:Array.from(o),updates:{category_id:$}}),Q()}catch(q){console.error("Bulk categorize failed:",q),alert("Failed to update categories. Please try again.")}},V=async $=>{try{await S.mutateAsync({ids:Array.from(o),updates:{account_id:$}}),Q()}catch(q){console.error("Bulk move failed:",q),alert("Failed to move transactions. Please try again.")}},te=c.jsxs("div",{className:"relative bg-white rounded-xl border border-gray-200 shadow-sm w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.name}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Account Register  Current Balance: ",ie(t.current_balance||0)]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",value:g,onChange:$=>v($.target.value),placeholder:"Search transactions...",className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent w-64"}),c.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",title:"Edit account (name, group, opening balance)",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Account"]}),n==="modal"&&e&&c.jsxs("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]})]}),t.type==="credit"&&c.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.credit_limit!==void 0&&t.credit_limit!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-blue-700",children:"Credit Limit"}),c.jsx("div",{className:"text-sm font-semibold text-blue-900",children:ie(t.credit_limit)})]}),t.interest_rate!==void 0&&t.interest_rate!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-blue-700",children:"Interest Rate (APR)"}),c.jsxs("div",{className:"text-sm font-semibold text-blue-900",children:[t.interest_rate,"%"]})]}),t.payment_due_day!==void 0&&t.payment_due_day!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-blue-700",children:"Next Payment Due"}),c.jsx("div",{className:"text-sm font-semibold text-blue-900",children:wa(j(t.payment_due_day).toISOString().split("T")[0])})]}),t.statement_close_day!==void 0&&t.statement_close_day!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-blue-700",children:"Next Statement Closes"}),c.jsx("div",{className:"text-sm font-semibold text-blue-900",children:wa(j(t.statement_close_day).toISOString().split("T")[0])})]})]})}),t.type==="mortgage"&&c.jsx("div",{className:"mb-6 bg-purple-50 border border-purple-200 rounded-lg p-4",children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.mortgage_interest_rate!==void 0&&t.mortgage_interest_rate!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Interest Rate (APR)"}),c.jsxs("div",{className:"text-sm font-semibold text-purple-900",children:[t.mortgage_interest_rate,"%"]})]}),t.mortgage_original_amount!==void 0&&t.mortgage_original_amount!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Original Amount"}),c.jsx("div",{className:"text-sm font-semibold text-purple-900",children:ie(t.mortgage_original_amount)})]}),t.mortgage_term_months!==void 0&&t.mortgage_term_months!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Loan Term"}),c.jsxs("div",{className:"text-sm font-semibold text-purple-900",children:[t.mortgage_term_months," months (",Math.round(t.mortgage_term_months/12)," years)"]})]}),t.mortgage_start_date&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Start Date"}),c.jsx("div",{className:"text-sm font-semibold text-purple-900",children:wa(t.mortgage_start_date)})]}),t.escrow_amount!==void 0&&t.escrow_amount!==null&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Monthly Escrow"}),c.jsx("div",{className:"text-sm font-semibold text-purple-900",children:ie(t.escrow_amount)})]}),t.next_payment_due_date&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Next Payment Due"}),c.jsx("div",{className:"text-sm font-semibold text-purple-900",children:wa(t.next_payment_due_date)})]}),t.property_address&&c.jsxs("div",{className:"col-span-2",children:[c.jsx("div",{className:"text-xs text-purple-700",children:"Property Address"}),c.jsx("div",{className:"text-sm font-semibold text-purple-900",children:t.property_address})]})]})}),o.size>0&&c.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-3",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[o.size," transaction",o.size!==1?"s":""," selected"]}),c.jsx("button",{onClick:Q,className:"text-sm text-blue-700 hover:text-blue-900 underline",children:"Clear"}),c.jsx("button",{onClick:()=>x(!b),className:"text-sm text-blue-700 hover:text-blue-900 underline",children:b?"Hide actions":"More actions"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:Y,disabled:w.isPending,className:"px-3 py-1.5 text-sm bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50",children:w.isPending?"Deleting...":"Delete"})})]}),b&&c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 pt-3 border-t border-blue-200",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Change Category"}),c.jsxs("select",{onChange:$=>{$.target.value&&(ne($.target.value),$.target.value="")},disabled:S.isPending,className:"w-full px-2 py-1.5 text-sm border border-blue-300 rounded bg-white focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50",children:[c.jsx("option",{value:"",children:"Select category..."}),A.map($=>c.jsx("option",{value:$.id,children:$.name},$.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium text-blue-900 mb-1",children:"Move to Account"}),c.jsxs("select",{onChange:$=>{$.target.value&&(V($.target.value),$.target.value="")},disabled:S.isPending,className:"w-full px-2 py-1.5 text-sm border border-blue-300 rounded bg-white focus:outline-none focus:ring-2 focus:ring-primary disabled:opacity-50",children:[c.jsx("option",{value:"",children:"Select account..."}),_.filter($=>$.id!==t.id).map($=>c.jsx("option",{value:$.id,children:$.name},$.id))]})]})]})]}),c.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 w-10",children:c.jsx("input",{type:"checkbox",checked:o.size>0&&o.size===z.length,onChange:$=>$.target.checked?H():Q(),className:"rounded border-gray-300 text-primary focus:ring-primary",title:"Select all transactions"})}),c.jsx("th",{role:"columnheader button","aria-sort":u==="date"?f==="asc"?"ascending":"descending":"none",onClick:()=>U("date"),className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider select-none cursor-pointer hover:text-gray-900",title:"Sort by date",children:c.jsxs("span",{className:"inline-flex items-center gap-1",children:["Date",u==="date"&&c.jsx("span",{children:f==="asc"?"":""})]})}),c.jsx("th",{role:"columnheader button","aria-sort":u==="description"?f==="asc"?"ascending":"descending":"none",onClick:()=>U("description"),className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider select-none cursor-pointer hover:text-gray-900",title:"Sort by description",children:c.jsxs("span",{className:"inline-flex items-center gap-1",children:["Description",u==="description"&&c.jsx("span",{children:f==="asc"?"":""})]})}),c.jsx("th",{role:"columnheader button","aria-sort":u==="category"?f==="asc"?"ascending":"descending":"none",onClick:()=>U("category"),className:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider select-none cursor-pointer hover:text-gray-900",title:"Sort by type/category",children:c.jsxs("span",{className:"inline-flex items-center gap-1",children:["Type",u==="category"&&c.jsx("span",{children:f==="asc"?"":""})]})}),c.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:N?"Charge":"Expense"}),c.jsx("th",{role:"columnheader button","aria-sort":u==="amount"?f==="asc"?"ascending":"descending":"none",onClick:()=>U("amount"),className:"px-4 py-3 text-right text-xs font-medium text-gray-600 uppercase tracking-wider select-none cursor-pointer hover:text-gray-900",title:"Sort by amount",children:c.jsxs("span",{className:"inline-flex items-center gap-1 justify-end w-full",children:["Payment",u==="amount"&&c.jsx("span",{children:f==="asc"?"":""})]})}),c.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-400 uppercase tracking-wider",title:"Balance is not sortable",children:"Balance"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(()=>{const $=u==="date"&&f==="desc";return c.jsxs(c.Fragment,{children:[!$&&c.jsxs("tr",{className:"bg-blue-50",children:[c.jsx("td",{className:"px-4 py-3"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:""}),c.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",colSpan:2,children:c.jsxs("span",{className:"inline-flex items-center gap-2",children:[r?`Beginning Balance (as of ${wa(r)})`:"Beginning Balance",!r&&c.jsx("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center p-1 text-xs text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",title:"Edit opening balance","aria-label":"Edit opening balance",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:ie(M)})]}),z.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No transactions yet"})}):z.map(q=>{var G,re;return c.jsxs("tr",{className:`hover:bg-gray-50 transition-colors cursor-pointer ${o.has(q.id)?"bg-blue-50":""}`,onClick:Z=>B(q.id,Z),children:[c.jsx("td",{className:"px-4 py-3",onClick:Z=>Z.stopPropagation(),children:c.jsx("input",{type:"checkbox",checked:o.has(q.id),onChange:Z=>K(q.id,Z),className:"rounded border-gray-300 text-primary focus:ring-primary"})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:wa(q.date)}),c.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:q.transfer_id?(()=>{const Z=F[q.transfer_id],J=(Z==null?void 0:Z.accountName)||"Other Account",X=Number(q.amount)<0;return q.transaction_type==="payment"?c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{children:""}),c.jsx("span",{children:X?`Payment to ${J}`:`Payment from ${J}`})]}):c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{children:""}),c.jsx("span",{children:X?`Transfer to ${J}`:`Transfer from ${J}`})]})})():((G=q.payee)==null?void 0:G.name)||""}),q.notes&&c.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:q.notes})]})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((re=q.category)==null?void 0:re.name)||""}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-red-600 font-medium",children:q.amount<0?ie(Math.abs(q.amount)):""}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-green-600 font-medium",children:q.amount>0?ie(q.amount):""}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:ie(q.runningBalance)})]},q.id)}),$&&c.jsxs("tr",{className:"bg-blue-50",children:[c.jsx("td",{className:"px-4 py-3"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:""}),c.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",colSpan:2,children:c.jsxs("span",{className:"inline-flex items-center gap-2",children:[r?`Beginning Balance (as of ${wa(r)})`:"Beginning Balance",!r&&c.jsx("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center p-1 text-xs text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded",title:"Edit opening balance","aria-label":"Edit opening balance",children:c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right font-semibold text-gray-900",children:ie(M)})]})]})})()})]})})}),c.jsx("div",{className:"mt-6 border-t border-gray-200 pt-4",children:c.jsxs("div",{className:"flex justify-between items-start text-sm",children:[c.jsxs("div",{className:"text-gray-600",children:[z.length," transaction",z.length!==1?"s":"",g.trim()&&z.length!==I.length&&c.jsxs("span",{className:"text-gray-500 ml-1",children:["(filtered from ",I.length,")"]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-2",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:N?"Charges":"Expenses"}),c.jsx("div",{className:"font-semibold text-red-600",children:ie(z.filter($=>{var q,G,re,Z;return $.amount<0&&!((G=(q=$.category)==null?void 0:q.name)!=null&&G.toLowerCase().includes("interest"))&&!((Z=(re=$.category)==null?void 0:re.name)!=null&&Z.toLowerCase().includes("reward"))}).reduce(($,q)=>$+Math.abs(q.amount),0))})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:N?"Payments":"Income"}),c.jsx("div",{className:"font-semibold text-green-600",children:ie(z.filter($=>{var q,G,re,Z;return $.amount>0&&!((G=(q=$.category)==null?void 0:q.name)!=null&&G.toLowerCase().includes("interest"))&&!((Z=(re=$.category)==null?void 0:re.name)!=null&&Z.toLowerCase().includes("reward"))}).reduce(($,q)=>$+q.amount,0))})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Interest Charged"}),c.jsx("div",{className:"font-semibold text-red-600",children:ie(z.filter($=>{var q,G;return $.amount<0&&((G=(q=$.category)==null?void 0:q.name)==null?void 0:G.toLowerCase().includes("interest"))}).reduce(($,q)=>$+Math.abs(q.amount),0))})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Interest Earned"}),c.jsx("div",{className:"font-semibold text-green-600",children:ie(z.filter($=>{var q,G;return $.amount>0&&((G=(q=$.category)==null?void 0:q.name)==null?void 0:G.toLowerCase().includes("interest"))}).reduce(($,q)=>$+q.amount,0))})]}),z.some($=>{var q,G;return $.amount<0&&((G=(q=$.category)==null?void 0:q.name)==null?void 0:G.toLowerCase().includes("reward"))})&&c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Rewards Redeemed"}),c.jsx("div",{className:"font-semibold text-red-600",children:ie(z.filter($=>{var q,G;return $.amount<0&&((G=(q=$.category)==null?void 0:q.name)==null?void 0:G.toLowerCase().includes("reward"))}).reduce(($,q)=>$+Math.abs(q.amount),0))})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Rewards Earned"}),c.jsx("div",{className:"font-semibold text-green-600",children:ie(z.filter($=>{var q,G;return $.amount>0&&((G=(q=$.category)==null?void 0:q.name)==null?void 0:G.toLowerCase().includes("reward"))}).reduce(($,q)=>$+q.amount,0))})]})]})]})}),n==="modal"&&e&&c.jsx("div",{className:"mt-6 flex justify-end",children:c.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Close"})})]});return n==="inline"?c.jsxs("div",{className:"w-full",children:[te,s&&c.jsx(qC,{transaction:P.find($=>$.id===s),isOpen:!0,onClose:()=>a(null)}),c.jsx(iF,{account:t,isOpen:m,onClose:()=>y(!1)})]}):c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),c.jsx("div",{className:"flex min-h-full items-start justify-center p-4 pt-16",children:c.jsx("div",{className:"max-w-5xl w-full",children:te})}),s&&c.jsx(qC,{transaction:P.find($=>$.id===s),isOpen:!0,onClose:()=>a(null)}),c.jsx(iF,{account:t,isOpen:m,onClose:()=>y(!1)})]})}function SAe({isOpen:t,onClose:e,accountId:n,defaultType:r,defaultToAccountId:i}){var ne;const{data:s=[]}=ar(),{data:a=[]}=Rl(),{data:o=[]}=Ms(),{data:l=[]}=lo(20),u=TO(),d=mj(),f=az(),[p,m]=T.useState("expense"),[y,g]=T.useState(new Date().toISOString().split("T")[0]),[v,b]=T.useState(""),[x,w]=T.useState(""),[S,_]=T.useState(""),[A,j]=T.useState(""),[N,P]=T.useState(""),[O,M]=T.useState({}),[R,I]=T.useState(!1),L=T.useRef(null),W=T.useRef(null),F=T.useRef(null),z=T.useMemo(()=>{const V=l.filter(q=>q.account_id===n&&q.payee_id),te=new Set,$=[];for(const q of V){if(!q.payee_id||te.has(q.payee_id))continue;te.add(q.payee_id);const G=a.find(re=>re.id===q.payee_id);G&&$.push({payeeId:q.payee_id,payeeName:G.name,categoryId:q.category_id,amount:Math.abs(q.amount),date:q.date})}return $.slice(0,8)},[l,n,a]);T.useEffect(()=>{t&&(setTimeout(()=>{var V;return(V=L.current)==null?void 0:V.focus()},100),r&&m(r),i&&P(i))},[t,r,i]),T.useEffect(()=>{if(!t)return;const V=te=>{if(document.activeElement===L.current&&(te.key==="ArrowUp"||te.key==="ArrowDown")){te.preventDefault();const $=new Date(y),q=new Date($);q.setDate($.getDate()+(te.key==="ArrowUp"?1:-1)),g(q.toISOString().split("T")[0])}te.key==="F1"?(te.preventDefault(),m("expense")):te.key==="F2"?(te.preventDefault(),m("income")):te.key==="F3"?(te.preventDefault(),m("transfer")):te.key==="F4"&&(te.preventDefault(),m("payment"))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[t,y]);const U=(V,te)=>{b(V),O.payeeName&&M($=>({...$,payeeName:""})),te!=null&&te.default_category_id&&w(te.default_category_id)},K=()=>{const V={};return y||(V.date="Date is required"),(!S||parseFloat(S)<=0)&&(V.amount="Valid amount is required"),p==="transfer"||p==="payment"?(N||(V.toAccountId="Destination account is required"),N&&N===n&&(V.toAccountId="Cannot transfer to the same account")):(v.trim()||(V.payeeName="Payee is required"),x||(V.categoryId="Category is required")),M(V),Object.keys(V).length===0},H=(V=!1)=>{b(""),_(""),j(""),P(""),M({}),V||(w(""),g(new Date().toISOString().split("T")[0]),m("expense"))},Q=(V,te,$,q)=>{b(te),$&&w($),_(q.toString()),setTimeout(()=>{var G;return(G=F.current)==null?void 0:G.focus()},50)},B=async V=>{var $,q;if(V.preventDefault(),!K())return;const te=parseFloat(S);try{if(p==="transfer"||p==="payment")await f.mutateAsync({date:y,fromAccountId:n,toAccountId:N,amount:te,notes:A||void 0,isDebtPayment:p==="payment"});else{const G=p==="expense"?-Math.abs(te):Math.abs(te);let re=($=a.find(Z=>Z.name===v))==null?void 0:$.id;if(!re){const Z=await u.mutateAsync({name:v,default_category_id:x||null,default_account_id:n||null});re=Array.isArray(Z)?(q=Z[0])==null?void 0:q.id:Z==null?void 0:Z.id}await d.mutateAsync({date:y,account_id:n,payee_id:re,category_id:x,amount:G,notes:A||null,is_pending:!1})}R?(H(!0),setTimeout(()=>{var G;return(G=W.current)==null?void 0:G.focus()},100)):(H(),e())}catch(G){Me.error("Failed to add transaction",G),alert("Failed to add transaction")}};if(!t)return null;const Y=((ne=s.find(V=>V.id===n))==null?void 0:ne.name)||"Account";return c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl w-full max-w-4xl p-6",children:[c.jsxs("div",{className:"flex items-start justify-between mb-6",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Transaction"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Y,"  ",c.jsx("span",{className:"text-blue-600",children:"Bulk Entry Mode"})]})]}),c.jsx("div",{className:"flex items-center gap-1.5",children:["expense","income","transfer","payment"].map((V,te)=>c.jsxs("button",{type:"button",tabIndex:-1,onClick:()=>m(V),title:`${V.charAt(0).toUpperCase()+V.slice(1)} (F${te+1})`,className:`px-3 py-1.5 rounded-md text-xs font-medium border transition-all ${p===V?"shadow-sm "+(V==="expense"?"bg-red-100 text-red-700 border-red-300":V==="income"?"bg-green-100 text-green-700 border-green-300":V==="transfer"?"bg-blue-100 text-blue-700 border-blue-300":"bg-green-100 text-green-700 border-green-300"):"bg-gray-50 text-gray-500 border-gray-200 hover:bg-gray-100"}`,children:[c.jsxs("span",{className:"opacity-60",children:["F",te+1]}),c.jsx("span",{className:"ml-1",children:V==="expense"?"":V==="income"?"":V==="transfer"?"":""})]},V))})]})}),c.jsxs("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 ml-4",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("form",{onSubmit:B,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Date"}),c.jsx("input",{ref:L,type:"date",value:y,onChange:V=>{g(V.target.value),O.date&&M(te=>({...te,date:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.date?"border-red-500":"border-gray-300"}`,required:!0}),O.date&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.date}),!O.date&&c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Use / arrows to adjust date"})]}),(p==="transfer"||p==="payment")&&c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",p==="payment"?"Pay To":"To Account"]}),c.jsxs("select",{value:N,onChange:V=>P(V.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.toAccountId?"border-red-500":"border-gray-300"}`,required:!0,children:[c.jsx("option",{value:"",children:"Select..."}),s.filter(V=>V.id!==n).filter(V=>p==="payment"?V.type==="credit"||V.type==="mortgage":!0).map(V=>c.jsx("option",{value:V.id,children:V.name},V.id))]}),O.toAccountId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.toAccountId})]}),p!=="transfer"&&p!=="payment"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Payee"}),c.jsx(OO,{value:v,onChange:U,placeholder:"Enter or select payee...",required:!0}),O.payeeName&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.payeeName})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Category"}),c.jsx(MO,{value:x,onChange:V=>{w(V),O.categoryId&&M(te=>({...te,categoryId:""}))},placeholder:"Search or select category...",required:!0,error:O.categoryId}),O.categoryId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.categoryId})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Amount"}),c.jsx("input",{type:"number",step:"0.01",value:S,onChange:V=>{_(V.target.value),O.amount&&M(te=>({...te,amount:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.amount?"border-red-500":"border-gray-300"}`,placeholder:"0.00",required:!0}),O.amount&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.amount})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" Notes ",c.jsx("span",{className:"text-gray-400 font-normal",children:"(optional)"})]}),c.jsx("input",{type:"text",value:A,onChange:V=>j(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Add a note..."})]}),c.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsx("input",{type:"checkbox",id:"keepOpen",checked:R,onChange:V=>I(V.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),c.jsxs("label",{htmlFor:"keepOpen",className:"text-sm text-gray-700 cursor-pointer",children:[c.jsx("span",{className:"font-medium",children:"Add Another"})," - Keep dialog open for rapid entry"]})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:d.isPending||f.isPending,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50 font-medium",children:d.isPending||f.isPending?"Saving...":R?"Save & Next":p==="transfer"?"Create Transfer":p==="payment"?"Submit Payment":"Add Transaction"})]})]})}),c.jsxs("div",{className:"space-y-4",children:[z.length>0&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recent Payees"}),c.jsx("div",{className:"space-y-2",children:z.map(V=>{var te;return c.jsxs("button",{type:"button",onClick:()=>Q(V.payeeId,V.payeeName,V.categoryId,V.amount),className:"w-full text-left px-3 py-2 bg-white border border-gray-200 rounded-md hover:bg-blue-50 hover:border-blue-300 transition-colors",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:V.payeeName}),c.jsxs("div",{className:"flex items-center justify-between mt-1",children:[c.jsx("span",{className:"text-xs text-gray-600 truncate",children:V.categoryId?(te=o.find($=>$.id===V.categoryId))==null?void 0:te.name:"No category"}),c.jsx("span",{className:"text-xs font-semibold text-gray-700",children:ie(-V.amount)})]})]},V.payeeId)})})]}),c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:" Quick Tips"}),c.jsxs("ul",{className:"space-y-1.5 text-xs text-blue-800",children:[c.jsx("li",{children:' Check "Add Another" for bulk entry'}),c.jsx("li",{children:" Click recent payees to auto-fill"}),c.jsx("li",{children:" Use / in date to adjust"}),c.jsx("li",{children:" Use F1-F4 to change transaction type"}),c.jsx("li",{children:" Tab skips type buttons for faster entry"}),c.jsx("li",{children:" Date & category persist when adding more"})]})]})]})]})]})})]})}function AAe(){const{data:t=[],isLoading:e,error:n}=ar(),[r,i]=T.useState(null),[s,a]=T.useState(!0),[o,l]=T.useState(),[u,d]=T.useState(),[f,p]=T.useState(!1),[m,y]=T.useState(void 0),g=T.useRef(null),v=(N,P)=>["credit","mortgage"].includes(N)||(P??0)<0,{assets:b,liabilities:x,totals:w}=T.useMemo(()=>{const N=t.filter(R=>!v(R.type,R.current_balance)),P=t.filter(R=>v(R.type,R.current_balance)),O=N.reduce((R,I)=>R+(I.current_balance??0),0),M=P.reduce((R,I)=>R+Math.abs(I.current_balance??0),0);return{assets:N,liabilities:P,totals:{assets:O,liabilities:M,net:O-M}}},[t]),S=T.useMemo(()=>t.find(N=>N.id===r)??t[0]??null,[t,r]);T.useEffect(()=>{if(!r&&t.length){const N=localStorage.getItem("lastSelectedAccountId");N&&t.some(P=>P.id===N)?i(N):i(t[0].id)}},[t,r]),T.useEffect(()=>{const N=()=>{y(void 0),p(!0)};return window.addEventListener("open-account-add-modal",N),()=>{window.removeEventListener("open-account-add-modal",N)}},[]),T.useEffect(()=>{r&&localStorage.setItem("lastSelectedAccountId",r)},[r]),T.useEffect(()=>{if(!r)return;const N=localStorage.getItem(`register-dates:${r}`);if(N)try{const P=JSON.parse(N);l(P.start),d(P.end)}catch{}else l(void 0),d(void 0)},[r]),T.useEffect(()=>{r&&localStorage.setItem(`register-dates:${r}`,JSON.stringify({start:o,end:u}))},[r,o,u]);const _=T.useMemo(()=>b,[b]),A=T.useMemo(()=>x,[x]),j=T.useMemo(()=>[..._,...A],[_,A]);return T.useEffect(()=>{function N(P){const O=P.target;if(!!O&&(O.tagName==="INPUT"||O.tagName==="TEXTAREA"||O.isContentEditable||O.tagName==="SELECT"))return;const R=P.key.toLowerCase();if(f){R==="escape"&&(P.preventDefault(),p(!1));return}if(R==="a")y(void 0),p(!0);else if(R==="t")y("transfer"),p(!0);else if(R==="d"&&!P.shiftKey){const I=new Date;!o&&!u?(l(Je(JL(I),"yyyy-MM-dd")),d(Je(I,"yyyy-MM-dd"))):(l(void 0),d(void 0))}else if(R==="d"&&P.shiftKey){const I=new Date;l(Je(Av(I),"yyyy-MM-dd")),d(Je(I,"yyyy-MM-dd"))}else if(P.key==="ArrowDown"){P.preventDefault();const I=j;if(!I.length)return;const L=I.findIndex(z=>z.id===r),W=Math.min(L+1,I.length-1),F=I[W]||I[0];F&&F.id!==r&&i(F.id)}else if(P.key==="ArrowUp"){P.preventDefault();const I=j;if(!I.length)return;const L=I.findIndex(z=>z.id===r),W=Math.max(L-1,0),F=I[W]||I[0];F&&F.id!==r&&i(F.id)}}return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[f,o,u,j,r]),e?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsx("div",{className:"text-sm text-gray-500",children:"Loading accounts"})}):n?c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-sm text-red-800",children:"Failed to load accounts."}):t.length===0?c.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center text-gray-600",children:"No accounts yet."}):c.jsxs("div",{className:"flex gap-6",children:[s&&c.jsx("aside",{className:"w-72 shrink-0",children:c.jsx("div",{className:"sticky top-4 space-y-6",children:c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-gray-200",children:[c.jsx("div",{className:"text-sm font-semibold text-gray-900",children:"Accounts"}),c.jsxs("div",{className:"text-xs text-gray-500",children:["Net Worth: ",ie(w.net)]})]}),c.jsxs("div",{className:"px-2 py-2",children:[c.jsx("div",{className:"px-2 py-1 text-xs uppercase tracking-wide text-gray-500 flex items-center justify-between",children:c.jsx("span",{children:"Assets"})}),c.jsx("ul",{className:"mt-1",children:_.map(N=>c.jsx("li",{children:c.jsxs("button",{onClick:()=>i(N.id),className:`w-full text-left px-3 py-2 rounded-md flex items-center justify-between hover:bg-gray-50 ${(S==null?void 0:S.id)===N.id?"bg-blue-50 border border-blue-200":""}`,children:[c.jsx("span",{className:"text-sm text-gray-900",children:N.name}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:ie(N.current_balance??0)})]})},N.id))})]}),c.jsxs("div",{className:"px-2 py-2 border-t border-gray-100",children:[c.jsxs("div",{className:"px-2 py-1 text-xs uppercase tracking-wide text-gray-500 flex items-center justify-between",children:[c.jsx("span",{children:"Liabilities"}),c.jsx("span",{className:"font-medium text-red-700",children:ie(w.liabilities)})]}),c.jsx("ul",{className:"mt-1",children:A.map(N=>c.jsx("li",{children:c.jsxs("button",{onClick:()=>i(N.id),className:`w-full text-left px-3 py-2 rounded-md flex items-center justify-between hover:bg-gray-50 ${(S==null?void 0:S.id)===N.id?"bg-blue-50 border border-blue-200":""}`,children:[c.jsx("span",{className:"text-sm text-gray-900",children:N.name}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:ie(Math.abs(N.current_balance??0))})]})},N.id))})]})]})})}),c.jsxs("section",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>a(N=>!N),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:s?"Hide Sidebar":"Show Sidebar"}),c.jsxs("div",{className:"hidden sm:flex items-center gap-3 text-xs text-gray-500",children:[c.jsx("span",{children:"Shortcuts:"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"A"}),c.jsx("span",{children:"Add"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"T"}),c.jsx("span",{children:"Transfer"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"D"}),c.jsx("span",{children:"Dates"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"Shift+D"}),c.jsx("span",{children:"This Month"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"/"}),c.jsx("span",{children:"Navigate"}),c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"Esc"}),c.jsx("span",{children:"Close"})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("div",{className:"hidden md:flex items-center gap-1 mr-1",children:[c.jsx("button",{onClick:()=>{const N=Je(new Date,"yyyy-MM-dd");l(N),d(N)},className:"px-2 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-50",title:"Today",children:"Today"}),c.jsx("button",{onClick:()=>{const N=new Date,P=Je(Av(N),"yyyy-MM-dd"),O=Je(N,"yyyy-MM-dd");l(P),d(O)},className:"px-2 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-50",title:"This Month",children:"This Month"}),c.jsx("button",{onClick:()=>{const N=new Date,P=Je(JL(N),"yyyy-MM-dd"),O=Je(N,"yyyy-MM-dd");l(P),d(O)},className:"px-2 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-50",title:"Last 30 days",children:"Last 30d"}),c.jsx("button",{onClick:()=>{const N=new Date,P=Je(q8(N),"yyyy-MM-dd"),O=Je(N,"yyyy-MM-dd");l(P),d(O)},className:"px-2 py-1 text-xs border border-gray-300 rounded-md hover:bg-gray-50",title:"Year to date",children:"YTD"})]}),c.jsx("input",{type:"date",value:o||"",onChange:N=>l(N.target.value||void 0),className:"px-2 py-1 border border-gray-300 rounded-md text-sm",placeholder:"Start",ref:g}),c.jsx("span",{className:"text-gray-400",children:""}),c.jsx("input",{type:"date",value:u||"",onChange:N=>d(N.target.value||void 0),className:"px-2 py-1 border border-gray-300 rounded-md text-sm",placeholder:"End"}),c.jsx("button",{onClick:()=>{l(void 0),d(void 0)},className:"px-2 py-1 text-sm text-gray-600 hover:text-gray-800",children:"Clear"}),c.jsx("div",{className:"w-px h-6 bg-gray-200 mx-1"}),c.jsx("button",{onClick:()=>{y(void 0),p(!0)},className:"px-3 py-2 bg-primary text-white rounded-md text-sm hover:bg-primary/90",children:"Add"}),c.jsx("button",{onClick:()=>{y("transfer"),p(!0)},className:"px-3 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Transfer"})]})]}),S?c.jsx(_Ae,{account:S,variant:"inline",startDate:o,endDate:u}):c.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-8 text-center text-gray-600",children:"Select an account to view its register."}),S&&c.jsx(SAe,{isOpen:f,onClose:()=>p(!1),accountId:S.id,defaultType:m})]})]})}function jAe({isOpen:t,onClose:e,defaultAccountId:n,defaultType:r,defaultToAccountId:i,lockAccountSelection:s}){var Q;const{data:a=[]}=ar(),{data:o=[]}=Rl(),{data:l=[]}=lo(5),u=mj(),d=az(),f=TO(),[p,m]=T.useState("expense"),[y,g]=T.useState(new Date().toISOString().split("T")[0]),[v,b]=T.useState(""),[x,w]=T.useState(""),[S,_]=T.useState(""),[A,j]=T.useState(""),[N,P]=T.useState(""),[O,M]=T.useState({}),[R,I]=T.useState(""),L=!!s||!!n,W=T.useRef(null),F=T.useRef(null);T.useEffect(()=>{if(a.length!==0){if(n){b(n);return}v||b(a[0].id)}},[a,v,n]),T.useEffect(()=>{t&&W.current&&setTimeout(()=>{var B,Y;(B=W.current)==null||B.focus(),(Y=W.current)==null||Y.select()},100),t&&r&&m(r),t&&i&&I(i)},[t]),T.useEffect(()=>{if(!t)return;const B=Y=>{const ne=Y.target,V=ne.tagName==="INPUT"||ne.tagName==="SELECT"||ne.tagName==="TEXTAREA";(Y.key==="t"||Y.key==="T")&&document.activeElement===W.current&&(Y.preventDefault(),g(new Date().toISOString().split("T")[0])),(Y.key==="i"||Y.key==="I")&&!V&&(Y.preventDefault(),m("income")),(Y.key==="e"||Y.key==="E")&&!V&&(Y.preventDefault(),m("expense")),Y.key==="Escape"&&e()};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[t,e]);const z=(B,Y)=>{if(w(B),O.payeeName&&M(ne=>({...ne,payeeName:""})),Y)Y.default_category_id&&_(Y.default_category_id),Y.default_account_id&&!v&&!L&&b(Y.default_account_id);else{const ne=o.find(V=>V.name.toLowerCase()===B.toLowerCase());ne&&ne.default_category_id&&_(ne.default_category_id)}},U=()=>{if(l.length===0)return;const B=l[0];L||b(B.account_id),_(B.category_id||""),j(Math.abs(B.amount).toString()),m(B.amount<0?"expense":"income");const Y=o.find(ne=>ne.id===B.payee_id);Y&&w(Y.name)},K=()=>{const B=A?parseFloat(A):void 0,Y=a.find(te=>te.id===v),ne=a.find(te=>te.id===R),V=gV({transactionType:p,accountId:v,accountType:Y==null?void 0:Y.type,toAccountId:R,toAccountType:ne==null?void 0:ne.type,payeeName:x,categoryId:S,amount:B,date:y});return M(V),Object.keys(V).length===0},H=async B=>{var ne,V,te;if(B.preventDefault(),!K())return;const Y=parseFloat(A);try{if(p==="transfer"||p==="payment"){if(!R){alert("Please select a destination account");return}if(v===R){alert("Cannot transfer to the same account");return}await d.mutateAsync({date:y,fromAccountId:v,toAccountId:R,amount:Y,notes:N||void 0,isDebtPayment:p==="payment"}),b(((ne=a[0])==null?void 0:ne.id)||""),I(""),j(""),P(""),g(new Date().toISOString().split("T")[0]),m("expense"),M({}),e();return}const $=p==="expense"?-Math.abs(Y):Math.abs(Y);let q=(V=o.find(G=>G.name===x))==null?void 0:V.id;if(!q){const G=await f.mutateAsync({name:x,default_category_id:S||null,default_account_id:v||null});q=Array.isArray(G)?(te=G[0])==null?void 0:te.id:G==null?void 0:G.id}await u.mutateAsync({date:y,account_id:v,payee_id:q,category_id:S,amount:$,notes:N||null,is_pending:!1}),w(""),_(""),j(""),P(""),g(new Date().toISOString().split("T")[0]),m("expense"),M({}),e()}catch($){Me.error("Failed to create transaction",$),alert("Failed to create transaction")}};return t?c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Quick Add Transaction"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Press ",c.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"I"})," for Income,",c.jsx("kbd",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"E"})," for Expense,",c.jsx("kbd",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 border border-gray-300 rounded text-xs",children:"T"})," for Today"]})]}),c.jsxs("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"lg:col-span-2",children:c.jsxs("form",{onSubmit:H,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Date"})}),c.jsx("input",{ref:W,type:"date",value:y,onChange:B=>{g(B.target.value),O.date&&M(Y=>({...Y,date:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.date?"border-red-500":"border-gray-300"}`,required:!0}),O.date&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.date})]}),!L&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsxs("span",{className:"flex items-center gap-1",children:[" ",p==="transfer"||p==="payment"?"From Account":"Account"]})}),c.jsxs("select",{value:v,onChange:B=>{b(B.target.value),O.accountId&&M(Y=>({...Y,accountId:""}))},className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.accountId?"border-red-500":"border-gray-300"}`,required:!0,children:[c.jsx("option",{value:"",children:"Select..."}),a.map(B=>c.jsxs("option",{value:B.id,children:[B.name," (",ie(B.current_balance||0),")"]},B.id))]}),O.accountId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.accountId})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{type:"button",onClick:()=>m("expense"),className:`px-4 py-2.5 rounded-lg font-medium transition-all ${p==="expense"?"bg-red-100 text-red-700 border-2 border-red-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Expense"})]})}),c.jsx("button",{type:"button",onClick:()=>m("income"),className:`px-4 py-2.5 rounded-lg font-medium transition-all ${p==="income"?"bg-green-100 text-green-700 border-2 border-green-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Income"})]})}),c.jsx("button",{type:"button",onClick:()=>m("transfer"),className:`px-4 py-2.5 rounded-lg font-medium transition-all ${p==="transfer"?"bg-blue-100 text-blue-700 border-2 border-blue-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Transfer"})]})}),c.jsx("button",{type:"button",onClick:()=>m("payment"),className:`px-4 py-2.5 rounded-lg font-medium transition-all ${p==="payment"?"bg-green-100 text-green-700 border-2 border-green-300 shadow-sm":"bg-gray-50 text-gray-600 border-2 border-gray-200 hover:bg-gray-100"}`,children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),c.jsx("span",{children:"Payment"})]})})]})]}),(p==="transfer"||p==="payment")&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsxs("span",{className:"flex items-center gap-1",children:[" ",p==="payment"?"Pay To":"To Account"]})}),c.jsxs("select",{value:R,onChange:B=>{I(B.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:[c.jsx("option",{value:"",children:"Select destination..."}),a.filter(B=>{if(p==="payment"){const Y=B.type==="credit"||B.type==="mortgage",ne=B.id!==v;return Y&&ne}return B.id!==v}).map(B=>c.jsxs("option",{value:B.id,children:[B.name," (",ie(B.current_balance||0),")"]},B.id)),p==="payment"&&a.filter(B=>(B.type==="credit"||B.type==="mortgage")&&B.id!==v).length===0&&c.jsx("option",{value:"",disabled:!0,children:"No credit cards or mortgages available"})]})]}),p!=="transfer"&&p!=="payment"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Payee"})}),c.jsx(OO,{value:x,onChange:z,placeholder:"Enter or select payee...",required:!0,autoFocus:!0}),O.payeeName&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.payeeName})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Category"})}),c.jsx(MO,{value:S,onChange:B=>{_(B),O.categoryId&&M(Y=>({...Y,categoryId:""}))},placeholder:"Search or select category...",required:!0,error:O.categoryId}),O.categoryId&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.categoryId})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsx("span",{className:"flex items-center gap-1",children:" Amount"})}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{ref:F,type:"number",step:"0.01",value:A,onChange:B=>{j(B.target.value),O.amount&&M(Y=>({...Y,amount:""}))},className:`w-full pl-8 pr-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent ${O.amount?"border-red-500":"border-gray-300"}`,placeholder:"0.00",required:!0})]}),O.amount&&c.jsx("p",{className:"text-xs text-red-600 mt-1",children:O.amount})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:c.jsxs("span",{className:"flex items-center gap-1",children:[" Notes ",c.jsx("span",{className:"text-gray-400 font-normal",children:"(optional)"})]})}),c.jsx("input",{type:"text",value:N,onChange:B=>P(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Add a note..."})]}),c.jsxs("div",{className:"flex gap-3 pt-2",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:u.isPending||d.isPending,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 transition-colors font-medium",children:u.isPending||d.isPending?"Saving...":p==="transfer"?"Create Transfer":p==="payment"?"Submit Payment":"Add Transaction"})]})]})}),c.jsxs("div",{className:"space-y-4",children:[l.length>0&&c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Copy Previous"}),c.jsxs("button",{type:"button",onClick:U,className:"w-full px-3 py-2 bg-white border border-blue-200 rounded-md hover:bg-blue-50 hover:border-blue-300 transition-colors text-left",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:((Q=o.find(B=>B.id===l[0].payee_id))==null?void 0:Q.name)||"Last Transaction"}),c.jsx("div",{className:"text-xs text-gray-600 mt-1",children:ie(l[0].amount)})]})]}),l.length>0&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Recent"}),c.jsx("div",{className:"space-y-2",children:l.slice(0,5).map(B=>{const Y=a.find(V=>V.id===B.account_id),ne=o.find(V=>V.id===B.payee_id);return c.jsxs("div",{className:"text-xs bg-white border border-gray-200 rounded p-2",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-gray-900 truncate",children:(ne==null?void 0:ne.name)||"Unknown"}),c.jsx("div",{className:"text-gray-500 truncate",children:(Y==null?void 0:Y.name)||"Unknown"})]}),c.jsx("div",{className:`font-semibold ml-2 ${B.amount<0?"text-red-600":"text-green-600"}`,children:ie(B.amount)})]}),c.jsx("div",{className:"text-gray-400 mt-1",children:wa(B.date)})]},B.id)})})]})]})]})]})})]}):null}function kAe({transaction:t,accountName:e,payeeName:n,categoryName:r,isSelected:i=!1,onSelect:s,onClick:a,transferAccountName:o}){const{date:l,amount:u,notes:d,is_pending:f,transfer_id:p,transaction_type:m}=t,y=u<0,g=!!p,v=m==="debt_payment";return c.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 transition-colors ${f?"opacity-60":""} ${i?"bg-blue-50":""}`,children:[s&&c.jsx("td",{className:"py-3 px-4",children:c.jsx("input",{type:"checkbox",checked:i,onChange:s,onClick:b=>b.stopPropagation(),className:"rounded border-gray-300 text-primary focus:ring-primary"})}),c.jsxs("td",{className:"py-3 px-4 text-sm text-gray-900 cursor-pointer",onClick:a,children:[wa(l),f&&c.jsx("span",{className:"ml-2 text-xs text-orange-600 font-medium",children:"Pending"})]}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600 cursor-pointer",onClick:a,children:e||""}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-900 font-medium cursor-pointer",onClick:a,children:g?c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:v?"text-green-600":"text-blue-600",title:v?"Debt Payment":"Transfer",children:v?"":""}),c.jsx("span",{className:v?"text-green-700":"text-blue-700",children:y?`To ${o||"Unknown"}`:`From ${o||"Unknown"}`})]}):n||"Unknown"}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600 cursor-pointer",onClick:a,children:g?c.jsx("span",{className:`${v?"text-green-600":"text-blue-600"} italic`,children:v?"Debt Payment":"Transfer"}):r||"Uncategorized"}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-500 max-w-xs truncate cursor-pointer",onClick:a,children:d||""}),c.jsx("td",{className:`py-3 px-4 text-sm font-semibold text-right cursor-pointer ${y?"text-danger":"text-success"}`,onClick:a,children:ie(u)})]})}function NAe({transactions:t,categories:e,payees:n}){var v,b;const{data:r=[]}=ar(),i=T.useMemo(()=>{const x=new Map;return r.forEach(w=>x.set(w.id,{id:w.id,type:w.type})),x},[r]),s=x=>{if(x.path){const w=x.path.split(">");return w[w.length-1]}return x.name},a=T.useMemo(()=>new Map(n.map(x=>[x.id,x.name])),[n]),o=T.useMemo(()=>new Map(e.map(x=>[x.id,s(x)])),[e]),l=T.useMemo(()=>{const x=new Map;let w=0;return t.forEach(_=>{if(!_.transfer_id&&_.amount<0){const A=o.get(_.category_id||"")||"Uncategorized",j=x.get(A)||{amount:0,count:0};x.set(A,{amount:j.amount+Math.abs(_.amount),count:j.count+1}),w+=Math.abs(_.amount)}}),Array.from(x.entries()).map(([_,A])=>({category:_,amount:A.amount,count:A.count,percentage:w>0?A.amount/w*100:0})).sort((_,A)=>A.amount-_.amount).slice(0,10)},[t,o]),u=T.useMemo(()=>{const x=new Map;return t.forEach(S=>{if(!S.transfer_id&&S.amount<0){const _=a.get(S.payee_id||"")||"Unknown",A=x.get(_)||{amount:0,count:0};x.set(_,{amount:A.amount+Math.abs(S.amount),count:A.count+1})}}),Array.from(x.entries()).map(([S,_])=>({payee:S,amount:_.amount,count:_.count})).sort((S,_)=>_.amount-S.amount).slice(0,10)},[t,a]),d=T.useMemo(()=>{const x=new Map;return t.forEach(S=>{if(S.transfer_id)return;const _=new Date(S.date),A=`${_.getFullYear()}-${String(_.getMonth()+1).padStart(2,"0")}`,j=x.get(A)||{income:0,expenses:0};S.amount>0?j.income+=S.amount:j.expenses+=Math.abs(S.amount),x.set(A,j)}),Array.from(x.entries()).map(([S,_])=>({month:S,income:_.income,expenses:_.expenses,net:_.income-_.expenses})).sort((S,_)=>S.month.localeCompare(_.month)).slice(-6)},[t]),f=T.useMemo(()=>{let x=0,w=0;const S=new Map;t.forEach(A=>{var j;if(A.transaction_type==="debt_payment"&&A.amount<0){const N=t.find(I=>I.id===A.transfer_id),P=N?(j=i.get(N.account_id))==null?void 0:j.type:void 0;if(["credit","credit_card"].includes(P||""))return;const O=Math.abs(A.amount);x+=O,w++;const M=new Date(A.date),R=`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`;S.set(R,(S.get(R)||0)+O)}});const _=Array.from(S.entries()).map(([A,j])=>({month:A,amount:j})).sort((A,j)=>A.month.localeCompare(j.month)).slice(-6);return{total:x,count:w,monthlyData:_,averagePayment:w>0?x/w:0}},[t,i]),p=((v=l[0])==null?void 0:v.amount)||1,m=((b=u[0])==null?void 0:b.amount)||1,y=Math.max(...d.map(x=>Math.max(x.income,x.expenses))),g=Math.max(...f.monthlyData.map(x=>x.amount),1);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Spending Categories"}),l.length===0?c.jsx("p",{className:"text-gray-500 text-sm",children:"No expense data available"}):c.jsx("div",{className:"space-y-3",children:l.map((x,w)=>c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsx("span",{className:"font-medium text-gray-900",children:x.category}),c.jsxs("span",{className:"text-gray-600",children:[ie(x.amount)," (",x.percentage.toFixed(1),"%)"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:"bg-red-500 h-full rounded-full transition-all duration-300",style:{width:`${x.amount/p*100}%`}})}),c.jsxs("span",{className:"text-xs text-gray-500 w-12 text-right",children:[x.count," tx"]})]})]},w))})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Payees"}),u.length===0?c.jsx("p",{className:"text-gray-500 text-sm",children:"No payee data available"}):c.jsx("div",{className:"space-y-3",children:u.map((x,w)=>c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm",children:[c.jsx("span",{className:"font-medium text-gray-900",children:x.payee}),c.jsx("span",{className:"text-gray-600",children:ie(x.amount)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:"bg-blue-500 h-full rounded-full transition-all duration-300",style:{width:`${x.amount/m*100}%`}})}),c.jsxs("span",{className:"text-xs text-gray-500 w-12 text-right",children:[x.count," tx"]})]})]},w))})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Trends (Last 6 Months)"}),d.length===0?c.jsx("p",{className:"text-gray-500 text-sm",children:"No trend data available"}):c.jsx("div",{className:"space-y-4",children:d.map((x,w)=>{const _=new Date(x.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"});return c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:_}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsx("span",{className:"text-gray-600",children:"Income"}),c.jsx("span",{className:"font-medium text-green-600",children:ie(x.income)})]}),c.jsx("div",{className:"bg-gray-200 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:"bg-green-500 h-full rounded-full transition-all duration-300",style:{width:`${x.income/y*100}%`}})})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsx("span",{className:"text-gray-600",children:"Expenses"}),c.jsx("span",{className:"font-medium text-red-600",children:ie(x.expenses)})]}),c.jsx("div",{className:"bg-gray-200 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:"bg-red-500 h-full rounded-full transition-all duration-300",style:{width:`${x.expenses/y*100}%`}})})]})]}),c.jsxs("div",{className:"text-xs text-right",children:["Net: ",c.jsx("span",{className:`font-medium ${x.net>=0?"text-green-600":"text-red-600"}`,children:ie(x.net)})]})]},w)})})]}),f.total>0&&c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[c.jsx("span",{children:""}),"Debt Payment Progress"]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Paid"}),c.jsx("div",{className:"text-xl font-bold text-green-600",children:ie(f.total)})]}),c.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Payments Made"}),c.jsx("div",{className:"text-xl font-bold text-gray-900",children:f.count})]}),c.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-100",children:[c.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Avg Payment"}),c.jsx("div",{className:"text-xl font-bold text-gray-900",children:ie(f.averagePayment)})]})]}),f.monthlyData.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-gray-700 mb-3",children:"Monthly Progress (Last 6 Months)"}),c.jsx("div",{className:"space-y-3",children:f.monthlyData.map((x,w)=>{const _=new Date(x.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"});return c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center justify-between text-xs",children:[c.jsx("span",{className:"text-gray-700 font-medium",children:_}),c.jsx("span",{className:"font-semibold text-green-600",children:ie(x.amount)})]}),c.jsx("div",{className:"bg-white rounded-full h-3 overflow-hidden border border-green-200",children:c.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 h-full rounded-full transition-all duration-300",style:{width:`${x.amount/g*100}%`}})})]},w)})})]})]})]})}function EAe({onClose:t}){const[e,n]=T.useState([]),[r,i]=T.useState([]),[s,a]=T.useState({}),[o,l]=T.useState(""),[u,d]=T.useState(!1),[f,p]=T.useState({current:0,total:0}),m=T.useRef(null),{data:y=[]}=ar(),{data:g=[]}=Rl(),{data:v=[]}=Ms(),b=mj(),x=sz(),w=j=>{var O;const N=(O=j.target.files)==null?void 0:O[0];if(!N)return;const P=new FileReader;P.onload=M=>{var z;const I=((z=M.target)==null?void 0:z.result).split(`
`).filter(U=>U.trim());if(I.length===0){alert("CSV file is empty");return}const L=I[0],W=S(L);i(W);const F=[];for(let U=1;U<I.length;U++){const K=S(I[U]),H={};W.forEach((Q,B)=>{H[Q]=K[B]||""}),F.push(H)}n(F),_(W)},P.readAsText(N)},S=j=>{const N=[];let P="",O=!1;for(let M=0;M<j.length;M++){const R=j[M];R==='"'?O=!O:R===","&&!O?(N.push(P.trim()),P=""):P+=R}return N.push(P.trim()),N},_=j=>{const N={};j.forEach(P=>{const O=P.toLowerCase();O.includes("date")?N.date=P:O.includes("amount")||O.includes("value")?N.amount=P:O.includes("payee")||O.includes("vendor")||O.includes("merchant")?N.payee=P:O.includes("category")?N.category=P:O.includes("note")||O.includes("memo")||O.includes("description")?N.notes=P:O.includes("account")&&(N.account=P)}),a(N)},A=async()=>{if(!s.date||!s.amount){alert("Date and Amount columns are required");return}if(!o&&!s.account){alert("Please select a default account or map an account column");return}d(!0),p({current:0,total:e.length});let j=0,N=0;const P=new Map(g.map(R=>[R.name.toLowerCase(),R.id])),O=new Map(v.map(R=>[(R.path||R.name).toLowerCase(),R.id])),M=new Map(y.map(R=>[R.name.toLowerCase(),R.id]));for(let R=0;R<e.length;R++){const I=e[R];p({current:R+1,total:e.length});try{const L=I[s.date];if(!L){N++;continue}const W=new Date(L);if(isNaN(W.getTime())){N++;continue}const F=W.toISOString().split("T")[0],z=I[s.amount].replace(/[^0-9.-]/g,""),U=parseFloat(z);if(isNaN(U)){N++;continue}let K=null;if(s.payee&&I[s.payee]){const ne=I[s.payee].trim(),V=P.get(ne.toLowerCase());if(V)K=V;else{const te=await x.mutateAsync({name:ne});K=te[0].id,P.set(ne.toLowerCase(),te[0].id)}}let H=null;if(s.category&&I[s.category]){const ne=I[s.category].trim();H=O.get(ne.toLowerCase())||null}let Q=o;if(s.account&&I[s.account]){const ne=I[s.account].trim();Q=M.get(ne.toLowerCase())||o}const B=s.notes?I[s.notes]:null,Y={date:F,amount:U,account_id:Q,payee_id:K,category_id:H,notes:B||null,is_pending:!1};await b.mutateAsync(Y),j++}catch(L){console.error("Error importing row:",I,L),N++}}d(!1),alert(`Import complete!
Success: ${j}
Errors: ${N}`),t()};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"p-6 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Import Transactions from CSV"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",disabled:u,children:""})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[!e.length&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),c.jsx("input",{ref:m,type:"file",accept:".csv",onChange:w,className:`block w-full text-sm text-gray-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-md file:border-0
                  file:text-sm file:font-medium
                  file:bg-primary file:text-white
                  hover:file:bg-primary/90
                  cursor-pointer`}),c.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"CSV file should have headers. Supported formats: Date, Amount, Payee, Category, Notes, Account"})]}),e.length>0&&!u&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Map Columns (",e.length," rows found)"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Column *"}),c.jsxs("select",{value:s.date||"",onChange:j=>a({...s,date:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount Column *"}),c.jsxs("select",{value:s.amount||"",onChange:j=>a({...s,amount:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payee Column"}),c.jsxs("select",{value:s.payee||"",onChange:j=>a({...s,payee:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Column"}),c.jsxs("select",{value:s.category||"",onChange:j=>a({...s,category:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes Column"}),c.jsxs("select",{value:s.notes||"",onChange:j=>a({...s,notes:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Column"}),c.jsxs("select",{value:s.account||"",onChange:j=>a({...s,account:j.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select..."}),r.map(j=>c.jsx("option",{value:j,children:j},j))]})]})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Default Account ",!s.account&&"*"]}),c.jsxs("select",{value:o,onChange:j=>l(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select account..."}),y.map(j=>c.jsx("option",{value:j.id,children:j.name},j.id))]}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Used when no account column is mapped or value is not found"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Preview (First 5 Rows)"}),c.jsx("div",{className:"border border-gray-200 rounded-lg overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Date"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Amount"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Payee"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Category"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.slice(0,5).map((j,N)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:s.date?j[s.date]:"-"}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:s.amount?j[s.amount]:"-"}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:s.payee?j[s.payee]:"-"}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:s.category?j[s.category]:"-"})]},N))})]})})]})]}),u&&c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Importing Transactions..."}),c.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[f.current," of ",f.total]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 max-w-md mx-auto",children:c.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${f.current/f.total*100}%`}})})]})]}),c.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-2",children:[c.jsx("button",{onClick:t,disabled:u,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.length>0&&c.jsxs("button",{onClick:A,disabled:u,className:"px-4 py-2 bg-primary text-white rounded-md text-sm font-medium hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",e.length," Transactions"]})]})]})})}const Cr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),GC=[.001,0,0,.001,0,0],Lk=1.35,Di={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ql={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},kv="pdfjs_internal_editor_",Pe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ze={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},CAe={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},KC={TRIANGLES:1,LATTICE:2},Hn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},s1={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},un={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Af={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},vj={ERRORS:0,WARNINGS:1,INFOS:5},Nv={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},wy={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},PAe={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let xj=vj.WARNINGS;function TAe(t){Number.isInteger(t)&&(xj=t)}function OAe(){return xj}function bj(t){xj>=vj.INFOS&&console.info(`Info: ${t}`)}function Ne(t){xj>=vj.WARNINGS&&console.warn(`Warning: ${t}`)}function bt(t){throw new Error(t)}function We(t,e){t||bt(e)}function MAe(t){switch(t==null?void 0:t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function cz(t,e=null,n=null){if(!t)return null;if(n&&typeof t=="string"){if(n.addDefaultProtocol&&t.startsWith("www.")){const i=t.match(/\./g);(i==null?void 0:i.length)>=2&&(t=`http://${t}`)}if(n.tryConvertEncoding)try{t=LAe(t)}catch{}}const r=e?URL.parse(t,e):URL.parse(t);return MAe(r)?r:null}function uz(t,e,n=!1){const r=URL.parse(t);return r?(r.hash=e,r.href):n&&cz(t,"http://example.com")?t.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Oe(t,e,n,r=!1){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!0,writable:!1}),n}const af=function(){function e(n,r){this.message=n,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class sF extends af{constructor(e,n){super(e,"PasswordException"),this.code=n}}class Fk extends af{constructor(e,n){super(e,"UnknownErrorException"),this.details=n}}class VC extends af{constructor(e){super(e,"InvalidPDFException")}}class bS extends af{constructor(e,n,r){super(e,"ResponseException"),this.status=n,this.missing=r}}class RAe extends af{constructor(e){super(e,"FormatError")}}class vu extends af{constructor(e){super(e,"AbortException")}}function dz(t){(typeof t!="object"||(t==null?void 0:t.length)===void 0)&&bt("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const r=[];for(let i=0;i<e;i+=n){const s=Math.min(i+n,e),a=t.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function Wb(t){typeof t!="string"&&bt("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let r=0;r<e;++r)n[r]=t.charCodeAt(r)&255;return n}function IAe(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,t&255)}function DAe(){const t=new Uint8Array(4);return t[0]=1,new Uint32Array(t.buffer,0,1)[0]===1}function $Ae(){try{return new Function(""),!0}catch{return!1}}class nr{static get isLittleEndian(){return Oe(this,"isLittleEndian",DAe())}static get isEvalSupported(){return Oe(this,"isEvalSupported",$Ae())}static get isOffscreenCanvasSupported(){return Oe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Oe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Oe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Oe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:n}=navigator;return Oe(this,"platform",{isAndroid:n.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:n.includes("Firefox")})}static get isCSSRoundSupported(){var e,n;return Oe(this,"isCSSRoundSupported",(n=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:n.call(e,"width: round(1.5px, 1px)"))}}const Bk=Array.from(Array(256).keys(),t=>t.toString(16).padStart(2,"0"));var ml,a1,YC;class ge{static makeHexColor(e,n,r){return`#${Bk[e]}${Bk[n]}${Bk[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,n){let r;e[0]?(e[0]<0&&(r=n[0],n[0]=n[2],n[2]=r),n[0]*=e[0],n[2]*=e[0],e[3]<0&&(r=n[1],n[1]=n[3],n[3]=r),n[1]*=e[3],n[3]*=e[3]):(r=n[0],n[0]=n[1],n[1]=r,r=n[2],n[2]=n[3],n[3]=r,e[1]<0&&(r=n[1],n[1]=n[3],n[3]=r),n[1]*=e[1],n[3]*=e[1],e[2]<0&&(r=n[0],n[0]=n[2],n[2]=r),n[0]*=e[2],n[2]*=e[2]),n[0]+=e[4],n[1]+=e[5],n[2]+=e[4],n[3]+=e[5]}static transform(e,n){return[e[0]*n[0]+e[2]*n[1],e[1]*n[0]+e[3]*n[1],e[0]*n[2]+e[2]*n[3],e[1]*n[2]+e[3]*n[3],e[0]*n[4]+e[2]*n[5]+e[4],e[1]*n[4]+e[3]*n[5]+e[5]]}static multiplyByDOMMatrix(e,n){return[e[0]*n.a+e[2]*n.b,e[1]*n.a+e[3]*n.b,e[0]*n.c+e[2]*n.d,e[1]*n.c+e[3]*n.d,e[0]*n.e+e[2]*n.f+e[4],e[1]*n.e+e[3]*n.f+e[5]]}static applyTransform(e,n,r=0){const i=e[r],s=e[r+1];e[r]=i*n[0]+s*n[2]+n[4],e[r+1]=i*n[1]+s*n[3]+n[5]}static applyTransformToBezier(e,n,r=0){const i=n[0],s=n[1],a=n[2],o=n[3],l=n[4],u=n[5];for(let d=0;d<6;d+=2){const f=e[r+d],p=e[r+d+1];e[r+d]=f*i+p*a+l,e[r+d+1]=f*s+p*o+u}}static applyInverseTransform(e,n){const r=e[0],i=e[1],s=n[0]*n[3]-n[1]*n[2];e[0]=(r*n[3]-i*n[2]+n[2]*n[5]-n[4]*n[3])/s,e[1]=(-r*n[1]+i*n[0]+n[4]*n[1]-n[5]*n[0])/s}static axialAlignedBoundingBox(e,n,r){const i=n[0],s=n[1],a=n[2],o=n[3],l=n[4],u=n[5],d=e[0],f=e[1],p=e[2],m=e[3];let y=i*d+l,g=y,v=i*p+l,b=v,x=o*f+u,w=x,S=o*m+u,_=S;if(s!==0||a!==0){const A=s*d,j=s*p,N=a*f,P=a*m;y+=N,b+=N,v+=P,g+=P,x+=A,_+=A,S+=j,w+=j}r[0]=Math.min(r[0],y,v,g,b),r[1]=Math.min(r[1],x,S,w,_),r[2]=Math.max(r[2],y,v,g,b),r[3]=Math.max(r[3],x,S,w,_)}static inverseTransform(e){const n=e[0]*e[3]-e[1]*e[2];return[e[3]/n,-e[1]/n,-e[2]/n,e[0]/n,(e[2]*e[5]-e[4]*e[3])/n,(e[4]*e[1]-e[5]*e[0])/n]}static singularValueDecompose2dScale(e,n){const r=e[0],i=e[1],s=e[2],a=e[3],o=r**2+i**2,l=r*s+i*a,u=s**2+a**2,d=(o+u)/2,f=Math.sqrt(d**2-(o*u-l**2));n[0]=Math.sqrt(d+f||1),n[1]=Math.sqrt(d-f||1)}static normalizeRect(e){const n=e.slice(0);return e[0]>e[2]&&(n[0]=e[2],n[2]=e[0]),e[1]>e[3]&&(n[1]=e[3],n[3]=e[1]),n}static intersect(e,n){const r=Math.max(Math.min(e[0],e[2]),Math.min(n[0],n[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(n[0],n[2]));if(r>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(n[1],n[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(n[1],n[3]));return s>a?null:[r,s,i,a]}static pointBoundingBox(e,n,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],n),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],n)}static rectBoundingBox(e,n,r,i,s){s[0]=Math.min(s[0],e,r),s[1]=Math.min(s[1],n,i),s[2]=Math.max(s[2],e,r),s[3]=Math.max(s[3],n,i)}static bezierBoundingBox(e,n,r,i,s,a,o,l,u){u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],n,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],n,l),C(this,ml,YC).call(this,e,r,s,o,n,i,a,l,3*(-e+3*(r-s)+o),6*(e-2*r+s),3*(r-e),u),C(this,ml,YC).call(this,e,r,s,o,n,i,a,l,3*(-n+3*(i-a)+l),6*(n-2*i+a),3*(i-n),u)}}ml=new WeakSet,a1=function(e,n,r,i,s,a,o,l,u,d){if(u<=0||u>=1)return;const f=1-u,p=u*u,m=p*u,y=f*(f*(f*e+3*u*n)+3*p*r)+m*i,g=f*(f*(f*s+3*u*a)+3*p*o)+m*l;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],g)},YC=function(e,n,r,i,s,a,o,l,u,d,f,p){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&C(this,ml,a1).call(this,e,n,r,i,s,a,o,l,-f/d,p);return}const m=d**2-4*f*u;if(m<0)return;const y=Math.sqrt(m),g=2*u;C(this,ml,a1).call(this,e,n,r,i,s,a,o,l,(-d+y)/g,p),C(this,ml,a1).call(this,e,n,r,i,s,a,o,l,(-d-y)/g,p)},E(ge,ml);function LAe(t){return decodeURIComponent(escape(t))}let Uk=null,aF=null;function FAe(t){return Uk||(Uk=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,aF=new Map([["","t"]])),t.replaceAll(Uk,(e,n,r)=>n?n.normalize("NFKC"):aF.get(r))}function hz(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const t=new Uint8Array(32);return crypto.getRandomValues(t),dz(t)}const Yf="pdfjs_internal_id_";function BAe(t,e,n){if(!Array.isArray(n)||n.length<2)return!1;const[r,i,...s]=n;if(!t(r)&&!Number.isInteger(r)||!e(i))return!1;const a=s.length;let o=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of s)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Pr(t,e,n){return Math.min(Math.max(t,e),n)}function fz(t){return Uint8Array.prototype.toBase64?t.toBase64():btoa(dz(t))}function UAe(t){return Uint8Array.fromBase64?Uint8Array.fromBase64(t):Wb(atob(t))}typeof Promise.try!="function"&&(Promise.try=function(t,...e){return new Promise(n=>{n(t(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(t){return t.reduce((e,n)=>e+n,0)});class Ev{static textContent(e){const n=[],r={items:n,styles:Object.create(null)};function i(s){var l;if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(Ev.shouldBuildText(o))(l=s==null?void 0:s.attributes)!=null&&l.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&n.push({str:a}),!!s.children)for(const u of s.children)i(u)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class pz{static setupStorage(e,n,r,i,s){const a=i.getValue(n,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(n,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{i.setValue(n,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{i.setValue(n,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(n,{value:u})});break}}static setAttributes({html:e,element:n,storage:r=null,intent:i,linkService:s}){const{attributes:a}=n,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&s.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,n,r)}static render(e){var f,p;const n=e.annotationStorage,r=e.linkService,i=e.xfaHtml,s=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);a.append(m),o&&Ev.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const d=[[i,-1,a]];for(;d.length>0;){const[m,y,g]=d.at(-1);if(y+1===m.children.length){d.pop();continue}const v=m.children[++d.at(-1)[1]];if(v===null)continue;const{name:b}=v;if(b==="#text"){const w=document.createTextNode(v.value);u.push(w),g.append(w);continue}const x=(f=v==null?void 0:v.attributes)!=null&&f.xmlns?document.createElementNS(v.attributes.xmlns,b):document.createElement(b);if(g.append(x),v.attributes&&this.setAttributes({html:x,element:v,storage:n,intent:s,linkService:r}),((p=v.children)==null?void 0:p.length)>0)d.push([v,-1,x]);else if(v.value){const w=document.createTextNode(v.value);o&&Ev.shouldBuildText(b)&&u.push(w),x.append(w)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const n=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=n,e.div.hidden=!1}}const ho="http://www.w3.org/2000/svg",Xu=class Xu{};ae(Xu,"CSS",96),ae(Xu,"PDF",72),ae(Xu,"PDF_TO_CSS_UNITS",Xu.CSS/Xu.PDF);let xu=Xu;async function Hb(t,e="text"){if(Ry(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,r)=>{const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":n(i.response);return}n(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class qb{constructor({viewBox:e,userUnit:n,scale:r,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=n,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=a,r*=n;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,f,p,m;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,f=0,p=0,m=1;break;case 90:d=0,f=1,p=1,m=0;break;case 270:d=0,f=-1,p=-1,m=0;break;case 0:d=1,f=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let y,g,v,b;d===0?(y=Math.abs(u-e[1])*r+s,g=Math.abs(l-e[0])*r+a,v=(e[3]-e[1])*r,b=(e[2]-e[0])*r):(y=Math.abs(l-e[0])*r+s,g=Math.abs(u-e[1])*r+a,v=(e[2]-e[0])*r,b=(e[3]-e[1])*r),this.transform=[d*r,f*r,p*r,m*r,y-d*r*l-p*r*u,g-f*r*l-m*r*u],this.width=v,this.height=b}get rawDims(){const e=this.viewBox;return Oe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:n=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new qb({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:n,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(e,n){const r=[e,n];return ge.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const n=[e[0],e[1]];ge.applyTransform(n,this.transform);const r=[e[2],e[3]];return ge.applyTransform(r,this.transform),[n[0],n[1],r[0],r[1]]}convertToPdfPoint(e,n){const r=[e,n];return ge.applyInverseTransform(r,this.transform),r}}class RO extends af{constructor(e,n=0){super(e,"RenderingCancelledException"),this.extraDelay=n}}function wj(t){const e=t.length;let n=0;for(;n<e&&t[n].trim()==="";)n++;return t.substring(n,n+5).toLowerCase()==="data:"}function IO(t){return typeof t=="string"&&/\.pdf$/i.test(t)}function zAe(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function WAe(t,e="document.pdf"){if(typeof t!="string")return e;if(wj(t))return Ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(t);if(!r)return e;const i=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},s=/\.pdf$/i,a=r.pathname.split("/").at(-1);if(s.test(a))return i(a);if(r.searchParams.size>0){const o=Array.from(r.searchParams.values()).reverse();for(const u of o)if(s.test(u))return i(u);const l=Array.from(r.searchParams.keys()).reverse();for(const u of l)if(s.test(u))return i(u)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return i(l[0])}return e}class oF{constructor(){ae(this,"started",Object.create(null));ae(this,"times",[])}time(e){e in this.started&&Ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let n=0;for(const{name:r}of this.times)n=Math.max(r.length,n);for(const{name:r,start:i,end:s}of this.times)e.push(`${r.padEnd(n)} ${s-i}ms
`);return e.join("")}}function Ry(t,e){const n=e?URL.parse(t,e):URL.parse(t);return(n==null?void 0:n.protocol)==="http:"||(n==null?void 0:n.protocol)==="https:"}function Ps(t){t.preventDefault()}function rn(t){t.preventDefault(),t.stopPropagation()}function HAe(t){console.log("Deprecated API usage: "+t)}var Dv;class wS{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;h(this,Dv)||k(this,Dv,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const n=h(this,Dv).exec(e);if(!n)return null;const r=parseInt(n[1],10);let i=parseInt(n[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(n[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(n[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(n[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(n[6],10);l=l>=0&&l<=59?l:0;const u=n[7]||"Z";let d=parseInt(n[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(n[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(a+=d,o+=f):u==="+"&&(a-=d,o-=f),new Date(Date.UTC(r,i,s,a,o,l))}}Dv=new WeakMap,E(wS,Dv);function qAe(t,{scale:e=1,rotation:n=0}){const{width:r,height:i}=t.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new qb({viewBox:s,userUnit:1,scale:e,rotation:n})}function Gb(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map(e=>parseInt(e)):t.startsWith("rgba(")?t.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ne(`Not a valid color format: "${t}"`),[0,0,0])}function GAe(t){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const n of t.keys()){e.style.color=n;const r=window.getComputedStyle(e).color;t.set(n,Gb(r))}e.remove()}function zt(t){const{a:e,b:n,c:r,d:i,e:s,f:a}=t.getTransform();return[e,n,r,i,s,a]}function ga(t){const{a:e,b:n,c:r,d:i,e:s,f:a}=t.getTransform().invertSelf();return[e,n,r,i,s,a]}function Yh(t,e,n=!1,r=!0){if(e instanceof qb){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:a}=t,o=nr.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${s}px`,d=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!n||e.rotation%180===0?(a.width=d,a.height=f):(a.width=f,a.height=d)}r&&t.setAttribute("data-main-rotation",e.rotation)}class io{constructor(){const{pixelRatio:e}=io;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,n,r,i,s=-1){let a=1/0,o=1/0,l=1/0;r=io.capPixels(r,s),r>0&&(a=Math.sqrt(r/(e*n))),i!==-1&&(o=i/e,l=i/n);const u=Math.min(a,o,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,n){if(n>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+n/100));return e>0?Math.min(e,r):r}return e}}const XC=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class KAe{static get isDarkMode(){var e;return Oe(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class VAe{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:n}=e;n.width=n.height="0",n.display="none",n.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),Oe(this,"commentForegroundColor",Gb(r))}}function YAe(t,e,n,r){r=Math.min(Math.max(r??1,0),1);const i=255*(1-r);return t=Math.round(t*r+i),e=Math.round(e*r+i),n=Math.round(n*r+i),[t,e,n]}function lF(t,e){const n=t[0]/255,r=t[1]/255,i=t[2]/255,s=Math.max(n,r,i),a=Math.min(n,r,i),o=(s+a)/2;if(s===a)e[0]=e[1]=0;else{const l=s-a;switch(e[1]=o<.5?l/(s+a):l/(2-s-a),s){case n:e[0]=((r-i)/l+(r<i?6:0))*60;break;case r:e[0]=((i-n)/l+2)*60;break;case i:e[0]=((n-r)/l+4)*60;break}}e[2]=o}function QC(t,e){const n=t[0],r=t[1],i=t[2],s=(1-Math.abs(2*i-1))*r,a=s*(1-Math.abs(n/60%2-1)),o=i-s/2;switch(Math.floor(n/60)){case 0:e[0]=s+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=s+o,e[2]=o;break;case 2:e[0]=o,e[1]=s+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=s+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=s+o;break;case 5:case 6:e[0]=s+o,e[1]=o,e[2]=a+o;break}}function cF(t){return t<=.03928?t/12.92:((t+.055)/1.055)**2.4}function uF(t,e,n){QC(t,n),n.map(cF);const r=.2126*n[0]+.7152*n[1]+.0722*n[2];QC(e,n),n.map(cF);const i=.2126*n[0]+.7152*n[1]+.0722*n[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}const dF=new Map;function XAe(t,e){const n=t[0]+t[1]*256+t[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=dF.get(n);if(r)return r;const i=new Float32Array(9),s=i.subarray(0,3),a=i.subarray(3,6);lF(t,a);const o=i.subarray(6,9);lF(e,o);const l=o[2]<.5,u=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),uF(a,o,s)<u){let d,f;l?(d=a[2],f=1):(d=0,f=a[2]);const p=.005;for(;f-d>p;){const m=a[2]=(d+f)/2;l===uF(a,o,s)<u?d=m:f=m}a[2]=l?f:d}return QC(a,s),r=ge.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),dF.set(n,r),r}function mz({html:t,dir:e,className:n},r){const i=document.createDocumentFragment();if(typeof t=="string"){const s=document.createElement("p");s.dir=e||"auto";const a=t.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const u=a[o];s.append(document.createTextNode(u)),o<l-1&&s.append(document.createElement("br"))}i.append(s)}else pz.render({xfaHtml:t,div:i,intent:"richText"});i.firstChild.classList.add("richText",n),r.append(i)}function gz(t){const e=new Path2D;if(!t)return e;for(let n=0,r=t.length;n<r;)switch(t[n++]){case wy.moveTo:e.moveTo(t[n++],t[n++]);break;case wy.lineTo:e.lineTo(t[n++],t[n++]);break;case wy.curveTo:e.bezierCurveTo(t[n++],t[n++],t[n++],t[n++],t[n++],t[n++]);break;case wy.quadraticCurveTo:e.quadraticCurveTo(t[n++],t[n++],t[n++],t[n++]);break;case wy.closePath:e.closePath();break;default:Ne(`Unrecognized drawing path operator: ${t[n-1]}`);break}return e}var oc,lc,ns,rs,$v,cc,Ap,jp,Lv,MS,yz,er,vz,xz,jf,Iy;const vo=class vo{constructor(e){E(this,er);E(this,oc,null);E(this,lc,null);E(this,ns);E(this,rs,null);E(this,$v,null);E(this,cc,null);E(this,Ap,null);E(this,jp,null);k(this,ns,e),h(vo,Lv)||k(vo,Lv,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=k(this,oc,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const n=h(this,ns)._uiManager._signal;n instanceof AbortSignal&&!n.aborted&&(e.addEventListener("contextmenu",Ps,{signal:n}),e.addEventListener("pointerdown",C(vo,MS,yz),{signal:n}));const r=k(this,rs,document.createElement("div"));r.className="buttons",e.append(r);const i=h(this,ns).toolbarPosition;if(i){const{style:s}=e,a=h(this,ns)._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return h(this,oc)}hide(){var e;h(this,oc).classList.add("hidden"),(e=h(this,lc))==null||e.hideDropdown()}show(){var e,n;h(this,oc).classList.remove("hidden"),(e=h(this,$v))==null||e.shown(),(n=h(this,cc))==null||n.shown()}addDeleteButton(){const{editorType:e,_uiManager:n}=h(this,ns),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",h(vo,Lv)[e]),C(this,er,jf).call(this,r)&&r.addEventListener("click",i=>{n.delete()},{signal:n._signal}),h(this,rs).append(r)}async addAltText(e){const n=await e.render();C(this,er,jf).call(this,n),h(this,rs).append(n,h(this,er,Iy)),k(this,$v,e)}addComment(e,n=null){if(h(this,cc))return;const r=e.renderForToolbar();if(!r)return;C(this,er,jf).call(this,r);const i=k(this,Ap,h(this,er,Iy));n?(h(this,rs).insertBefore(r,n),h(this,rs).insertBefore(i,n)):h(this,rs).append(r,i),k(this,cc,e),e.toolbar=this}addColorPicker(e){if(h(this,lc))return;k(this,lc,e);const n=e.renderButton();C(this,er,jf).call(this,n),h(this,rs).append(n,h(this,er,Iy))}async addEditSignatureButton(e){const n=k(this,jp,await e.renderEditButton(h(this,ns)));C(this,er,jf).call(this,n),h(this,rs).append(n,h(this,er,Iy))}removeButton(e){var n,r;switch(e){case"comment":(n=h(this,cc))==null||n.removeToolbarCommentButton(),k(this,cc,null),(r=h(this,Ap))==null||r.remove(),k(this,Ap,null);break}}async addButton(e,n){switch(e){case"colorPicker":n&&this.addColorPicker(n);break;case"altText":n&&await this.addAltText(n);break;case"editSignature":n&&await this.addEditSignatureButton(n);break;case"delete":this.addDeleteButton();break;case"comment":n&&this.addComment(n);break}}async addButtonBefore(e,n,r){if(!n&&e==="comment")return;const i=h(this,rs).querySelector(r);i&&e==="comment"&&this.addComment(n,i)}updateEditSignatureButton(e){h(this,jp)&&(h(this,jp).title=e)}remove(){var e;h(this,oc).remove(),(e=h(this,lc))==null||e.destroy(),k(this,lc,null)}};oc=new WeakMap,lc=new WeakMap,ns=new WeakMap,rs=new WeakMap,$v=new WeakMap,cc=new WeakMap,Ap=new WeakMap,jp=new WeakMap,Lv=new WeakMap,MS=new WeakSet,yz=function(e){e.stopPropagation()},er=new WeakSet,vz=function(e){h(this,ns)._focusEventsAllowed=!1,rn(e)},xz=function(e){h(this,ns)._focusEventsAllowed=!0,rn(e)},jf=function(e){const n=h(this,ns)._uiManager._signal;return!(n instanceof AbortSignal)||n.aborted?!1:(e.addEventListener("focusin",C(this,er,vz).bind(this),{capture:!0,signal:n}),e.addEventListener("focusout",C(this,er,xz).bind(this),{capture:!0,signal:n}),e.addEventListener("contextmenu",Ps,{signal:n}),!0)},Iy=function(){const e=document.createElement("div");return e.className="divider",e},E(vo,MS),E(vo,Lv,null);let JC=vo;var Fv,vd,jo,jl,bz,wz,ZC;class QAe{constructor(e){E(this,jl);E(this,Fv,null);E(this,vd,null);E(this,jo);k(this,jo,e)}show(e,n,r){const[i,s]=C(this,jl,wz).call(this,n,r),{style:a}=h(this,vd)||k(this,vd,C(this,jl,bz).call(this));e.append(h(this,vd)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){h(this,vd).remove()}}Fv=new WeakMap,vd=new WeakMap,jo=new WeakMap,jl=new WeakSet,bz=function(){const e=k(this,vd,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const n=h(this,jo)._signal;n instanceof AbortSignal&&!n.aborted&&e.addEventListener("contextmenu",Ps,{signal:n});const r=k(this,Fv,document.createElement("div"));return r.className="buttons",e.append(r),h(this,jo).hasCommentManager()&&C(this,jl,ZC).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{h(this,jo).commentSelection("floating_button")}),C(this,jl,ZC).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{h(this,jo).highlightSelection("floating_button")}),e},wz=function(e,n){let r=0,i=0;for(const s of e){const a=s.y+s.height;if(a<r)continue;const o=s.x+(n?s.width:0);if(a>r){i=o,r=a;continue}n?o>i&&(i=o):o<i&&(i=o)}return[n?1-i:i,r]},ZC=function(e,n,r,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",n);const a=document.createElement("span");s.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",r);const o=h(this,jo)._signal;o instanceof AbortSignal&&!o.aborted&&(s.addEventListener("contextmenu",Ps,{signal:o}),s.addEventListener("click",i,{signal:o})),h(this,Fv).append(s)};function _z(t,e,n){for(const r of n)e.addEventListener(r,t[r].bind(t))}var xd,bd,kp,wd;const lt=class lt{static initializeAndAddPointerId(e){(h(lt,bd)||k(lt,bd,new Set)).add(e)}static setPointer(e,n){h(lt,xd)||k(lt,xd,n),h(lt,wd)??k(lt,wd,e)}static setTimeStamp(e){k(lt,kp,e)}static isSamePointerId(e){return h(lt,xd)===e}static isSamePointerIdOrRemove(e){var n;return h(lt,xd)===e?!0:((n=h(lt,bd))==null||n.delete(e),!1)}static isSamePointerType(e){return h(lt,wd)===e}static isInitializedAndDifferentPointerType(e){return h(lt,wd)!==null&&!lt.isSamePointerType(e)}static isSameTimeStamp(e){return h(lt,kp)===e}static isUsingMultiplePointers(){var e;return((e=h(lt,bd))==null?void 0:e.size)>=1}static clearPointerType(){k(lt,wd,null)}static clearPointerIds(){k(lt,xd,NaN),k(lt,bd,null)}static clearTimeStamp(){k(lt,kp,NaN)}};xd=new WeakMap,bd=new WeakMap,kp=new WeakMap,wd=new WeakMap,E(lt,xd,NaN),E(lt,bd,null),E(lt,kp,NaN),E(lt,wd,null);let ur=lt;var RS;class JAe{constructor(){E(this,RS,0)}get id(){return`${kv}${Vt(this,RS)._++}`}}RS=new WeakMap;var Np,Bv,dr,Ep,o1;const WO=class WO{constructor(){E(this,Ep);E(this,Np,hz());E(this,Bv,0);E(this,dr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Oe(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:n,name:r,size:i,type:s}=e;return C(this,Ep,o1).call(this,`${n}_${r}_${i}_${s}`,e)}async getFromUrl(e){return C(this,Ep,o1).call(this,e,e)}async getFromBlob(e,n){const r=await n;return C(this,Ep,o1).call(this,e,r)}async getFromId(e){h(this,dr)||k(this,dr,new Map);const n=h(this,dr).get(e);if(!n)return null;if(n.bitmap)return n.refCounter+=1,n;if(n.file)return this.getFromFile(n.file);if(n.blobPromise){const{blobPromise:r}=n;return delete n.blobPromise,this.getFromBlob(n.id,r)}return this.getFromUrl(n.url)}getFromCanvas(e,n){h(this,dr)||k(this,dr,new Map);let r=h(this,dr).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(n.width,n.height);return i.getContext("2d").drawImage(n,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${h(this,Np)}_${Vt(this,Bv)._++}`,refCounter:1,isSvg:!1},h(this,dr).set(e,r),h(this,dr).set(r.id,r),r}getSvgUrl(e){const n=h(this,dr).get(e);return n!=null&&n.isSvg?n.svgUrl:null}deleteId(e){var i;h(this,dr)||k(this,dr,new Map);const n=h(this,dr).get(e);if(!n||(n.refCounter-=1,n.refCounter!==0))return;const{bitmap:r}=n;if(!n.url&&!n.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),n.blobPromise=s.convertToBlob()}(i=r.close)==null||i.call(r),n.bitmap=null}isValidId(e){return e.startsWith(`image_${h(this,Np)}_`)}};Np=new WeakMap,Bv=new WeakMap,dr=new WeakMap,Ep=new WeakSet,o1=async function(e,n){h(this,dr)||k(this,dr,new Map);let r=h(this,dr).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${h(this,Np)}_${Vt(this,Bv)._++}`,refCounter:0,isSvg:!1});let i;if(typeof n=="string"?(r.url=n,i=await Hb(n,"blob")):n instanceof File?i=r.file=n:n instanceof Blob&&(i=n),i.type==="image/svg+xml"){const s=WO._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,d)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,u()},a.onload=async()=>{const f=r.svgUrl=a.result;o.src=await s?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=d});a.readAsDataURL(i),await l}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Ne(i),r=null}return h(this,dr).set(e,r),r&&h(this,dr).set(r.id,r),r};let e2=WO;var sn,uc,Uv,Ut;class ZAe{constructor(e=128){E(this,sn,[]);E(this,uc,!1);E(this,Uv);E(this,Ut,-1);k(this,Uv,e)}add({cmd:e,undo:n,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),h(this,uc))return;const l={cmd:e,undo:n,post:r,type:s};if(h(this,Ut)===-1){h(this,sn).length>0&&(h(this,sn).length=0),k(this,Ut,0),h(this,sn).push(l);return}if(a&&h(this,sn)[h(this,Ut)].type===s){o&&(l.undo=h(this,sn)[h(this,Ut)].undo),h(this,sn)[h(this,Ut)]=l;return}const u=h(this,Ut)+1;u===h(this,Uv)?h(this,sn).splice(0,1):(k(this,Ut,u),u<h(this,sn).length&&h(this,sn).splice(u)),h(this,sn).push(l)}undo(){if(h(this,Ut)===-1)return;k(this,uc,!0);const{undo:e,post:n}=h(this,sn)[h(this,Ut)];e(),n==null||n(),k(this,uc,!1),k(this,Ut,h(this,Ut)-1)}redo(){if(h(this,Ut)<h(this,sn).length-1){k(this,Ut,h(this,Ut)+1),k(this,uc,!0);const{cmd:e,post:n}=h(this,sn)[h(this,Ut)];e(),n==null||n(),k(this,uc,!1)}}hasSomethingToUndo(){return h(this,Ut)!==-1}hasSomethingToRedo(){return h(this,Ut)<h(this,sn).length-1}cleanType(e){if(h(this,Ut)!==-1){for(let n=h(this,Ut);n>=0;n--)if(h(this,sn)[n].type!==e){h(this,sn).splice(n+1,h(this,Ut)-n),k(this,Ut,n);return}h(this,sn).length=0,k(this,Ut,-1)}}destroy(){k(this,sn,null)}}sn=new WeakMap,uc=new WeakMap,Uv=new WeakMap,Ut=new WeakMap;var IS,Sz;class Kb{constructor(e){E(this,IS);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:n}=nr.platform;for(const[r,i,s={}]of e)for(const a of r){const o=a.startsWith("mac+");n&&o?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!n&&!o&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,n){if(!this.allKeys.has(n.key))return;const r=this.callbacks.get(C(this,IS,Sz).call(this,n));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:o=null}}=r;o&&!o(e,n)||(i.bind(e,...a,n)(),s||rn(n))}}IS=new WeakSet,Sz=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const n=this.buffer.join("+");return this.buffer.length=0,n};const DS=class DS{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return GAe(e),Oe(this,"_colors",e)}convert(e){const n=Gb(e);if(!window.matchMedia("(forced-colors: active)").matches)return n;for(const[r,i]of this._colors)if(i.every((s,a)=>s===n[a]))return DS._colorsMapping.get(r);return n}getHexCode(e){const n=this._colors.get(e);return n?ge.makeHexColor(...n):e}};ae(DS,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let t2=DS;var Cp,vi,Pp,Xt,Sn,Tp,is,Op,ss,hr,dc,hc,Mp,fc,ja,as,_d,zv,Wv,Rp,Hv,ka,pc,Ip,mc,Na,$S,gc,Dp,qv,yc,Sd,$p,vc,Gv,dn,nt,ko,xc,bc,Kv,Lp,Vv,wc,Ea,No,Yv,Xv,os,de,l1,n2,Az,jz,Dy,kz,Nz,Ez,r2,Cz,Pz,Tz,Oz,_r,fo,Mz,Rz,i2,Iz,$y,s2;const Qf=class Qf{constructor(e,n,r,i,s,a,o,l,u,d,f,p,m,y,g,v){E(this,de);E(this,Cp,new AbortController);E(this,vi,null);E(this,Pp,null);E(this,Xt,new Map);E(this,Sn,new Map);E(this,Tp,null);E(this,is,null);E(this,Op,null);E(this,ss,new ZAe);E(this,hr,null);E(this,dc,null);E(this,hc,null);E(this,Mp,0);E(this,fc,new Set);E(this,ja,null);E(this,as,null);E(this,_d,new Set);ae(this,"_editorUndoBar",null);E(this,zv,!1);E(this,Wv,!1);E(this,Rp,!1);E(this,Hv,null);E(this,ka,null);E(this,pc,null);E(this,Ip,null);E(this,mc,!1);E(this,Na,null);E(this,$S,new JAe);E(this,gc,!1);E(this,Dp,!1);E(this,qv,!1);E(this,yc,null);E(this,Sd,null);E(this,$p,null);E(this,vc,null);E(this,Gv,null);E(this,dn,Pe.NONE);E(this,nt,new Set);E(this,ko,null);E(this,xc,null);E(this,bc,null);E(this,Kv,null);E(this,Lp,null);E(this,Vv,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});E(this,wc,[0,0]);E(this,Ea,null);E(this,No,null);E(this,Yv,null);E(this,Xv,null);E(this,os,null);const b=this._signal=h(this,Cp).signal;k(this,No,e),k(this,Yv,n),k(this,Xv,r),k(this,Tp,i),k(this,hr,s),k(this,xc,a),k(this,Lp,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:b}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),o._on("setpreference",this.onSetPreference.bind(this),{signal:b}),o._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:b}),window.addEventListener("pointerdown",()=>{k(this,Dp,!0)},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{k(this,Dp,!1)},{capture:!0,signal:b}),C(this,de,kz).call(this),C(this,de,Oz).call(this),C(this,de,r2).call(this),k(this,is,l.annotationStorage),k(this,Hv,l.filterFactory),k(this,bc,u),k(this,Ip,d||null),k(this,zv,f),k(this,Wv,p),k(this,Rp,m),k(this,Gv,y||null),this.viewParameters={realScale:xu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=v!==!1,s==null||s.setSidebarUiManager(this)}static get _keyboardManager(){const e=Qf.prototype,n=a=>h(a,No).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Oe(this,"_keyboardManager",new Kb([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&h(a,No).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&h(a,No).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:n}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:n}]]))}destroy(){var e,n,r,i,s,a,o,l,u;(e=h(this,os))==null||e.resolve(),k(this,os,null),(n=h(this,Cp))==null||n.abort(),k(this,Cp,null),this._signal=null;for(const d of h(this,Sn).values())d.destroy();h(this,Sn).clear(),h(this,Xt).clear(),h(this,_d).clear(),(r=h(this,vc))==null||r.clear(),k(this,vi,null),h(this,nt).clear(),h(this,ss).destroy(),(i=h(this,Tp))==null||i.destroy(),(s=h(this,hr))==null||s.destroy(),(a=h(this,xc))==null||a.destroy(),(o=h(this,Na))==null||o.hide(),k(this,Na,null),(l=h(this,$p))==null||l.destroy(),k(this,$p,null),k(this,Pp,null),h(this,ka)&&(clearTimeout(h(this,ka)),k(this,ka,null)),h(this,Ea)&&(clearTimeout(h(this,Ea)),k(this,Ea,null)),(u=this._editorUndoBar)==null||u.destroy(),k(this,Lp,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return h(this,Gv)}get useNewAltTextFlow(){return h(this,Wv)}get useNewAltTextWhenAddingImage(){return h(this,Rp)}get hcmFilter(){return Oe(this,"hcmFilter",h(this,bc)?h(this,Hv).addHCMFilter(h(this,bc).foreground,h(this,bc).background):"none")}get direction(){return Oe(this,"direction",getComputedStyle(h(this,No)).direction)}get _highlightColors(){return Oe(this,"_highlightColors",h(this,Ip)?new Map(h(this,Ip).split(",").map(e=>(e=e.split("=").map(n=>n.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Oe(this,"highlightColors",null);const n=new Map,r=!!h(this,bc);for(const[i,s]of e){const a=i.endsWith("_HCM");if(r&&a){n.set(i.replace("_HCM",""),s);continue}!r&&!a&&n.set(i,s)}return Oe(this,"highlightColors",n)}get highlightColorNames(){return Oe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const n=this.highlightColorNames.get(e);return this._highlightColors.get(n)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),k(this,hc,e)}setMainHighlightColorPicker(e){k(this,$p,e)}editAltText(e,n=!1){var r;(r=h(this,Tp))==null||r.editAltText(this,e,n)}hasCommentManager(){return!!h(this,hr)}editComment(e,n,r,i){var s;(s=h(this,hr))==null||s.showDialog(this,e,n,r,i)}selectComment(e,n){const r=h(this,Sn).get(e),i=r==null?void 0:r.getEditorByUID(n);i==null||i.toggleComment(!0,!0)}updateComment(e){var n;(n=h(this,hr))==null||n.updateComment(e.getData())}updatePopupColor(e){var n;(n=h(this,hr))==null||n.updatePopupColor(e)}removeComment(e){var n;(n=h(this,hr))==null||n.removeComments([e.uid])}toggleComment(e,n,r=void 0){var i;(i=h(this,hr))==null||i.toggleCommentPopup(e,n,r)}makeCommentColor(e,n){var r;return e&&((r=h(this,hr))==null?void 0:r.makeCommentColor(e,n))||null}getCommentDialogElement(){var e;return((e=h(this,hr))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(h(this,Sn).has(e-1))return;const{resolve:n,promise:r}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),n())};this._eventBus.on("editorsrendered",i),await r}getSignature(e){var n;(n=h(this,xc))==null||n.getSignature({uiManager:this,editor:e})}get signatureManager(){return h(this,xc)}switchToMode(e,n){this._eventBus.on("annotationeditormodechanged",n,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,n){this._eventBus.dispatch("setpreference",{source:this,name:e,value:n})}onSetPreference({name:e,value:n}){switch(e){case"enableNewAltTextWhenAddingImage":k(this,Rp,n);break}}onPageChanging({pageNumber:e}){k(this,Mp,e-1)}focusMainContainer(){h(this,No).focus()}findParent(e,n){for(const r of h(this,Sn).values()){const{x:i,y:s,width:a,height:o}=r.div.getBoundingClientRect();if(e>=i&&e<=i+a&&n>=s&&n<=s+o)return r}return null}disableUserSelect(e=!1){h(this,Yv).classList.toggle("noUserSelect",e)}addShouldRescale(e){h(this,_d).add(e)}removeShouldRescale(e){h(this,_d).delete(e)}onScaleChanging({scale:e}){var n;this.commitOrRemove(),this.viewParameters.realScale=e*xu.PDF_TO_CSS_UNITS;for(const r of h(this,_d))r.onScaleChanging();(n=h(this,hc))==null||n.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",n=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o}=r,l=r.toString(),d=C(this,de,l1).call(this,r).closest(".textLayer"),f=this.getSelectionBoxes(d);if(!f)return;r.empty();const p=C(this,de,n2).call(this,d),m=h(this,dn)===Pe.NONE,y=()=>{const g=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:o,text:l});m&&this.showAllEditors("highlight",!0,!0),n&&(g==null||g.editComment())};if(m){this.switchToMode(Pe.HIGHLIGHT,y);return}y()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!h(this,is))return null;const n=`${kv}${e}`,r=h(this,is).getRawValue(n);return r&&h(this,is).remove(n),r}addToAnnotationStorage(e){!e.isEmpty()&&h(this,is)&&!h(this,is).has(e.id)&&h(this,is).setValue(e.id,e)}a11yAlert(e,n=null){const r=h(this,Xv);r&&(r.setAttribute("data-l10n-id",e),n?r.setAttribute("data-l10n-args",JSON.stringify(n)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,h(this,mc)&&(k(this,mc,!1),C(this,de,Dy).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const n of h(this,nt))if(n.div.contains(e)){k(this,Sd,[n,e]),n._focusEventsAllowed=!1;break}}focus(){if(!h(this,Sd))return;const[e,n]=h(this,Sd);k(this,Sd,null),n.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),n.focus()}addEditListeners(){C(this,de,r2).call(this),this.setEditingState(!0)}removeEditListeners(){C(this,de,Cz).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:n}of e.dataTransfer.items)for(const r of h(this,as))if(r.isHandlingMimeForPasting(n)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const n of e.dataTransfer.items)for(const r of h(this,as))if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=h(this,vi))==null||r.commitOrRemove(),!this.hasSelection)return;const n=[];for(const i of h(this,nt)){const s=i.serialize(!0);s&&n.push(s)}n.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(n))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:n}=e;for(const s of n.items)for(const a of h(this,as))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=n.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Ne(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const l of r){const u=await i.deserialize(l);if(!u)return;s.push(u)}const a=()=>{for(const l of s)C(this,de,i2).call(this,l);C(this,de,s2).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Ne(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),h(this,dn)!==Pe.NONE&&!this.isEditorHandlingKeyboard&&Qf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,h(this,mc)&&(k(this,mc,!1),C(this,de,Dy).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(C(this,de,Nz).call(this),C(this,de,Pz).call(this),C(this,de,_r).call(this,{isEditing:h(this,dn)!==Pe.NONE,isEmpty:C(this,de,$y).call(this),hasSomethingToUndo:h(this,ss).hasSomethingToUndo(),hasSomethingToRedo:h(this,ss).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,de,Ez).call(this),C(this,de,Tz).call(this),C(this,de,_r).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!h(this,as)){k(this,as,e);for(const n of h(this,as))C(this,de,fo).call(this,n.defaultPropertiesToUpdate)}}getId(){return h(this,$S).id}get currentLayer(){return h(this,Sn).get(h(this,Mp))}getLayer(e){return h(this,Sn).get(e)}get currentPageIndex(){return h(this,Mp)}addLayer(e){h(this,Sn).set(e.pageIndex,e),h(this,gc)?e.enable():e.disable()}removeLayer(e){h(this,Sn).delete(e.pageIndex)}async updateMode(e,n=null,r=!1,i=!1,s=!1){var a,o,l,u,d,f;if(h(this,dn)!==e&&!(h(this,os)&&(await h(this,os).promise,!h(this,os)))){if(k(this,os,Promise.withResolvers()),(a=h(this,hc))==null||a.commitOrRemove(),h(this,dn)===Pe.POPUP&&((o=h(this,hr))==null||o.hideSidebar()),(l=h(this,hr))==null||l.destroyPopup(),k(this,dn,e),e===Pe.NONE){this.setEditingState(!1),C(this,de,Rz).call(this);for(const p of h(this,Xt).values())p.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),h(this,os).resolve();return}for(const p of h(this,Xt).values())p.addStandaloneCommentButton();e===Pe.SIGNATURE&&await((d=h(this,xc))==null?void 0:d.loadSignatures()),this.setEditingState(!0),await C(this,de,Mz).call(this),this.unselectAll();for(const p of h(this,Sn).values())p.updateMode(e);if(e===Pe.POPUP){h(this,Pp)||k(this,Pp,await h(this,Lp).getAnnotationsByType(new Set(h(this,as).map(y=>y._editorType))));const p=new Set,m=[];for(const y of h(this,Xt).values()){const{annotationElementId:g,hasComment:v,deleted:b}=y;g&&p.add(g),v&&!b&&m.push(y.getData())}for(const y of h(this,Pp)){const{id:g,popupRef:v,contentsObj:b}=y;v&&(b!=null&&b.str)&&!p.has(g)&&!h(this,fc).has(g)&&m.push(y)}(f=h(this,hr))==null||f.showSidebar(m)}if(!n){r&&this.addNewEditorFromKeyboard(),h(this,os).resolve();return}for(const p of h(this,Xt).values())p.uid===n?(this.setSelected(p),s?p.editComment():i?p.enterInEditMode():p.focus()):p.unselect();h(this,os).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==h(this,dn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,n){if(h(this,as)){switch(e){case ze.CREATE:this.currentLayer.addNewEditor(n);return;case ze.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(h(this,Kv)||k(this,Kv,new Map)).set(e,n),this.showAllEditors("highlight",n);break}if(this.hasSelection)for(const r of h(this,nt))r.updateParams(e,n);else for(const r of h(this,as))r.updateDefaultParams(e,n)}}showAllEditors(e,n,r=!1){var s;for(const a of h(this,Xt).values())a.editorType===e&&a.show(n);(((s=h(this,Kv))==null?void 0:s.get(ze.HIGHLIGHT_SHOW_ALL))??!0)!==n&&C(this,de,fo).call(this,[[ze.HIGHLIGHT_SHOW_ALL,n]])}enableWaiting(e=!1){if(h(this,qv)!==e){k(this,qv,e);for(const n of h(this,Sn).values())e?n.disableClick():n.enableClick(),n.div.classList.toggle("waiting",e)}}*getEditors(e){for(const n of h(this,Xt).values())n.pageIndex===e&&(yield n)}getEditor(e){return h(this,Xt).get(e)}addEditor(e){h(this,Xt).set(e.id,e)}removeEditor(e){var n,r;e.div.contains(document.activeElement)&&(h(this,ka)&&clearTimeout(h(this,ka)),k(this,ka,setTimeout(()=>{this.focusMainContainer(),k(this,ka,null)},0))),h(this,Xt).delete(e.id),e.annotationElementId&&((n=h(this,vc))==null||n.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!h(this,fc).has(e.annotationElementId))&&((r=h(this,is))==null||r.remove(e.id))}addDeletedAnnotationElement(e){h(this,fc).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return h(this,fc).has(e)}removeDeletedAnnotationElement(e){h(this,fc).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){h(this,vi)!==e&&(k(this,vi,e),e&&C(this,de,fo).call(this,e.propertiesToUpdate))}updateUI(e){h(this,de,Iz)===e&&C(this,de,fo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){C(this,de,fo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(h(this,nt).has(e)){h(this,nt).delete(e),e.unselect(),C(this,de,_r).call(this,{hasSelectedEditor:this.hasSelection});return}h(this,nt).add(e),e.select(),C(this,de,fo).call(this,e.propertiesToUpdate),C(this,de,_r).call(this,{hasSelectedEditor:!0})}setSelected(e){var n;this.updateToolbar({mode:e.mode,editId:e.uid}),(n=h(this,hc))==null||n.commitOrRemove();for(const r of h(this,nt))r!==e&&r.unselect();h(this,nt).clear(),h(this,nt).add(e),e.select(),C(this,de,fo).call(this,e.propertiesToUpdate),C(this,de,_r).call(this,{hasSelectedEditor:!0})}isSelected(e){return h(this,nt).has(e)}get firstSelectedEditor(){return h(this,nt).values().next().value}unselect(e){e.unselect(),h(this,nt).delete(e),C(this,de,_r).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return h(this,nt).size!==0}get isEnterHandled(){return h(this,nt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;h(this,ss).undo(),C(this,de,_r).call(this,{hasSomethingToUndo:h(this,ss).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,de,$y).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){h(this,ss).redo(),C(this,de,_r).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:h(this,ss).hasSomethingToRedo(),isEmpty:C(this,de,$y).call(this)})}addCommands(e){h(this,ss).add(e),C(this,de,_r).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,de,$y).call(this)})}cleanUndoStack(e){h(this,ss).cleanType(e)}delete(){var s;this.commitOrRemove();const e=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const n=e?[e]:[...h(this,nt)],r=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,n.length===1?n[0].editorType:n.length);for(const o of n)o.remove()},i=()=>{for(const a of n)C(this,de,i2).call(this,a)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=h(this,vi))==null||e.commitOrRemove()}hasSomethingToControl(){return h(this,vi)||this.hasSelection}selectAll(){for(const e of h(this,nt))e.commit();C(this,de,s2).call(this,h(this,Xt).values())}unselectAll(){var e;if(!(h(this,vi)&&(h(this,vi).commitOrRemove(),h(this,dn)!==Pe.NONE))&&!((e=h(this,hc))!=null&&e.commitOrRemove())&&this.hasSelection){for(const n of h(this,nt))n.unselect();h(this,nt).clear(),C(this,de,_r).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,n,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;h(this,wc)[0]+=e,h(this,wc)[1]+=n;const[i,s]=h(this,wc),a=[...h(this,nt)],o=1e3;h(this,Ea)&&clearTimeout(h(this,Ea)),k(this,Ea,setTimeout(()=>{k(this,Ea,null),h(this,wc)[0]=h(this,wc)[1]=0,this.addCommands({cmd:()=>{for(const l of a)h(this,Xt).has(l.id)&&(l.translateInPage(i,s),l.translationDone())},undo:()=>{for(const l of a)h(this,Xt).has(l.id)&&(l.translateInPage(-i,-s),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,n),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),k(this,ja,new Map);for(const e of h(this,nt))h(this,ja).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!h(this,ja))return!1;this.disableUserSelect(!1);const e=h(this,ja);k(this,ja,null);let n=!1;for(const[{x:i,y:s,pageIndex:a},o]of e)o.newX=i,o.newY=s,o.newPageIndex=a,n||(n=i!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!n)return!1;const r=(i,s,a,o)=>{if(h(this,Xt).has(i.id)){const l=h(this,Sn).get(o);l?i._setParentAndPosition(l,s,a):(i.pageIndex=o,i.x=s,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:a,newPageIndex:o}]of e)r(i,s,a,o)},undo:()=>{for(const[i,{savedX:s,savedY:a,savedPageIndex:o}]of e)r(i,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,n){if(h(this,ja))for(const r of h(this,ja).keys())r.drag(e,n)}rebuild(e){if(e.parent===null){const n=this.getLayer(e.pageIndex);n?(n.changeParent(e),n.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||h(this,nt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return h(this,vi)===e}getActive(){return h(this,vi)}getMode(){return h(this,dn)}isEditingMode(){return h(this,dn)!==Pe.NONE}get imageManager(){return Oe(this,"imageManager",new e2)}getSelectionBoxes(e){if(!e)return null;const n=document.getSelection();for(let u=0,d=n.rangeCount;u<d;u++)if(!e.contains(n.getRangeAt(u).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,d,f,p)=>({x:(d-i)/a,y:1-(u+f-r)/s,width:p/a,height:f/s});break;case"180":o=(u,d,f,p)=>({x:1-(u+f-r)/s,y:1-(d+p-i)/a,width:f/s,height:p/a});break;case"270":o=(u,d,f,p)=>({x:1-(d+p-i)/a,y:(u-r)/s,width:p/a,height:f/s});break;default:o=(u,d,f,p)=>({x:(u-r)/s,y:(d-i)/a,width:f/s,height:p/a});break}const l=[];for(let u=0,d=n.rangeCount;u<d;u++){const f=n.getRangeAt(u);if(!f.collapsed)for(const{x:p,y:m,width:y,height:g}of f.getClientRects())y===0||g===0||l.push(o(p,m,y,g))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:n}){(h(this,Op)||k(this,Op,new Map)).set(e,n)}removeChangedExistingAnnotation({annotationElementId:e}){var n;(n=h(this,Op))==null||n.delete(e)}renderAnnotationElement(e){var i;const n=(i=h(this,Op))==null?void 0:i.get(e.data.id);if(!n)return;const r=h(this,is).getRawValue(n);r&&(h(this,dn)===Pe.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,n,r){var s;const i=(s=h(this,vc))==null?void 0:s.get(e);i&&(i.setCanvas(n,r),h(this,vc).delete(e))}addMissingCanvas(e,n){(h(this,vc)||k(this,vc,new Map)).set(e,n)}};Cp=new WeakMap,vi=new WeakMap,Pp=new WeakMap,Xt=new WeakMap,Sn=new WeakMap,Tp=new WeakMap,is=new WeakMap,Op=new WeakMap,ss=new WeakMap,hr=new WeakMap,dc=new WeakMap,hc=new WeakMap,Mp=new WeakMap,fc=new WeakMap,ja=new WeakMap,as=new WeakMap,_d=new WeakMap,zv=new WeakMap,Wv=new WeakMap,Rp=new WeakMap,Hv=new WeakMap,ka=new WeakMap,pc=new WeakMap,Ip=new WeakMap,mc=new WeakMap,Na=new WeakMap,$S=new WeakMap,gc=new WeakMap,Dp=new WeakMap,qv=new WeakMap,yc=new WeakMap,Sd=new WeakMap,$p=new WeakMap,vc=new WeakMap,Gv=new WeakMap,dn=new WeakMap,nt=new WeakMap,ko=new WeakMap,xc=new WeakMap,bc=new WeakMap,Kv=new WeakMap,Lp=new WeakMap,Vv=new WeakMap,wc=new WeakMap,Ea=new WeakMap,No=new WeakMap,Yv=new WeakMap,Xv=new WeakMap,os=new WeakMap,de=new WeakSet,l1=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},n2=function(e){const{currentLayer:n}=this;if(n.hasTextLayer(e))return n;for(const r of h(this,Sn).values())if(r.hasTextLayer(e))return r;return null},Az=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=C(this,de,l1).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(h(this,Na)||k(this,Na,new QAe(this)),h(this,Na).show(r,i,this.direction==="ltr"))},jz=function(){var s,a,o;const e=document.getSelection();if(!e||e.isCollapsed){h(this,ko)&&((s=h(this,Na))==null||s.hide(),k(this,ko,null),C(this,de,_r).call(this,{hasSelectedText:!1}));return}const{anchorNode:n}=e;if(n===h(this,ko))return;const i=C(this,de,l1).call(this,e).closest(".textLayer");if(!i){h(this,ko)&&((a=h(this,Na))==null||a.hide(),k(this,ko,null),C(this,de,_r).call(this,{hasSelectedText:!1}));return}if((o=h(this,Na))==null||o.hide(),k(this,ko,n),C(this,de,_r).call(this,{hasSelectedText:!0}),!(h(this,dn)!==Pe.HIGHLIGHT&&h(this,dn)!==Pe.NONE)&&(h(this,dn)===Pe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),k(this,mc,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=h(this,dn)===Pe.HIGHLIGHT?C(this,de,n2).call(this,i):null;if(l==null||l.toggleDrawing(),h(this,Dp)){const u=new AbortController,d=this.combinedSignal(u),f=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&C(this,de,Dy).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}else l==null||l.toggleDrawing(!0),C(this,de,Dy).call(this,"main_toolbar")}},Dy=function(e=""){h(this,dn)===Pe.HIGHLIGHT?this.highlightSelection(e):h(this,zv)&&C(this,de,Az).call(this)},kz=function(){document.addEventListener("selectionchange",C(this,de,jz).bind(this),{signal:this._signal})},Nz=function(){if(h(this,pc))return;k(this,pc,new AbortController);const e=this.combinedSignal(h(this,pc));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Ez=function(){var e;(e=h(this,pc))==null||e.abort(),k(this,pc,null)},r2=function(){if(h(this,yc))return;k(this,yc,new AbortController);const e=this.combinedSignal(h(this,yc));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},Cz=function(){var e;(e=h(this,yc))==null||e.abort(),k(this,yc,null)},Pz=function(){if(h(this,dc))return;k(this,dc,new AbortController);const e=this.combinedSignal(h(this,dc));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Tz=function(){var e;(e=h(this,dc))==null||e.abort(),k(this,dc,null)},Oz=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},_r=function(e){Object.entries(e).some(([r,i])=>h(this,Vv)[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(h(this,Vv),e)}),h(this,dn)===Pe.HIGHLIGHT&&e.hasSelectedEditor===!1&&C(this,de,fo).call(this,[[ze.HIGHLIGHT_FREE,!0]]))},fo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Mz=async function(){if(!h(this,gc)){k(this,gc,!0);const e=[];for(const n of h(this,Sn).values())e.push(n.enable());await Promise.all(e);for(const n of h(this,Xt).values())n.enable()}},Rz=function(){if(this.unselectAll(),h(this,gc)){k(this,gc,!1);for(const e of h(this,Sn).values())e.disable();for(const e of h(this,Xt).values())e.disable()}},i2=function(e){const n=h(this,Sn).get(e.pageIndex);n?n.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Iz=function(){let e=null;for(e of h(this,nt));return e},$y=function(){if(h(this,Xt).size===0)return!0;if(h(this,Xt).size===1)for(const e of h(this,Xt).values())return e.isEmpty();return!1},s2=function(e){for(const n of h(this,nt))n.unselect();h(this,nt).clear();for(const n of e)n.isEmpty()||(h(this,nt).add(n),n.select());C(this,de,_r).call(this,{hasSelectedEditor:this.hasSelection})},ae(Qf,"TRANSLATE_SMALL",1),ae(Qf,"TRANSLATE_BIG",10);let Xh=Qf;var On,Ca,zs,Fp,Pa,xi,Bp,Ta,Xr,Eo,Ad,Oa,_c,oa,Ly,c1;const Sr=class Sr{constructor(e){E(this,oa);E(this,On,null);E(this,Ca,!1);E(this,zs,null);E(this,Fp,null);E(this,Pa,null);E(this,xi,null);E(this,Bp,!1);E(this,Ta,null);E(this,Xr,null);E(this,Eo,null);E(this,Ad,null);E(this,Oa,!1);k(this,Xr,e),k(this,Oa,e._uiManager.useNewAltTextFlow),h(Sr,_c)||k(Sr,_c,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Sr._l10n??(Sr._l10n=e)}async render(){const e=k(this,zs,document.createElement("button"));e.className="altText",e.tabIndex="0";const n=k(this,Fp,document.createElement("span"));e.append(n),h(this,Oa)?(e.classList.add("new"),e.setAttribute("data-l10n-id",h(Sr,_c).missing),n.setAttribute("data-l10n-id",h(Sr,_c)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=h(this,Xr)._uiManager._signal;e.addEventListener("contextmenu",Ps,{signal:r}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),h(this,Xr)._uiManager.editAltText(h(this,Xr)),h(this,Oa)&&h(this,Xr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:h(this,oa,Ly)}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(k(this,Bp,!0),i(s))},{signal:r}),await C(this,oa,c1).call(this),e}finish(){h(this,zs)&&(h(this,zs).focus({focusVisible:h(this,Bp)}),k(this,Bp,!1))}isEmpty(){return h(this,Oa)?h(this,On)===null:!h(this,On)&&!h(this,Ca)}hasData(){return h(this,Oa)?h(this,On)!==null||!!h(this,Eo):this.isEmpty()}get guessedText(){return h(this,Eo)}async setGuessedText(e){h(this,On)===null&&(k(this,Eo,e),k(this,Ad,await Sr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),C(this,oa,c1).call(this))}toggleAltTextBadge(e=!1){var n;if(!h(this,Oa)||h(this,On)){(n=h(this,Ta))==null||n.remove(),k(this,Ta,null);return}if(!h(this,Ta)){const r=k(this,Ta,document.createElement("div"));r.className="noAltTextBadge",h(this,Xr).div.append(r)}h(this,Ta).classList.toggle("hidden",!e)}serialize(e){let n=h(this,On);return!e&&h(this,Eo)===n&&(n=h(this,Ad)),{altText:n,decorative:h(this,Ca),guessedText:h(this,Eo),textWithDisclaimer:h(this,Ad)}}get data(){return{altText:h(this,On),decorative:h(this,Ca)}}set data({altText:e,decorative:n,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(k(this,Eo,r),k(this,Ad,i)),!(h(this,On)===e&&h(this,Ca)===n)&&(s||(k(this,On,e),k(this,Ca,n)),C(this,oa,c1).call(this))}toggle(e=!1){h(this,zs)&&(!e&&h(this,xi)&&(clearTimeout(h(this,xi)),k(this,xi,null)),h(this,zs).disabled=!e)}shown(){h(this,Xr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:h(this,oa,Ly)}})}destroy(){var e,n;(e=h(this,zs))==null||e.remove(),k(this,zs,null),k(this,Fp,null),k(this,Pa,null),(n=h(this,Ta))==null||n.remove(),k(this,Ta,null)}};On=new WeakMap,Ca=new WeakMap,zs=new WeakMap,Fp=new WeakMap,Pa=new WeakMap,xi=new WeakMap,Bp=new WeakMap,Ta=new WeakMap,Xr=new WeakMap,Eo=new WeakMap,Ad=new WeakMap,Oa=new WeakMap,_c=new WeakMap,oa=new WeakSet,Ly=function(){return h(this,On)&&"added"||h(this,On)===null&&this.guessedText&&"review"||"missing"},c1=async function(){var i,s,a;const e=h(this,zs);if(!e)return;if(h(this,Oa)){if(e.classList.toggle("done",!!h(this,On)),e.setAttribute("data-l10n-id",h(Sr,_c)[h(this,oa,Ly)]),(i=h(this,Fp))==null||i.setAttribute("data-l10n-id",h(Sr,_c)[`${h(this,oa,Ly)}-label`]),!h(this,On)){(s=h(this,Pa))==null||s.remove();return}}else{if(!h(this,On)&&!h(this,Ca)){e.classList.remove("done"),(a=h(this,Pa))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let n=h(this,Pa);if(!n){k(this,Pa,n=document.createElement("span")),n.className="tooltip",n.setAttribute("role","tooltip"),n.id=`alt-text-tooltip-${h(this,Xr).id}`;const o=100,l=h(this,Xr)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(h(this,xi)),k(this,xi,null)},{once:!0}),e.addEventListener("mouseenter",()=>{k(this,xi,setTimeout(()=>{k(this,xi,null),h(this,Pa).classList.add("show"),h(this,Xr)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;h(this,xi)&&(clearTimeout(h(this,xi)),k(this,xi,null)),(u=h(this,Pa))==null||u.classList.remove("show")},{signal:l})}h(this,Ca)?n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(n.removeAttribute("data-l10n-id"),n.textContent=h(this,On)),n.parentNode||e.append(n);const r=h(this,Xr).getElementForAltText();r==null||r.setAttribute("aria-describedby",n.id)},E(Sr,_c,null),ae(Sr,"_l10n",null);let _S=Sr;var qn,ls,jd,St,Qv,kd,Ws,Nd,Ed,Cd,Jv,a2;class Mw{constructor(e){E(this,Jv);E(this,qn,null);E(this,ls,null);E(this,jd,!1);E(this,St,null);E(this,Qv,null);E(this,kd,null);E(this,Ws,null);E(this,Nd,null);E(this,Ed,!1);E(this,Cd,null);k(this,St,e)}renderForToolbar(){const e=k(this,ls,document.createElement("button"));return e.className="comment",C(this,Jv,a2).call(this,e,!1)}renderForStandalone(){const e=k(this,qn,document.createElement("button"));e.className="annotationCommentButton";const n=h(this,St).commentButtonPosition;if(n){const{style:r}=e;r.insetInlineEnd=`calc(${100*(h(this,St)._uiManager.direction==="ltr"?1-n[0]:n[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*n[1]}% - var(--comment-button-dim))`;const i=h(this,St).commentButtonColor;i&&(r.backgroundColor=i)}return C(this,Jv,a2).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=h(this,qn)??h(this,ls))==null||e.focus()},0)}onUpdatedColor(){if(!h(this,qn))return;const e=h(this,St).commentButtonColor;e&&(h(this,qn).style.backgroundColor=e),h(this,St)._uiManager.updatePopupColor(h(this,St))}get commentButtonWidth(){var e;return(((e=h(this,qn))==null?void 0:e.getBoundingClientRect().width)??0)/h(this,St).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(h(this,Cd))return h(this,Cd);if(!h(this,qn))return null;const{x:e,y:n,height:r}=h(this,qn).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=h(this,St).parent.boundingClientRect;return[(e-i)/a,(n+r-s)/o]}set commentPopupPositionInLayer(e){k(this,Cd,e)}hasDefaultPopupPosition(){return h(this,Cd)===null}removeStandaloneCommentButton(){var e;(e=h(this,qn))==null||e.remove(),k(this,qn,null)}removeToolbarCommentButton(){var e;(e=h(this,ls))==null||e.remove(),k(this,ls,null)}setCommentButtonStates({selected:e,hasPopup:n}){h(this,qn)&&(h(this,qn).classList.toggle("selected",e),h(this,qn).ariaExpanded=n)}edit(e){const n=this.commentPopupPositionInLayer;let r,i;if(n)[r,i]=n;else{[r,i]=h(this,St).commentButtonPosition;const{width:d,height:f,x:p,y:m}=h(this,St);r=p+r*d,i=m+i*f}const s=h(this,St).parent.boundingClientRect,{x:a,y:o,width:l,height:u}=s;h(this,St)._uiManager.editComment(h(this,St),a+r*l,o+i*u,{...e,parentDimensions:s})}finish(){h(this,ls)&&(h(this,ls).focus({focusVisible:h(this,jd)}),k(this,jd,!1))}isDeleted(){return h(this,Ed)||h(this,Ws)===""}isEmpty(){return h(this,Ws)===null}hasBeenEdited(){return this.isDeleted()||h(this,Ws)!==h(this,Qv)}serialize(){return this.data}get data(){return{text:h(this,Ws),richText:h(this,kd),date:h(this,Nd),deleted:this.isDeleted()}}set data(e){if(e!==h(this,Ws)&&k(this,kd,null),e===null){k(this,Ws,""),k(this,Ed,!0);return}k(this,Ws,e),k(this,Nd,new Date),k(this,Ed,!1)}setInitialText(e,n=null){k(this,Qv,e),this.data=e,k(this,Nd,null),k(this,kd,n)}shown(){}destroy(){var e,n;(e=h(this,ls))==null||e.remove(),k(this,ls,null),(n=h(this,qn))==null||n.remove(),k(this,qn,null),k(this,Ws,""),k(this,kd,null),k(this,Nd,null),k(this,St,null),k(this,jd,!1),k(this,Ed,!1)}}qn=new WeakMap,ls=new WeakMap,jd=new WeakMap,St=new WeakMap,Qv=new WeakMap,kd=new WeakMap,Ws=new WeakMap,Nd=new WeakMap,Ed=new WeakMap,Cd=new WeakMap,Jv=new WeakSet,a2=function(e,n){if(!h(this,St)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",n?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[h(this,St)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const r=h(this,St)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",Ps,{signal:r}),n&&(e.addEventListener("focusin",s=>{h(this,St)._focusEventsAllowed=!1,rn(s)},{capture:!0,signal:r}),e.addEventListener("focusout",s=>{h(this,St)._focusEventsAllowed=!0,rn(s)},{capture:!0,signal:r})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),e===h(this,ls)?this.edit():h(this,St).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(k(this,jd,!0),i(s))},{signal:r}),e.addEventListener("pointerenter",()=>{h(this,St).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{h(this,St).toggleComment(!1,!1)},{signal:r}),e};var Up,Pd,Zv,ex,tx,nx,rx,Co,Td,Po,Od,To,bu,Dz,$z,Lz;const HO=class HO{constructor({container:e,isPinchingDisabled:n=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){E(this,bu);E(this,Up);E(this,Pd,!1);E(this,Zv,null);E(this,ex);E(this,tx);E(this,nx);E(this,rx);E(this,Co,null);E(this,Td);E(this,Po,null);E(this,Od);E(this,To,null);k(this,Up,e),k(this,Zv,r),k(this,ex,n),k(this,tx,i),k(this,nx,s),k(this,rx,a),k(this,Od,new AbortController),k(this,Td,AbortSignal.any([o,h(this,Od).signal])),e.addEventListener("touchstart",C(this,bu,Dz).bind(this),{passive:!1,signal:h(this,Td)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/io.pixelRatio}destroy(){var e,n;(e=h(this,Od))==null||e.abort(),k(this,Od,null),(n=h(this,Co))==null||n.abort(),k(this,Co,null)}};Up=new WeakMap,Pd=new WeakMap,Zv=new WeakMap,ex=new WeakMap,tx=new WeakMap,nx=new WeakMap,rx=new WeakMap,Co=new WeakMap,Td=new WeakMap,Po=new WeakMap,Od=new WeakMap,To=new WeakMap,bu=new WeakSet,Dz=function(e){var i,s,a;if((i=h(this,ex))!=null&&i.call(this))return;if(e.touches.length===1){if(h(this,Co))return;const o=k(this,Co,new AbortController),l=AbortSignal.any([h(this,Td),o.signal]),u=h(this,Up),d={capture:!0,signal:l,passive:!1},f=p=>{var m;p.pointerType==="touch"&&((m=h(this,Co))==null||m.abort(),k(this,Co,null))};u.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(rn(p),f(p))},d),u.addEventListener("pointerup",f,d),u.addEventListener("pointercancel",f,d);return}if(!h(this,To)){k(this,To,new AbortController);const o=AbortSignal.any([h(this,Td),h(this,To).signal]),l=h(this,Up),u={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",C(this,bu,$z).bind(this),u);const d=C(this,bu,Lz).bind(this);l.addEventListener("touchend",d,u),l.addEventListener("touchcancel",d,u),u.capture=!0,l.addEventListener("pointerdown",rn,u),l.addEventListener("pointermove",rn,u),l.addEventListener("pointercancel",rn,u),l.addEventListener("pointerup",rn,u),(s=h(this,tx))==null||s.call(this)}if(rn(e),e.touches.length!==2||(a=h(this,Zv))!=null&&a.call(this)){k(this,Po,null);return}let[n,r]=e.touches;n.identifier>r.identifier&&([n,r]=[r,n]),k(this,Po,{touch0X:n.screenX,touch0Y:n.screenY,touch1X:r.screenX,touch1Y:r.screenY})},$z=function(e){var S;if(!h(this,Po)||e.touches.length!==2)return;rn(e);let[n,r]=e.touches;n.identifier>r.identifier&&([n,r]=[r,n]);const{screenX:i,screenY:s}=n,{screenX:a,screenY:o}=r,l=h(this,Po),{touch0X:u,touch0Y:d,touch1X:f,touch1Y:p}=l,m=f-u,y=p-d,g=a-i,v=o-s,b=Math.hypot(g,v)||1,x=Math.hypot(m,y)||1;if(!h(this,Pd)&&Math.abs(x-b)<=HO.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,!h(this,Pd)){k(this,Pd,!0);return}const w=[(i+a)/2,(s+o)/2];(S=h(this,nx))==null||S.call(this,w,x,b)},Lz=function(e){var n;e.touches.length>=2||(h(this,To)&&(h(this,To).abort(),k(this,To,null),(n=h(this,rx))==null||n.call(this)),h(this,Po)&&(rn(e),k(this,Po,null),k(this,Pd,!1)))};let SS=HO;var Md,Hs,Dt,gt,Oo,zp,Sc,ix,Gn,Rd,Mo,cs,Ac,sx,Id,bi,ax,Dd,Ro,Ma,Wp,Hp,us,$d,ox,LS,Se,o2,lx,l2,u1,Fz,Bz,c2,d1,u2,Uz,zz,Wz,d2,Hz,h2,qz,Gz,Kz,f2,Fy;const Ce=class Ce{constructor(e){E(this,Se);E(this,Md,null);E(this,Hs,null);E(this,Dt,null);E(this,gt,null);E(this,Oo,null);E(this,zp,!1);E(this,Sc,null);E(this,ix,"");E(this,Gn,null);E(this,Rd,null);E(this,Mo,null);E(this,cs,null);E(this,Ac,null);E(this,sx,"");E(this,Id,!1);E(this,bi,null);E(this,ax,!1);E(this,Dd,!1);E(this,Ro,!1);E(this,Ma,null);E(this,Wp,0);E(this,Hp,0);E(this,us,null);E(this,$d,null);ae(this,"isSelected",!1);ae(this,"_isCopy",!1);ae(this,"_editToolbar",null);ae(this,"_initialOptions",Object.create(null));ae(this,"_initialData",null);ae(this,"_isVisible",!0);ae(this,"_uiManager",null);ae(this,"_focusEventsAllowed",!0);E(this,ox,!1);E(this,LS,Ce._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:n,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=n,this.pageRotation=(360+n-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ce.prototype._resizeWithKeyboard,n=Xh.TRANSLATE_SMALL,r=Xh.TRANSLATE_BIG;return Oe(this,"_resizerKeyboardManager",new Kb([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-n,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[n,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-n]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,n]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],Ce.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Oe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const n=new eje({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});n.annotationElementId=e.annotationElementId,n.deleted=!0,n._uiManager.addToAnnotationStorage(n)}static initialize(e,n){if(Ce._l10n??(Ce._l10n=e),Ce._l10nResizer||(Ce._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ce._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Ce._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,n){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,n){bt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return h(this,ox)}set _isDraggable(e){var n;k(this,ox,e),(n=this.div)==null||n.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,n]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*n/(e*2),this.y+=this.width*e/(n*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*n/(e*2),this.y-=this.width*e/(n*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=h(this,LS)}setParent(e){var n;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(C(this,Se,Fy).call(this),(n=h(this,cs))==null||n.remove(),k(this,cs,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(h(this,Id)?k(this,Id,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const n=e.relatedTarget;n!=null&&n.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,n,r,i){const[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/s,this.y=(n+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,n){const[r,i]=this.parentDimensions;this.setAt(e*r,n*i,this.width*r,this.height*i),this._onTranslated()}translate(e,n){C(this,Se,o2).call(this,this.parentDimensions,e,n)}translateInPage(e,n){h(this,bi)||k(this,bi,[this.x,this.y,this.width,this.height]),C(this,Se,o2).call(this,this.pageDimensions,e,n),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,n){h(this,bi)||k(this,bi,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=n/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:d}=r;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,n){}_onTranslated(e,n){}get _hasBeenMoved(){return!!h(this,bi)&&(h(this,bi)[0]!==this.x||h(this,bi)[1]!==this.y)}get _hasBeenResized(){return!!h(this,bi)&&(h(this,bi)[2]!==this.width||h(this,bi)[3]!==this.height)}getBaseTranslation(){const[e,n]=this.parentDimensions,{_borderLineWidth:r}=Ce,i=r/e,s=r/n;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:n},pageDimensions:[r,i]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=r,l*=i,s*=r,a*=i,this._mustFixPosition)switch(e){case 0:s=Pr(s,0,r-o),a=Pr(a,0,i-l);break;case 90:s=Pr(s,0,r-l),a=Pr(a,o,i);break;case 180:s=Pr(s,o,r),a=Pr(a,l,i);break;case 270:s=Pr(s,l,r),a=Pr(a,0,i-o);break}this.x=s/=r,this.y=a/=i;const[u,d]=this.getBaseTranslation();s+=u,a+=d,n.left=`${(100*s).toFixed(2)}%`,n.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,n){var r;return C(r=Ce,lx,l2).call(r,e,n,this.parentRotation)}pageTranslationToScreen(e,n){var r;return C(r=Ce,lx,l2).call(r,e,n,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[n,r]}=this;return[n*e,r*e]}setDims(){const{div:{style:e},width:n,height:r}=this;e.width=`${(100*n).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=h(this,Dt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||h(this,Dd))return this._editToolbar;this._editToolbar=new JC(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[n,r]of e)await this._editToolbar.addButton(n,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,n;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(n=h(this,Dt))==null||n.destroy()}addContainer(e){var r;const n=(r=this._editToolbar)==null?void 0:r.div;n?n.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return h(this,Dt)||(_S.initialize(Ce._l10n),k(this,Dt,new _S(this)),h(this,Md)&&(h(this,Dt).data=h(this,Md),k(this,Md,null))),h(this,Dt)}get altTextData(){var e;return(e=h(this,Dt))==null?void 0:e.data}set altTextData(e){h(this,Dt)&&(h(this,Dt).data=e)}get guessedAltText(){var e;return(e=h(this,Dt))==null?void 0:e.guessedText}async setGuessedAltText(e){var n;await((n=h(this,Dt))==null?void 0:n.setGuessedText(e))}serializeAltText(e){var n;return(n=h(this,Dt))==null?void 0:n.serialize(e)}hasAltText(){return!!h(this,Dt)&&!h(this,Dt).isEmpty()}hasAltTextData(){var e;return((e=h(this,Dt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=h(this,gt))==null||e.focusButton()}addCommentButton(){return this.canAddComment?h(this,gt)||k(this,gt,new Mw(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(h(this,Oo)){this._uiManager.isEditingMode()&&h(this,Oo).classList.remove("hidden");return}this.hasComment&&(k(this,Oo,h(this,gt).renderForStandalone()),this.div.append(h(this,Oo)))}}removeStandaloneCommentButton(){h(this,gt).removeStandaloneCommentButton(),k(this,Oo,null)}hideStandaloneCommentButton(){var e;(e=h(this,Oo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:n,date:r,deleted:i}}=h(this,gt);return{text:n,richText:e,date:r,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){h(this,gt)||k(this,gt,new Mw(this)),h(this,gt).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:n,richText:r}){if(!n||(h(this,gt)||k(this,gt,new Mw(this)),h(this,gt).setInitialText(e,r),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=h(this,gt))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=h(this,gt))==null?void 0:e.isDeleted()}get hasComment(){return!!h(this,gt)&&!h(this,gt).isEmpty()&&!h(this,gt).isDeleted()}async editComment(e){h(this,gt)||k(this,gt,new Mw(this)),h(this,gt).edit(e)}toggleComment(e,n=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,n)}setSelectedCommentButton(e){h(this,gt).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[a]=this.pageTranslation,o=a+s+1,l=i-100,u=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,u,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:n}}){h(this,gt).data=n?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=h(this,zp)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),C(this,Se,h2).call(this);const[n,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/n).toFixed(2)}%`,e.style.maxHeight=`${(100*n/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),_z(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(h(this,$d)||k(this,$d,new SS({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:C(this,Se,Uz).bind(this),onPinching:C(this,Se,zz).bind(this),onPinchEnd:C(this,Se,Wz).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:n}=nr.platform;if(e.button!==0||e.ctrlKey&&n){e.preventDefault();return}if(k(this,Id,!0),this._isDraggable){C(this,Se,Hz).call(this,e);return}C(this,Se,d2).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){h(this,Ma)&&clearTimeout(h(this,Ma)),k(this,Ma,setTimeout(()=>{var e;k(this,Ma,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,n,r){e.changeParent(this),this.x=n,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,n,r=this.rotation){const i=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/i,d=n/i,f=this.x*s,p=this.y*a,m=this.width*s,y=this.height*a;switch(r){case 0:return[f+u+o,a-p-d-y+l,f+u+m+o,a-p-d+l];case 90:return[f+d+o,a-p+u+l,f+d+y+o,a-p+u+m+l];case 180:return[f-u-m+o,a-p+d+l,f-u+o,a-p+d+y+l];case 270:return[f-d-y+o,a-p-u-m+l,f-d+o,a-p-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,n){const[r,i,s,a]=e,o=s-r,l=a-i;switch(this.rotation){case 0:return[r,n-a,o,l];case 90:return[r,n-i,l,o];case 180:return[s,n-i,o,l];case 270:return[s,n-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Ce._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=h(this,gt))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:n,date:r,opacity:i,deleted:s,richText:a},uid:o,pageIndex:l,creationDate:u,modificationDate:d}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:r||d,popupRef:!s,color:n,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),k(this,Dd,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),k(this,Dd,!1),!0):!1}isInEditMode(){return h(this,Dd)}shouldGetKeyboardEvents(){return h(this,Ro)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:n,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return n<a&&i>0&&e<s&&r>0}rebuild(){C(this,Se,h2).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,n=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,n,r){const i=new this.prototype.constructor({parent:n,id:n.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,k(i,Md,e.accessibilityData),i._isCopy=e.isCopy||!1;const[s,a]=i.pageDimensions,[o,l,u,d]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/s,i.y=l/a,i.width=u/s,i.height=d/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,n,r;if((e=h(this,Ac))==null||e.abort(),k(this,Ac,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),h(this,Ma)&&(clearTimeout(h(this,Ma)),k(this,Ma,null)),C(this,Se,Fy).call(this),this.removeEditToolbar(),h(this,us)){for(const i of h(this,us).values())clearTimeout(i);k(this,us,null)}this.parent=null,(n=h(this,$d))==null||n.destroy(),k(this,$d,null),(r=h(this,cs))==null||r.remove(),k(this,cs,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,Se,Fz).call(this),h(this,Gn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,n]}=this,[r,i,s,a]=this.getPDFRect();return[Ce._round(r+(s-r)*e),Ce._round(i+(a-i)*(1-n))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return h(this,gt).commentPopupPositionInLayer}set commentPopupPosition(e){h(this,gt).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return h(this,gt).hasDefaultPopupPosition()}get commentButtonWidth(){return h(this,gt).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var n;(n=h(this,gt))==null||n.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),k(this,Mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const n=h(this,Gn).children;if(!h(this,Hs)){k(this,Hs,Array.from(n));const a=C(this,Se,qz).bind(this),o=C(this,Se,Gz).bind(this),l=this._uiManager._signal;for(const u of h(this,Hs)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",C(this,Se,Kz).bind(this,d),{signal:l}),u.setAttribute("data-l10n-id",Ce._l10nResizer[d])}}const r=h(this,Hs)[0];let i=0;for(const a of n){if(a===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(h(this,Hs).length/4);if(s!==i){if(s<i)for(let o=0;o<i-s;o++)h(this,Gn).append(h(this,Gn).firstChild);else if(s>i)for(let o=0;o<s-i;o++)h(this,Gn).firstChild.before(h(this,Gn).lastChild);let a=0;for(const o of n){const u=h(this,Hs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Ce._l10nResizer[u])}}C(this,Se,f2).call(this,0),k(this,Ro,!0),h(this,Gn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,n){h(this,Ro)&&C(this,Se,u2).call(this,h(this,sx),{deltaX:e,deltaY:n,fromKeyboard:!0})}_stopResizingWithKeyboard(){C(this,Se,Fy).call(this),this.div.focus()}select(){var e,n,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,s;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(n=this._editToolbar)==null||n.show(),(r=h(this,Dt))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,n,r,i,s;this.isSelected&&(this.isSelected=!1,(e=h(this,Gn))==null||e.classList.add("hidden"),(n=this.div)==null||n.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(s=h(this,Dt))==null||s.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,n){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return h(this,ax)}set isEditing(e){k(this,ax,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,n=!1){if(n){h(this,us)||k(this,us,new Map);const{action:r}=e;let i=h(this,us).get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),h(this,us).delete(r),h(this,us).size===0&&k(this,us,null)},Ce._telemetryTimeout),h(this,us).set(r,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),k(this,zp,!1)}disable(){this.div&&(this.div.tabIndex=-1),k(this,zp,!0)}updateFakeAnnotationElement(e){if(!h(this,cs)&&!this.deleted){k(this,cs,e.addFakeAnnotation(this));return}if(this.deleted){h(this,cs).remove(),k(this,cs,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&h(this,cs).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let n=e.container.querySelector(".annotationContent");if(!n)n=document.createElement("div"),n.classList.add("annotationContent",this.editorType),e.container.prepend(n);else if(n.nodeName==="CANVAS"){const r=n;n=document.createElement("div"),n.classList.add("annotationContent",this.editorType),r.before(n)}return n}resetAnnotationElement(e){const{firstChild:n}=e.container;(n==null?void 0:n.nodeName)==="DIV"&&n.classList.contains("annotationContent")&&n.remove()}};Md=new WeakMap,Hs=new WeakMap,Dt=new WeakMap,gt=new WeakMap,Oo=new WeakMap,zp=new WeakMap,Sc=new WeakMap,ix=new WeakMap,Gn=new WeakMap,Rd=new WeakMap,Mo=new WeakMap,cs=new WeakMap,Ac=new WeakMap,sx=new WeakMap,Id=new WeakMap,bi=new WeakMap,ax=new WeakMap,Dd=new WeakMap,Ro=new WeakMap,Ma=new WeakMap,Wp=new WeakMap,Hp=new WeakMap,us=new WeakMap,$d=new WeakMap,ox=new WeakMap,LS=new WeakMap,Se=new WeakSet,o2=function([e,n],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/n,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},lx=new WeakSet,l2=function(e,n,r){switch(r){case 90:return[n,-e];case 180:return[-e,-n];case 270:return[-n,e];default:return[e,n]}},u1=function(e){switch(e){case 90:{const[n,r]=this.pageDimensions;return[0,-n/r,r/n,0]}case 180:return[-1,0,0,-1];case 270:{const[n,r]=this.pageDimensions;return[0,n/r,-r/n,0]}default:return[1,0,0,1]}},Fz=function(){if(h(this,Gn))return;k(this,Gn,document.createElement("div")),h(this,Gn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],n=this._uiManager._signal;for(const r of e){const i=document.createElement("div");h(this,Gn).append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",C(this,Se,Bz).bind(this,r),{signal:n}),i.addEventListener("contextmenu",Ps,{signal:n}),i.tabIndex=-1}this.div.prepend(h(this,Gn))},Bz=function(e,n){var d;n.preventDefault();const{isMac:r}=nr.platform;if(n.button!==0||n.ctrlKey&&r)return;(d=h(this,Dt))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,k(this,Rd,[n.screenX,n.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C(this,Se,u2).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",rn,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ps,{signal:a}),k(this,Mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(n.target).cursor;const u=()=>{var f;s.abort(),this.parent.togglePointerEvents(!0),(f=h(this,Dt))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,C(this,Se,d1).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},c2=function(e,n,r,i){this.width=r,this.height=i,this.x=e,this.y=n,this.setDims(),this.fixAndSetPosition(),this._onResized()},d1=function(){if(!h(this,Mo))return;const{savedX:e,savedY:n,savedWidth:r,savedHeight:i}=h(this,Mo);k(this,Mo,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===n&&o===r&&l===i||this.addCommands({cmd:C(this,Se,c2).bind(this,s,a,o,l),undo:C(this,Se,c2).bind(this,e,n,r,i),mustExec:!0})},u2=function(e,n){const[r,i]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,u=Ce.MIN_SIZE/r,d=Ce.MIN_SIZE/i,f=C(this,Se,u1).call(this,this.rotation),p=(F,z)=>[f[0]*F+f[2]*z,f[1]*F+f[3]*z],m=C(this,Se,u1).call(this,360-this.rotation),y=(F,z)=>[m[0]*F+m[2]*z,m[1]*F+m[3]*z];let g,v,b=!1,x=!1;switch(e){case"topLeft":b=!0,g=(F,z)=>[0,0],v=(F,z)=>[F,z];break;case"topMiddle":g=(F,z)=>[F/2,0],v=(F,z)=>[F/2,z];break;case"topRight":b=!0,g=(F,z)=>[F,0],v=(F,z)=>[0,z];break;case"middleRight":x=!0,g=(F,z)=>[F,z/2],v=(F,z)=>[0,z/2];break;case"bottomRight":b=!0,g=(F,z)=>[F,z],v=(F,z)=>[0,0];break;case"bottomMiddle":g=(F,z)=>[F/2,z],v=(F,z)=>[F/2,0];break;case"bottomLeft":b=!0,g=(F,z)=>[0,z],v=(F,z)=>[F,0];break;case"middleLeft":x=!0,g=(F,z)=>[0,z/2],v=(F,z)=>[F,z/2];break}const w=g(o,l),S=v(o,l);let _=p(...S);const A=Ce._round(s+_[0]),j=Ce._round(a+_[1]);let N=1,P=1,O,M;if(n.fromKeyboard)({deltaX:O,deltaY:M}=n);else{const{screenX:F,screenY:z}=n,[U,K]=h(this,Rd);[O,M]=this.screenToPageTranslation(F-U,z-K),h(this,Rd)[0]=F,h(this,Rd)[1]=z}if([O,M]=y(O/r,M/i),b){const F=Math.hypot(o,l);N=P=Math.max(Math.min(Math.hypot(S[0]-w[0]-O,S[1]-w[1]-M)/F,1/o,1/l),u/o,d/l)}else x?N=Pr(Math.abs(S[0]-w[0]-O),u,1)/o:P=Pr(Math.abs(S[1]-w[1]-M),d,1)/l;const R=Ce._round(o*N),I=Ce._round(l*P);_=p(...v(R,I));const L=A-_[0],W=j-_[1];h(this,bi)||k(this,bi,[this.x,this.y,this.width,this.height]),this.width=R,this.height=I,this.x=L,this.y=W,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Uz=function(){var e;k(this,Mo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=h(this,Dt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},zz=function(e,n,r){let s=.7*(r/n)+1-.7;if(s===1)return;const a=C(this,Se,u1).call(this,this.rotation),o=(A,j)=>[a[0]*A+a[2]*j,a[1]*A+a[3]*j],[l,u]=this.parentDimensions,d=this.x,f=this.y,p=this.width,m=this.height,y=Ce.MIN_SIZE/l,g=Ce.MIN_SIZE/u;s=Math.max(Math.min(s,1/p,1/m),y/p,g/m);const v=Ce._round(p*s),b=Ce._round(m*s);if(v===p&&b===m)return;h(this,bi)||k(this,bi,[d,f,p,m]);const x=o(p/2,m/2),w=Ce._round(d+x[0]),S=Ce._round(f+x[1]),_=o(v/2,b/2);this.x=w-_[0],this.y=S-_[1],this.width=v,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Wz=function(){var e;(e=h(this,Dt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),C(this,Se,d1).call(this)},d2=function(e){const{isMac:n}=nr.platform;e.ctrlKey&&!n||e.shiftKey||e.metaKey&&n?this.parent.toggleSelected(this):this.parent.setSelected(this)},Hz=function(e){const{isSelected:n}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},o=u=>{i.abort(),k(this,Sc,null),k(this,Id,!1),this._uiManager.endDragSession()||C(this,Se,d2).call(this,u),r&&this._onStopDragging()};n&&(k(this,Wp,e.clientX),k(this,Hp,e.clientY),k(this,Sc,e.pointerId),k(this,ix,e.pointerType),window.addEventListener("pointermove",u=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:f,pointerId:p}=u;if(p!==h(this,Sc)){rn(u);return}const[m,y]=this.screenToPageTranslation(d-h(this,Wp),f-h(this,Hp));k(this,Wp,d),k(this,Hp,f),this._uiManager.dragSelectedEditors(m,y)},a),window.addEventListener("touchmove",rn,a),window.addEventListener("pointerdown",u=>{u.pointerType===h(this,ix)&&(h(this,$d)||u.isPrimary)&&o(u),rn(u)},a));const l=u=>{if(!h(this,Sc)||h(this,Sc)===u.pointerId){o(u);return}rn(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},h2=function(){if(h(this,Ac)||!this.div)return;k(this,Ac,new AbortController);const e=this._uiManager.combinedSignal(h(this,Ac));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},qz=function(e){Ce._resizerKeyboardManager.exec(this,e)},Gz=function(e){var n;h(this,Ro)&&((n=e.relatedTarget)==null?void 0:n.parentNode)!==h(this,Gn)&&C(this,Se,Fy).call(this)},Kz=function(e){k(this,sx,h(this,Ro)?e:"")},f2=function(e){if(h(this,Hs))for(const n of h(this,Hs))n.tabIndex=e},Fy=function(){k(this,Ro,!1),C(this,Se,f2).call(this,-1),C(this,Se,d1).call(this)},E(Ce,lx),ae(Ce,"_l10n",null),ae(Ce,"_l10nResizer",null),ae(Ce,"_borderLineWidth",-1),ae(Ce,"_colorManager",new t2),ae(Ce,"_zIndex",1),ae(Ce,"_telemetryTimeout",1e3);let Nt=Ce;class eje extends Nt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const hF=3285377520,Ji=4294901760,ya=65535;class Vz{constructor(e){this.h1=e?e&4294967295:hF,this.h2=e?e&4294967295:hF}update(e){let n,r;if(typeof e=="string"){n=new Uint8Array(e.length*2),r=0;for(let g=0,v=e.length;g<v;g++){const b=e.charCodeAt(g);b<=255?n[r++]=b:(n[r++]=b>>>8,n[r++]=b&255)}}else if(ArrayBuffer.isView(e))n=e.slice(),r=n.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,a=new Uint32Array(n.buffer,0,i);let o=0,l=0,u=this.h1,d=this.h2;const f=3432918353,p=461845907,m=f&ya,y=p&ya;for(let g=0;g<i;g++)g&1?(o=a[g],o=o*f&Ji|o*m&ya,o=o<<15|o>>>17,o=o*p&Ji|o*y&ya,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[g],l=l*f&Ji|l*m&ya,l=l<<15|l>>>17,l=l*p&Ji|l*y&ya,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,s){case 3:o^=n[i*4+2]<<16;case 2:o^=n[i*4+1]<<8;case 1:o^=n[i*4],o=o*f&Ji|o*m&ya,o=o<<15|o>>>17,o=o*p&Ji|o*y&ya,i&1?u^=o:d^=o}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,n=this.h2;return e^=n>>>1,e=e*3981806797&Ji|e*36045&ya,n=n*4283543511&Ji|((n<<16|e>>>16)*2950163797&Ji)>>>16,e^=n>>>1,e=e*444984403&Ji|e*60499&ya,n=n*3301882366&Ji|((n<<16|e>>>16)*3120437893&Ji)>>>16,e^=n>>>1,(e>>>0).toString(16).padStart(8,"0")+(n>>>0).toString(16).padStart(8,"0")}}const p2=Object.freeze({map:null,hash:"",transfer:void 0});var Ld,Fd,Io,Kn,FS,Yz;class DO{constructor(){E(this,FS);E(this,Ld,!1);E(this,Fd,null);E(this,Io,null);E(this,Kn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,n){const r=h(this,Kn).get(e);return r===void 0?n:Object.assign(n,r)}getRawValue(e){return h(this,Kn).get(e)}remove(e){const n=h(this,Kn).get(e);if(n!==void 0&&(n instanceof Nt&&h(this,Io).delete(n.annotationElementId),h(this,Kn).delete(e),h(this,Kn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of h(this,Kn).values())if(r instanceof Nt)return;this.onAnnotationEditor(null)}}setValue(e,n){const r=h(this,Kn).get(e);let i=!1;if(r!==void 0)for(const[s,a]of Object.entries(n))r[s]!==a&&(i=!0,r[s]=a);else i=!0,h(this,Kn).set(e,n);i&&C(this,FS,Yz).call(this),n instanceof Nt&&((h(this,Io)||k(this,Io,new Map)).set(n.annotationElementId,n),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(n.constructor._type))}has(e){return h(this,Kn).has(e)}get size(){return h(this,Kn).size}resetModified(){h(this,Ld)&&(k(this,Ld,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Xz(this)}get serializable(){if(h(this,Kn).size===0)return p2;const e=new Map,n=new Vz,r=[],i=Object.create(null);let s=!1;for(const[a,o]of h(this,Kn)){const l=o instanceof Nt?o.serialize(!1,i):o;l&&(e.set(a,l),n.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:n.hexdigest(),transfer:r}:p2}get editorStats(){let e=null;const n=new Map;let r=0,i=0;for(const s of h(this,Kn).values()){if(!(s instanceof Nt)){s.popup&&(s.popup.deleted?i+=1:r+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(r+=1);const a=s.telemetryFinalData;if(!a)continue;const{type:o}=a;n.has(o)||n.set(o,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[u,d]of Object.entries(a)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const p=f.get(d)??0;f.set(d,p+1)}}if((i>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:r}),!e)return null;for(const[s,a]of n)e[s]=a.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){k(this,Fd,null)}updateEditor(e,n){var i;const r=(i=h(this,Io))==null?void 0:i.get(e);return r?(r.updateFromAnnotationLayer(n),!0):!1}getEditor(e){var n;return((n=h(this,Io))==null?void 0:n.get(e))||null}get modifiedIds(){if(h(this,Fd))return h(this,Fd);const e=[];if(h(this,Io))for(const n of h(this,Io).values())n.serialize()&&e.push(n.annotationElementId);return k(this,Fd,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return h(this,Kn).entries()}}Ld=new WeakMap,Fd=new WeakMap,Io=new WeakMap,Kn=new WeakMap,FS=new WeakSet,Yz=function(){h(this,Ld)||(k(this,Ld,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var cx;class Xz extends DO{constructor(n){super();E(this,cx);const{map:r,hash:i,transfer:s}=n.serializable,a=structuredClone(r,s?{transfer:s}:null);k(this,cx,{map:a,hash:i,transfer:s})}get print(){bt("Should not call PrintAnnotationStorage.print")}get serializable(){return h(this,cx)}get modifiedIds(){return Oe(this,"modifiedIds",{ids:new Set,hash:""})}}cx=new WeakMap;var qp;class tje{constructor({ownerDocument:e=globalThis.document,styleElement:n=null}){E(this,qp,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const n=this.styleElement.sheet;n.insertRule(e,n.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),h(this,qp).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:n,_inspectFont:r}){if(!(!e||h(this,qp).has(e.loadedName))){if(We(!n,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:a}=e,o=new FontFace(i,s,a);this.addNativeFontFace(o);try{await o.load(),h(this,qp).add(i),r==null||r(e)}catch{Ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}bt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Ne(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const n=e.createFontFaceRule();if(n){if(this.insertRule(n),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var n;const e=!!((n=this._document)!=null&&n.fonts);return Oe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Oe(this,"isSyncFontLoadingSupported",Cr||nr.platform.isFirefox)}_queueLoadingCallback(e){function n(){for(We(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:n,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Oe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,n){function r(S,_){return S.charCodeAt(_)<<24|S.charCodeAt(_+1)<<16|S.charCodeAt(_+2)<<8|S.charCodeAt(_+3)&255}function i(S,_,A,j){const N=S.substring(0,_),P=S.substring(_+A);return N+j+P}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function d(S,_){if(++u>30){Ne("Load test font never loaded."),_();return}if(l.font="30px "+S,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(d.bind(null,S,_))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,f.length,f);const y=16,g=1482184792;let v=r(p,y);for(s=0,a=f.length-3;s<a;s+=4)v=v-g+r(f,s)|0;s<f.length&&(v=v-g+r(f+"XXX",s)|0),p=i(p,y,4,IAe(v));const b=`url(data:font/opentype;base64,${btoa(p)});`,x=`@font-face {font-family:"${f}";src:${b}}`;this.insertRule(x);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const S of[e.loadedName,f]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=S,w.append(_)}this._document.body.append(w),d(f,()=>{w.remove(),n.complete()})}}qp=new WeakMap;var ct;class nje{constructor(e,n=null,r,i){E(this,ct);this.compiledGlyphs=Object.create(null),k(this,ct,e),this._inspectFont=n,r&&Object.assign(this,r),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var n;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(n=this._inspectFont)==null||n.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${fz(this.data)});`;let n;if(!this.cssFontInfo)n=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),n}getPathGenerator(e,n){if(this.compiledGlyphs[n]!==void 0)return this.compiledGlyphs[n];const r=this.loadedName+"_path_"+n;let i;try{i=e.get(r)}catch(a){Ne(`getPathGenerator - ignoring character: "${a}".`)}const s=gz(i);return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[n]=s}get black(){return h(this,ct).black}get bold(){return h(this,ct).bold}get disableFontFace(){return h(this,ct).disableFontFace??!1}get fontExtraProperties(){return h(this,ct).fontExtraProperties??!1}get isInvalidPDFjsFont(){return h(this,ct).isInvalidPDFjsFont}get isType3Font(){return h(this,ct).isType3Font}get italic(){return h(this,ct).italic}get missingFile(){return h(this,ct).missingFile}get remeasure(){return h(this,ct).remeasure}get vertical(){return h(this,ct).vertical}get ascent(){return h(this,ct).ascent}get defaultWidth(){return h(this,ct).defaultWidth}get descent(){return h(this,ct).descent}get bbox(){return h(this,ct).bbox}get fontMatrix(){return h(this,ct).fontMatrix}get fallbackName(){return h(this,ct).fallbackName}get loadedName(){return h(this,ct).loadedName}get mimetype(){return h(this,ct).mimetype}get name(){return h(this,ct).name}get data(){return h(this,ct).data}clearData(){h(this,ct).clearData()}get cssFontInfo(){return h(this,ct).cssFontInfo}get systemFontInfo(){return h(this,ct).systemFontInfo}get defaultVMetrics(){return h(this,ct).defaultVMetrics}}ct=new WeakMap;var Gp,Kp,ux,Vp,h1;const Jf=class Jf{constructor(e){E(this,Vp);E(this,Gp);E(this,Kp);E(this,ux);k(this,Gp,e),k(this,Kp,new DataView(h(this,Gp))),k(this,ux,new TextDecoder)}static write(e){const n=new TextEncoder,r={};let i=0;for(const u of Jf.strings){const d=n.encode(e[u]);r[u]=d,i+=4+d.length}const s=new ArrayBuffer(i),a=new Uint8Array(s),o=new DataView(s);let l=0;for(const u of Jf.strings){const d=r[u],f=d.length;o.setUint32(l,f),a.set(d,l+4),l+=4+f}return We(l===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}get fontFamily(){return C(this,Vp,h1).call(this,0)}get fontWeight(){return C(this,Vp,h1).call(this,1)}get italicAngle(){return C(this,Vp,h1).call(this,2)}};Gp=new WeakMap,Kp=new WeakMap,ux=new WeakMap,Vp=new WeakSet,h1=function(e){We(e<Jf.strings.length,"Invalid string index");let n=0;for(let i=0;i<e;i++)n+=h(this,Kp).getUint32(n)+4;const r=h(this,Kp).getUint32(n);return h(this,ux).decode(new Uint8Array(h(this,Gp),n+4,r))},ae(Jf,"strings",["fontFamily","fontWeight","italicAngle"]);let AS=Jf;var jc,Ra,Bd,Ud,By;const Zf=class Zf{constructor(e){E(this,Ud);E(this,jc);E(this,Ra);E(this,Bd);k(this,jc,e),k(this,Ra,new DataView(h(this,jc))),k(this,Bd,new TextDecoder)}static write(e){const n=new TextEncoder,r={};let i=0;for(const p of Zf.strings){const m=n.encode(e[p]);r[p]=m,i+=4+m.length}i+=4;let s,a,o=1+i;e.style&&(s=n.encode(e.style.style),a=n.encode(e.style.weight),o+=4+s.length+4+a.length);const l=new ArrayBuffer(o),u=new Uint8Array(l),d=new DataView(l);let f=0;d.setUint8(f++,e.guessFallback?1:0),d.setUint32(f,0),f+=4,i=0;for(const p of Zf.strings){const m=r[p],y=m.length;i+=4+y,d.setUint32(f,y),u.set(m,f+4),f+=4+y}return d.setUint32(f-i-4,i),e.style&&(d.setUint32(f,s.length),u.set(s,f+4),f+=4+s.length,d.setUint32(f,a.length),u.set(a,f+4),f+=4+a.length),We(f<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(f)}get guessFallback(){return h(this,Ra).getUint8(0)!==0}get css(){return C(this,Ud,By).call(this,0)}get loadedName(){return C(this,Ud,By).call(this,1)}get baseFontName(){return C(this,Ud,By).call(this,2)}get src(){return C(this,Ud,By).call(this,3)}get style(){let e=1;e+=4+h(this,Ra).getUint32(e);const n=h(this,Ra).getUint32(e),r=h(this,Bd).decode(new Uint8Array(h(this,jc),e+4,n));e+=4+n;const i=h(this,Ra).getUint32(e),s=h(this,Bd).decode(new Uint8Array(h(this,jc),e+4,i));return{style:r,weight:s}}};jc=new WeakMap,Ra=new WeakMap,Bd=new WeakMap,Ud=new WeakSet,By=function(e){We(e<Zf.strings.length,"Invalid string index");let n=5;for(let i=0;i<e;i++)n+=h(this,Ra).getUint32(n)+4;const r=h(this,Ra).getUint32(n);return h(this,Bd).decode(new Uint8Array(h(this,jc),n+4,r))},ae(Zf,"strings",["css","loadedName","baseFontName","src"]);let jS=Zf;var Yp,Xp,Qp,Jp,wi,Ia,dx,ut,en,$s,f1,Uy;const Te=class Te{constructor({data:e,extra:n}){E(this,en);E(this,Ia);E(this,dx);E(this,ut);k(this,Ia,e),k(this,dx,new TextDecoder),k(this,ut,new DataView(h(this,Ia))),n&&Object.assign(this,n)}get black(){return C(this,en,$s).call(this,0)}get bold(){return C(this,en,$s).call(this,1)}get disableFontFace(){return C(this,en,$s).call(this,2)}get fontExtraProperties(){return C(this,en,$s).call(this,3)}get isInvalidPDFjsFont(){return C(this,en,$s).call(this,4)}get isType3Font(){return C(this,en,$s).call(this,5)}get italic(){return C(this,en,$s).call(this,6)}get missingFile(){return C(this,en,$s).call(this,7)}get remeasure(){return C(this,en,$s).call(this,8)}get vertical(){return C(this,en,$s).call(this,9)}get ascent(){return C(this,en,f1).call(this,0)}get defaultWidth(){return C(this,en,f1).call(this,1)}get descent(){return C(this,en,f1).call(this,2)}get bbox(){let e=h(Te,Xp);if(h(this,ut).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<4;i++)r.push(h(this,ut).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=h(Te,Qp);if(h(this,ut).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<6;i++)r.push(h(this,ut).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=h(Te,Jp);if(h(this,ut).getUint8(e)===0)return;e+=1;const r=[];for(let i=0;i<3;i++)r.push(h(this,ut).getInt16(e,!0)),e+=2;return r}get fallbackName(){return C(this,en,Uy).call(this,0)}get loadedName(){return C(this,en,Uy).call(this,1)}get mimetype(){return C(this,en,Uy).call(this,2)}get name(){return C(this,en,Uy).call(this,3)}get data(){let e=h(Te,wi);const n=h(this,ut).getUint32(e);e+=4+n;const r=h(this,ut).getUint32(e);e+=4+r;const i=h(this,ut).getUint32(e);e+=4+i;const s=h(this,ut).getUint32(e);if(s!==0)return new Uint8Array(h(this,Ia),e+4,s)}clearData(){let e=h(Te,wi);const n=h(this,ut).getUint32(e);e+=4+n;const r=h(this,ut).getUint32(e);e+=4+r;const i=h(this,ut).getUint32(e);e+=4+i;const s=h(this,ut).getUint32(e);new Uint8Array(h(this,Ia),e+4,s).fill(0),h(this,ut).setUint32(e,0)}get cssFontInfo(){let e=h(Te,wi);const n=h(this,ut).getUint32(e);e+=4+n;const r=h(this,ut).getUint32(e);e+=4+r;const i=h(this,ut).getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(h(this,Ia),e+4,i)),new AS(s.buffer)}get systemFontInfo(){let e=h(Te,wi);const n=h(this,ut).getUint32(e);e+=4+n;const r=h(this,ut).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(h(this,Ia),e+4,r)),new jS(i.buffer)}static write(e){const n=e.systemFontInfo?jS.write(e.systemFontInfo):null,r=e.cssFontInfo?AS.write(e.cssFontInfo):null,i=new TextEncoder,s={};let a=0;for(const g of Te.strings)s[g]=i.encode(e[g]),a+=4+s[g].length;const o=h(Te,wi)+4+a+4+(n?n.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),u=new Uint8Array(l),d=new DataView(l);let f=0;const p=Te.bools.length;let m=0,y=0;for(let g=0;g<p;g++){const v=e[Te.bools[g]];m|=(v===void 0?0:v?2:1)<<y,y+=2,(y===8||g===p-1)&&(d.setUint8(f++,m),m=0,y=0)}We(f===h(Te,Yp),"FontInfo.write: Boolean properties offset mismatch");for(const g of Te.numbers)d.setFloat64(f,e[g]),f+=8;if(We(f===h(Te,Xp),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(f++,4);for(const g of e.bbox)d.setInt16(f,g,!0),f+=2}else d.setUint8(f++,0),f+=2*4;if(We(f===h(Te,Qp),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(f++,6);for(const g of e.fontMatrix)d.setFloat64(f,g,!0),f+=8}else d.setUint8(f++,0),f+=8*6;if(We(f===h(Te,Jp),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(f++,1);for(const g of e.defaultVMetrics)d.setInt16(f,g,!0),f+=2}else d.setUint8(f++,0),f+=3*2;We(f===h(Te,wi),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(h(Te,wi),0),f+=4;for(const g of Te.strings){const v=s[g],b=v.length;d.setUint32(f,b),u.set(v,f+4),f+=4+b}if(d.setUint32(h(Te,wi),f-h(Te,wi)-4),!n)d.setUint32(f,0),f+=4;else{const g=n.byteLength;d.setUint32(f,g),We(f+4+g<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(n),f+4),f+=4+g}if(!r)d.setUint32(f,0),f+=4;else{const g=r.byteLength;d.setUint32(f,g),We(f+4+g<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(r),f+4),f+=4+g}return e.data===void 0?(d.setUint32(f,0),f+=4):(d.setUint32(f,e.data.length),u.set(e.data,f+4),f+=4+e.data.length),We(f<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(f)}};Yp=new WeakMap,Xp=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,wi=new WeakMap,Ia=new WeakMap,dx=new WeakMap,ut=new WeakMap,en=new WeakSet,$s=function(e){We(e<Te.bools.length,"Invalid boolean index");const n=Math.floor(e/4),r=e*2%8,i=h(this,ut).getUint8(n)>>r&3;return i===0?void 0:i===2},f1=function(e){return We(e<Te.numbers.length,"Invalid number index"),h(this,ut).getFloat64(h(Te,Yp)+e*8)},Uy=function(e){We(e<Te.strings.length,"Invalid string index");let n=h(Te,wi)+4;for(let s=0;s<e;s++)n+=h(this,ut).getUint32(n)+4;const r=h(this,ut).getUint32(n),i=new Uint8Array(r);return i.set(new Uint8Array(h(this,Ia),n+4,r)),h(this,dx).decode(i)},ae(Te,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),ae(Te,"numbers",["ascent","defaultWidth","descent"]),ae(Te,"strings",["fallbackName","loadedName","mimetype","name"]),E(Te,Yp,Math.ceil(Te.bools.length*2/8)),E(Te,Xp,h(Te,Yp)+Te.numbers.length*8),E(Te,Qp,h(Te,Xp)+1+2*4),E(Te,Jp,h(Te,Qp)+1+8*6),E(Te,wi,h(Te,Jp)+1+2*3);let m2=Te;var hx,fx,px,mx,gx,yx,vx,xx;const _t=class _t{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let n,r=null,i=[],s=[],a=[],o=[],l=null,u=null;switch(e[0]){case"RadialAxial":n=e[1]==="axial"?1:2,r=e[2],a=e[3],n===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":n=3,l=e[1],i=e[2],s=e[3],o=e[4]||[],r=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const d=Math.floor(i.length/2),f=Math.floor(s.length/3),p=a.length,m=o.length;let y=0;for(const _ of o)y+=1,y=Math.ceil(y/4)*4,y+=4+_.coords.length*4,y+=4+_.colors.length*4,_.verticesPerRow!==void 0&&(y+=4);const g=20+d*8+f*3+p*8+(r?16:0)+(u?3:0)+y,v=new ArrayBuffer(g),b=new DataView(v),x=new Uint8Array(v);b.setUint8(h(_t,hx),n),b.setUint8(h(_t,fx),r?1:0),b.setUint8(h(_t,px),u?1:0),b.setUint8(h(_t,mx),l),b.setUint32(h(_t,gx),d,!0),b.setUint32(h(_t,yx),f,!0),b.setUint32(h(_t,vx),p,!0),b.setUint32(h(_t,xx),m,!0);let w=20;new Float32Array(v,w,d*2).set(i),w+=d*8,x.set(s,w),w+=f*3;for(const[_,A]of a)b.setFloat32(w,_,!0),w+=4,b.setUint32(w,parseInt(A.slice(1),16),!0),w+=4;if(r)for(const _ of r)b.setFloat32(w,_,!0),w+=4;u&&(x.set(u,w),w+=3);for(let _=0;_<o.length;_++){const A=o[_];b.setUint8(w,A.type),w+=1,w=Math.ceil(w/4)*4,b.setUint32(w,A.coords.length,!0),w+=4,new Int32Array(v,w,A.coords.length).set(A.coords),w+=A.coords.length*4,b.setUint32(w,A.colors.length,!0),w+=4,new Int32Array(v,w,A.colors.length).set(A.colors),w+=A.colors.length*4,A.verticesPerRow!==void 0&&(b.setUint32(w,A.verticesPerRow,!0),w+=4)}return v}getIR(){const e=this.view,n=this.data[h(_t,hx)],r=!!this.data[h(_t,fx)],i=!!this.data[h(_t,px)],s=e.getUint32(h(_t,gx),!0),a=e.getUint32(h(_t,yx),!0),o=e.getUint32(h(_t,vx),!0),l=e.getUint32(h(_t,xx),!0);let u=20;const d=new Float32Array(this.buffer,u,s*2);u+=s*8;const f=new Uint8Array(this.buffer,u,a*3);u+=a*3;const p=[];for(let v=0;v<o;++v){const b=e.getFloat32(u,!0);u+=4;const x=e.getUint32(u,!0);u+=4,p.push([b,`#${x.toString(16).padStart(6,"0")}`])}let m=null;if(r){m=[];for(let v=0;v<4;++v)m.push(e.getFloat32(u,!0)),u+=4}let y=null;i&&(y=new Uint8Array(this.buffer,u,3),u+=3);const g=[];for(let v=0;v<l;++v){const b=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const x=e.getUint32(u,!0);u+=4;const w=new Int32Array(this.buffer,u,x);u+=x*4;const S=e.getUint32(u,!0);u+=4;const _=new Int32Array(this.buffer,u,S);u+=S*4;const A={type:b,coords:w,colors:_};b===KC.LATTICE&&(A.verticesPerRow=e.getUint32(u,!0),u+=4),g.push(A)}if(n===1)return["RadialAxial","axial",m,p,Array.from(d.slice(0,2)),Array.from(d.slice(2,4)),null,null];if(n===2)return["RadialAxial","radial",m,p,[d[0],d[1]],[d[3],d[4]],d[2],d[5]];if(n===3){const v=this.data[h(_t,mx)];let b=null;if(d.length>0){let x=d[0],w=d[0],S=d[1],_=d[1];for(let A=0;A<d.length;A+=2){const j=d[A],N=d[A+1];x=x>j?j:x,S=S>N?N:S,w=w<j?j:w,_=_<N?N:_}b=[x,S,w,_]}return["Mesh",v,d,f,g,b,m,y]}throw new Error(`Unsupported pattern kind: ${n}`)}};hx=new WeakMap,fx=new WeakMap,px=new WeakMap,mx=new WeakMap,gx=new WeakMap,yx=new WeakMap,vx=new WeakMap,xx=new WeakMap,E(_t,hx,0),E(_t,fx,1),E(_t,px,2),E(_t,mx,3),E(_t,gx,4),E(_t,yx,8),E(_t,vx,12),E(_t,xx,16);let g2=_t;function rje(t){if(t instanceof URL)return t.href;if(typeof t=="string"){if(Cr)return t;const e=URL.parse(t,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function ije(t){if(Cr&&typeof Buffer<"u"&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if(typeof t=="string")return Wb(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||typeof t=="object"&&!isNaN(t==null?void 0:t.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Rw(t){if(typeof t!="string")return null;if(t.endsWith("/"))return t;throw new Error(`Invalid factory url: "${t}" must include trailing slash.`)}const y2=t=>typeof t=="object"&&Number.isInteger(t==null?void 0:t.num)&&t.num>=0&&Number.isInteger(t==null?void 0:t.gen)&&t.gen>=0,sje=t=>typeof t=="object"&&typeof(t==null?void 0:t.name)=="string",aje=BAe.bind(null,y2,sje);var Do,BS;class oje{constructor(){E(this,Do,new Map);E(this,BS,Promise.resolve())}postMessage(e,n){const r={data:structuredClone(e,n?{transfer:n}:null)};h(this,BS).then(()=>{for(const[i]of h(this,Do))i.call(this,r)})}addEventListener(e,n,r=null){let i=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Ne("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,n);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}h(this,Do).set(n,i)}removeEventListener(e,n){const r=h(this,Do).get(n);r==null||r(),h(this,Do).delete(n)}terminate(){for(const[,e]of h(this,Do))e==null||e();h(this,Do).clear()}}Do=new WeakMap,BS=new WeakMap;const Iw={DATA:1,ERROR:2},cn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function fF(){}function Gr(t){if(t instanceof vu||t instanceof VC||t instanceof sF||t instanceof bS||t instanceof Fk)return t;switch(t instanceof Error||typeof t=="object"&&t!==null||bt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new vu(t.message);case"InvalidPDFException":return new VC(t.message);case"PasswordException":return new sF(t.message,t.code);case"ResponseException":return new bS(t.message,t.status,t.missing);case"UnknownErrorException":return new Fk(t.message,t.details)}return new Fk(t.message,t.toString())}var Zp,Ss,Qz,Jz,Zz,p1;class zy{constructor(e,n,r){E(this,Ss);E(this,Zp,new AbortController);this.sourceName=e,this.targetName=n,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",C(this,Ss,Qz).bind(this),{signal:h(this,Zp).signal})}on(e,n){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=n}send(e,n,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:n},r)}sendWithPromise(e,n,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:n},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,n,r,i){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:n,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,l.postMessage({sourceName:a,targetName:o,stream:cn.PULL,streamId:s,desiredSize:u.desiredSize}),d.promise},cancel:u=>{We(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:cn.CANCEL,streamId:s,reason:Gr(u)}),d.promise}},r)}destroy(){var e;(e=h(this,Zp))==null||e.abort(),k(this,Zp,null)}}Zp=new WeakMap,Ss=new WeakSet,Qz=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){C(this,Ss,Zz).call(this,e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===Iw.DATA)i.resolve(e.data);else if(e.callback===Iw.ERROR)i.reject(Gr(e.reason));else throw new Error("Unexpected callback case");return}const n=this.actionHandler[e.action];if(!n)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(n,e.data).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:Iw.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:Iw.ERROR,callbackId:e.callbackId,reason:Gr(a)})});return}if(e.streamId){C(this,Ss,Jz).call(this,e);return}n(e.data)},Jz=function(e){const n=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,d=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:cn.ENQUEUE,streamId:n,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:cn.CLOSE,streamId:n}),delete a.streamSinks[n])},error(u){We(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:cn.ERROR,streamId:n,reason:Gr(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[n]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:cn.START_COMPLETE,streamId:n,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:cn.START_COMPLETE,streamId:n,reason:Gr(u)})})},Zz=function(e){const n=e.streamId,r=this.sourceName,i=e.sourceName,s=this.comObj,a=this.streamControllers[n],o=this.streamSinks[n];switch(e.stream){case cn.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Gr(e.reason));break;case cn.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Gr(e.reason));break;case cn.PULL:if(!o){s.postMessage({sourceName:r,targetName:i,stream:cn.PULL_COMPLETE,streamId:n,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||fF).then(function(){s.postMessage({sourceName:r,targetName:i,stream:cn.PULL_COMPLETE,streamId:n,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:cn.PULL_COMPLETE,streamId:n,reason:Gr(u)})});break;case cn.ENQUEUE:if(We(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case cn.CLOSE:if(We(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),C(this,Ss,p1).call(this,a,n);break;case cn.ERROR:We(a,"error should have stream controller"),a.controller.error(Gr(e.reason)),C(this,Ss,p1).call(this,a,n);break;case cn.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Gr(e.reason)),C(this,Ss,p1).call(this,a,n);break;case cn.CANCEL:if(!o)break;const l=Gr(e.reason);Promise.try(o.onCancel||fF,l).then(function(){s.postMessage({sourceName:r,targetName:i,stream:cn.CANCEL_COMPLETE,streamId:n,success:!0})},function(u){s.postMessage({sourceName:r,targetName:i,stream:cn.CANCEL_COMPLETE,streamId:n,reason:Gr(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[n];break;default:throw new Error("Unexpected stream case")}},p1=async function(e,n){var r,i,s;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(i=e.pullCall)==null?void 0:i.promise,(s=e.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[n]};var bx;class e9{constructor({enableHWA:e=!1}){E(this,bx,!1);k(this,bx,e)}create(e,n){if(e<=0||n<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,n);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!h(this,bx)})}}reset(e,n,r){if(!e.canvas)throw new Error("Canvas is not specified");if(n<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=n,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,n){bt("Abstract method `_createCanvas` called.")}}bx=new WeakMap;class lje extends e9{constructor({ownerDocument:e=globalThis.document,enableHWA:n=!1}){super({enableHWA:n}),this._document=e}_createCanvas(e,n){const r=this._document.createElement("canvas");return r.width=e,r.height=n,r}}class t9{constructor({baseUrl:e=null,isCompressed:n=!0}){this.baseUrl=e,this.isCompressed=n}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const n=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(n).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${n}`)})}async _fetch(e){bt("Abstract method `_fetch` called.")}}class pF extends t9{async _fetch(e){const n=await Hb(e,this.isCompressed?"arraybuffer":"text");return n instanceof ArrayBuffer?new Uint8Array(n):Wb(n)}}class n9{addFilter(e){return"none"}addHCMFilter(e,n){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,n,r,i,s){return"none"}destroy(e=!1){}}var zd,em,$o,Lo,fr,Wd,Hd,fe,cr,Wy,kf,m1,Nf,r9,v2,Ef,Hy,qy,x2,Gy;class cje extends n9{constructor({docId:n,ownerDocument:r=globalThis.document}){super();E(this,fe);E(this,zd);E(this,em);E(this,$o);E(this,Lo);E(this,fr);E(this,Wd);E(this,Hd,0);k(this,Lo,n),k(this,fr,r)}addFilter(n){if(!n)return"none";let r=h(this,fe,cr).get(n);if(r)return r;const[i,s,a]=C(this,fe,m1).call(this,n),o=n.length===1?i:`${i}${s}${a}`;if(r=h(this,fe,cr).get(o),r)return h(this,fe,cr).set(n,r),r;const l=`g_${h(this,Lo)}_transfer_map_${Vt(this,Hd)._++}`,u=C(this,fe,Nf).call(this,l);h(this,fe,cr).set(n,u),h(this,fe,cr).set(o,u);const d=C(this,fe,Ef).call(this,l);return C(this,fe,qy).call(this,i,s,a,d),u}addHCMFilter(n,r){var y;const i=`${n}-${r}`,s="base";let a=h(this,fe,Wy).get(s);if((a==null?void 0:a.key)===i||(a?((y=a.filter)==null||y.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},h(this,fe,Wy).set(s,a)),!n||!r))return a.url;const o=C(this,fe,Gy).call(this,n);n=ge.makeHexColor(...o);const l=C(this,fe,Gy).call(this,r);if(r=ge.makeHexColor(...l),h(this,fe,kf).style.color="",n==="#000000"&&r==="#ffffff"||n===r)return a.url;const u=new Array(256);for(let g=0;g<=255;g++){const v=g/255;u[g]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const d=u.join(","),f=`g_${h(this,Lo)}_hcm_filter`,p=a.filter=C(this,fe,Ef).call(this,f);C(this,fe,qy).call(this,d,d,d,p),C(this,fe,v2).call(this,p);const m=(g,v)=>{const b=o[g]/255,x=l[g]/255,w=new Array(v+1);for(let S=0;S<=v;S++)w[S]=b+S/v*(x-b);return w.join(",")};return C(this,fe,qy).call(this,m(0,5),m(1,5),m(2,5),p),a.url=C(this,fe,Nf).call(this,f),a.url}addAlphaFilter(n){let r=h(this,fe,cr).get(n);if(r)return r;const[i]=C(this,fe,m1).call(this,[n]),s=`alpha_${i}`;if(r=h(this,fe,cr).get(s),r)return h(this,fe,cr).set(n,r),r;const a=`g_${h(this,Lo)}_alpha_map_${Vt(this,Hd)._++}`,o=C(this,fe,Nf).call(this,a);h(this,fe,cr).set(n,o),h(this,fe,cr).set(s,o);const l=C(this,fe,Ef).call(this,a);return C(this,fe,x2).call(this,i,l),o}addLuminosityFilter(n){let r=h(this,fe,cr).get(n||"luminosity");if(r)return r;let i,s;if(n?([i]=C(this,fe,m1).call(this,[n]),s=`luminosity_${i}`):s="luminosity",r=h(this,fe,cr).get(s),r)return h(this,fe,cr).set(n,r),r;const a=`g_${h(this,Lo)}_luminosity_map_${Vt(this,Hd)._++}`,o=C(this,fe,Nf).call(this,a);h(this,fe,cr).set(n,o),h(this,fe,cr).set(s,o);const l=C(this,fe,Ef).call(this,a);return C(this,fe,r9).call(this,l),n&&C(this,fe,x2).call(this,i,l),o}addHighlightHCMFilter(n,r,i,s,a){var x;const o=`${r}-${i}-${s}-${a}`;let l=h(this,fe,Wy).get(n);if((l==null?void 0:l.key)===o||(l?((x=l.filter)==null||x.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},h(this,fe,Wy).set(n,l)),!r||!i))return l.url;const[u,d]=[r,i].map(C(this,fe,Gy).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[m,y]=[s,a].map(C(this,fe,Gy).bind(this));p<f&&([f,p,m,y]=[p,f,y,m]),h(this,fe,kf).style.color="";const g=(w,S,_)=>{const A=new Array(256),j=(p-f)/_,N=w/255,P=(S-w)/(255*_);let O=0;for(let M=0;M<=_;M++){const R=Math.round(f+M*j),I=N+M*P;for(let L=O;L<=R;L++)A[L]=I;O=R+1}for(let M=O;M<256;M++)A[M]=A[O-1];return A.join(",")},v=`g_${h(this,Lo)}_hcm_${n}_filter`,b=l.filter=C(this,fe,Ef).call(this,v);return C(this,fe,v2).call(this,b),C(this,fe,qy).call(this,g(m[0],y[0],5),g(m[1],y[1],5),g(m[2],y[2],5),b),l.url=C(this,fe,Nf).call(this,v),l.url}destroy(n=!1){var r,i,s,a;n&&((r=h(this,Wd))!=null&&r.size)||((i=h(this,$o))==null||i.parentNode.parentNode.remove(),k(this,$o,null),(s=h(this,em))==null||s.clear(),k(this,em,null),(a=h(this,Wd))==null||a.clear(),k(this,Wd,null),k(this,Hd,0))}}zd=new WeakMap,em=new WeakMap,$o=new WeakMap,Lo=new WeakMap,fr=new WeakMap,Wd=new WeakMap,Hd=new WeakMap,fe=new WeakSet,cr=function(){return h(this,em)||k(this,em,new Map)},Wy=function(){return h(this,Wd)||k(this,Wd,new Map)},kf=function(){if(!h(this,$o)){const n=h(this,fr).createElement("div"),{style:r}=n;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const i=h(this,fr).createElementNS(ho,"svg");i.setAttribute("width",0),i.setAttribute("height",0),k(this,$o,h(this,fr).createElementNS(ho,"defs")),n.append(i),i.append(h(this,$o)),h(this,fr).body.append(n)}return h(this,$o)},m1=function(n){if(n.length===1){const u=n[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=u[p]/255;const f=d.join(",");return[f,f,f]}const[r,i,s]=n,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=r[u]/255,o[u]=i[u]/255,l[u]=s[u]/255;return[a.join(","),o.join(","),l.join(",")]},Nf=function(n){if(h(this,zd)===void 0){k(this,zd,"");const r=h(this,fr).URL;r!==h(this,fr).baseURI&&(wj(r)?Ne('#createUrl: ignore "data:"-URL for performance reasons.'):k(this,zd,uz(r,"")))}return`url(${h(this,zd)}#${n})`},r9=function(n){const r=h(this,fr).createElementNS(ho,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),n.append(r)},v2=function(n){const r=h(this,fr).createElementNS(ho,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),n.append(r)},Ef=function(n){const r=h(this,fr).createElementNS(ho,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",n),h(this,fe,kf).append(r),r},Hy=function(n,r,i){const s=h(this,fr).createElementNS(ho,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),n.append(s)},qy=function(n,r,i,s){const a=h(this,fr).createElementNS(ho,"feComponentTransfer");s.append(a),C(this,fe,Hy).call(this,a,"feFuncR",n),C(this,fe,Hy).call(this,a,"feFuncG",r),C(this,fe,Hy).call(this,a,"feFuncB",i)},x2=function(n,r){const i=h(this,fr).createElementNS(ho,"feComponentTransfer");r.append(i),C(this,fe,Hy).call(this,i,"feFuncA",n)},Gy=function(n){return h(this,fe,kf).style.color=n,Gb(getComputedStyle(h(this,fe,kf)).getPropertyValue("color"))};class i9{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const n=`${this.baseUrl}${e}`;return this._fetch(n).catch(r=>{throw new Error(`Unable to load font data at: ${n}`)})}async _fetch(e){bt("Abstract method `_fetch` called.")}}class mF extends i9{async _fetch(e){const n=await Hb(e,"arraybuffer");return new Uint8Array(n)}}class s9{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const n=`${this.baseUrl}${e}`;return this._fetch(n).catch(r=>{throw new Error(`Unable to load wasm data at: ${n}`)})}async _fetch(e){bt("Abstract method `_fetch` called.")}}class gF extends s9{async _fetch(e){const n=await Hb(e,"arraybuffer");return new Uint8Array(n)}}Cr&&Ne("Please use the `legacy` build in Node.js environments.");async function $O(t){const n=await process.getBuiltinModule("fs").promises.readFile(t);return new Uint8Array(n)}class uje extends n9{}class dje extends e9{_createCanvas(e,n){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,n)}}class hje extends t9{async _fetch(e){return $O(e)}}class fje extends i9{async _fetch(e){return $O(e)}}class pje extends s9{async _fetch(e){return $O(e)}}const bf="__forcedDependency",{floor:yF,ceil:vF}=Math;function Dw(t,e,n,r,i,s){t[e*4+0]=Math.min(t[e*4+0],n),t[e*4+1]=Math.min(t[e*4+1],r),t[e*4+2]=Math.max(t[e*4+2],i),t[e*4+3]=Math.max(t[e*4+3],s)}const b2=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var tm,kc;class mje{constructor(e,n){E(this,tm);E(this,kc);k(this,tm,e),k(this,kc,n)}get length(){return h(this,tm).length}isEmpty(e){return h(this,tm)[e]===b2}minX(e){return h(this,kc)[e*4+0]/256}minY(e){return h(this,kc)[e*4+1]/256}maxX(e){return(h(this,kc)[e*4+2]+1)/256}maxY(e){return(h(this,kc)[e*4+3]+1)/256}}tm=new WeakMap,kc=new WeakMap;const $w=(t,e)=>{if(!t)return;let n=t.get(e);return n||(n={dependencies:new Set,isRenderingOperation:!1},t.set(e,n)),n};var Qr,Jr,qd,qs,Gd,Fo,rt,dt,Bo,Zr,wx,nm,Kd,Vd,Uo,pr,Da,_x,w2;class gje{constructor(e,n,r=!1){E(this,_x);E(this,Qr,{__proto__:null});E(this,Jr,{__proto__:null,transform:[],moveText:[],sameLineText:[],[bf]:[]});E(this,qd,new Map);E(this,qs,[]);E(this,Gd,[]);E(this,Fo,[[1,0,0,1,0,0]]);E(this,rt,[-1/0,-1/0,1/0,1/0]);E(this,dt,new Float64Array([1/0,1/0,-1/0,-1/0]));E(this,Bo,-1);E(this,Zr,new Set);E(this,wx,new Map);E(this,nm,new Map);E(this,Kd);E(this,Vd);E(this,Uo);E(this,pr);E(this,Da);k(this,Kd,e.width),k(this,Vd,e.height),C(this,_x,w2).call(this,n),r&&k(this,Da,new Map)}growOperationsCount(e){e>=h(this,pr).length&&C(this,_x,w2).call(this,e,h(this,pr))}save(e){return k(this,Qr,{__proto__:h(this,Qr)}),k(this,Jr,{__proto__:h(this,Jr),transform:{__proto__:h(this,Jr).transform},moveText:{__proto__:h(this,Jr).moveText},sameLineText:{__proto__:h(this,Jr).sameLineText},[bf]:{__proto__:h(this,Jr)[bf]}}),k(this,rt,{__proto__:h(this,rt)}),h(this,qs).push(e),this}restore(e){var i;const n=Object.getPrototypeOf(h(this,Qr));if(n===null)return this;k(this,Qr,n),k(this,Jr,Object.getPrototypeOf(h(this,Jr))),k(this,rt,Object.getPrototypeOf(h(this,rt)));const r=h(this,qs).pop();return r!==void 0&&((i=$w(h(this,Da),e))==null||i.dependencies.add(r),h(this,pr)[e]=h(this,pr)[r]),this}recordOpenMarker(e){return h(this,qs).push(e),this}getOpenMarker(){return h(this,qs).length===0?null:h(this,qs).at(-1)}recordCloseMarker(e){var r;const n=h(this,qs).pop();return n!==void 0&&((r=$w(h(this,Da),e))==null||r.dependencies.add(n),h(this,pr)[e]=h(this,pr)[n]),this}beginMarkedContent(e){return h(this,Gd).push(e),this}endMarkedContent(e){var r;const n=h(this,Gd).pop();return n!==void 0&&((r=$w(h(this,Da),e))==null||r.dependencies.add(n),h(this,pr)[e]=h(this,pr)[n]),this}pushBaseTransform(e){return h(this,Fo).push(ge.multiplyByDOMMatrix(h(this,Fo).at(-1),e.getTransform())),this}popBaseTransform(){return h(this,Fo).length>1&&h(this,Fo).pop(),this}recordSimpleData(e,n){return h(this,Qr)[e]=n,this}recordIncrementalData(e,n){return h(this,Jr)[e].push(n),this}resetIncrementalData(e,n){return h(this,Jr)[e].length=0,this}recordNamedData(e,n){return h(this,qd).set(e,n),this}recordSimpleDataFromNamed(e,n,r){h(this,Qr)[e]=h(this,qd).get(n)??r}recordFutureForcedDependency(e,n){return this.recordIncrementalData(bf,n),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const n of e)n in h(this,Qr)&&this.recordFutureForcedDependency(n,h(this,Qr)[n]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of h(this,Zr))this.recordFutureForcedDependency(bf,e);return this}resetBBox(e){return h(this,Bo)!==e&&(k(this,Bo,e),h(this,dt)[0]=1/0,h(this,dt)[1]=1/0,h(this,dt)[2]=-1/0,h(this,dt)[3]=-1/0),this}recordClipBox(e,n,r,i,s,a){const o=ge.multiplyByDOMMatrix(h(this,Fo).at(-1),n.getTransform()),l=[1/0,1/0,-1/0,-1/0];ge.axialAlignedBoundingBox([r,s,i,a],o,l);const u=ge.intersect(h(this,rt),l);return u?(h(this,rt)[0]=u[0],h(this,rt)[1]=u[1],h(this,rt)[2]=u[2],h(this,rt)[3]=u[3]):(h(this,rt)[0]=h(this,rt)[1]=1/0,h(this,rt)[2]=h(this,rt)[3]=-1/0),this}recordBBox(e,n,r,i,s,a){const o=h(this,rt);if(o[0]===1/0)return this;const l=ge.multiplyByDOMMatrix(h(this,Fo).at(-1),n.getTransform());if(o[0]===-1/0)return ge.axialAlignedBoundingBox([r,s,i,a],l,h(this,dt)),this;const u=[1/0,1/0,-1/0,-1/0];return ge.axialAlignedBoundingBox([r,s,i,a],l,u),h(this,dt)[0]=Math.min(h(this,dt)[0],Math.max(u[0],o[0])),h(this,dt)[1]=Math.min(h(this,dt)[1],Math.max(u[1],o[1])),h(this,dt)[2]=Math.max(h(this,dt)[2],Math.min(u[2],o[2])),h(this,dt)[3]=Math.max(h(this,dt)[3],Math.min(u[3],o[3])),this}recordCharacterBBox(e,n,r,i=1,s=0,a=0,o){const l=r.bbox;let u,d;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&h(this,nm).get(r),u!==!1&&(d=[0,0,0,0],ge.axialAlignedBoundingBox(l,r.fontMatrix,d),(i!==1||s!==0||a!==0)&&ge.scaleMinMax([i,0,0,-i,s,a],d),u)))return this.recordBBox(e,n,d[0],d[2],d[1],d[3]);if(!o)return this.recordFullPageBBox(e);const f=o();return l&&d&&u===void 0&&(u=d[0]<=s-f.actualBoundingBoxLeft&&d[2]>=s+f.actualBoundingBoxRight&&d[1]<=a-f.actualBoundingBoxAscent&&d[3]>=a+f.actualBoundingBoxDescent,h(this,nm).set(r,u),u)?this.recordBBox(e,n,d[0],d[2],d[1],d[3]):this.recordBBox(e,n,s-f.actualBoundingBoxLeft,s+f.actualBoundingBoxRight,a-f.actualBoundingBoxAscent,a+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return h(this,dt)[0]=Math.max(0,h(this,rt)[0]),h(this,dt)[1]=Math.max(0,h(this,rt)[1]),h(this,dt)[2]=Math.min(h(this,Kd),h(this,rt)[2]),h(this,dt)[3]=Math.min(h(this,Vd),h(this,rt)[3]),this}getSimpleIndex(e){return h(this,Qr)[e]}recordDependencies(e,n){const r=h(this,Zr),i=h(this,Qr),s=h(this,Jr);for(const a of n)a in h(this,Qr)?r.add(i[a]):a in s&&s[a].forEach(r.add,r);return this}recordNamedDependency(e,n){return h(this,qd).has(n)&&h(this,Zr).add(h(this,qd).get(n)),this}recordOperation(e,n=!1){if(this.recordDependencies(e,[bf]),h(this,Da)){const r=$w(h(this,Da),e),{dependencies:i}=r;h(this,Zr).forEach(i.add,i),h(this,qs).forEach(i.add,i),h(this,Gd).forEach(i.add,i),i.delete(e),r.isRenderingOperation=!0}if(h(this,Bo)===e){const r=yF(h(this,dt)[0]*256/h(this,Kd)),i=yF(h(this,dt)[1]*256/h(this,Vd)),s=vF(h(this,dt)[2]*256/h(this,Kd)),a=vF(h(this,dt)[3]*256/h(this,Vd));Dw(h(this,Uo),e,r,i,s,a);for(const o of h(this,Zr))o!==e&&Dw(h(this,Uo),o,r,i,s,a);for(const o of h(this,qs))o!==e&&Dw(h(this,Uo),o,r,i,s,a);for(const o of h(this,Gd))o!==e&&Dw(h(this,Uo),o,r,i,s,a);n||(h(this,Zr).clear(),k(this,Bo,-1))}return this}recordShowTextOperation(e,n=!1){const r=Array.from(h(this,Zr));this.recordOperation(e,n),this.recordIncrementalData("sameLineText",e);for(const i of r)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,n=!1){return h(this,Bo)===e&&(k(this,Bo,-1),h(this,rt)[0]=Math.max(h(this,rt)[0],h(this,dt)[0]),h(this,rt)[1]=Math.max(h(this,rt)[1],h(this,dt)[1]),h(this,rt)[2]=Math.min(h(this,rt)[2],h(this,dt)[2]),h(this,rt)[3]=Math.min(h(this,rt)[3],h(this,dt)[3]),n||h(this,Zr).clear()),this}_takePendingDependencies(){const e=h(this,Zr);return k(this,Zr,new Set),e}_extractOperation(e){const n=h(this,wx).get(e);return h(this,wx).delete(e),n}_pushPendingDependencies(e){for(const n of e)h(this,Zr).add(n)}take(){return h(this,nm).clear(),new mje(h(this,pr),h(this,Uo))}takeDebugMetadata(){return h(this,Da)}}Qr=new WeakMap,Jr=new WeakMap,qd=new WeakMap,qs=new WeakMap,Gd=new WeakMap,Fo=new WeakMap,rt=new WeakMap,dt=new WeakMap,Bo=new WeakMap,Zr=new WeakMap,wx=new WeakMap,nm=new WeakMap,Kd=new WeakMap,Vd=new WeakMap,Uo=new WeakMap,pr=new WeakMap,Da=new WeakMap,_x=new WeakSet,w2=function(e,n){const r=new ArrayBuffer(e*4);k(this,Uo,new Uint8ClampedArray(r)),k(this,pr,new Uint32Array(r)),n&&n.length>0?(h(this,pr).set(n),h(this,pr).fill(b2,n.length)):h(this,pr).fill(b2)};var yt,Qt,Gs,rm,im;const qO=class qO{constructor(e,n,r){E(this,yt);E(this,Qt);E(this,Gs);E(this,rm,0);E(this,im,0);if(e instanceof qO&&h(e,Gs)===!!r)return e;k(this,yt,e),k(this,Qt,n),k(this,Gs,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Vt(this,im)._++,h(this,yt).save(h(this,Qt)),this}restore(e){return h(this,im)>0&&(h(this,yt).restore(h(this,Qt)),Vt(this,im)._--),this}recordOpenMarker(e){return Vt(this,rm)._++,this}getOpenMarker(){return h(this,rm)>0?h(this,Qt):h(this,yt).getOpenMarker()}recordCloseMarker(e){return Vt(this,rm)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return h(this,yt).pushBaseTransform(e),this}popBaseTransform(){return h(this,yt).popBaseTransform(),this}recordSimpleData(e,n){return h(this,yt).recordSimpleData(e,h(this,Qt)),this}recordIncrementalData(e,n){return h(this,yt).recordIncrementalData(e,h(this,Qt)),this}resetIncrementalData(e,n){return h(this,yt).resetIncrementalData(e,h(this,Qt)),this}recordNamedData(e,n){return this}recordSimpleDataFromNamed(e,n,r){return h(this,yt).recordSimpleDataFromNamed(e,n,h(this,Qt)),this}recordFutureForcedDependency(e,n){return h(this,yt).recordFutureForcedDependency(e,h(this,Qt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return h(this,yt).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return h(this,yt).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return h(this,Gs)||h(this,yt).resetBBox(h(this,Qt)),this}recordClipBox(e,n,r,i,s,a){return h(this,Gs)||h(this,yt).recordClipBox(h(this,Qt),n,r,i,s,a),this}recordBBox(e,n,r,i,s,a){return h(this,Gs)||h(this,yt).recordBBox(h(this,Qt),n,r,i,s,a),this}recordCharacterBBox(e,n,r,i,s,a,o){return h(this,Gs)||h(this,yt).recordCharacterBBox(h(this,Qt),n,r,i,s,a,o),this}recordFullPageBBox(e){return h(this,Gs)||h(this,yt).recordFullPageBBox(h(this,Qt)),this}getSimpleIndex(e){return h(this,yt).getSimpleIndex(e)}recordDependencies(e,n){return h(this,yt).recordDependencies(h(this,Qt),n),this}recordNamedDependency(e,n){return h(this,yt).recordNamedDependency(h(this,Qt),n),this}recordOperation(e){return h(this,yt).recordOperation(h(this,Qt),!0),this}recordShowTextOperation(e){return h(this,yt).recordShowTextOperation(h(this,Qt),!0),this}bboxToClipBoxDropOperation(e){return h(this,Gs)||h(this,yt).bboxToClipBoxDropOperation(h(this,Qt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};yt=new WeakMap,Qt=new WeakMap,Gs=new WeakMap,rm=new WeakMap,im=new WeakMap;let kS=qO;const Zi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Jn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function _2(t,e){if(!e)return;const n=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],n,r),t.clip(i)}class LO{isModifyingCurrentTransform(){return!1}getPattern(){bt("Abstract method `getPattern` called.")}}class yje extends LO{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let n;this._type==="axial"?n=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)n.addColorStop(r[0],r[1]);return n}getPattern(e,n,r,i){let s;if(i===Jn.STROKE||i===Jn.FILL){const a=n.current.getClippedPathBoundingBox(i,zt(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=n.cachedCanvases.getCanvas("pattern",o,l),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),r=ge.transform(r,[1,0,0,1,a[0],a[1]]),d.transform(...n.baseTransform),this.matrix&&d.transform(...this.matrix),_2(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(r);s.setTransform(f)}else _2(e,this._bbox),s=this._createGradient(e);return s}}function zk(t,e,n,r,i,s,a,o){const l=e.coords,u=e.colors,d=t.data,f=t.width*4;let p;l[n+1]>l[r+1]&&(p=n,n=r,r=p,p=s,s=a,a=p),l[r+1]>l[i+1]&&(p=r,r=i,i=p,p=a,a=o,o=p),l[n+1]>l[r+1]&&(p=n,n=r,r=p,p=s,s=a,a=p);const m=(l[n]+e.offsetX)*e.scaleX,y=(l[n+1]+e.offsetY)*e.scaleY,g=(l[r]+e.offsetX)*e.scaleX,v=(l[r+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY;if(y>=x)return;const w=u[s],S=u[s+1],_=u[s+2],A=u[a],j=u[a+1],N=u[a+2],P=u[o],O=u[o+1],M=u[o+2],R=Math.round(y),I=Math.round(x);let L,W,F,z,U,K,H,Q;for(let B=R;B<=I;B++){if(B<v){const $=B<y?0:(y-B)/(y-v);L=m-(m-g)*$,W=w-(w-A)*$,F=S-(S-j)*$,z=_-(_-N)*$}else{let $;B>x?$=1:v===x?$=0:$=(v-B)/(v-x),L=g-(g-b)*$,W=A-(A-P)*$,F=j-(j-O)*$,z=N-(N-M)*$}let Y;B<y?Y=0:B>x?Y=1:Y=(y-B)/(y-x),U=m-(m-b)*Y,K=w-(w-P)*Y,H=S-(S-O)*Y,Q=_-(_-M)*Y;const ne=Math.round(Math.min(L,U)),V=Math.round(Math.max(L,U));let te=f*B+ne*4;for(let $=ne;$<=V;$++)Y=(L-$)/(L-U),Y<0?Y=0:Y>1&&(Y=1),d[te++]=W-(W-K)*Y|0,d[te++]=F-(F-H)*Y|0,d[te++]=z-(z-Q)*Y|0,d[te++]=255}}function vje(t,e,n){const r=e.coords,i=e.colors;let s,a;switch(e.type){case KC.LATTICE:const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,u=o-1;for(s=0;s<l;s++){let d=s*o;for(let f=0;f<u;f++,d++)zk(t,n,r[d],r[d+1],r[d+o],i[d],i[d+1],i[d+o]),zk(t,n,r[d+o+1],r[d+1],r[d+o],i[d+o+1],i[d+1],i[d+o])}break;case KC.TRIANGLES:for(s=0,a=r.length;s<a;s+=3)zk(t,n,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class xje extends LO{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,n,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),m=u/f,y=d/p,g={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/m,scaleY:1/y},v=f+2*2,b=p+2*2,x=r.getCanvas("mesh",v,b),w=x.context,S=w.createImageData(f,p);if(n){const A=S.data;for(let j=0,N=A.length;j<N;j+=4)A[j]=n[0],A[j+1]=n[1],A[j+2]=n[2],A[j+3]=255}for(const A of this._figures)vje(S,A,g);return w.putImageData(S,2,2),{canvas:x.canvas,offsetX:o-2*m,offsetY:l-2*y,scaleX:m,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,n,r,i){_2(e,this._bbox);const s=new Float32Array(2);if(i===Jn.SHADING)ge.singularValueDecompose2dScale(zt(e),s);else if(this.matrix){ge.singularValueDecompose2dScale(this.matrix,s);const[o,l]=s;ge.singularValueDecompose2dScale(n.baseTransform,s),s[0]*=o,s[1]*=l}else ge.singularValueDecompose2dScale(n.baseTransform,s);const a=this._createMeshCanvas(s,i===Jn.SHADING?null:this._background,n.cachedCanvases);return i!==Jn.SHADING&&(e.setTransform(...n.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class bje extends LO{getPattern(){return"hotpink"}}function wje(t){switch(t[0]){case"RadialAxial":return new yje(t);case"Mesh":return new xje(t);case"Dummy":return new bje}throw new Error(`Unknown IR type: ${t[0]}`)}const xF={COLORED:1,UNCOLORED:2},US=class US{constructor(e,n,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e,n){var K,H;const{bbox:r,operatorList:i,paintType:s,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:d}=this;u=Math.abs(u),d=Math.abs(d),bj("TilingType: "+a);const f=r[0],p=r[1],m=r[2],y=r[3],g=m-f,v=y-p,b=new Float32Array(2);ge.singularValueDecompose2dScale(this.matrix,b);const[x,w]=b;ge.singularValueDecompose2dScale(this.baseTransform,b);const S=x*b[0],_=w*b[1];let A=g,j=v,N=!1,P=!1;const O=Math.ceil(u*S),M=Math.ceil(d*_),R=Math.ceil(g*S),I=Math.ceil(v*_);O>=R?A=u:N=!0,M>=I?j=d:P=!0;const L=this.getSizeAndScale(A,this.ctx.canvas.width,S),W=this.getSizeAndScale(j,this.ctx.canvas.height,_),F=e.cachedCanvases.getCanvas("pattern",L.size,W.size),z=F.context,U=l.createCanvasGraphics(z,n);if(U.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(U,s,o),z.translate(-L.scale*f,-W.scale*p),U.transform(0,L.scale,0,0,W.scale,0,0),z.save(),(K=U.dependencyTracker)==null||K.save(),this.clipBbox(U,f,p,m,y),U.baseTransform=zt(U.ctx),U.executeOperatorList(i),U.endDrawing(),(H=U.dependencyTracker)==null||H.restore(),z.restore(),N||P){const Q=F.canvas;N&&(A=u),P&&(j=d);const B=this.getSizeAndScale(A,this.ctx.canvas.width,S),Y=this.getSizeAndScale(j,this.ctx.canvas.height,_),ne=B.size,V=Y.size,te=e.cachedCanvases.getCanvas("pattern-workaround",ne,V),$=te.context,q=N?Math.floor(g/u):0,G=P?Math.floor(v/d):0;for(let re=0;re<=q;re++)for(let Z=0;Z<=G;Z++)$.drawImage(Q,ne*re,V*Z,ne,V,0,0,ne,V);return{canvas:te.canvas,scaleX:B.scale,scaleY:Y.scale,offsetX:f,offsetY:p}}return{canvas:F.canvas,scaleX:L.scale,scaleY:W.scale,offsetX:f,offsetY:p}}getSizeAndScale(e,n,r){const i=Math.max(US.MAX_PATTERN_SIZE,n);let s=Math.ceil(e*r);return s>=i?s=i:r=s/e,{scale:r,size:s}}clipBbox(e,n,r,i,s){const a=i-n,o=s-r;e.ctx.rect(n,r,a,o),ge.axialAlignedBoundingBox([n,r,i,s],zt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,n,r){const i=e.ctx,s=e.current;switch(n){case xF.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;i.fillStyle=s.fillColor=a,i.strokeStyle=s.strokeColor=o;break;case xF.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new RAe(`Unsupported paint type: ${n}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,n,r,i,s){let a=r;i!==Jn.SHADING&&(a=ge.transform(a,n.baseTransform),this.matrix&&(a=ge.transform(a,this.matrix)));const o=this.createPatternCanvas(n,s);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(l),u}};ae(US,"MAX_PATTERN_SIZE",3e3);let S2=US;function _je({src:t,srcPos:e=0,dest:n,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=nr.isLittleEndian?4278190080:255,[l,u]=a?[s,o]:[o,s],d=r>>3,f=r&7,p=t.length;n=new Uint32Array(n.buffer);let m=0;for(let y=0;y<i;y++){for(const v=e+d;e<v;e++){const b=e<p?t[e]:255;n[m++]=b&128?u:l,n[m++]=b&64?u:l,n[m++]=b&32?u:l,n[m++]=b&16?u:l,n[m++]=b&8?u:l,n[m++]=b&4?u:l,n[m++]=b&2?u:l,n[m++]=b&1?u:l}if(f===0)continue;const g=e<p?t[e++]:255;for(let v=0;v<f;v++)n[m++]=g&1<<7-v?u:l}return{srcPos:e,destPos:m}}const bF=16,wF=100,Sje=15,_F=10,ri=16,Wk=new DOMMatrix,Fi=new Float32Array(2),Xf=new Float32Array([1/0,1/0,-1/0,-1/0]);function Aje(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(n,r){e.translate(n,r),this.__originalTranslate(n,r)},t.scale=function(n,r){e.scale(n,r),this.__originalScale(n,r)},t.transform=function(n,r,i,s,a,o){e.transform(n,r,i,s,a,o),this.__originalTransform(n,r,i,s,a,o)},t.setTransform=function(n,r,i,s,a,o){e.setTransform(n,r,i,s,a,o),this.__originalSetTransform(n,r,i,s,a,o)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(n){e.rotate(n),this.__originalRotate(n)},t.clip=function(n){e.clip(n),this.__originalClip(n)},t.moveTo=function(n,r){e.moveTo(n,r),this.__originalMoveTo(n,r)},t.lineTo=function(n,r){e.lineTo(n,r),this.__originalLineTo(n,r)},t.bezierCurveTo=function(n,r,i,s,a,o){e.bezierCurveTo(n,r,i,s,a,o),this.__originalBezierCurveTo(n,r,i,s,a,o)},t.rect=function(n,r,i,s){e.rect(n,r,i,s),this.__originalRect(n,r,i,s)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class jje{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,n,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,n,r)):(i=this.canvasFactory.create(n,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const n=this.cache[e];this.canvasFactory.destroy(n),delete this.cache[e]}}}function Lw(t,e,n,r,i,s,a,o,l,u){const[d,f,p,m,y,g]=zt(t);if(f===0&&p===0){const x=a*d+y,w=Math.round(x),S=o*m+g,_=Math.round(S),A=(a+l)*d+y,j=Math.abs(Math.round(A)-w)||1,N=(o+u)*m+g,P=Math.abs(Math.round(N)-_)||1;return t.setTransform(Math.sign(d),0,0,Math.sign(m),w,_),t.drawImage(e,n,r,i,s,0,0,j,P),t.setTransform(d,f,p,m,y,g),[j,P]}if(d===0&&m===0){const x=o*p+y,w=Math.round(x),S=a*f+g,_=Math.round(S),A=(o+u)*p+y,j=Math.abs(Math.round(A)-w)||1,N=(a+l)*f+g,P=Math.abs(Math.round(N)-_)||1;return t.setTransform(0,Math.sign(f),Math.sign(p),0,w,_),t.drawImage(e,n,r,i,s,0,0,P,j),t.setTransform(d,f,p,m,y,g),[P,j]}t.drawImage(e,n,r,i,s,a,o,l,u);const v=Math.hypot(d,f),b=Math.hypot(p,m);return[v*l,b*u]}class SF{constructor(e,n,r){ae(this,"alphaIsShape",!1);ae(this,"fontSize",0);ae(this,"fontSizeScale",1);ae(this,"textMatrix",null);ae(this,"textMatrixScale",1);ae(this,"fontMatrix",GC);ae(this,"leading",0);ae(this,"x",0);ae(this,"y",0);ae(this,"lineX",0);ae(this,"lineY",0);ae(this,"charSpacing",0);ae(this,"wordSpacing",0);ae(this,"textHScale",1);ae(this,"textRenderingMode",Hn.FILL);ae(this,"textRise",0);ae(this,"fillColor","#000000");ae(this,"strokeColor","#000000");ae(this,"patternFill",!1);ae(this,"patternStroke",!1);ae(this,"fillAlpha",1);ae(this,"strokeAlpha",1);ae(this,"lineWidth",1);ae(this,"activeSMask",null);ae(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,n]),this.minMax=Xf.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Jn.FILL,n=null){const r=this.minMax.slice();if(e===Jn.STROKE){n||bt("Stroke bounding box must include transform."),ge.singularValueDecompose2dScale(n,Fi);const i=Fi[0]*this.lineWidth/2,s=Fi[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const e=ge.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Xf,0)}getClippedPathBoundingBox(e=Jn.FILL,n=null){return ge.intersect(this.clipBox,this.getPathBoundingBox(e,n))}}function AF(t,e){if(e instanceof ImageData){t.putImageData(e,0,0);return}const n=e.height,r=e.width,i=n%ri,s=(n-i)/ri,a=i===0?s:s+1,o=t.createImageData(r,ri);let l=0,u;const d=e.data,f=o.data;let p,m,y,g;if(e.kind===s1.GRAYSCALE_1BPP){const v=d.byteLength,b=new Uint32Array(f.buffer,0,f.byteLength>>2),x=b.length,w=r+7>>3,S=4294967295,_=nr.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(y=p<s?ri:i,u=0,m=0;m<y;m++){const A=v-l;let j=0;const N=A>w?r:A*8-7,P=N&-8;let O=0,M=0;for(;j<P;j+=8)M=d[l++],b[u++]=M&128?S:_,b[u++]=M&64?S:_,b[u++]=M&32?S:_,b[u++]=M&16?S:_,b[u++]=M&8?S:_,b[u++]=M&4?S:_,b[u++]=M&2?S:_,b[u++]=M&1?S:_;for(;j<N;j++)O===0&&(M=d[l++],O=128),b[u++]=M&O?S:_,O>>=1}for(;u<x;)b[u++]=0;t.putImageData(o,0,p*ri)}}else if(e.kind===s1.RGBA_32BPP){for(m=0,g=r*ri*4,p=0;p<s;p++)f.set(d.subarray(l,l+g)),l+=g,t.putImageData(o,0,m),m+=ri;p<a&&(g=r*i*4,f.set(d.subarray(l,l+g)),t.putImageData(o,0,m))}else if(e.kind===s1.RGB_24BPP)for(y=ri,g=r*y,p=0;p<a;p++){for(p>=s&&(y=i,g=r*y),u=0,m=g;m--;)f[u++]=d[l++],f[u++]=d[l++],f[u++]=d[l++],f[u++]=255;t.putImageData(o,0,p*ri)}else throw new Error(`bad image kind: ${e.kind}`)}function jF(t,e){if(e.bitmap){t.drawImage(e.bitmap,0,0);return}const n=e.height,r=e.width,i=n%ri,s=(n-i)/ri,a=i===0?s:s+1,o=t.createImageData(r,ri);let l=0;const u=e.data,d=o.data;for(let f=0;f<a;f++){const p=f<s?ri:i;({srcPos:l}=_je({src:u,srcPos:l,dest:d,width:r,height:p,nonBlackColor:0})),t.putImageData(o,0,f*ri)}}function _y(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of n)t[r]!==void 0&&(e[r]=t[r]);t.setLineDash!==void 0&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function Fw(t){t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",t.setLineDash!==void 0&&(t.setLineDash([]),t.lineDashOffset=0);const{filter:e}=t;e!=="none"&&e!==""&&(t.filter="none")}function kF(t,e){if(e)return!0;ge.singularValueDecompose2dScale(t,Fi);const n=Math.fround(io.pixelRatio*xu.PDF_TO_CSS_UNITS);return Fi[0]<=n&&Fi[1]<=n}const kje=["butt","round","square"],Nje=["miter","round","bevel"],Eje={},NF={};var fa,A2,j2,k2;const GO=class GO{constructor(e,n,r,i,s,{optionalContentConfig:a,markedContentStack:o=null},l,u,d){E(this,fa);this.ctx=e,this.current=new SF(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new jje(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,n,r=null){var i;return typeof n=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,n),n.startsWith("g_")?this.commonObjs.get(n):this.objs.get(n)):r}beginDrawing({transform:e,viewport:n,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...zt(this.compositeCtx))}this.ctx.save(),Fw(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=zt(this.ctx)}executeOperatorList(e,n,r,i,s){var b;const a=e.argsArray,o=e.fnArray;let l=n||0;const u=a.length;if(u===l)return l;const d=u-l>_F&&typeof r=="function",f=d?Date.now()+Sje:0;let p=0;const m=this.commonObjs,y=this.objs;let g,v;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(!s||s(l))if(g=o[l],v=a[l]??null,g!==Nv.dependency)v===null?this[g](l):this[g](l,...v);else for(const x of v){(b=this.dependencyTracker)==null||b.recordNamedData(x,l);const w=x.startsWith("g_")?m:y;if(!w.has(x))return w.get(x,r),l}if(l++,l===u)return l;if(d&&++p>_F){if(Date.now()>f)return r(),l;p=0}}}endDrawing(){C(this,fa,A2).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const n of e.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);e.clear()}this._cachedBitmapsMap.clear(),C(this,fa,j2).call(this)}_scaleImage(e,n){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(n[0],n[1]),1),a=Math.max(Math.hypot(n[2],n[3]),1),o=r,l=i,u="prescale1",d,f;for(;s>2&&o>1||a>2&&l>1;){let p=o,m=l;s>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/p),a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/m),d=this.cachedCanvases.getCanvas(u,p,m),f=d.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,o,l,0,0,p,m),e=d.canvas,o=p,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,n){var O,M;const r=this.ctx,{width:i,height:s}=n,a=this.current.fillColor,o=this.current.patternFill,l=zt(r);let u,d,f,p;if((n.bitmap||n.data)&&n.count>1){const R=n.bitmap||n.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),a]),u=this._cachedBitmapsMap.get(R),u||(u=new Map,this._cachedBitmapsMap.set(R,u));const I=u.get(d);if(I&&!o){const L=Math.round(Math.min(l[0],l[2])+l[4]),W=Math.round(Math.min(l[1],l[3])+l[5]);return(O=this.dependencyTracker)==null||O.recordDependencies(e,Zi.transformAndFill),{canvas:I,offsetX:L,offsetY:W}}f=I}f||(p=this.cachedCanvases.getCanvas("maskCanvas",i,s),jF(p.context,n));let m=ge.transform(l,[1/i,0,0,-1/s,0,0]);m=ge.transform(m,[1,0,0,1,0,-s]);const y=Xf.slice();ge.axialAlignedBoundingBox([0,0,i,s],m,y);const[g,v,b,x]=y,w=Math.round(b-g)||1,S=Math.round(x-v)||1,_=this.cachedCanvases.getCanvas("fillCanvas",w,S),A=_.context,j=g,N=v;A.translate(-j,-N),A.transform(...m),f||(f=this._scaleImage(p.canvas,ga(A)),f=f.img,u&&o&&u.set(d,f)),A.imageSmoothingEnabled=kF(zt(A),n.interpolate),Lw(A,f,0,0,f.width,f.height,0,0,i,s),A.globalCompositeOperation="source-in";const P=ge.transform(ga(A),[1,0,0,1,-j,-N]);return A.fillStyle=o?a.getPattern(r,this,P,Jn.FILL,e):a,A.fillRect(0,0,i,s),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(d,_.canvas)),(M=this.dependencyTracker)==null||M.recordDependencies(e,Zi.transformAndFill),{canvas:_.canvas,offsetX:Math.round(j),offsetY:Math.round(N)}}setLineWidth(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),n!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=n,this.ctx.lineWidth=n}setLineCap(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=kje[n]}setLineJoin(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=Nje[n]}setMiterLimit(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=n}setDash(e,n,r){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(n),i.lineDashOffset=r)}setRenderingIntent(e,n){}setFlatness(e,n){}setGState(e,n){var r,i,s,a,o;for(const[l,u]of n)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(s=this.dependencyTracker)==null||s.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const n=this.ctx.canvas.width,r=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,n,r);this.suspendedCtx=this.ctx;const a=this.ctx=s.context;a.setTransform(this.suspendedCtx.getTransform()),_y(this.suspendedCtx,a),Aje(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),_y(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,n,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,n,r,i){const s=i[0],a=i[1],o=i[2]-s,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(n.context,r,o,l,n.subtype,n.backdrop,n.transferMap,s,a,n.offsetX,n.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,n,r,i,s,a,o,l,u,d,f){let p=e.canvas,m=l-d,y=u-f;if(a)if(m<0||y<0||m+r>p.width||y+i>p.height){const v=this.cachedCanvases.getCanvas("maskExtension",r,i),b=v.context;b.drawImage(p,-m,-y),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,r,i),b.globalCompositeOperation="source-over",p=v.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(m,y,r,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(m,y,r,i),e.restore()}n.save(),n.globalAlpha=1,n.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?n.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(n.filter=this.filterFactory.addLuminosityFilter(o));const g=new Path2D;g.rect(l,u,r,i),n.clip(g),n.globalCompositeOperation="destination-in",n.drawImage(p,m,y,r,i,l,u,r,i),n.restore()}save(e){var r;this.inSMaskMode&&_y(this.ctx,this.suspendedCtx),this.ctx.save();const n=this.current;this.stateStack.push(n),this.current=n.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var n;if((n=this.dependencyTracker)==null||n.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&_y(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,n,r,i,s,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(n,r,i,s,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,n,r,i){let[s]=r;if(!i){s||(s=r[0]=new Path2D),this[n](e,s);return}if(this.dependencyTracker!==null){const a=n===Nv.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}s instanceof Path2D||(s=r[0]=gz(s)),ge.axialAlignedBoundingBox(i,zt(this.ctx),this.current.minMax),this[n](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,n,r=!0){var a;const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const o=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,ga(i),Jn.STROKE,e),o){const l=new Path2D;l.addPath(n,i.getTransform().invertSelf().multiplySelf(o)),n=l}this.rescaleAndStroke(n,!1),i.restore()}else this.rescaleAndStroke(n,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,Zi.stroke),r&&this.consumePath(e,n,this.current.getClippedPathBoundingBox(Jn.STROKE,zt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,n){this.stroke(e,n)}fill(e,n,r=!0){var u,d,f;const i=this.ctx,s=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const p=s.isModifyingCurrentTransform()?i.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),i.save(),i.fillStyle=s.getPattern(i,this,ga(i),Jn.FILL,e),p){const m=new Path2D;m.addPath(n,i.getTransform().invertSelf().multiplySelf(p)),n=m}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(n,"evenodd"),this.pendingEOFill=!1):i.fill(n)),(d=this.dependencyTracker)==null||d.recordDependencies(e,Zi.fill),o&&(i.restore(),(f=this.dependencyTracker)==null||f.restore(e)),r&&this.consumePath(e,n,l)}eoFill(e,n){this.pendingEOFill=!0,this.fill(e,n)}fillStroke(e,n){this.fill(e,n,!1),this.stroke(e,n,!1),this.consumePath(e,n)}eoFillStroke(e,n){this.pendingEOFill=!0,this.fillStroke(e,n)}closeFillStroke(e,n){this.fillStroke(e,n)}closeEOFillStroke(e,n){this.pendingEOFill=!0,this.fillStroke(e,n)}endPath(e,n){this.consumePath(e,n)}rawFillPath(e,n){var r;this.ctx.fill(n),(r=this.dependencyTracker)==null||r.recordDependencies(e,Zi.rawFillPath).recordOperation(e)}clip(e){var n;(n=this.dependencyTracker)==null||n.recordFutureForcedDependency("clipMode",e),this.pendingClip=Eje}eoClip(e){var n;(n=this.dependencyTracker)==null||n.recordFutureForcedDependency("clipMode",e),this.pendingClip=NF}beginText(e){var n;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(n=this.dependencyTracker)==null||n.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const n=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;n!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(n!==void 0){const i=new Path2D,s=r.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:u,path:d}of n)d&&i.addPath(d,new DOMMatrix(a).preMultiplySelf(s).translate(o,l).scale(u,-u));r.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=n}setWordSpacing(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=n}setHScale(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=n/100}setLeading(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-n}setFont(e,n,r){var f,p;(f=this.dependencyTracker)==null||f.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",n,e);const i=this.commonObjs.get(n),s=this.current;if(!i)throw new Error(`Can't find font for ${n}`);if(s.fontMatrix=i.fontMatrix||GC,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ne("Invalid font matrix for font "+n),r<0?(r=-r,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=r,i.isType3Font)return;const a=i.loadedName||"sans-serif",o=((p=i.systemFontInfo)==null?void 0:p.css)||`"${a}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let d=r;r<bF?d=bF:r>wF&&(d=wF),this.current.fontSizeScale=r/d,this.ctx.font=`${u} ${l} ${d}px ${o}`}setTextRenderingMode(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=n}setTextRise(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=n}moveText(e,n,r){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=n,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,n,r){this.setLeading(e,-r),this.moveText(e,n,r)}setTextMatrix(e,n){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=n,r.textMatrixScale=Math.hypot(n[0],n[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var n;this.moveText(e,0,this.current.leading),(n=this.dependencyTracker)==null||n.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,n,r,i,s,a){var b,x,w,S;const o=this.ctx,l=this.current,u=l.font,d=l.textRenderingMode,f=l.fontSize/l.fontSizeScale,p=d&Hn.FILL_STROKE_MASK,m=!!(d&Hn.ADD_TO_PATH_FLAG),y=l.patternFill&&!u.missingFile,g=l.patternStroke&&!u.missingFile;let v;if((u.disableFontFace||m||y||g)&&!u.missingFile&&(v=u.getPathGenerator(this.commonObjs,n)),v&&(u.disableFontFace||y||g)){o.save(),o.translate(r,i),o.scale(f,-f),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,u);let _;if(p===Hn.FILL||p===Hn.FILL_STROKE)if(s){_=o.getTransform(),o.setTransform(...s);const A=C(this,fa,k2).call(this,v,_,s);o.fill(A)}else o.fill(v);if(p===Hn.STROKE||p===Hn.FILL_STROKE)if(a){_||(_=o.getTransform()),o.setTransform(...a);const{a:A,b:j,c:N,d:P}=_,O=ge.inverseTransform(a),M=ge.transform([A,j,N,P,0,0],O);ge.singularValueDecompose2dScale(M,Fi),o.lineWidth*=Math.max(Fi[0],Fi[1])/f,o.stroke(C(this,fa,k2).call(this,v,_,a))}else o.lineWidth/=f,o.stroke(v);o.restore()}else(p===Hn.FILL||p===Hn.FILL_STROKE)&&(o.fillText(n,r,i),(x=this.dependencyTracker)==null||x.recordCharacterBBox(e,o,u,f,r,i,()=>o.measureText(n))),(p===Hn.STROKE||p===Hn.FILL_STROKE)&&(this.dependencyTracker&&((w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,u,f,r,i,()=>o.measureText(n)).recordDependencies(e,Zi.stroke)),o.strokeText(n,r,i));m&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:zt(o),x:r,y:i,fontSize:f,path:v}),(S=this.dependencyTracker)==null||S.recordCharacterBBox(e,o,u,f,r,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const n=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<n.length;i+=4)if(n[i]>0&&n[i]<255){r=!0;break}return Oe(this,"isFontSubpixelAAEnabled",r)}showText(e,n){var N,P,O,M;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Zi.showText).resetBBox(e),this.current.textRenderingMode&Hn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,i=r.font;if(i.isType3Font){this.showType3Text(e,n),(N=this.dependencyTracker)==null||N.recordShowTextOperation(e);return}const s=r.fontSize;if(s===0){(P=this.dependencyTracker)==null||P.recordOperation(e);return}const a=this.ctx,o=r.fontSizeScale,l=r.charSpacing,u=r.wordSpacing,d=r.fontDirection,f=r.textHScale*d,p=n.length,m=i.vertical,y=m?1:-1,g=i.defaultVMetrics,v=s*r.fontMatrix[0],b=r.textRenderingMode===Hn.FILL&&!i.disableFontFace&&!r.patternFill;a.save(),r.textMatrix&&a.transform(...r.textMatrix),a.translate(r.x,r.y+r.textRise),d>0?a.scale(f,-1):a.scale(f,1);let x,w;if(r.patternFill){a.save();const R=r.fillColor.getPattern(a,this,ga(a),Jn.FILL,e);x=zt(a),a.restore(),a.fillStyle=R}if(r.patternStroke){a.save();const R=r.strokeColor.getPattern(a,this,ga(a),Jn.STROKE,e);w=zt(a),a.restore(),a.strokeStyle=R}let S=r.lineWidth;const _=r.textMatrixScale;if(_===0||S===0){const R=r.textRenderingMode&Hn.FILL_STROKE_MASK;(R===Hn.STROKE||R===Hn.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=_;if(o!==1&&(a.scale(o,o),S/=o),a.lineWidth=S,i.isInvalidPDFjsFont){const R=[];let I=0;for(const W of n)R.push(W.unicode),I+=W.width;const L=R.join("");if(a.fillText(L,0,0),this.dependencyTracker!==null){const W=a.measureText(L);this.dependencyTracker.recordBBox(e,this.ctx,-W.actualBoundingBoxLeft,W.actualBoundingBoxRight,-W.actualBoundingBoxAscent,W.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=I*v*f,a.restore(),this.compose();return}let A=0,j;for(j=0;j<p;++j){const R=n[j];if(typeof R=="number"){A+=y*R*s/1e3;continue}let I=!1;const L=(R.isSpace?u:0)+l,W=R.fontChar,F=R.accent;let z,U,K=R.width;if(m){const B=R.vmetric||g,Y=-(R.vmetric?B[1]:K*.5)*v,ne=B[2]*v;K=B?-B[0]:K,z=Y/o,U=(A+ne)/o}else z=A/o,U=0;let H;if(i.remeasure&&K>0){H=a.measureText(W);const B=H.width*1e3/s*o;if(K<B&&this.isFontSubpixelAAEnabled){const Y=K/B;I=!0,a.save(),a.scale(Y,1),z/=Y}else K!==B&&(z+=(K-B)/2e3*s/o)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(b&&!F)a.fillText(W,z,U),(O=this.dependencyTracker)==null||O.recordCharacterBBox(e,a,H?{bbox:null}:i,s/o,z,U,()=>H??a.measureText(W));else if(this.paintChar(e,W,z,U,x,w),F){const B=z+s*F.offset.x/o,Y=U-s*F.offset.y/o;this.paintChar(e,F.fontChar,B,Y,x,w)}}const Q=m?K*v-L*d:K*v+L*d;A+=Q,I&&a.restore()}m?r.y-=A:r.x+=A*f,a.restore(),this.compose(),(M=this.dependencyTracker)==null||M.recordShowTextOperation(e)}showType3Text(e,n){const r=this.ctx,i=this.current,s=i.font,a=i.fontSize,o=i.fontDirection,l=s.vertical?1:-1,u=i.charSpacing,d=i.wordSpacing,f=i.textHScale*o,p=i.fontMatrix||GC,m=n.length,y=i.textRenderingMode===Hn.INVISIBLE;let g,v,b,x;if(y||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),r.scale(f,o);const w=this.dependencyTracker;for(this.dependencyTracker=w?new kS(w,e):null,g=0;g<m;++g){if(v=n[g],typeof v=="number"){x=l*v*a/1e3,this.ctx.translate(x,0),i.x+=x*f;continue}const S=(v.isSpace?d:0)+u,_=s.charProcOperatorList[v.operatorListId];_?this.contentVisible&&(this.save(),r.scale(a,a),r.transform(...p),this.executeOperatorList(_),this.restore()):Ne(`Type3 character "${v.operatorListId}" is not available.`);const A=[v.width,0];ge.applyTransform(A,p),b=A[0]*a+S,r.translate(b,0),i.x+=b*f}r.restore(),w&&(this.dependencyTracker=w)}setCharWidth(e,n,r){}setCharWidthAndBounds(e,n,r,i,s,a,o){var u;const l=new Path2D;l.rect(i,s,a-i,o-s),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,i,a,s,o).recordClipBox(e,this.ctx,i,a,s,o),this.endPath(e)}getColorN_Pattern(e,n){let r;if(n[0]==="TilingPattern"){const i=this.baseTransform||zt(this.ctx),s={createCanvasGraphics:(a,o)=>new GO(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new kS(this.dependencyTracker,o,!0):null)};r=new S2(n,this.ctx,s,i)}else r=this._getPattern(e,n[1],n[2]);return r}setStrokeColorN(e,...n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,n),this.current.patternStroke=!0}setFillColorN(e,...n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,n),this.current.patternFill=!0}setStrokeRGBColor(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=n,this.current.patternStroke=!1}setStrokeTransparent(e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,n){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=n,this.current.patternFill=!1}setFillTransparent(e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,n,r=null){let i;return this.cachedPatterns.has(n)?i=this.cachedPatterns.get(n):(i=wje(this.getObject(e,n)),this.cachedPatterns.set(n,i)),r&&(i.matrix=r),i}shadingFill(e,n){var a;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const i=this._getPattern(e,n);r.fillStyle=i.getPattern(r,this,ga(r),Jn.SHADING,e);const s=ga(r);if(s){const{width:o,height:l}=r.canvas,u=Xf.slice();ge.axialAlignedBoundingBox([0,0,o,l],s,u);const[d,f,p,m]=u;this.ctx.fillRect(d,f,p-d,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Zi.transform).recordDependencies(e,Zi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){bt("Should not call beginInlineImage")}beginImageData(){bt("Should not call beginImageData")}paintFormXObjectBegin(e,n,r){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),n&&this.transform(e,...n),this.baseTransform=zt(this.ctx),r)){ge.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[s,a,o,l]=r,u=new Path2D;u.rect(s,a,o-s,l-a),this.ctx.clip(u),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,s,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,n){var w;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;n.isolated||bj("TODO: Support non-isolated groups."),n.knockout&&Ne("Knockout groups not supported.");const i=zt(r);if(n.matrix&&r.transform(...n.matrix),!n.bbox)throw new Error("Bounding box is required.");let s=Xf.slice();ge.axialAlignedBoundingBox(n.bbox,zt(r),s);const a=[0,0,r.canvas.width,r.canvas.height];s=ge.intersect(s,a)||[0,0,0,0];const o=Math.floor(s[0]),l=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-o,1),d=Math.max(Math.ceil(s[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,d]);let f="groupAt"+this.groupLevel;n.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,u,d),m=p.context;m.translate(-o,-l),m.transform(...i);let y=new Path2D;const[g,v,b,x]=n.bbox;if(y.rect(g,v,b-g,x-v),n.matrix){const S=new Path2D;S.addPath(y,new DOMMatrix(n.matrix)),y=S}m.clip(y),n.smask&&this.smaskStack.push({canvas:p.canvas,context:m,offsetX:o,offsetY:l,subtype:n.smask.subtype,backdrop:n.smask.backdrop,transferMap:n.smask.transferMap||null,startTransformInverse:null}),(!n.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(o,l),r.save()),_y(r,m),this.ctx=m,(w=this.dependencyTracker)==null||w.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,n){var s;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(s=this.dependencyTracker)==null||s.popBaseTransform(),n.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=zt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=Xf.slice();ge.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],a,o),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,n,r,i,s,a){if(C(this,fa,A2).call(this),Fw(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const o=r[2]-r[0],l=r[3]-r[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=r[0],i[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=o,r[3]=l,ge.singularValueDecompose2dScale(zt(this.ctx),Fi);const{viewportScale:u}=this,d=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(n,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(Fi[0],0,0,-Fi[1],0,l*Fi[1]),Fw(this.ctx)}else{Fw(this.ctx),this.endPath(e);const u=new Path2D;u.rect(r[0],r[1],o,l),this.ctx.clip(u)}}this.current=new SF(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),C(this,fa,j2).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,n){var o;if(!this.contentVisible)return;const r=n.count;n=this.getObject(e,n.data,n),n.count=r;const i=this.ctx,s=this._createMaskCanvas(e,n),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+a.width,s.offsetY,s.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,n,r,i=0,s=0,a,o){var f,p,m;if(!this.contentVisible)return;n=this.getObject(e,n.data,n);const l=this.ctx;l.save();const u=zt(l);l.transform(r,i,s,a,0,0);const d=this._createMaskCanvas(e,n);l.setTransform(1,0,0,1,d.offsetX-u[4],d.offsetY-u[5]),(f=this.dependencyTracker)==null||f.resetBBox(e);for(let y=0,g=o.length;y<g;y+=2){const v=ge.transform(u,[r,i,s,a,o[y],o[y+1]]);l.drawImage(d.canvas,v[4],v[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,v[4],v[4]+d.canvas.width,v[5],v[5]+d.canvas.height)}l.restore(),this.compose(),(m=this.dependencyTracker)==null||m.recordOperation(e)}paintImageMaskXObjectGroup(e,n){var a,o,l;if(!this.contentVisible)return;const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,Zi.transformAndFill);for(const u of n){const{data:d,width:f,height:p,transform:m}=u,y=this.cachedCanvases.getCanvas("maskCanvas",f,p),g=y.context;g.save();const v=this.getObject(e,d,u);jF(g,v),g.globalCompositeOperation="source-in",g.fillStyle=s?i.getPattern(g,this,ga(r),Jn.FILL,e):i,g.fillRect(0,0,f,p),g.restore(),r.save(),r.transform(...m),r.scale(1,-1),Lw(r,y.canvas,0,0,f,p,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,r,0,f,0,p),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,n){if(!this.contentVisible)return;const r=this.getObject(e,n);if(!r){Ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,n,r,i,s){if(!this.contentVisible)return;const a=this.getObject(e,n);if(!a){Ne("Dependent image isn't ready yet");return}const o=a.width,l=a.height,u=[];for(let d=0,f=s.length;d<f;d+=2)u.push({transform:[r,0,0,i,s[d],s[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:n,width:r,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(n,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e,n){var u;if(!this.contentVisible)return;const r=n.width,i=n.height,s=this.ctx;this.save(e);const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none"),s.scale(1/r,-1/i);let o;if(n.bitmap)o=this.applyTransferMapsToBitmap(n);else if(typeof HTMLElement=="function"&&n instanceof HTMLElement||!n.data)o=n;else{const f=this.cachedCanvases.getCanvas("inlineImage",r,i).context;AF(f,n),o=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(o,ga(s));s.imageSmoothingEnabled=kF(zt(s),n.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,s,0,r,-i,0).recordDependencies(e,Zi.imageXObject).recordOperation(e),Lw(s,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,r,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,n,r){var a,o,l;if(!this.contentVisible)return;const i=this.ctx;let s;if(n.bitmap)s=n.bitmap;else{const u=n.width,d=n.height,p=this.cachedCanvases.getCanvas("inlineImage",u,d).context;AF(p,n),s=this.applyTransferMapsToCanvas(p)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of r)i.save(),i.transform(...u.transform),i.scale(1,-1),Lw(i,s,u.x,u.y,u.w,u.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var n;this.contentVisible&&((n=this.dependencyTracker)==null||n.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Zi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,n){}markPointProps(e,n,r){}beginMarkedContent(e,n){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,n,r){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),n==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var n;(n=this.dependencyTracker)==null||n.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,n,r){var a,o;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===NF?s.clip(n,"evenodd"):s.clip(n)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=zt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const n=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:n,b:r,c:i,d:s}=this.ctx.getTransform();let a,o;if(r===0&&i===0){const l=Math.abs(n),u=Math.abs(s);if(l===u)if(e===0)a=o=1/l;else{const d=l*e;a=o=d<1?1/d:1}else if(e===0)a=1/l,o=1/u;else{const d=l*e,f=u*e;a=d<1?1/d:1,o=f<1?1/f:1}}else{const l=Math.abs(n*s-r*i),u=Math.hypot(n,r),d=Math.hypot(i,s);if(e===0)a=d/l,o=u/l;else{const f=e*l;a=d>f?d/f:1,o=u>f?u/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,n){const{ctx:r,current:{lineWidth:i}}=this,[s,a]=this.getScaleForStroking();if(s===a){r.lineWidth=(i||1)*s,r.stroke(e);return}const o=r.getLineDash();n&&r.save(),r.scale(s,a),Wk.a=1/s,Wk.d=1/a;const l=new Path2D;if(l.addPath(e,Wk),o.length>0){const u=Math.max(s,a);r.setLineDash(o.map(d=>d/u)),r.lineDashOffset/=u}r.lineWidth=i||1,r.stroke(l),n&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};fa=new WeakSet,A2=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},j2=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const n=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=n}}},k2=function(e,n,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(n)),i};let dp=GO;for(const t in Nv)dp.prototype[t]!==void 0&&(dp.prototype[Nv[t]]=dp.prototype[t]);var Sx,Ax;class Va{static get workerPort(){return h(this,Sx)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");k(this,Sx,e)}static get workerSrc(){return h(this,Ax)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");k(this,Ax,e)}}Sx=new WeakMap,Ax=new WeakMap,E(Va,Sx,null),E(Va,Ax,"");var sm,jx;class Cje{constructor({parsedData:e,rawData:n}){E(this,sm);E(this,jx);k(this,sm,e),k(this,jx,n)}getRaw(){return h(this,jx)}get(e){return h(this,sm).get(e)??null}[Symbol.iterator](){return h(this,sm).entries()}}sm=new WeakMap,jx=new WeakMap;const Cf=Symbol("INTERNAL");var kx,Nx,Ex,am;class Pje{constructor(e,{name:n,intent:r,usage:i,rbGroups:s}){E(this,kx,!1);E(this,Nx,!1);E(this,Ex,!1);E(this,am,!0);k(this,kx,!!(e&Di.DISPLAY)),k(this,Nx,!!(e&Di.PRINT)),this.name=n,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(h(this,Ex))return h(this,am);if(!h(this,am))return!1;const{print:e,view:n}=this.usage;return h(this,kx)?(n==null?void 0:n.viewState)!=="OFF":h(this,Nx)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,n,r=!1){e!==Cf&&bt("Internal method `_setVisible` called."),k(this,Ex,r),k(this,am,n)}}kx=new WeakMap,Nx=new WeakMap,Ex=new WeakMap,am=new WeakMap;var Nc,ht,om,lm,Cx,N2;class Tje{constructor(e,n=Di.DISPLAY){E(this,Cx);E(this,Nc,null);E(this,ht,new Map);E(this,om,null);E(this,lm,null);if(this.renderingIntent=n,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,k(this,lm,e.order);for(const r of e.groups)h(this,ht).set(r.id,new Pje(n,r));if(e.baseState==="OFF")for(const r of h(this,ht).values())r._setVisible(Cf,!1);for(const r of e.on)h(this,ht).get(r)._setVisible(Cf,!0);for(const r of e.off)h(this,ht).get(r)._setVisible(Cf,!1);k(this,om,this.getHash())}}isVisible(e){if(h(this,ht).size===0)return!0;if(!e)return bj("Optional content group not defined."),!0;if(e.type==="OCG")return h(this,ht).has(e.id)?h(this,ht).get(e.id).visible:(Ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return C(this,Cx,N2).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const n of e.ids){if(!h(this,ht).has(n))return Ne(`Optional content group not found: ${n}`),!0;if(h(this,ht).get(n).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const n of e.ids){if(!h(this,ht).has(n))return Ne(`Optional content group not found: ${n}`),!0;if(!h(this,ht).get(n).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const n of e.ids){if(!h(this,ht).has(n))return Ne(`Optional content group not found: ${n}`),!0;if(!h(this,ht).get(n).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const n of e.ids){if(!h(this,ht).has(n))return Ne(`Optional content group not found: ${n}`),!0;if(h(this,ht).get(n).visible)return!1}return!0}return Ne(`Unknown optional content policy ${e.policy}.`),!0}return Ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,n=!0,r=!0){var s;const i=h(this,ht).get(e);if(!i){Ne(`Optional content group not found: ${e}`);return}if(r&&n&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((s=h(this,ht).get(o))==null||s._setVisible(Cf,!1,!0));i._setVisible(Cf,!!n,!0),k(this,Nc,null)}setOCGState({state:e,preserveRB:n}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=h(this,ht).get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,n);break;case"OFF":this.setVisibility(i,!1,n);break;case"Toggle":this.setVisibility(i,!s.visible,n);break}}k(this,Nc,null)}get hasInitialVisibility(){return h(this,om)===null||this.getHash()===h(this,om)}getOrder(){return h(this,ht).size?h(this,lm)?h(this,lm).slice():[...h(this,ht).keys()]:null}getGroup(e){return h(this,ht).get(e)||null}getHash(){if(h(this,Nc)!==null)return h(this,Nc);const e=new Vz;for(const[n,r]of h(this,ht))e.update(`${n}:${r.visible}`);return k(this,Nc,e.hexdigest())}[Symbol.iterator](){return h(this,ht).entries()}}Nc=new WeakMap,ht=new WeakMap,om=new WeakMap,lm=new WeakMap,Cx=new WeakSet,N2=function(e){const n=e.length;if(n<2)return!0;const r=e[0];for(let i=1;i<n;i++){const s=e[i];let a;if(Array.isArray(s))a=C(this,Cx,N2).call(this,s);else if(h(this,ht).has(s))a=h(this,ht).get(s).visible;else return Ne(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class Oje{constructor(e,{disableRange:n=!1,disableStream:r=!1}){We(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(s==null?void 0:s.length)>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!n,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:n}){const r=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(r),!0)});We(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var n,r,i,s;e.total===void 0?(r=(n=this._rangeReaders[0])==null?void 0:n.onProgress)==null||r.call(n,{loaded:e.loaded}):(s=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||s.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const n=this._rangeReaders.indexOf(e);n>=0&&this._rangeReaders.splice(n,1)}getFullReader(){We(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Mje(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const r=new Rje(this,e,n);return this._pdfDataRangeTransport.requestDataRange(e,n),this._rangeReaders.push(r),r}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class Mje{constructor(e,n,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=IO(i)?i:null,this._queuedChunks=n||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Rje{constructor(e,n,r){this._stream=e,this._begin=n,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Ije(t){let e=!0,n=r("filename\\*","i").exec(t);if(n){n=n[1];let d=o(n);return d=unescape(d),d=l(d),d=u(d),s(d)}if(n=a(t),n){const d=u(n);return s(d)}if(n=r("filename","i").exec(t),n){n=n[1];let d=o(n);return d=u(d),s(d)}function r(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(d,{fatal:!0}),m=Wb(f);f=p.decode(m),e=!1}catch{}}return f}function s(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function a(d){const f=[];let p;const m=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(d))!==null;){let[,g,v,b]=p;if(g=parseInt(g,10),g in f){if(g===0)break;continue}f[g]=[v,b]}const y=[];for(let g=0;g<f.length&&g in f;++g){let[v,b]=f[g];b=o(b),v&&(b=unescape(b),g===0&&(b=l(b))),y.push(b)}return y.join("")}function o(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function l(d){const f=d.indexOf("'");if(f===-1)return d;const p=d.slice(0,f),y=d.slice(f+1).replace(/^[^']*'/,"");return i(p,y)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,v){return String.fromCharCode(parseInt(v,16))}),i(p,y);try{y=atob(y)}catch{}return i(p,y)})}return""}function a9(t,e){const n=new Headers;if(!t||!e||typeof e!="object")return n;for(const r in e){const i=e[r];i!==void 0&&n.append(r,i)}return n}function _j(t){var e;return((e=URL.parse(t))==null?void 0:e.origin)??null}function o9({responseHeaders:t,isHttp:e,rangeChunkSize:n,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*n)||r||!e||t.get("Accept-Ranges")!=="bytes"||(t.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function l9(t){const e=t.get("Content-Disposition");if(e){let n=Ije(e);if(n.includes("%"))try{n=decodeURIComponent(n)}catch{}if(IO(n))return n}return null}function Vb(t,e){return new bS(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t,t===404||t===0&&e.startsWith("file:"))}function c9(t){return t===200||t===206}function u9(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function d9(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(Ne(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class Dje{constructor(e){ae(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=a9(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return We(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new $je(this),this._fullRequestReader}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const r=new Lje(this,e,n);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class $je{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const n=e.source;this._withCredentials=n.withCredentials||!1,this._contentLength=n.length,this._headersCapability=Promise.withResolvers(),this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange;const r=new Headers(e.headers),i=n.url;fetch(i,u9(r,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=_j(s.url),!c9(s.status))throw Vb(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=o9({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=l9(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new vu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:n}=await this._reader.read();return n?{value:e,done:n}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:d9(e),done:!1})}cancel(e){var n;(n=this._reader)==null||n.cancel(e),this._abortController.abort()}}class Lje{constructor(e,n,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${n}-${r-1}`);const a=i.url;fetch(a,u9(s,this._withCredentials,this._abortController)).then(o=>{const l=_j(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!c9(o.status))throw Vb(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:n}=await this._reader.read();return n?{value:e,done:n}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:d9(e),done:!1})}cancel(e){var n;(n=this._reader)==null||n.cancel(e),this._abortController.abort()}}const Hk=200,qk=206;function Fje(t){const e=t.response;return typeof e!="string"?e:Wb(e).buffer}class Bje{constructor({url:e,httpHeaders:n,withCredentials:r}){ae(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=a9(this.isHttp,n),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const n=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:n};n.open("GET",this.url),n.withCredentials=this.withCredentials;for(const[s,a]of this.headers)n.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(n.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=qk):i.expectedStatus=Hk,n.responseType="arraybuffer",We(e.onError,"Expected `onError` callback to be provided."),n.onerror=()=>{e.onError(n.status)},n.onreadystatechange=this.onStateChange.bind(this,r),n.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,n.send(null),r}onProgress(e,n){var i;const r=this.pendingRequests[e];r&&((i=r.onProgress)==null||i.call(r,n))}onStateChange(e,n){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||Hk;if(!(s===Hk&&r.expectedStatus===qk)&&s!==r.expectedStatus){r.onError(i.status);return}const o=Fje(i);if(s===qk){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?r.onDone({begin:parseInt(u[1],10),chunk:o}):(Ne('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const n=this.pendingRequests[e].xhr;delete this.pendingRequests[e],n.abort()}}class Uje{constructor(e){this._source=e,this._manager=new Bje(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const n=this._rangeRequestReaders.indexOf(e);n>=0&&this._rangeRequestReaders.splice(n,1)}getFullReader(){return We(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new zje(this._manager,this._source),this._fullRequestReader}getRangeReader(e,n){const r=new Wje(this._manager,e,n);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class zje{constructor(e,n){this._manager=e,this._url=n.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=n.disableRange||!1,this._contentLength=n.length,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,n=this._manager.getRequestXhr(e);this._manager._responseOrigin=_j(n.responseURL);const r=n.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=o9({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=l9(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Vb(e,this._url),this._headersCapability.reject(this._storedError);for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var n;(n=this.onProgress)==null||n.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Wje{constructor(e,n,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:n,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var n;const e=_j((n=this._manager.getRequestXhr(this._requestId))==null?void 0:n.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const n=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:n,done:!1}):this._queuedChunk=n,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Vb(e,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var n;this.isStreamingSupported||(n=this.onProgress)==null||n.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Hje=/^[a-z][a-z0-9\-+.]+:/i;function qje(t){if(Hje.test(t))return new URL(t);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}class Gje{constructor(e){this.source=e,this.url=qje(e.url),We(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return We(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Kje(this),this._fullRequestReader}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const r=new Vje(this,e,n);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class Kje{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const n=e.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Vb(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",n=>{this._error(n)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new vu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Vje{constructor(e,n,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:n,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",n=>{this._error(n)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Sy=Symbol("INITIAL_DATA");var _i,Px,E2;class h9{constructor(){E(this,Px);E(this,_i,Object.create(null))}get(e,n=null){if(n){const i=C(this,Px,E2).call(this,e);return i.promise.then(()=>n(i.data)),null}const r=h(this,_i)[e];if(!r||r.data===Sy)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const n=h(this,_i)[e];return!!n&&n.data!==Sy}delete(e){const n=h(this,_i)[e];return!n||n.data===Sy?!1:(delete h(this,_i)[e],!0)}resolve(e,n=null){const r=C(this,Px,E2).call(this,e);r.data=n,r.resolve()}clear(){var e;for(const n in h(this,_i)){const{data:r}=h(this,_i)[n];(e=r==null?void 0:r.bitmap)==null||e.close()}k(this,_i,Object.create(null))}*[Symbol.iterator](){for(const e in h(this,_i)){const{data:n}=h(this,_i)[e];n!==Sy&&(yield[e,n])}}}_i=new WeakMap,Px=new WeakSet,E2=function(e){var n;return(n=h(this,_i))[e]||(n[e]={...Promise.withResolvers(),data:Sy})};const Yje=1e5,EF=30;var KF,Ec,ei,Tx,Ox,Yd,zo,Mx,Rx,Xd,cm,um,Cc,dm,Ix,hm,Qd,Dx,$x,fm,Jd,Lx,Pc,pm,kl,f9,p9,C2,qi,g1,P2,m9,g9;const wn=class wn{constructor({textContentSource:e,container:n,viewport:r}){E(this,kl);E(this,Ec,Promise.withResolvers());E(this,ei,null);E(this,Tx,!1);E(this,Ox,!!((KF=globalThis.FontInspector)!=null&&KF.enabled));E(this,Yd,null);E(this,zo,null);E(this,Mx,0);E(this,Rx,0);E(this,Xd,null);E(this,cm,null);E(this,um,0);E(this,Cc,0);E(this,dm,Object.create(null));E(this,Ix,[]);E(this,hm,null);E(this,Qd,[]);E(this,Dx,new WeakMap);E(this,$x,null);var l;if(e instanceof ReadableStream)k(this,hm,e);else if(typeof e=="object")k(this,hm,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');k(this,ei,k(this,cm,n)),k(this,Cc,r.scale*io.pixelRatio),k(this,um,r.rotation),k(this,zo,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:s,pageX:a,pageY:o}=r.rawDims;k(this,$x,[1,0,0,-1,-a,o+s]),k(this,Rx,i),k(this,Mx,s),C(l=wn,qi,m9).call(l),Yh(n,r),h(this,Ec).promise.finally(()=>{h(wn,pm).delete(this),k(this,zo,null),k(this,dm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:n}=nr.platform;return Oe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&n?"Calibri, ":""}sans-serif`],["monospace",`${e&&n?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{h(this,Xd).read().then(({value:n,done:r})=>{if(r){h(this,Ec).resolve();return}h(this,Yd)??k(this,Yd,n.lang),Object.assign(h(this,dm),n.styles),C(this,kl,f9).call(this,n.items),e()},h(this,Ec).reject)};return k(this,Xd,h(this,hm).getReader()),h(wn,pm).add(this),e(),h(this,Ec).promise}update({viewport:e,onBefore:n=null}){var s;const r=e.scale*io.pixelRatio,i=e.rotation;if(i!==h(this,um)&&(n==null||n(),k(this,um,i),Yh(h(this,cm),{rotation:i})),r!==h(this,Cc)){n==null||n(),k(this,Cc,r);const a={div:null,properties:null,ctx:C(s=wn,qi,g1).call(s,h(this,Yd))};for(const o of h(this,Qd))a.properties=h(this,Dx).get(o),a.div=o,C(this,kl,C2).call(this,a)}}cancel(){var n;const e=new vu("TextLayer task cancelled.");(n=h(this,Xd))==null||n.cancel(e).catch(()=>{}),k(this,Xd,null),h(this,Ec).reject(e)}get textDivs(){return h(this,Qd)}get textContentItemsStr(){return h(this,Ix)}static cleanup(){if(!(h(this,pm).size>0)){h(this,fm).clear();for(const{canvas:e}of h(this,Jd).values())e.remove();h(this,Jd).clear()}}};Ec=new WeakMap,ei=new WeakMap,Tx=new WeakMap,Ox=new WeakMap,Yd=new WeakMap,zo=new WeakMap,Mx=new WeakMap,Rx=new WeakMap,Xd=new WeakMap,cm=new WeakMap,um=new WeakMap,Cc=new WeakMap,dm=new WeakMap,Ix=new WeakMap,hm=new WeakMap,Qd=new WeakMap,Dx=new WeakMap,$x=new WeakMap,fm=new WeakMap,Jd=new WeakMap,Lx=new WeakMap,Pc=new WeakMap,pm=new WeakMap,kl=new WeakSet,f9=function(e){var i,s;if(h(this,Tx))return;(s=h(this,zo)).ctx??(s.ctx=C(i=wn,qi,g1).call(i,h(this,Yd)));const n=h(this,Qd),r=h(this,Ix);for(const a of e){if(n.length>Yje){Ne("Ignoring additional textDivs for performance reasons."),k(this,Tx,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=h(this,ei);k(this,ei,document.createElement("span")),h(this,ei).classList.add("markedContent"),a.id&&h(this,ei).setAttribute("id",`${a.id}`),o.append(h(this,ei))}else a.type==="endMarkedContent"&&k(this,ei,h(this,ei).parentNode);continue}r.push(a.str),C(this,kl,p9).call(this,a)}},p9=function(e){var g;const n=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};h(this,Qd).push(n);const i=ge.transform(h(this,$x),e.transform);let s=Math.atan2(i[1],i[0]);const a=h(this,dm)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=h(this,Ox)&&a.fontSubstitution||a.fontFamily;o=wn.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),u=l*C(g=wn,qi,g9).call(g,o,a,h(this,Yd));let d,f;s===0?(d=i[4],f=i[5]-u):(d=i[4]+u*Math.sin(s),f=i[5]-u*Math.cos(s));const p="calc(var(--total-scale-factor) *",m=n.style;h(this,ei)===h(this,cm)?(m.left=`${(100*d/h(this,Rx)).toFixed(2)}%`,m.top=`${(100*f/h(this,Mx)).toFixed(2)}%`):(m.left=`${p}${d.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(h(wn,Pc)*l).toFixed(2)}px)`,m.fontFamily=o,r.fontSize=l,n.setAttribute("role","presentation"),n.textContent=e.str,n.dir=e.dir,h(this,Ox)&&(n.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(r.angle=s*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const v=Math.abs(e.transform[0]),b=Math.abs(e.transform[3]);v!==b&&Math.max(v,b)/Math.min(v,b)>1.5&&(y=!0)}if(y&&(r.canvasWidth=a.vertical?e.height:e.width),h(this,Dx).set(n,r),h(this,zo).div=n,h(this,zo).properties=r,C(this,kl,C2).call(this,h(this,zo)),r.hasText&&h(this,ei).append(n),r.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),h(this,ei).append(v)}},C2=function(e){var o;const{div:n,properties:r,ctx:i}=e,{style:s}=n;let a="";if(h(wn,Pc)>1&&(a=`scale(${1/h(wn,Pc)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:d}=r;C(o=wn,qi,P2).call(o,i,d*h(this,Cc),l);const{width:f}=i.measureText(n.textContent);f>0&&(a=`scaleX(${u*h(this,Cc)/f}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)},qi=new WeakSet,g1=function(e=null){let n=h(this,Jd).get(e||(e=""));if(!n){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),n=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),h(this,Jd).set(e,n),h(this,Lx).set(n,{size:0,family:""})}return n},P2=function(e,n,r){const i=h(this,Lx).get(e);n===i.size&&r===i.family||(e.font=`${n}px ${r}`,i.size=n,i.family=r)},m9=function(){if(h(this,Pc)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),k(this,Pc,e.getBoundingClientRect().height),e.remove()},g9=function(e,n,r){const i=h(this,fm).get(e);if(i)return i;const s=C(this,qi,g1).call(this,r);s.canvas.width=s.canvas.height=EF,C(this,qi,P2).call(this,s,EF,e);const a=s.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let u=.8;return o?u=o/(o+l):(nr.platform.isFirefox&&Ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),n.ascent?u=n.ascent:n.descent&&(u=1+n.descent)),h(this,fm).set(e,u),u},E(wn,qi),E(wn,fm,new Map),E(wn,Jd,new Map),E(wn,Lx,new WeakMap),E(wn,Pc,null),E(wn,pm,new Set);let Cv=wn;const Xje=100;function y9(t={}){typeof t=="string"||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new T2,{docId:n}=e,r=t.url?rje(t.url):null,i=t.data?ije(t.data):null,s=t.httpHeaders||null,a=t.withCredentials===!0,o=t.password??null,l=t.range instanceof v9?t.range:null,u=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:2**16;let d=t.worker instanceof Pv?t.worker:null;const f=t.verbosity,p=typeof t.docBaseUrl=="string"&&!wj(t.docBaseUrl)?t.docBaseUrl:null,m=Rw(t.cMapUrl),y=t.cMapPacked!==!1,g=t.CMapReaderFactory||(Cr?hje:pF),v=Rw(t.iccUrl),b=Rw(t.standardFontDataUrl),x=t.StandardFontDataFactory||(Cr?fje:mF),w=Rw(t.wasmUrl),S=t.WasmFactory||(Cr?pje:gF),_=t.stopAtErrors!==!0,A=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,j=t.isEvalSupported!==!1,N=typeof t.isOffscreenCanvasSupported=="boolean"?t.isOffscreenCanvasSupported:!Cr,P=typeof t.isImageDecoderSupported=="boolean"?t.isImageDecoderSupported:!Cr&&(nr.platform.isFirefox||!globalThis.chrome),O=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,M=typeof t.disableFontFace=="boolean"?t.disableFontFace:Cr,R=t.fontExtraProperties===!0,I=t.enableXfa===!0,L=t.ownerDocument||globalThis.document,W=t.disableRange===!0,F=t.disableStream===!0,z=t.disableAutoFetch===!0,U=t.pdfBug===!0,K=t.CanvasFactory||(Cr?dje:lje),H=t.FilterFactory||(Cr?uje:cje),Q=t.enableHWA===!0,B=t.useWasm!==!1,Y=l?l.length:t.length??NaN,ne=typeof t.useSystemFonts=="boolean"?t.useSystemFonts:!Cr&&!M,V=typeof t.useWorkerFetch=="boolean"?t.useWorkerFetch:!!(g===pF&&x===mF&&S===gF&&m&&b&&w&&Ry(m,document.baseURI)&&Ry(b,document.baseURI)&&Ry(w,document.baseURI)),te=null;TAe(f);const $={canvasFactory:new K({ownerDocument:L,enableHWA:Q}),filterFactory:new H({docId:n,ownerDocument:L}),cMapReaderFactory:V?null:new g({baseUrl:m,isCompressed:y}),standardFontDataFactory:V?null:new x({baseUrl:b}),wasmFactory:V?null:new S({baseUrl:w})};d||(d=Pv.create({verbosity:f,port:Va.workerPort}),e._worker=d);const q={docId:n,apiVersion:"5.4.394",data:i,password:o,disableAutoFetch:z,rangeChunkSize:u,length:Y,docBaseUrl:p,enableXfa:I,evaluatorOptions:{maxImageSize:A,disableFontFace:M,ignoreErrors:_,isEvalSupported:j,isOffscreenCanvasSupported:N,isImageDecoderSupported:P,canvasMaxAreaInBytes:O,fontExtraProperties:R,useSystemFonts:ne,useWasm:B,useWorkerFetch:V,cMapUrl:m,iccUrl:v,standardFontDataUrl:b,wasmUrl:w}},G={ownerDocument:L,pdfBug:U,styleElement:te,loadingParams:{disableAutoFetch:z,enableXfa:I}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const re=d.messageHandler.sendWithPromise("GetDocRequest",q,i?[i.buffer]:null);let Z;if(l)Z=new Oje(l,{disableRange:W,disableStream:F});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const J=Ry(r)?Dje:Cr?Gje:Uje;Z=new J({url:r,length:Y,httpHeaders:s,withCredentials:a,rangeChunkSize:u,disableRange:W,disableStream:F})}return re.then(J=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const X=new zy(n,J,d.port),se=new Zje(X,e,Z,G,$,Q);e._transport=se,X.send("Ready",null)})}).catch(e._capability.reject),e}var zS;const WS=class WS{constructor(){ae(this,"_capability",Promise.withResolvers());ae(this,"_transport",null);ae(this,"_worker",null);ae(this,"docId",`d${Vt(WS,zS)._++}`);ae(this,"destroyed",!1);ae(this,"onPassword",null);ae(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,n,r,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((n=this._transport)==null?void 0:n.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};zS=new WeakMap,E(WS,zS,0);let T2=WS;var Zd,Fx,Bx,Ux,zx;class v9{constructor(e,n,r=!1,i=null){E(this,Zd,Promise.withResolvers());E(this,Fx,[]);E(this,Bx,[]);E(this,Ux,[]);E(this,zx,[]);this.length=e,this.initialData=n,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){h(this,zx).push(e)}addProgressListener(e){h(this,Ux).push(e)}addProgressiveReadListener(e){h(this,Bx).push(e)}addProgressiveDoneListener(e){h(this,Fx).push(e)}onDataRange(e,n){for(const r of h(this,zx))r(e,n)}onDataProgress(e,n){h(this,Zd).promise.then(()=>{for(const r of h(this,Ux))r(e,n)})}onDataProgressiveRead(e){h(this,Zd).promise.then(()=>{for(const n of h(this,Bx))n(e)})}onDataProgressiveDone(){h(this,Zd).promise.then(()=>{for(const e of h(this,Fx))e()})}transportReady(){h(this,Zd).resolve()}requestDataRange(e,n){bt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Zd=new WeakMap,Fx=new WeakMap,Bx=new WeakMap,Ux=new WeakMap,zx=new WeakMap;class Qje{constructor(e,n){this._pdfInfo=e,this._transport=n}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Oe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,n){return this._transport.getAnnotationsByType(e,n)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:n}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(n)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Wo,eh,Ky;class Jje{constructor(e,n,r,i=!1){E(this,eh);E(this,Wo,!1);this._pageIndex=e,this._pageInfo=n,this._transport=r,this._stats=i?new oF:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new h9,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:n=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new qb({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:n,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:n}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,n)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Oe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:n=e.canvas,viewport:r,intent:i="display",annotationMode:s=Ql.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:d=null,printAnnotationStorage:f=null,isEditing:p=!1,recordOperations:m=!1,operationsFilter:y=null}){var P,O,M;(P=this._stats)==null||P.time("Overall");const g=this._transport.getRenderingIntent(i,s,f,p),{renderingIntent:v,cacheKey:b}=g;k(this,Wo,!1),l||(l=this._transport.getOptionalContentConfig(v));let x=this._intentStates.get(b);x||(x=Object.create(null),this._intentStates.set(b,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const w=!!(v&Di.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(O=this._stats)==null||O.time("Page Request"),this._pumpOperatorList(g));const S=!!(this._pdfBug&&((M=globalThis.StepperManager)!=null&&M.enabled)),_=!this.recordedBBoxes&&(m||S),A=R=>{var I,L;if(x.renderTasks.delete(j),_){const W=(I=j.gfx)==null?void 0:I.dependencyTracker.take();W&&(j.stepper&&j.stepper.setOperatorBBoxes(W,j.gfx.dependencyTracker.takeDebugMetadata()),m&&(this.recordedBBoxes=W))}w&&k(this,Wo,!0),C(this,eh,Ky).call(this),R?(j.capability.reject(R),this._abortOperatorList({intentState:x,reason:R instanceof Error?R:new Error(R)})):j.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(L=globalThis.Stats)!=null&&L.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},j=new O2({callback:A,params:{canvas:n,canvasContext:e,dependencyTracker:_?new gje(n,x.operatorList.length,S):null,viewport:r,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:y});(x.renderTasks||(x.renderTasks=new Set)).add(j);const N=j.task;return Promise.all([x.displayReadyCapability.promise,l]).then(([R,I])=>{var L;if(this.destroyed){A();return}if((L=this._stats)==null||L.time("Rendering"),!(I.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");j.initializeGraphics({transparency:R,optionalContentConfig:I}),j.operatorListChanged()}).catch(A),N}getOperatorList({intent:e="display",annotationMode:n=Ql.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){var u;function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,n,r,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:n===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Ev.textContent(r));const n=this.streamTextContent(e);return new Promise(function(r,i){function s(){a.read().then(function({value:l,done:u}){if(u){r(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},i)}const a=n.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(const r of n.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),k(this,Wo,!1),Promise.all(e)}cleanup(e=!1){k(this,Wo,!0);const n=C(this,eh,Ky).call(this);return e&&n&&this._stats&&(this._stats=new oF),n}_startRenderPage(e,n){var i,s;const r=this._intentStates.get(n);r&&((i=this._stats)==null||i.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(e))}_renderPageChunk(e,n){for(let r=0,i=e.length;r<i;r++)n.operatorList.fnArray.push(e.fnArray[r]),n.operatorList.argsArray.push(e.argsArray[r]);n.operatorList.lastChunk=e.lastChunk,n.operatorList.separateAnnots=e.separateAnnots;for(const r of n.renderTasks)r.operatorListChanged();e.lastChunk&&C(this,eh,Ky).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:n,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:n,annotationStorage:s,modifiedIds:i},a).getReader(),u=this._intentStates.get(n);u.streamReader=l;const d=()=>{l.read().then(({value:f,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),d())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();C(this,eh,Ky).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:e,reason:n,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(n instanceof RO){let i=Xje;n.extraDelay>0&&n.extraDelay<1e3&&(i+=n.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:n,force:!0})},i);return}}if(e.streamReader.cancel(new vu(n.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Wo=new WeakMap,eh=new WeakSet,Ky=function(){if(!h(this,Wo)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),k(this,Wo,!1),!0};var Tc,Ks,Ho,th,HS,nh,rh,Dr,y1,x9,b9,Vy,mm,v1;const It=class It{constructor({name:e=null,port:n=null,verbosity:r=OAe()}={}){E(this,Dr);E(this,Tc,Promise.withResolvers());E(this,Ks,null);E(this,Ho,null);E(this,th,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,n){if(h(It,rh).has(n))throw new Error("Cannot use more than one PDFWorker per port.");h(It,rh).set(n,this),C(this,Dr,x9).call(this,n)}else C(this,Dr,b9).call(this)}get promise(){return h(this,Tc).promise}get port(){return h(this,Ho)}get messageHandler(){return h(this,Ks)}destroy(){var e,n;this.destroyed=!0,(e=h(this,th))==null||e.terminate(),k(this,th,null),h(It,rh).delete(h(this,Ho)),k(this,Ho,null),(n=h(this,Ks))==null||n.destroy(),k(this,Ks,null)}static create(e){const n=h(this,rh).get(e==null?void 0:e.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new It(e)}static get workerSrc(){if(Va.workerSrc)return Va.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Oe(this,"_setupFakeWorkerGlobal",(async()=>h(this,mm,v1)?h(this,mm,v1):(await import(this.workerSrc)).WorkerMessageHandler)())}};Tc=new WeakMap,Ks=new WeakMap,Ho=new WeakMap,th=new WeakMap,HS=new WeakMap,nh=new WeakMap,rh=new WeakMap,Dr=new WeakSet,y1=function(){h(this,Tc).resolve(),h(this,Ks).send("configure",{verbosity:this.verbosity})},x9=function(e){k(this,Ho,e),k(this,Ks,new zy("main","worker",e)),h(this,Ks).on("ready",()=>{}),C(this,Dr,y1).call(this)},b9=function(){if(h(It,nh)||h(It,mm,v1)){C(this,Dr,Vy).call(this);return}let{workerSrc:e}=It;try{It._isSameOrigin(window.location,e)||(e=It._createCDNWrapper(new URL(e,window.location).href));const n=new Worker(e,{type:"module"}),r=new zy("main","worker",n),i=()=>{s.abort(),r.destroy(),n.terminate(),this.destroyed?h(this,Tc).reject(new Error("Worker was destroyed")):C(this,Dr,Vy).call(this)},s=new AbortController;n.addEventListener("error",()=>{h(this,th)||i()},{signal:s.signal}),r.on("test",o=>{if(s.abort(),this.destroyed||!o){i();return}k(this,Ks,r),k(this,Ho,n),k(this,th,n),C(this,Dr,y1).call(this)}),r.on("ready",o=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{C(this,Dr,Vy).call(this)}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{bj("The worker has been disabled.")}C(this,Dr,Vy).call(this)},Vy=function(){h(It,nh)||(Ne("Setting up fake worker."),k(It,nh,!0)),It._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){h(this,Tc).reject(new Error("Worker was destroyed"));return}const n=new oje;k(this,Ho,n);const r=`fake${Vt(It,HS)._++}`,i=new zy(r+"_worker",r,n);e.setup(i,n),k(this,Ks,new zy(r,r+"_worker",n)),C(this,Dr,y1).call(this)}).catch(e=>{h(this,Tc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},mm=new WeakSet,v1=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},E(It,mm),E(It,HS,0),E(It,nh,!1),E(It,rh,new WeakMap),Cr&&(k(It,nh,!0),Va.workerSrc||(Va.workerSrc="./pdf.worker.mjs")),It._isSameOrigin=(e,n)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const i=new URL(n,r);return r.origin===i.origin},It._createCDNWrapper=e=>{const n=`await import("${e}");`;return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))},It.fromPort=e=>{if(HAe("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return It.create(e)};let Pv=It;var qo,$a,gm,ym,Go,ih,Yy;class Zje{constructor(e,n,r,i,s,a){E(this,ih);E(this,qo,new Map);E(this,$a,new Map);E(this,gm,new Map);E(this,ym,new Map);E(this,Go,null);this.messageHandler=e,this.loadingTask=n,this.commonObjs=new h9,this.fontLoader=new tje({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Oe(this,"annotationStorage",new DO)}getRenderingIntent(e,n=Ql.ENABLE,r=null,i=!1,s=!1){let a=Di.DISPLAY,o=p2;switch(e){case"any":a=Di.ANY;break;case"display":break;case"print":a=Di.PRINT;break;default:Ne(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Di.PRINT&&r instanceof Xz?r:this.annotationStorage;switch(n){case Ql.DISABLE:a+=Di.ANNOTATIONS_DISABLE;break;case Ql.ENABLE:break;case Ql.ENABLE_FORMS:a+=Di.ANNOTATIONS_FORMS;break;case Ql.ENABLE_STORAGE:a+=Di.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Ne(`getRenderingIntent - invalid annotationMode: ${n}`)}i&&(a+=Di.IS_EDITING),s&&(a+=Di.OPLIST);const{ids:u,hash:d}=l.modifiedIds,f=[a,o.hash,d];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=h(this,Go))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of h(this,$a).values())e.push(i._destroy());h(this,$a).clear(),h(this,gm).clear(),h(this,ym).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return e.push(n),Promise.all(e).then(()=>{var i,s;this.commonObjs.clear(),this.fontLoader.clear(),h(this,qo).clear(),this.filterFactory.destroy(),Cv.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new vu("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:n}=this;e.on("GetReader",(r,i)=>{We(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}We(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&((o=n.onProgress)==null||o.call(n,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=n.onProgress)==null||u.call(n,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(r,i)=>{We(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){i.close();return}We(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,n._capability.resolve(new Qje(r,this))}),e.on("DocException",r=>{n._capability.reject(Gr(r))}),e.on("PasswordRequest",r=>{k(this,Go,Promise.withResolvers());try{if(!n.onPassword)throw Gr(r);const i=s=>{s instanceof Error?h(this,Go).reject(s):h(this,Go).resolve({password:s})};n.onPassword(i,r.code)}catch(i){h(this,Go).reject(i)}return h(this,Go).promise}),e.on("DataLoaded",r=>{var i;(i=n.onProgress)==null||i.call(n,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;h(this,$a).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,s])=>{var a;if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const p=s.error;Ne(`Error during font loading: ${p}`),this.commonObjs.resolve(r,p);break}const o=new m2(s),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,u=new nje(o,l,s.extra,s.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:d}=s;We(d,"The imageRef must be defined.");for(const p of h(this,$a).values())for(const[,m]of p.objs)if((m==null?void 0:m.ref)===d)return m.dataLen?(this.commonObjs.resolve(r,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":this.commonObjs.resolve(r,s);break;case"Pattern":const f=new g2(s);this.commonObjs.resolve(r,f.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,s,a])=>{var l;if(this.destroyed)return;const o=h(this,$a).get(i);if(!o.objs.has(r)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(s){case"Image":case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",r=>{var i;this.destroyed||(i=n.onProgress)==null||i.call(n,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:n}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},n).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const n=e-1,r=h(this,gm).get(n);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&h(this,ym).set(s.refStr,e);const a=new Jje(n,s,this,this._params.pdfBug);return h(this,$a).set(n,a),a});return h(this,gm).set(n,i),i}getPageIndex(e){return y2(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:n})}getFieldObjects(){return C(this,ih,Yy).call(this,"GetFieldObjects")}hasJSActions(){return C(this,ih,Yy).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,n){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:n})}getDocJSActions(){return C(this,ih,Yy).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return C(this,ih,Yy).call(this,"GetOptionalContentConfig").then(n=>new Tje(n,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",n=h(this,qo).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,null).then(i=>{var s,a;return{info:i[0],metadata:i[1]?new Cje(i[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return h(this,qo).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const n of h(this,$a).values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),h(this,qo).clear(),this.filterFactory.destroy(!0),Cv.cleanup()}}cachedPageNumber(e){if(!y2(e))return null;const n=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return h(this,ym).get(n)??null}}qo=new WeakMap,$a=new WeakMap,gm=new WeakMap,ym=new WeakMap,Go=new WeakMap,ih=new WeakSet,Yy=function(e,n=null){const r=h(this,qo).get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,n);return h(this,qo).set(e,i),i};var Oc;class eke{constructor(e){E(this,Oc,null);ae(this,"onContinue",null);ae(this,"onError",null);k(this,Oc,e)}get promise(){return h(this,Oc).capability.promise}cancel(e=0){h(this,Oc).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=h(this,Oc).operatorList;if(!e)return!1;const{annotationCanvasMap:n}=h(this,Oc);return e.form||e.canvas&&(n==null?void 0:n.size)>0}}Oc=new WeakMap;var Mc,sh;const Qu=class Qu{constructor({callback:e,params:n,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:p=null,enableHWA:m=!1,operationsFilter:y=null}){E(this,Mc,null);this.callback=e,this.params=n,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new eke(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvas,this._canvasContext=n.canvas?null:n.canvasContext,this._enableHWA=m,this._dependencyTracker=n.dependencyTracker,this._operationsFilter=y}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:n}){var l,u;if(this.cancelled)return;if(this._canvas){if(h(Qu,sh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");h(Qu,sh).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:i,background:s,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new dp(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,n=0){var r,i,s;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),h(this,Mc)&&(window.cancelAnimationFrame(h(this,Mc)),k(this,Mc,null)),h(Qu,sh).delete(this._canvas),e||(e=new RO(`Rendering cancelled, page ${this._pageIndex+1}`,n)),this.callback(e),(s=(i=this.task).onError)==null||s.call(i,e)}operatorListChanged(){var e,n;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(n=this.stepper)==null||n.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?k(this,Mc,window.requestAnimationFrame(()=>{k(this,Mc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),h(Qu,sh).delete(this._canvas),this.callback())))}};Mc=new WeakMap,sh=new WeakMap,E(Qu,sh,new WeakSet);let O2=Qu;const tke="5.4.394",nke="2cc809ade";var Si,ah,vm,An,Wx,xm,Ko,Hx,Rc,Vs,qx,pt,M2,R2,I2,Wu,w9,Wl;const Kr=class Kr{constructor({editor:e=null,uiManager:n=null}){E(this,pt);E(this,Si,null);E(this,ah,null);E(this,vm);E(this,An,null);E(this,Wx,!1);E(this,xm,!1);E(this,Ko,null);E(this,Hx);E(this,Rc,null);E(this,Vs,null);var r,i;e?(k(this,xm,!1),k(this,Ko,e)):k(this,xm,!0),k(this,Vs,(e==null?void 0:e._uiManager)||n),k(this,Hx,h(this,Vs)._eventBus),k(this,vm,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((i=h(this,Vs))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),h(Kr,qx)||k(Kr,qx,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Oe(this,"_keyboardManager",new Kb([[["Escape","mac+Escape"],Kr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Kr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Kr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Kr.prototype._moveToPrevious],[["Home","mac+Home"],Kr.prototype._moveToBeginning],[["End","mac+End"],Kr.prototype._moveToEnd]]))}renderButton(){const e=k(this,Si,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",h(this,Ko)&&(e.ariaControls=`${h(this,Ko).id}_colorpicker_dropdown`);const n=h(this,Vs)._signal;e.addEventListener("click",C(this,pt,Wu).bind(this),{signal:n}),e.addEventListener("keydown",C(this,pt,I2).bind(this),{signal:n});const r=k(this,ah,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=h(this,vm),e.append(r),e}renderMainDropdown(){const e=k(this,An,C(this,pt,M2).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===h(this,Si)){C(this,pt,Wu).call(this,e);return}const n=e.target.getAttribute("data-color");n&&C(this,pt,R2).call(this,n,e)}_moveToNext(e){var n,r;if(!h(this,pt,Wl)){C(this,pt,Wu).call(this,e);return}if(e.target===h(this,Si)){(n=h(this,An).firstChild)==null||n.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var n,r;if(e.target===((n=h(this,An))==null?void 0:n.firstChild)||e.target===h(this,Si)){h(this,pt,Wl)&&this._hideDropdownFromKeyboard();return}h(this,pt,Wl)||C(this,pt,Wu).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var n;if(!h(this,pt,Wl)){C(this,pt,Wu).call(this,e);return}(n=h(this,An).firstChild)==null||n.focus()}_moveToEnd(e){var n;if(!h(this,pt,Wl)){C(this,pt,Wu).call(this,e);return}(n=h(this,An).lastChild)==null||n.focus()}hideDropdown(){var e,n;(e=h(this,An))==null||e.classList.add("hidden"),h(this,Si).ariaExpanded="false",(n=h(this,Rc))==null||n.abort(),k(this,Rc,null)}_hideDropdownFromKeyboard(){var e;if(!h(this,xm)){if(!h(this,pt,Wl)){(e=h(this,Ko))==null||e.unselect();return}this.hideDropdown(),h(this,Si).focus({preventScroll:!0,focusVisible:h(this,Wx)})}}updateColor(e){if(h(this,ah)&&(h(this,ah).style.backgroundColor=e),!h(this,An))return;const n=h(this,Vs).highlightColors.values();for(const r of h(this,An).children)r.ariaSelected=n.next().value===e.toUpperCase()}destroy(){var e,n;(e=h(this,Si))==null||e.remove(),k(this,Si,null),k(this,ah,null),(n=h(this,An))==null||n.remove(),k(this,An,null)}};Si=new WeakMap,ah=new WeakMap,vm=new WeakMap,An=new WeakMap,Wx=new WeakMap,xm=new WeakMap,Ko=new WeakMap,Hx=new WeakMap,Rc=new WeakMap,Vs=new WeakMap,qx=new WeakMap,pt=new WeakSet,M2=function(){const e=document.createElement("div"),n=h(this,Vs)._signal;e.addEventListener("contextmenu",Ps,{signal:n}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),h(this,Ko)&&(e.id=`${h(this,Ko).id}_colorpicker_dropdown`);for(const[r,i]of h(this,Vs).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",h(Kr,qx)[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.ariaSelected=i===h(this,vm),s.addEventListener("click",C(this,pt,R2).bind(this,i),{signal:n}),e.append(s)}return e.addEventListener("keydown",C(this,pt,I2).bind(this),{signal:n}),e},R2=function(e,n){n.stopPropagation(),h(this,Hx).dispatch("switchannotationeditorparams",{source:this,type:ze.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},I2=function(e){Kr._keyboardManager.exec(this,e)},Wu=function(e){if(h(this,pt,Wl)){this.hideDropdown();return}if(k(this,Wx,e.detail===0),h(this,Rc)||(k(this,Rc,new AbortController),window.addEventListener("pointerdown",C(this,pt,w9).bind(this),{signal:h(this,Vs).combinedSignal(h(this,Rc))})),h(this,Si).ariaExpanded="true",h(this,An)){h(this,An).classList.remove("hidden");return}const n=k(this,An,C(this,pt,M2).call(this));h(this,Si).append(n)},w9=function(e){var n;(n=h(this,An))!=null&&n.contains(e.target)||this.hideDropdown()},Wl=function(){return h(this,An)&&!h(this,An).classList.contains("hidden")},E(Kr,qx,null);let NS=Kr;var La,Gx,bm,Kx;const Ju=class Ju{constructor(e){E(this,La,null);E(this,Gx,null);E(this,bm,null);k(this,Gx,e),k(this,bm,e._uiManager),h(Ju,Kx)||k(Ju,Kx,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(h(this,La))return h(this,La);const{editorType:e,colorType:n,color:r}=h(this,Gx),i=k(this,La,document.createElement("input"));return i.type="color",i.value=r||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",h(Ju,Kx)[e]),i.addEventListener("input",()=>{h(this,bm).updateParams(n,i.value)},{signal:h(this,bm)._signal}),i}update(e){h(this,La)&&(h(this,La).value=e)}destroy(){var e;(e=h(this,La))==null||e.remove(),k(this,La,null)}hideDropdown(){}};La=new WeakMap,Gx=new WeakMap,bm=new WeakMap,Kx=new WeakMap,E(Ju,Kx,null);let ES=Ju;function CF(t){return Math.floor(Math.max(0,Math.min(1,t))*255).toString(16).padStart(2,"0")}function Ay(t){return Math.max(0,Math.min(255,255*t))}class PF{static CMYK_G([e,n,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*n+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ay(e),[e,e,e]}static G_HTML([e]){const n=CF(e);return`#${n}${n}${n}`}static RGB_G([e,n,r]){return["G",.3*e+.59*n+.11*r]}static RGB_rgb(e){return e.map(Ay)}static RGB_HTML(e){return`#${e.map(CF).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,n,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,n+i)]}static CMYK_rgb([e,n,r,i]){return[Ay(1-Math.min(1,e+i)),Ay(1-Math.min(1,r+i)),Ay(1-Math.min(1,n+i))]}static CMYK_HTML(e){const n=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(n)}static RGB_CMYK([e,n,r]){const i=1-e,s=1-n,a=1-r,o=Math.min(i,s,a);return["CMYK",i,s,a,o]}}class rke{create(e,n,r=!1){if(e<=0||n<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${n}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${n}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){bt("Abstract method `_createSVG` called.")}}class CS extends rke{_createSVG(e){return document.createElementNS(ho,e)}}const ike=9,Qh=new WeakSet,ske=new Date().getTimezoneOffset()*60*1e3;class Gk{static create(e){switch(e.data.annotationType){case un.LINK:return new FO(e);case un.TEXT:return new oke(e);case un.WIDGET:switch(e.data.fieldType){case"Tx":return new lke(e);case"Btn":return e.data.radioButton?new A9(e):e.data.checkBox?new uke(e):new dke(e);case"Ch":return new hke(e);case"Sig":return new cke(e)}return new of(e);case un.POPUP:return new $2(e);case un.FREETEXT:return new C9(e);case un.LINE:return new pke(e);case un.SQUARE:return new mke(e);case un.CIRCLE:return new gke(e);case un.POLYLINE:return new P9(e);case un.CARET:return new vke(e);case un.INK:return new BO(e);case un.POLYGON:return new yke(e);case un.HIGHLIGHT:return new T9(e);case un.UNDERLINE:return new xke(e);case un.SQUIGGLY:return new bke(e);case un.STRIKEOUT:return new wke(e);case un.STAMP:return new O9(e);case un.FILEATTACHMENT:return new _ke(e);default:return new Gt(e)}}}var oh,wm,ds,Vx,D2;const KO=class KO{constructor(e,{isRenderable:n=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){E(this,Vx);E(this,oh,null);E(this,wm,!1);E(this,ds,null);this.isRenderable=n,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,n&&(this.contentElement=this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:n}){return!!(e!=null&&e.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return KO._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,n=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return n?n.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:n,inkLists:r,rect:i}=this.data;let s=-1/0,a=-1/0;if((n==null?void 0:n.length)>=8){for(let l=0;l<n.length;l+=8)n[l+1]>a?(a=n[l+1],s=n[l+2]):n[l+1]===a&&(s=Math.max(s,n[l+2]));return[s,a]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let u=0,d=l.length;u<d;u+=2)l[u+1]>a?(a=l[u+1],s=l[u]):l[u+1]===a&&(s=Math.max(s,l[u]));if(s!==1/0)return[s,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:n},viewport:{rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}}=this.parent;return e[1]=n[3]-e[1]+n[1],e[0]=100*(e[0]-s)/r,e[1]=100*(e[1]-a)/i,e}get commentText(){var n,r,i;const{data:e}=this;return((r=(n=this.annotationStorage.getRawValue(`${kv}${e.id}`))==null?void 0:n.popup)==null?void 0:r.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:n}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(n.id,{popup:r})||this.annotationStorage.setValue(`${kv}${n.id}`,{id:n.id,annotationType:n.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:n.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,n;(n=((e=h(this,ds))==null?void 0:e.popup)||this.popup)==null||n.remove(),k(this,ds,this.popup=null)}updateEdited(e){var s;if(!this.container)return;e.rect&&(h(this,oh)||k(this,oh,{rect:this.data.rect.slice(0)}));const{rect:n,popup:r}=e;n&&C(this,Vx,D2).call(this,n);let i=((s=h(this,ds))==null?void 0:s.popup)||this.popup;!i&&(r!=null&&r.text)&&(this._createPopup(r),i=h(this,ds).popup),i&&(i.updateEdited(e),r!=null&&r.deleted&&(i.remove(),k(this,ds,null),this.popup=null))}resetEdited(){var e;h(this,oh)&&(C(this,Vx,D2).call(this,h(this,oh).rect),(e=h(this,ds))==null||e.popup.resetEdited(),k(this,oh,null))}_createContainer(e){const{data:n,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",n.id),!(this instanceof of)&&!(this instanceof FO)&&(s.tabIndex=0);const{style:a}=s;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,n.alternativeText&&(s.title=n.alternativeText),n.noRotate&&s.classList.add("norotate"),!n.rect||this instanceof $2){const{rotation:g}=n;return!n.hasOwnCanvas&&g!==0&&this.setRotation(g,s),s}const{width:o,height:l}=this;if(!e&&n.borderStyle.width>0){a.borderWidth=`${n.borderStyle.width}px`;const g=n.borderStyle.horizontalCornerRadius,v=n.borderStyle.verticalCornerRadius;if(g>0||v>0){const x=`calc(${g}px * var(--total-scale-factor)) / calc(${v}px * var(--total-scale-factor))`;a.borderRadius=x}else if(this instanceof A9){const x=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=x}switch(n.borderStyle.style){case Af.SOLID:a.borderStyle="solid";break;case Af.DASHED:a.borderStyle="dashed";break;case Af.BEVELED:Ne("Unimplemented border style: beveled");break;case Af.INSET:Ne("Unimplemented border style: inset");break;case Af.UNDERLINE:a.borderBottomStyle="solid";break}const b=n.borderColor||null;b?(k(this,wm,!0),a.borderColor=ge.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const u=ge.normalizeRect([n.rect[0],r.view[3]-n.rect[1]+r.view[1],n.rect[2],r.view[3]-n.rect[3]+r.view[1]]),{pageWidth:d,pageHeight:f,pageX:p,pageY:m}=i.rawDims;a.left=`${100*(u[0]-p)/d}%`,a.top=`${100*(u[1]-m)/f}%`;const{rotation:y}=n;return n.hasOwnCanvas||y===0?(a.width=`${100*o/d}%`,a.height=`${100*l/f}%`):this.setRotation(y,s),s}setRotation(e,n=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:a}=this;e%180!==0&&([s,a]=[a,s]),n.style.width=`${100*s/r}%`,n.style.height=`${100*a/i}%`,n.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(n,r,i)=>{const s=i.detail[n],a=s[0],o=s.slice(1);i.target.style[r]=PF[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:PF[`${a}_rgb`](o)})};return Oe(this,"_commonActions",{display:n=>{const{display:r}=n.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:n=>{this.annotationStorage.setValue(this.data.id,{noPrint:!n.detail.print})},hidden:n=>{const{hidden:r}=n.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.target.disabled=n.detail.readonly},required:n=>{this._setRequired(n.target,n.detail.required)},bgColor:n=>{e("bgColor","backgroundColor",n)},fillColor:n=>{e("fillColor","backgroundColor",n)},fgColor:n=>{e("fgColor","color",n)},textColor:n=>{e("textColor","color",n)},borderColor:n=>{e("borderColor","borderColor",n)},strokeColor:n=>{e("strokeColor","borderColor",n)},rotation:n=>{const r=n.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,n){const r=this._commonActions;for(const i of Object.keys(n.detail)){const s=e[i]||r[i];s==null||s(n)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const r=this._commonActions;for(const[i,s]of Object.entries(n)){const a=r[i];if(a){const o={detail:{[i]:s},target:e};a(o),delete n[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[n,r,i,s]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,v,b,x]=e.subarray(2,6);if(i===g&&s===v&&n===b&&r===x)return}const{style:a}=this.container;let o;if(h(this,wm)){const{borderColor:g,borderWidth:v}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${v}">`],this.container.classList.add("hasBorder")}const l=i-n,u=s-r,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=d.createElement("defs");f.append(p);const m=d.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let g=2,v=e.length;g<v;g+=8){const b=e[g],x=e[g+1],w=e[g+2],S=e[g+3],_=d.createElement("rect"),A=(w-n)/l,j=(s-x)/u,N=(b-w)/l,P=(x-S)/u;_.setAttribute("x",A),_.setAttribute("y",j),_.setAttribute("width",N),_.setAttribute("height",P),m.append(_),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${A}" y="${j}" width="${N}" height="${P}"/>`)}h(this,wm)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:n}=this;let r,i;e?(r={str:e.text},i=e.date):(r=n.contentsObj,i=n.modificationDate),k(this,ds,new $2({data:{color:n.color,titleObj:n.titleObj,modificationDate:i,contentsObj:r,richText:n.richText,parentRect:n.rect,borderStyle:0,id:`popup_${n.id}`,rotation:n.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(h(this,ds)||this.popup||this.data.popupRef)}get extraPopupElement(){return h(this,ds)}render(){bt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,n=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:a,exportValues:o}of i){if(s===-1||a===n)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Qh.has(u)){Ne(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:u})}return r}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==n&&Qh.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const n of e)n.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:n}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:n,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};oh=new WeakMap,wm=new WeakMap,ds=new WeakMap,Vx=new WeakSet,D2=function(e){const{container:{style:n},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;r==null||r.splice(0,4,...e),n.left=`${100*(e[0]-o)/s}%`,n.top=`${100*(a-e[3]+l)/a}%`,i===0?(n.width=`${100*(e[2]-e[0])/s}%`,n.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let Gt=KO;class ake extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Bi,Hu,_9,S9;class FO extends Gt{constructor(n,r=null){super(n,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});E(this,Bi);this.isTooltipOnly=n.data.isTooltipOnly}render(){const{data:n,linkService:r}=this,i=document.createElement("a");i.setAttribute("data-element-id",n.id);let s=!1;return n.url?(r.addLinkAttributes(i,n.url,n.newWindow),s=!0):n.action?(this._bindNamedAction(i,n.action,n.overlaidText),s=!0):n.attachment?(C(this,Bi,_9).call(this,i,n.attachment,n.overlaidText,n.attachmentDest),s=!0):n.setOCGState?(C(this,Bi,S9).call(this,i,n.setOCGState,n.overlaidText),s=!0):n.dest?(this._bindLink(i,n.dest,n.overlaidText),s=!0):(n.actions&&(n.actions.Action||n.actions["Mouse Up"]||n.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,n),s=!0),n.resetForm?(this._bindResetFormAction(i,n.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(n,r,i=""){n.href=this.linkService.getDestinationHash(r),n.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&C(this,Bi,Hu).call(this),i&&(n.title=i)}_bindNamedAction(n,r,i=""){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeNamedAction(r),!1),i&&(n.title=i),C(this,Bi,Hu).call(this)}_bindJSAction(n,r){n.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const a=i.get(s);a&&(n[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}r.overlaidText&&(n.title=r.overlaidText),n.onclick||(n.onclick=()=>!1),C(this,Bi,Hu).call(this)}_bindResetFormAction(n,r){const i=n.onclick;if(i||(n.href=this.linkService.getAnchorUrl("")),C(this,Bi,Hu).call(this),!this._fieldObjects){Ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(n.onclick=()=>!1);return}n.onclick=()=>{var f;i==null||i();const{fields:s,refs:a,include:o}=r,l=[];if(s.length!==0||a.length!==0){const p=new Set(a);for(const m of s){const y=this._fieldObjects[m]||[];for(const{id:g}of y)p.add(g)}for(const m of Object.values(this._fieldObjects))for(const y of m)p.has(y.id)===o&&l.push(y)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const u=this.annotationStorage,d=[];for(const p of l){const{id:m}=p;switch(d.push(m),p.type){case"text":{const g=p.defaultValue||"";u.setValue(m,{value:g});break}case"checkbox":case"radiobutton":{const g=p.defaultValue===p.exportValues;u.setValue(m,{value:g});break}case"combobox":case"listbox":{const g=p.defaultValue||"";u.setValue(m,{value:g});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!Qh.has(y)){Ne(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Bi=new WeakSet,Hu=function(){this.container.setAttribute("data-internal-link","")},_9=function(n,r,i="",s=null){n.href=this.linkService.getAnchorUrl(""),r.description?n.title=r.description:i&&(n.title=i),n.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(r.content,r.filename,s),!1},C(this,Bi,Hu).call(this)},S9=function(n,r,i=""){n.href=this.linkService.getAnchorUrl(""),n.onclick=()=>(this.linkService.executeSetOCGState(r),!1),i&&(n.title=i),C(this,Bi,Hu).call(this)};class oke extends Gt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class of extends Gt{render(){return this.container}showElementAndHideCanvas(e){var n;this.data.hasOwnCanvas&&(((n=e.previousSibling)==null?void 0:n.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return nr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,n,r,i,s){r.includes("mouse")?e.addEventListener(r,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{var o;if(r==="blur"){if(!n.focused||!a.relatedTarget)return;n.focused=!1}else if(r==="focus"){if(n.focused)return;n.focused=!0}s&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}}))})}_setEventListeners(e,n,r,i){var s,a,o;for(const[l,u]of r)(u==="Action"||(s=this.data.actions)!=null&&s[u])&&((u==="Focus"||u==="Blur")&&(n||(n={focused:!1})),this._setEventListener(e,n,l,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,n,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,n,"focus","Focus",null))}_setBackgroundColor(e){const n=this.data.backgroundColor||null;e.style.backgroundColor=n===null?"transparent":ge.makeHexColor(n[0],n[1],n[2])}_setTextStyle(e){const n=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||ike,s=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(u/(Lk*i))||1,f=u/d;a=Math.min(i,l(f/Lk))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(u/Lk))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=ge.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=n[this.data.textAlignment])}_setRequired(e,n){n?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",n)}}class lke extends of{constructor(e){const n=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:n})}setPropertyOnSiblings(e,n,r,i){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[n]=r),s.setValue(a.id,{[i]:r})}render(){var i,s;const e=this.annotationStorage,n=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=e.getValue(n,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(n,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=u??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",u??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Qh.add(r),this.contentElement=r,r.setAttribute("data-element-id",n),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:m}=this.data,y=!!p&&this.enableScripting;f&&(r.title=f),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",v=>{e.setValue(n,{value:v.target.value}),this.setPropertyOnSiblings(r,"value",v.target.value,"value"),d.formattedValue=null}),r.addEventListener("resetform",v=>{const b=this.data.defaultFieldValue??"";r.value=d.userValue=b,d.formattedValue=null});let g=v=>{const{formattedValue:b}=d;b!=null&&(v.target.value=b),v.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",b=>{var w;if(d.focused)return;const{target:x}=b;if(y&&(x.type=p,m&&(x.step=m)),d.userValue){const S=d.userValue;if(y)if(p==="time"){const _=new Date(S),A=[_.getHours(),_.getMinutes(),_.getSeconds()];x.value=A.map(j=>j.toString().padStart(2,"0")).join(":")}else x.value=new Date(S-ske).toISOString().split(p==="date"?"T":".",1)[0];else x.value=S}d.lastCommittedValue=x.value,d.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(d.focused=!0)}),r.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const x={value(w){d.userValue=w.detail.value??"",y||e.setValue(n,{value:d.userValue.toString()}),w.target.value=d.userValue},formattedValue(w){const{formattedValue:S}=w.detail;d.formattedValue=S,S!=null&&w.target!==document.activeElement&&(w.target.value=S);const _={formattedValue:S};y&&(_.value=S),e.setValue(n,_)},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var j;const{charLimit:S}=w.detail,{target:_}=w;if(S===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",S);let A=d.userValue;!A||A.length<=S||(A=A.slice(0,S),_.value=d.userValue=A,e.setValue(n,{value:A}),(j=this.linkService.eventBus)==null||j.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(x,b)}),r.addEventListener("keydown",b=>{var S;d.commitKey=1;let x=-1;if(b.key==="Escape"?x=0:b.key==="Enter"&&!this.data.multiLine?x=2:b.key==="Tab"&&(d.commitKey=3),x===-1)return;const{value:w}=b.target;d.lastCommittedValue!==w&&(d.lastCommittedValue=w,d.userValue=w,(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:w,willCommit:!0,commitKey:x,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const v=g;g=null,r.addEventListener("blur",b=>{var S,_;if(!d.focused||!b.relatedTarget)return;(S=this.data.actions)!=null&&S.Blur||(d.focused=!1);const{target:x}=b;let{value:w}=x;if(y){if(w&&p==="time"){const A=w.split(":").map(j=>parseInt(j,10));w=new Date(2e3,0,1,A[0],A[1],A[2]||0).valueOf(),x.step=""}else w.includes("T")||(w=`${w}T00:00`),w=new Date(w).valueOf();x.type="text"}d.userValue=w,d.lastCommittedValue!==w&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:w,willCommit:!0,commitKey:d.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),v(b)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",b=>{var P;d.lastCommittedValue=null;const{data:x,target:w}=b,{value:S,selectionStart:_,selectionEnd:A}=w;let j=_,N=A;switch(b.inputType){case"deleteWordBackward":{const O=S.substring(0,_).match(/\w*[^\w]*$/);O&&(j-=O[0].length);break}case"deleteWordForward":{const O=S.substring(_).match(/^[^\w]*\w*/);O&&(N+=O[0].length);break}case"deleteContentBackward":_===A&&(j-=1);break;case"deleteContentForward":_===A&&(N+=1);break}b.preventDefault(),(P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:S,change:x||"",willCommit:!1,selStart:j,selEnd:N}})}),this._setEventListeners(r,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(g&&r.addEventListener("blur",g),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class cke extends of{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class uke extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,n=this.data,r=n.id;let i=e.getValue(r,{value:n.exportValue===n.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Qh.add(s),s.setAttribute("data-element-id",r),s.disabled=n.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=n.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",n.exportValue),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r)){const d=l&&u.exportValue===n.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=n.defaultFieldValue||"Off";a.target.checked=o===n.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class A9 extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,n=this.data,r=n.id;let i=e.getValue(r,{value:n.fieldValue===n.buttonValue}).value;if(typeof i=="string"&&(i=i!==n.buttonValue,e.setValue(r,{value:i})),i)for(const a of this._getElementsByName(n.fieldName,r))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(Qh.add(s),s.setAttribute("data-element-id",r),s.disabled=n.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=n.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),s.addEventListener("resetform",a=>{const o=n.defaultFieldValue;a.target.checked=o!=null&&o===n.buttonValue}),this.enableScripting&&this.hasJSActions){const a=n.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const d=a===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const p=d&&f.id===r;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class dke extends FO{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const n=e.lastChild;return this.enableScripting&&this.hasJSActions&&n&&(this._setDefaultPropertiesFromJS(n),n.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class hke extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,n=this.data.id,r=e.getValue(n,{value:this.data.fieldValue}),i=document.createElement("select");Qh.add(i),i.setAttribute("data-element-id",n),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,r.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),s=!1),i.append(f)}let a=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),a=()=>{d.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=d=>{const f=d?"value":"textContent",{options:p,multiple:m}=i;return m?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const u=d=>{const f=d.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const f={value(p){a==null||a();const m=p.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const g of i.options)g.selected=y.has(g.value);e.setValue(n,{value:o(!0)}),l=o(!1)},multipleSelection(p){i.multiple=!0},remove(p){const m=i.options,y=p.detail.remove;m[y].selected=!1,i.remove(y),m.length>0&&Array.prototype.findIndex.call(m,v=>v.selected)===-1&&(m[0].selected=!0),e.setValue(n,{value:o(!0),items:u(p)}),l=o(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(n,{value:null,items:[]}),l=o(!1)},insert(p){const{index:m,displayValue:y,exportValue:g}=p.detail.insert,v=i.children[m],b=document.createElement("option");b.textContent=y,b.value=g,v?v.before(b):i.append(b),e.setValue(n,{value:o(!0),items:u(p)}),l=o(!1)},items(p){const{items:m}=p.detail;for(;i.length!==0;)i.remove(0);for(const y of m){const{displayValue:g,exportValue:v}=y,b=document.createElement("option");b.textContent=g,b.value=v,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(n,{value:o(!0),items:u(p)}),l=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const y of p.target.options)y.selected=m.has(y.index);e.setValue(n,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,d)}),i.addEventListener("input",d=>{var m;const f=o(!0),p=o(!1);e.setValue(n,{value:f}),d.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(n,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var Yx,L2;class $2 extends Gt{constructor(n){const{data:r,elements:i,parent:s}=n,a=!!s._commentManager;super(n,{isRenderable:!a&&Gt._hasPopupData(r)});E(this,Yx);if(this.elements=i,a&&Gt._hasPopupData(r)){const o=this.popup=C(this,Yx,L2).call(this);for(const l of i)l.popup=o}else this.popup=null}render(){const{container:n}=this;n.classList.add("popupAnnotation"),n.role="comment";const r=this.popup=C(this,Yx,L2).call(this),i=[];for(const s of this.elements)s.popup=r,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Yf}${s}`).join(",")),this.container}}Yx=new WeakSet,L2=function(){return new fke({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Ai,Ic,qS,GS,_m,Sm,Jt,Fa,Dc,lh,Am,jm,Ba,ji,Vo,Yo,Zt,Xo,$c,Xx,Qo,km,ch,Lc,Mn,Fc,De,x1,F2,B2,U2,b1,z2,j9,k9,N9,E9,w1,_1,W2;class fke{constructor({container:e,color:n,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:u,parentRect:d,open:f,commentManager:p=null}){E(this,De);E(this,Ai,null);E(this,Ic,C(this,De,N9).bind(this));E(this,qS,C(this,De,W2).bind(this));E(this,GS,C(this,De,_1).bind(this));E(this,_m,C(this,De,w1).bind(this));E(this,Sm,null);E(this,Jt,null);E(this,Fa,null);E(this,Dc,null);E(this,lh,null);E(this,Am,null);E(this,jm,null);E(this,Ba,!1);E(this,ji,null);E(this,Vo,null);E(this,Yo,null);E(this,Zt,null);E(this,Xo,null);E(this,$c,null);E(this,Xx,null);E(this,Qo,null);E(this,km,null);E(this,ch,null);E(this,Lc,!1);E(this,Mn,null);E(this,Fc,null);k(this,Jt,e),k(this,km,i),k(this,Fa,a),k(this,Qo,o),k(this,Am,l),k(this,Sm,n),k(this,Xx,u),k(this,jm,d),k(this,lh,r),k(this,Ai,p),k(this,Mn,r[0]),k(this,Dc,wS.toDateObject(s)),this.trigger=r.flatMap(m=>m.getElementsToTriggerPopup()),p||(C(this,De,x1).call(this),h(this,Jt).hidden=!0,f&&C(this,De,w1).call(this))}renderCommentButton(){if(h(this,Zt)){h(this,Zt).parentNode||h(this,Mn).container.after(h(this,Zt));return}if(h(this,Xo)||C(this,De,F2).call(this),!h(this,Xo))return;const{signal:e}=k(this,Vo,new AbortController),n=h(this,Mn).hasOwnCommentButton,r=()=>{h(this,Ai).toggleCommentPopup(this,!0,void 0,!n)},i=()=>{h(this,Ai).toggleCommentPopup(this,!1,!0,!n)},s=()=>{h(this,Ai).toggleCommentPopup(this,!1,!1)};if(n){k(this,Zt,h(this,Mn).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",h(this,Ic),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=k(this,Zt,document.createElement("button"));a.className="annotationCommentButton";const o=h(this,Mn).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),C(this,De,U2).call(this),C(this,De,B2).call(this),a.addEventListener("keydown",h(this,Ic),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",s,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:n}=h(this,Mn).commentData;return e?h(this,Am)._commentManager.makeCommentColor(e,n):null}focusCommentButton(){setTimeout(()=>{var e;(e=h(this,Zt))==null||e.focus()},0)}getData(){const{richText:e,color:n,opacity:r,creationDate:i,modificationDate:s}=h(this,Mn).commentData;return{contentsObj:{str:this.comment},richText:e,color:n,opacity:r,creationDate:i,modificationDate:s}}get elementBeforePopup(){return h(this,Zt)}get comment(){return h(this,Fc)||k(this,Fc,h(this,Mn).commentText),h(this,Fc)}set comment(e){e!==this.comment&&(h(this,Mn).commentText=k(this,Fc,e))}focus(){var e;(e=h(this,Mn).container)==null||e.focus()}get parentBoundingClientRect(){return h(this,Mn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:n}){h(this,Zt)&&(h(this,Zt).classList.toggle("selected",e),h(this,Zt).ariaExpanded=n)}setSelectedCommentButton(e){h(this,Zt).classList.toggle("selected",e)}get commentPopupPosition(){if(h(this,$c))return h(this,$c);const{x:e,y:n,height:r}=h(this,Zt).getBoundingClientRect(),{x:i,y:s,width:a,height:o}=h(this,Mn).layer.getBoundingClientRect();return[(e-i)/a,(n+r-s)/o]}set commentPopupPosition(e){k(this,$c,e)}hasDefaultPopupPosition(){return h(this,$c)===null}get commentButtonPosition(){return h(this,Xo)}get commentButtonWidth(){return h(this,Zt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[n,r]=h(this,$c)||this.commentButtonPosition.map(u=>u/100),i=this.parentBoundingClientRect,{x:s,y:a,width:o,height:l}=i;h(this,Ai).showDialog(null,this,s+n*o,a+r*l,{...e,parentDimensions:i})}render(){var r,i;if(h(this,ji))return;const e=k(this,ji,document.createElement("div"));if(e.className="popup",h(this,Sm)){const s=e.style.outlineColor=ge.makeHexColor(...h(this,Sm));e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const n=document.createElement("span");if(n.className="header",(r=h(this,km))!=null&&r.str){const s=document.createElement("span");s.className="title",n.append(s),{dir:s.dir,str:s.textContent}=h(this,km)}if(e.append(n),h(this,Dc)){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:h(this,Dc).valueOf()})),s.dateTime=h(this,Dc).toISOString(),n.append(s)}mz({html:h(this,De,b1)||h(this,Fa).str,dir:(i=h(this,Fa))==null?void 0:i.dir,className:"popupContent"},e),h(this,Jt).append(e)}updateEdited({rect:e,popup:n,deleted:r}){var i;if(h(this,Ai)){r?(this.remove(),k(this,Fc,null)):n&&(n.deleted?this.remove():(C(this,De,U2).call(this),k(this,Fc,n.text))),e&&(k(this,Xo,null),C(this,De,F2).call(this),C(this,De,B2).call(this));return}if(r||n!=null&&n.deleted){this.remove();return}C(this,De,x1).call(this),h(this,ch)||k(this,ch,{contentsObj:h(this,Fa),richText:h(this,Qo)}),e&&k(this,Yo,null),n&&n.text&&(k(this,Qo,C(this,De,k9).call(this,n.text)),k(this,Dc,wS.toDateObject(n.date)),k(this,Fa,null)),(i=h(this,ji))==null||i.remove(),k(this,ji,null)}resetEdited(){var e;h(this,ch)&&({contentsObj:Vt(this,Fa)._,richText:Vt(this,Qo)._}=h(this,ch),k(this,ch,null),(e=h(this,ji))==null||e.remove(),k(this,ji,null),k(this,Yo,null))}remove(){var e,n,r;if((e=h(this,Vo))==null||e.abort(),k(this,Vo,null),(n=h(this,ji))==null||n.remove(),k(this,ji,null),k(this,Lc,!1),k(this,Ba,!1),(r=h(this,Zt))==null||r.remove(),k(this,Zt,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){k(this,Lc,this.isVisible),h(this,Lc)&&(h(this,Jt).hidden=!0)}maybeShow(){h(this,Ai)||(C(this,De,x1).call(this),h(this,Lc)&&(h(this,ji)||C(this,De,_1).call(this),k(this,Lc,!1),h(this,Jt).hidden=!1))}get isVisible(){return h(this,Ai)?!1:h(this,Jt).hidden===!1}}Ai=new WeakMap,Ic=new WeakMap,qS=new WeakMap,GS=new WeakMap,_m=new WeakMap,Sm=new WeakMap,Jt=new WeakMap,Fa=new WeakMap,Dc=new WeakMap,lh=new WeakMap,Am=new WeakMap,jm=new WeakMap,Ba=new WeakMap,ji=new WeakMap,Vo=new WeakMap,Yo=new WeakMap,Zt=new WeakMap,Xo=new WeakMap,$c=new WeakMap,Xx=new WeakMap,Qo=new WeakMap,km=new WeakMap,ch=new WeakMap,Lc=new WeakMap,Mn=new WeakMap,Fc=new WeakMap,De=new WeakSet,x1=function(){var n;if(h(this,Vo))return;k(this,Vo,new AbortController);const{signal:e}=h(this,Vo);for(const r of this.trigger)r.addEventListener("click",h(this,_m),{signal:e}),r.addEventListener("pointerenter",h(this,GS),{signal:e}),r.addEventListener("pointerleave",h(this,qS),{signal:e}),r.classList.add("popupTriggerArea");for(const r of h(this,lh))(n=r.container)==null||n.addEventListener("keydown",h(this,Ic),{signal:e})},F2=function(){const e=h(this,lh).find(n=>n.hasCommentButton);e&&k(this,Xo,e._normalizePoint(e.commentButtonPosition))},B2=function(){if(h(this,Mn).extraPopupElement&&!h(this,Mn).editor)return;h(this,Zt)||this.renderCommentButton();const[e,n]=h(this,Xo),{style:r}=h(this,Zt);r.left=`calc(${e}%)`,r.top=`calc(${n}% - var(--comment-button-dim))`},U2=function(){h(this,Mn).extraPopupElement||(h(this,Zt)||this.renderCommentButton(),h(this,Zt).style.backgroundColor=this.commentButtonColor||"")},b1=function(){const e=h(this,Qo),n=h(this,Fa);return e!=null&&e.str&&(!(n!=null&&n.str)||n.str===e.str)&&h(this,Qo).html||null},z2=function(){var e,n,r;return((r=(n=(e=h(this,De,b1))==null?void 0:e.attributes)==null?void 0:n.style)==null?void 0:r.fontSize)||0},j9=function(){var e,n,r;return((r=(n=(e=h(this,De,b1))==null?void 0:e.attributes)==null?void 0:n.style)==null?void 0:r.color)||null},k9=function(e){const n=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:n}]}},i={style:{color:h(this,De,j9),fontSize:h(this,De,z2)?`calc(${h(this,De,z2)}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))n.push({name:"span",value:s,attributes:i});return r},N9=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&h(this,Ba))&&C(this,De,w1).call(this)},E9=function(){if(h(this,Yo)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:s}}}=h(this,Am);let a=!!h(this,jm),o=a?h(this,jm):h(this,Xx);for(const y of h(this,lh))if(!o||ge.intersect(y.data.rect,o)!==null){o=y.data.rect,a=!0;break}const l=ge.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=a?o[2]-o[0]+5:0,f=l[0]+d,p=l[1];k(this,Yo,[100*(f-i)/n,100*(p-s)/r]);const{style:m}=h(this,Jt);m.left=`${h(this,Yo)[0]}%`,m.top=`${h(this,Yo)[1]}%`},w1=function(){if(h(this,Ai)){h(this,Ai).toggleCommentPopup(this,!1);return}k(this,Ba,!h(this,Ba)),h(this,Ba)?(C(this,De,_1).call(this),h(this,Jt).addEventListener("click",h(this,_m)),h(this,Jt).addEventListener("keydown",h(this,Ic))):(C(this,De,W2).call(this),h(this,Jt).removeEventListener("click",h(this,_m)),h(this,Jt).removeEventListener("keydown",h(this,Ic)))},_1=function(){h(this,ji)||this.render(),this.isVisible?h(this,Ba)&&h(this,Jt).classList.add("focused"):(C(this,De,E9).call(this),h(this,Jt).hidden=!1,h(this,Jt).style.zIndex=parseInt(h(this,Jt).style.zIndex)+1e3)},W2=function(){h(this,Jt).classList.remove("focused"),!(h(this,Ba)||!this.isVisible)&&(h(this,Jt).hidden=!0,h(this,Jt).style.zIndex=parseInt(h(this,Jt).style.zIndex)-1e3)};class C9 extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Pe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const n of this.textContent){const r=document.createElement("span");r.textContent=n,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Qx;class pke extends Gt{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});E(this,Qx,null)}render(){this.container.classList.add("lineAnnotation");const{data:n,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=k(this,Qx,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",n.rect[2]-n.lineCoordinates[0]),a.setAttribute("y1",n.rect[3]-n.lineCoordinates[1]),a.setAttribute("x2",n.rect[2]-n.lineCoordinates[2]),a.setAttribute("y2",n.rect[3]-n.lineCoordinates[3]),a.setAttribute("stroke-width",n.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!n.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,Qx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qx=new WeakMap;var Jx;class mke extends Gt{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});E(this,Jx,null)}render(){this.container.classList.add("squareAnnotation");const{data:n,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=n.borderStyle.width,o=k(this,Jx,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!n.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,Jx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Jx=new WeakMap;var Zx;class gke extends Gt{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});E(this,Zx,null)}render(){this.container.classList.add("circleAnnotation");const{data:n,width:r,height:i}=this,s=this.svgFactory.create(r,i,!0),a=n.borderStyle.width,o=k(this,Zx,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",i/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!n.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,Zx)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zx=new WeakMap;var eb;class P9 extends Gt{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});E(this,eb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:n,vertices:r,borderStyle:i,popupRef:s},width:a,height:o}=this;if(!r)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let f=0,p=r.length;f<p;f+=2){const m=r[f]-n[0],y=n[3]-r[f+1];u.push(`${m},${y}`)}u=u.join(" ");const d=k(this,eb,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return h(this,eb)}addHighlightArea(){this.container.classList.add("highlightArea")}}eb=new WeakMap;class yke extends P9{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class vke extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var tb,uh,nb,H2;class BO extends Gt{constructor(n){super(n,{isRenderable:!0,ignoreBorder:!0});E(this,nb);E(this,tb,null);E(this,uh,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Pe.HIGHLIGHT:Pe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:n,rotation:r,inkLists:i,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:u}=C(this,nb,H2).call(this,r,n),d=this.svgFactory.create(l,u,!0),f=k(this,tb,this.svgFactory.createElement("svg:g"));d.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,m=i.length;p<m;p++){const y=this.svgFactory.createElement(this.svgElementName);h(this,uh).push(y),y.setAttribute("points",i[p].join(",")),f.append(y)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(n){super.updateEdited(n);const{thickness:r,points:i,rect:s}=n,a=h(this,tb);if(r>=0&&a.setAttribute("stroke-width",r||1),i)for(let o=0,l=h(this,uh).length;o<l;o++)h(this,uh)[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:l,height:u}=C(this,nb,H2).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return h(this,uh)}addHighlightArea(){this.container.classList.add("highlightArea")}}tb=new WeakMap,uh=new WeakMap,nb=new WeakSet,H2=function(n,r){switch(n){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class T9 extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Pe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:n}}=this;if(!n&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class xke extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:n}}=this;if(!n&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class bke extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:n}}=this;if(!n&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class wke extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:n}}=this;if(!n&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class O9 extends Gt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Pe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var rb,ib,q2;class _ke extends Gt{constructor(n){var i;super(n,{isRenderable:!0});E(this,ib);E(this,rb,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:n,data:r}=this;let i;r.hasAppearance||r.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),i.addEventListener("dblclick",C(this,ib,q2).bind(this)),k(this,rb,i);const{isMac:s}=nr.platform;return n.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&C(this,ib,q2).call(this)}),!r.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),n.append(i),n}getElementsToTriggerPopup(){return h(this,rb)}addHighlightArea(){this.container.classList.add("highlightArea")}}rb=new WeakMap,ib=new WeakSet,q2=function(){var n;(n=this.downloadManager)==null||n.openOrDownloadData(this.content,this.filename)};var dh,hh,Nm,Bc,sb,fh,ki,ab,gl,S1,K2;const VO=class VO{constructor({div:e,accessibilityManager:n,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:o,commentManager:l,linkService:u,annotationStorage:d}){E(this,gl);E(this,dh,null);E(this,hh,null);E(this,Nm,null);E(this,Bc,new Map);E(this,sb,null);E(this,fh,null);E(this,ki,[]);E(this,ab,!1);this.div=e,k(this,dh,n),k(this,hh,r),k(this,sb,o||null),k(this,fh,u||null),k(this,Nm,d||new DO),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return h(this,Bc).size>0}async render(e){var o;const{annotations:n}=e,r=this.div;Yh(r,this.viewport);const i=new Map,s=[],a={data:null,layer:r,linkService:h(this,fh),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new CS,annotationStorage:h(this,Nm),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of n){if(l.noHTML)continue;const u=l.annotationType===un.POPUP;if(u){const p=i.get(l.id);if(!p)continue;if(!this._commentManager){s.push(l);continue}a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const d=Gk.create(a);if(!d.isRenderable)continue;if(!u&&(h(this,ki).push(d),l.popupRef)){const p=i.get(l.popupRef);p?p.push(d):i.set(l.popupRef,[d])}const f=d.render();l.hidden&&(f.style.visibility="hidden"),d._isEditable&&(h(this,Bc).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}await C(this,gl,S1).call(this);for(const l of s){const u=a.elements=i.get(l.id);a.data=l;const d=Gk.create(a);if(!d.isRenderable)continue;const f=d.render();d.contentElement.id=`${Yf}${l.id}`,l.hidden&&(f.style.visibility="hidden"),u.at(-1).container.after(f)}C(this,gl,K2).call(this)}async addLinkAnnotations(e){const n={data:null,layer:this.div,linkService:h(this,fh),svgFactory:new CS,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=VO._defaultBorderStyle),n.data=r;const i=Gk.create(n);i.isRenderable&&(i.render(),i.contentElement.id=`${Yf}${r.id}`,h(this,ki).push(i))}await C(this,gl,S1).call(this)}update({viewport:e}){const n=this.div;this.viewport=e,Yh(n,{rotation:e.rotation}),C(this,gl,K2).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(h(this,Bc).values())}getEditableAnnotation(e){return h(this,Bc).get(e)}addFakeAnnotation(e){const{div:n}=this,{id:r,rotation:i}=e,s=new ake({data:{id:r,rect:e.getPDFRect(),rotation:i},editor:e,layer:n,parent:this,enableComment:!!this._commentManager,linkService:h(this,fh),annotationStorage:h(this,Nm)});return s.render(),s.contentElement.id=`${Yf}${r}`,s.createOrUpdatePopup(),h(this,ki).push(s),s}removeAnnotation(e){var i;const n=h(this,ki).findIndex(s=>s.data.id===e);if(n<0)return;const[r]=h(this,ki).splice(n,1);(i=h(this,dh))==null||i.removePointerInTextLayer(r.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const n of e)n.updateFakeAnnotationElement(this);C(this,gl,S1).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Oe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Af.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};dh=new WeakMap,hh=new WeakMap,Nm=new WeakMap,Bc=new WeakMap,sb=new WeakMap,fh=new WeakMap,ki=new WeakMap,ab=new WeakMap,gl=new WeakSet,S1=async function(){var r,i,s;if(h(this,ki).length===0)return;this.div.replaceChildren();const e=[];if(!h(this,ab)){k(this,ab,!0);for(const{contentElement:a,data:{id:o}}of h(this,ki)){const l=a.id=`${Yf}${o}`;e.push((r=h(this,sb))==null?void 0:r.getAriaAttributes(l).then(u=>{if(u)for(const[d,f]of u)a.setAttribute(d,f)}))}}h(this,ki).sort(({data:{rect:[a,o,l,u]}},{data:{rect:[d,f,p,m]}})=>{if(a===l&&o===u)return 1;if(d===p&&f===m)return-1;const y=u,g=o,v=(o+u)/2,b=m,x=f,w=(f+m)/2;if(v>=b&&w<=g)return-1;if(w>=y&&v<=x)return 1;const S=(a+l)/2,_=(d+p)/2;return S-_});const n=document.createDocumentFragment();for(const a of h(this,ki))n.append(a.container),this._commentManager?(s=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||s.renderCommentButton():a.extraPopupElement&&n.append(a.extraPopupElement.render());if(this.div.append(n),await Promise.all(e),h(this,dh))for(const a of h(this,ki))h(this,dh).addPointerInTextLayer(a.contentElement,!1)},K2=function(){var n;if(!h(this,hh))return;const e=this.div;for(const[r,i]of h(this,hh)){const s=e.querySelector(`[data-annotation-id="${r}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):s.append(i);const o=h(this,Bc).get(r);o&&(o._hasNoCanvas?((n=this._annotationEditorUIManager)==null||n.setMissingCanvas(r,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}h(this,hh).clear()};let G2=VO;const Bw=/\r\n?|\n/g;var Ni,ob,ph,Ei,yn,M9,R9,I9,A1,yl,j1,k1,D9,Y2,$9;const Pt=class Pt extends Nt{constructor(n){super({...n,name:"freeTextEditor"});E(this,yn);E(this,Ni,"");E(this,ob,`${this.id}-editor`);E(this,ph,null);E(this,Ei);ae(this,"_colorPicker",null);this.color=n.color||Pt._defaultColor||Nt._defaultLineColor,k(this,Ei,n.fontSize||Pt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const n=Pt.prototype,r=a=>a.isEmpty(),i=Xh.TRANSLATE_SMALL,s=Xh.TRANSLATE_BIG;return Oe(this,"_keyboardManager",new Kb([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],n.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],n._translateEmpty,{args:[-i,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],n._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],n._translateEmpty,{args:[i,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],n._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],n._translateEmpty,{args:[0,-i],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],n._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],n._translateEmpty,{args:[0,i],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],n._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(n,r){Nt.initialize(n,r);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(n,r){switch(n){case ze.FREETEXT_SIZE:Pt._defaultFontSize=r;break;case ze.FREETEXT_COLOR:Pt._defaultColor=r;break}}updateParams(n,r){switch(n){case ze.FREETEXT_SIZE:C(this,yn,M9).call(this,r);break;case ze.FREETEXT_COLOR:C(this,yn,R9).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ze.FREETEXT_SIZE,Pt._defaultFontSize],[ze.FREETEXT_COLOR,Pt._defaultColor||Nt._defaultLineColor]]}get propertiesToUpdate(){return[[ze.FREETEXT_SIZE,h(this,Ei)],[ze.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new ES(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ze.FREETEXT_COLOR}onUpdatedColor(){var n;this.editorDiv.style.color=this.color,(n=this._colorPicker)==null||n.update(this.color),super.onUpdatedColor()}_translateEmpty(n,r){this._uiManager.translateSelectedEditors(n,r,!0)}getInitialTranslation(){const n=this.parentScale;return[-Pt._internalPadding*n,-(Pt._internalPadding+h(this,Ei))*n]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),k(this,ph,new AbortController);const n=this._uiManager.combinedSignal(h(this,ph));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:n}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:n}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:n}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:n}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:n}),!0}disableEditMode(){var n;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",h(this,ob)),this._isDraggable=!0,(n=h(this,ph))==null||n.abort(),k(this,ph,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(n){this._focusEventsAllowed&&(super.focusin(n),n.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(n){var r;this.width||(this.enableEditMode(),n&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const n=h(this,Ni),r=k(this,Ni,C(this,yn,I9).call(this).trimEnd());if(n===r)return;const i=s=>{if(k(this,Ni,s),!s){this.remove();return}C(this,yn,k1).call(this),this._uiManager.rebuild(this),C(this,yn,A1).call(this)};this.addCommands({cmd:()=>{i(r)},undo:()=>{i(n)},mustExec:!1}),C(this,yn,A1).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(n){n.target===this.div&&n.key==="Enter"&&(this.enterInEditMode(),n.preventDefault())}editorDivKeydown(n){Pt._keyboardManager.exec(this,n)}editorDivFocus(n){this.isEditing=!0}editorDivBlur(n){this.isEditing=!1}editorDivInput(n){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let n,r;(this._isCopy||this.annotationElementId)&&(n=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",h(this,ob)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${h(this,Ei)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[d,f]=this.pageDimensions,[p,m]=this.pageTranslation;let y,g;switch(this.rotation){case 0:y=n+(o[0]-p)/d,g=r+this.height-(o[1]-m)/f;break;case 90:y=n+(o[0]-p)/d,g=r-(o[1]-m)/f,[l,u]=[u,-l];break;case 180:y=n-this.width+(o[0]-p)/d,g=r-(o[1]-m)/f,[l,u]=[-l,-u];break;case 270:y=n+(o[0]-p-this.height*f)/d,g=r+(o[1]-m-this.width*d)/f,[l,u]=[-u,l];break}this.setAt(y*s,g*a,l,u)}else this._moveAfterPaste(n,r);C(this,yn,k1).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(n){var y,g,v;const r=n.clipboardData||window.clipboardData,{types:i}=r;if(i.length===1&&i[0]==="text/plain")return;n.preventDefault();const s=C(y=Pt,yl,Y2).call(y,r.getData("text")||"").replaceAll(Bw,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,d=[],f=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(f.push(l.nodeValue.slice(u).replaceAll(Bw,"")),b!==this.editorDiv){let x=d;for(const w of this.editorDiv.childNodes){if(w===b){x=f;continue}x.push(C(g=Pt,yl,j1).call(g,w))}}d.push(l.nodeValue.slice(0,u).replaceAll(Bw,""))}else if(l===this.editorDiv){let b=d,x=0;for(const w of this.editorDiv.childNodes)x++===u&&(b=f),b.push(C(v=Pt,yl,j1).call(v,w))}k(this,Ni,`${d.join(`
`)}${s}${f.join(`
`)}`),C(this,yn,k1).call(this);const p=new Range;let m=Math.sumPrecise(d.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const x=b.nodeValue.length;if(m<=x){p.setStart(b,m),p.setEnd(b,m);break}m-=x}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const n=Pt._internalPadding*this.parentScale;return this.getRect(n,n)}static async deserialize(n,r,i){var o;let s=null;if(n instanceof C9){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:p,popupRef:m,richText:y,contentsObj:g,creationDate:v,modificationDate:b},textContent:x,textPosition:w,parent:{page:{pageNumber:S}}}=n;if(!x||x.length===0)return null;s=n={annotationType:Pe.FREETEXT,color:Array.from(u),fontSize:l,value:x.join(`
`),position:w,pageIndex:S-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:(g==null?void 0:g.str)||null,richText:y,creationDate:v,modificationDate:b}}const a=await super.deserialize(n,r,i);return k(a,Ei,n.fontSize),a.color=ge.makeHexColor(...n.color),k(a,Ni,C(o=Pt,yl,Y2).call(o,n.value)),a._initialData=s,n.comment&&a.setCommentData(n),a}serialize(n=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Nt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(n),{color:r,fontSize:h(this,Ei),value:C(this,yn,D9).call(this)});return this.addComment(i),n?(i.isCopy=!0,i):this.annotationElementId&&!C(this,yn,$9).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(n){const r=super.renderAnnotationElement(n);if(!r)return null;const{style:i}=r;i.fontSize=`calc(${h(this,Ei)}px * var(--total-scale-factor))`,i.color=this.color,r.replaceChildren();for(const s of h(this,Ni).split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),r.append(a)}return n.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:h(this,Ni)}}),r}resetAnnotationElement(n){super.resetAnnotationElement(n),n.resetEdited()}};Ni=new WeakMap,ob=new WeakMap,ph=new WeakMap,Ei=new WeakMap,yn=new WeakSet,M9=function(n){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-h(this,Ei))*this.parentScale),k(this,Ei,s),C(this,yn,A1).call(this)},i=h(this,Ei);this.addCommands({cmd:r.bind(this,n),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},R9=function(n){const r=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:r.bind(this,n),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},I9=function(){var i;const n=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(n.push(C(i=Pt,yl,j1).call(i,s)),r=s);return n.join(`
`)},A1=function(){const[n,r]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/n,this.height=i.height/r):(this.width=i.height/n,this.height=i.width/r),this.fixAndSetPosition()},yl=new WeakSet,j1=function(n){return(n.nodeType===Node.TEXT_NODE?n.nodeValue:n.innerText).replaceAll(Bw,"")},k1=function(){if(this.editorDiv.replaceChildren(),!!h(this,Ni))for(const n of h(this,Ni).split(`
`)){const r=document.createElement("div");r.append(n?document.createTextNode(n):document.createElement("br")),this.editorDiv.append(r)}},D9=function(){return h(this,Ni).replaceAll(""," ")},Y2=function(n){return n.replaceAll(" ","")},$9=function(n){const{value:r,fontSize:i,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||n.value!==r||n.fontSize!==i||n.color.some((o,l)=>o!==s[l])||n.pageIndex!==a},E(Pt,yl),ae(Pt,"_freeTextDefaultContent",""),ae(Pt,"_internalPadding",0),ae(Pt,"_defaultColor",null),ae(Pt,"_defaultFontSize",10),ae(Pt,"_type","freetext"),ae(Pt,"_editorType",Pe.FREETEXT);let V2=Pt;class pe{toSVGPath(){bt("Abstract method `toSVGPath` must be implemented.")}get box(){bt("Abstract getter `box` must be implemented.")}serialize(e,n){bt("Abstract method `serialize` must be implemented.")}static _rescale(e,n,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=n+e[o]*i,a[o+1]=r+e[o+1]*s;return a}static _rescaleAndSwap(e,n,r,i,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=n+e[o+1]*i,a[o+1]=r+e[o]*s;return a}static _translate(e,n,r,i){i||(i=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)i[s]=n+e[s],i[s+1]=r+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,n,r,i,s){switch(s){case 90:return[1-n/r,e/i];case 180:return[1-e/r,1-n/i];case 270:return[n/r,1-e/i];default:return[e/r,n/i]}}static _normalizePagePoint(e,n,r){switch(r){case 90:return[1-n,e];case 180:return[1-e,1-n];case 270:return[n,1-e];default:return[e,n]}}static createBezierPoints(e,n,r,i,s,a){return[(e+5*r)/6,(n+5*i)/6,(5*r+s)/6,(5*i+a)/6,(r+s)/2,(i+a)/2]}}ae(pe,"PRECISION",1e-4);var Ci,Ys,Em,Cm,Ua,$e,mh,gh,lb,cb,Pm,Tm,Uc,ub,KS,VS,Cn,Xy,L9,F9,B9,U9,z9,W9;const xo=class xo{constructor({x:e,y:n},r,i,s,a,o=0){E(this,Cn);E(this,Ci);E(this,Ys,[]);E(this,Em);E(this,Cm);E(this,Ua,[]);E(this,$e,new Float32Array(18));E(this,mh);E(this,gh);E(this,lb);E(this,cb);E(this,Pm);E(this,Tm);E(this,Uc,[]);k(this,Ci,r),k(this,Tm,s*i),k(this,Cm,a),h(this,$e).set([NaN,NaN,NaN,NaN,e,n],6),k(this,Em,o),k(this,cb,h(xo,ub)*i),k(this,lb,h(xo,VS)*i),k(this,Pm,i),h(this,Uc).push(e,n)}isEmpty(){return isNaN(h(this,$e)[8])}add({x:e,y:n}){var P;k(this,mh,e),k(this,gh,n);const[r,i,s,a]=h(this,Ci);let[o,l,u,d]=h(this,$e).subarray(8,12);const f=e-u,p=n-d,m=Math.hypot(f,p);if(m<h(this,lb))return!1;const y=m-h(this,cb),g=y/m,v=g*f,b=g*p;let x=o,w=l;o=u,l=d,u+=v,d+=b,(P=h(this,Uc))==null||P.push(e,n);const S=-b/y,_=v/y,A=S*h(this,Tm),j=_*h(this,Tm);return h(this,$e).set(h(this,$e).subarray(2,8),0),h(this,$e).set([u+A,d+j],4),h(this,$e).set(h(this,$e).subarray(14,18),12),h(this,$e).set([u-A,d-j],16),isNaN(h(this,$e)[6])?(h(this,Ua).length===0&&(h(this,$e).set([o+A,l+j],2),h(this,Ua).push(NaN,NaN,NaN,NaN,(o+A-r)/s,(l+j-i)/a),h(this,$e).set([o-A,l-j],14),h(this,Ys).push(NaN,NaN,NaN,NaN,(o-A-r)/s,(l-j-i)/a)),h(this,$e).set([x,w,o,l,u,d],6),!this.isEmpty()):(h(this,$e).set([x,w,o,l,u,d],6),Math.abs(Math.atan2(w-l,x-o)-Math.atan2(b,v))<Math.PI/2?([o,l,u,d]=h(this,$e).subarray(2,6),h(this,Ua).push(NaN,NaN,NaN,NaN,((o+u)/2-r)/s,((l+d)/2-i)/a),[o,l,x,w]=h(this,$e).subarray(14,18),h(this,Ys).push(NaN,NaN,NaN,NaN,((x+o)/2-r)/s,((w+l)/2-i)/a),!0):([x,w,o,l,u,d]=h(this,$e).subarray(0,6),h(this,Ua).push(((x+5*o)/6-r)/s,((w+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+d)/6-i)/a,((o+u)/2-r)/s,((l+d)/2-i)/a),[u,d,o,l,x,w]=h(this,$e).subarray(12,18),h(this,Ys).push(((x+5*o)/6-r)/s,((w+5*l)/6-i)/a,((5*o+u)/6-r)/s,((5*l+d)/6-i)/a,((o+u)/2-r)/s,((l+d)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=h(this,Ua),n=h(this,Ys);if(isNaN(h(this,$e)[6])&&!this.isEmpty())return C(this,Cn,L9).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);C(this,Cn,B9).call(this,r);for(let i=n.length-6;i>=6;i-=6)isNaN(n[i])?r.push(`L${n[i+4]} ${n[i+5]}`):r.push(`C${n[i]} ${n[i+1]} ${n[i+2]} ${n[i+3]} ${n[i+4]} ${n[i+5]}`);return C(this,Cn,F9).call(this,r),r.join(" ")}newFreeDrawOutline(e,n,r,i,s,a){return new H9(e,n,r,i,s,a)}getOutlines(){var f;const e=h(this,Ua),n=h(this,Ys),r=h(this,$e),[i,s,a,o]=h(this,Ci),l=new Float32Array((((f=h(this,Uc))==null?void 0:f.length)??0)+2);for(let p=0,m=l.length-2;p<m;p+=2)l[p]=(h(this,Uc)[p]-i)/a,l[p+1]=(h(this,Uc)[p+1]-s)/o;if(l[l.length-2]=(h(this,mh)-i)/a,l[l.length-1]=(h(this,gh)-s)/o,isNaN(r[6])&&!this.isEmpty())return C(this,Cn,U9).call(this,l);const u=new Float32Array(h(this,Ua).length+24+h(this,Ys).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}d=C(this,Cn,W9).call(this,u,d);for(let p=n.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(n[p+m])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=n[p+m],u[d+1]=n[p+m+1],d+=2}return C(this,Cn,z9).call(this,u,d),this.newFreeDrawOutline(u,l,h(this,Ci),h(this,Pm),h(this,Em),h(this,Cm))}};Ci=new WeakMap,Ys=new WeakMap,Em=new WeakMap,Cm=new WeakMap,Ua=new WeakMap,$e=new WeakMap,mh=new WeakMap,gh=new WeakMap,lb=new WeakMap,cb=new WeakMap,Pm=new WeakMap,Tm=new WeakMap,Uc=new WeakMap,ub=new WeakMap,KS=new WeakMap,VS=new WeakMap,Cn=new WeakSet,Xy=function(){const e=h(this,$e).subarray(4,6),n=h(this,$e).subarray(16,18),[r,i,s,a]=h(this,Ci);return[(h(this,mh)+(e[0]-n[0])/2-r)/s,(h(this,gh)+(e[1]-n[1])/2-i)/a,(h(this,mh)+(n[0]-e[0])/2-r)/s,(h(this,gh)+(n[1]-e[1])/2-i)/a]},L9=function(){const[e,n,r,i]=h(this,Ci),[s,a,o,l]=C(this,Cn,Xy).call(this);return`M${(h(this,$e)[2]-e)/r} ${(h(this,$e)[3]-n)/i} L${(h(this,$e)[4]-e)/r} ${(h(this,$e)[5]-n)/i} L${s} ${a} L${o} ${l} L${(h(this,$e)[16]-e)/r} ${(h(this,$e)[17]-n)/i} L${(h(this,$e)[14]-e)/r} ${(h(this,$e)[15]-n)/i} Z`},F9=function(e){const n=h(this,Ys);e.push(`L${n[4]} ${n[5]} Z`)},B9=function(e){const[n,r,i,s]=h(this,Ci),a=h(this,$e).subarray(4,6),o=h(this,$e).subarray(16,18),[l,u,d,f]=C(this,Cn,Xy).call(this);e.push(`L${(a[0]-n)/i} ${(a[1]-r)/s} L${l} ${u} L${d} ${f} L${(o[0]-n)/i} ${(o[1]-r)/s}`)},U9=function(e){const n=h(this,$e),[r,i,s,a]=h(this,Ci),[o,l,u,d]=C(this,Cn,Xy).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(n[2]-r)/s,(n[3]-i)/a,NaN,NaN,NaN,NaN,(n[4]-r)/s,(n[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(n[16]-r)/s,(n[17]-i)/a,NaN,NaN,NaN,NaN,(n[14]-r)/s,(n[15]-i)/a],0),this.newFreeDrawOutline(f,e,h(this,Ci),h(this,Pm),h(this,Em),h(this,Cm))},z9=function(e,n){const r=h(this,Ys);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],n),n+=6},W9=function(e,n){const r=h(this,$e).subarray(4,6),i=h(this,$e).subarray(16,18),[s,a,o,l]=h(this,Ci),[u,d,f,p]=C(this,Cn,Xy).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l],n),n+=24},E(xo,ub,8),E(xo,KS,2),E(xo,VS,h(xo,ub)+h(xo,KS));let PS=xo;var Om,yh,Jo,db,Pi,hb,an,YS,q9;class H9 extends pe{constructor(n,r,i,s,a,o){super();E(this,YS);E(this,Om);E(this,yh,new Float32Array(4));E(this,Jo);E(this,db);E(this,Pi);E(this,hb);E(this,an);k(this,an,n),k(this,Pi,r),k(this,Om,i),k(this,hb,s),k(this,Jo,a),k(this,db,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],C(this,YS,q9).call(this,o);const[l,u,d,f]=h(this,yh);for(let p=0,m=n.length;p<m;p+=2)n[p]=(n[p]-l)/d,n[p+1]=(n[p+1]-u)/f;for(let p=0,m=r.length;p<m;p+=2)r[p]=(r[p]-l)/d,r[p+1]=(r[p+1]-u)/f}toSVGPath(){const n=[`M${h(this,an)[4]} ${h(this,an)[5]}`];for(let r=6,i=h(this,an).length;r<i;r+=6){if(isNaN(h(this,an)[r])){n.push(`L${h(this,an)[r+4]} ${h(this,an)[r+5]}`);continue}n.push(`C${h(this,an)[r]} ${h(this,an)[r+1]} ${h(this,an)[r+2]} ${h(this,an)[r+3]} ${h(this,an)[r+4]} ${h(this,an)[r+5]}`)}return n.push("Z"),n.join(" ")}serialize([n,r,i,s],a){const o=i-n,l=s-r;let u,d;switch(a){case 0:u=pe._rescale(h(this,an),n,s,o,-l),d=pe._rescale(h(this,Pi),n,s,o,-l);break;case 90:u=pe._rescaleAndSwap(h(this,an),n,r,o,l),d=pe._rescaleAndSwap(h(this,Pi),n,r,o,l);break;case 180:u=pe._rescale(h(this,an),i,r,-o,l),d=pe._rescale(h(this,Pi),i,r,-o,l);break;case 270:u=pe._rescaleAndSwap(h(this,an),i,s,-o,-l),d=pe._rescaleAndSwap(h(this,Pi),i,s,-o,-l);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return h(this,yh)}newOutliner(n,r,i,s,a,o=0){return new PS(n,r,i,s,a,o)}getNewOutline(n,r){const[i,s,a,o]=h(this,yh),[l,u,d,f]=h(this,Om),p=a*d,m=o*f,y=i*d+l,g=s*f+u,v=this.newOutliner({x:h(this,Pi)[0]*p+y,y:h(this,Pi)[1]*m+g},h(this,Om),h(this,hb),n,h(this,db),r??h(this,Jo));for(let b=2;b<h(this,Pi).length;b+=2)v.add({x:h(this,Pi)[b]*p+y,y:h(this,Pi)[b+1]*m+g});return v.getOutlines()}}Om=new WeakMap,yh=new WeakMap,Jo=new WeakMap,db=new WeakMap,Pi=new WeakMap,hb=new WeakMap,an=new WeakMap,YS=new WeakSet,q9=function(n){const r=h(this,an);let i=r[4],s=r[5];const a=[i,s,i,s];let o=i,l=s,u=i,d=s;const f=n?Math.max:Math.min,p=new Float32Array(4);for(let y=6,g=r.length;y<g;y+=6){const v=r[y+4],b=r[y+5];isNaN(r[y])?(ge.pointBoundingBox(v,b,a),l>b?(o=v,l=b):l===b&&(o=f(o,v)),d<b?(u=v,d=b):d===b&&(u=f(u,v))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,ge.bezierBoundingBox(i,s,...r.slice(y,y+6),p),ge.rectBoundingBox(p[0],p[1],p[2],p[3],a),l>p[1]?(o=p[0],l=p[1]):l===p[1]&&(o=f(o,p[0])),d<p[3]?(u=p[2],d=p[3]):d===p[3]&&(u=f(u,p[2]))),i=v,s=b}const m=h(this,yh);m[0]=a[0]-h(this,Jo),m[1]=a[1]-h(this,Jo),m[2]=a[2]-a[0]+2*h(this,Jo),m[3]=a[3]-a[1]+2*h(this,Jo),this.firstPoint=[o,l],this.lastPoint=[u,d]};var fb,pb,mb,zc,Xs,Br,G9,N1,K9,V9,Q2;class X2{constructor(e,n=0,r=0,i=!0){E(this,Br);E(this,fb);E(this,pb);E(this,mb);E(this,zc,[]);E(this,Xs,[]);const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:g,y:v,width:b,height:x}of e){const w=Math.floor((g-n)/a)*a,S=Math.ceil((g+b+n)/a)*a,_=Math.floor((v-n)/a)*a,A=Math.ceil((v+x+n)/a)*a,j=[w,_,A,!0],N=[S,_,A,!1];h(this,zc).push(j,N),ge.rectBoundingBox(w,_,S,A,s)}const o=s[2]-s[0]+2*r,l=s[3]-s[1]+2*r,u=s[0]-r,d=s[1]-r;let f=i?-1/0:1/0,p=1/0;const m=h(this,zc).at(i?-1:-2),y=[m[0],m[2]];for(const g of h(this,zc)){const[v,b,x,w]=g;!w&&i?b<p?(p=b,f=v):b===p&&(f=Math.max(f,v)):w&&!i&&(b<p?(p=b,f=v):b===p&&(f=Math.min(f,v))),g[0]=(v-u)/o,g[1]=(b-d)/l,g[2]=(x-d)/l}k(this,fb,new Float32Array([u,d,o,l])),k(this,pb,[f,p]),k(this,mb,y)}getOutlines(){h(this,zc).sort((n,r)=>n[0]-r[0]||n[1]-r[1]||n[2]-r[2]);const e=[];for(const n of h(this,zc))n[3]?(e.push(...C(this,Br,Q2).call(this,n)),C(this,Br,K9).call(this,n)):(C(this,Br,V9).call(this,n),e.push(...C(this,Br,Q2).call(this,n)));return C(this,Br,G9).call(this,e)}}fb=new WeakMap,pb=new WeakMap,mb=new WeakMap,zc=new WeakMap,Xs=new WeakMap,Br=new WeakSet,G9=function(e){const n=[],r=new Set;for(const a of e){const[o,l,u]=a;n.push([o,l,a],[o,u,a])}n.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=n.length;a<o;a+=2){const l=n[a][2],u=n[a+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}const i=[];let s;for(;r.size>0;){const a=r.values().next().value;let[o,l,u,d,f]=a;r.delete(a);let p=o,m=l;for(s=[o,u],i.push(s);;){let y;if(r.has(d))y=d;else if(r.has(f))y=f;else break;r.delete(y),[o,l,u,d,f]=y,p!==o&&(s.push(p,m,o,m===l?l:u),p=o),m=m===l?u:l}s.push(p,m)}return new Ske(i,h(this,fb),h(this,pb),h(this,mb))},N1=function(e){const n=h(this,Xs);let r=0,i=n.length-1;for(;r<=i;){const s=r+i>>1,a=n[s][0];if(a===e)return s;a<e?r=s+1:i=s-1}return i+1},K9=function([,e,n]){const r=C(this,Br,N1).call(this,e);h(this,Xs).splice(r,0,[e,n])},V9=function([,e,n]){const r=C(this,Br,N1).call(this,e);for(let i=r;i<h(this,Xs).length;i++){const[s,a]=h(this,Xs)[i];if(s!==e)break;if(s===e&&a===n){h(this,Xs).splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,a]=h(this,Xs)[i];if(s!==e)break;if(s===e&&a===n){h(this,Xs).splice(i,1);return}}},Q2=function(e){const[n,r,i]=e,s=[[n,r,i]],a=C(this,Br,N1).call(this,i);for(let o=0;o<a;o++){const[l,u]=h(this,Xs)[o];for(let d=0,f=s.length;d<f;d++){const[,p,m]=s[d];if(!(u<=p||m<=l)){if(p>=l){if(m>u)s[d][1]=u;else{if(f===1)return[];s.splice(d,1),d--,f--}continue}s[d][2]=l,m>u&&s.push([n,u,m])}}}return s};var gb,Mm;class Ske extends pe{constructor(n,r,i,s){super();E(this,gb);E(this,Mm);k(this,Mm,n),k(this,gb,r),this.firstPoint=i,this.lastPoint=s}toSVGPath(){const n=[];for(const r of h(this,Mm)){let[i,s]=r;n.push(`M${i} ${s}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===i?(n.push(`V${l}`),s=l):l===s&&(n.push(`H${o}`),i=o)}n.push("Z")}return n.join(" ")}serialize([n,r,i,s],a){const o=[],l=i-n,u=s-r;for(const d of h(this,Mm)){const f=new Array(d.length);for(let p=0;p<d.length;p+=2)f[p]=n+d[p]*l,f[p+1]=s-d[p+1]*u;o.push(f)}return o}get box(){return h(this,gb)}get classNamesForOutlining(){return["highlightOutline"]}}gb=new WeakMap,Mm=new WeakMap;class J2 extends PS{newFreeDrawOutline(e,n,r,i,s,a){return new Ake(e,n,r,i,s,a)}}class Ake extends H9{newOutliner(e,n,r,i,s,a=0){return new J2(e,n,r,i,s,a)}}var Rm,yb,Zo,vh,vb,ti,xb,bb,xh,Ti,Oi,Vn,Im,Dm,mr,$m,hs,wb,Ie,Z2,E1,Y9,X9,Q9,eP,qu,vs,Pf,J9,C1,P1,Z9,eW,tW,nW,rW;const Ye=class Ye extends Nt{constructor(n){super({...n,name:"highlightEditor"});E(this,Ie);E(this,Rm,null);E(this,yb,0);E(this,Zo);E(this,vh,null);E(this,vb,null);E(this,ti,null);E(this,xb,null);E(this,bb,0);E(this,xh,null);E(this,Ti,null);E(this,Oi,null);E(this,Vn,!1);E(this,Im,null);E(this,Dm,null);E(this,mr,null);E(this,$m,"");E(this,hs);E(this,wb,"");this.color=n.color||Ye._defaultColor,k(this,hs,n.thickness||Ye._defaultThickness),this.opacity=n.opacity||Ye._defaultOpacity,k(this,Zo,n.boxes||null),k(this,wb,n.methodOfCreation||""),k(this,$m,n.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",n.highlightId>-1?(k(this,Vn,!0),C(this,Ie,E1).call(this,n),C(this,Ie,qu).call(this)):h(this,Zo)&&(k(this,Rm,n.anchorNode),k(this,yb,n.anchorOffset),k(this,xb,n.focusNode),k(this,bb,n.focusOffset),C(this,Ie,Z2).call(this),C(this,Ie,qu).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const n=Ye.prototype;return Oe(this,"_keyboardManager",new Kb([[["ArrowLeft","mac+ArrowLeft"],n._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],n._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],n._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],n._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:h(this,Vn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:h(this,hs),methodOfCreation:h(this,wb)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(n){return{numberOfColors:n.get("color").size}}static initialize(n,r){var i;Nt.initialize(n,r),Ye._defaultColor||(Ye._defaultColor=((i=r.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(n,r){switch(n){case ze.HIGHLIGHT_COLOR:Ye._defaultColor=r;break;case ze.HIGHLIGHT_THICKNESS:Ye._defaultThickness=r;break}}translateInPage(n,r){}get toolbarPosition(){return h(this,Dm)}get commentButtonPosition(){return h(this,Im)}updateParams(n,r){switch(n){case ze.HIGHLIGHT_COLOR:C(this,Ie,Y9).call(this,r);break;case ze.HIGHLIGHT_THICKNESS:C(this,Ie,X9).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[ze.HIGHLIGHT_COLOR,Ye._defaultColor],[ze.HIGHLIGHT_THICKNESS,Ye._defaultThickness]]}get propertiesToUpdate(){return[[ze.HIGHLIGHT_COLOR,this.color||Ye._defaultColor],[ze.HIGHLIGHT_THICKNESS,h(this,hs)||Ye._defaultThickness],[ze.HIGHLIGHT_FREE,h(this,Vn)]]}onUpdatedColor(){var n,r;(n=this.parent)==null||n.drawLayer.updateProperties(h(this,Oi),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=h(this,vb))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",k(this,vb,new NS({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,Ie,P1).call(this))}getBaseTranslation(){return[0,0]}getRect(n,r){return super.getRect(n,r,C(this,Ie,P1).call(this))}onceAdded(n){this.annotationElementId||this.parent.addUndoableEditor(this),n&&this.div.focus()}remove(){C(this,Ie,eP).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,Ie,qu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(n){var i;let r=!1;this.parent&&!n?C(this,Ie,eP).call(this):n&&(C(this,Ie,qu).call(this,n),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(n),this.show(this._isVisible),r&&this.select()}rotate(n){var s,a,o;const{drawLayer:r}=this.parent;let i;h(this,Vn)?(n=(n-this.rotation+360)%360,i=C(s=Ye,vs,Pf).call(s,h(this,Ti).box,n)):i=C(a=Ye,vs,Pf).call(a,[this.x,this.y,this.width,this.height],n),r.updateProperties(h(this,Oi),{bbox:i,root:{"data-main-rotation":n}}),r.updateProperties(h(this,mr),{bbox:C(o=Ye,vs,Pf).call(o,h(this,ti).box,n),root:{"data-main-rotation":n}})}render(){if(this.div)return this.div;const n=super.render();h(this,$m)&&(n.setAttribute("aria-label",h(this,$m)),n.setAttribute("role","mark")),h(this,Vn)?n.classList.add("free"):this.div.addEventListener("keydown",C(this,Ie,J9).bind(this),{signal:this._uiManager._signal});const r=k(this,xh,document.createElement("div"));return n.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=h(this,vh),this.setDims(),_z(this,h(this,xh),["pointerover","pointerleave"]),this.enableEditing(),n}pointerover(){var n;this.isSelected||(n=this.parent)==null||n.drawLayer.updateProperties(h(this,mr),{rootClass:{hovered:!0}})}pointerleave(){var n;this.isSelected||(n=this.parent)==null||n.drawLayer.updateProperties(h(this,mr),{rootClass:{hovered:!1}})}_moveCaret(n){switch(this.parent.unselect(this),n){case 0:case 2:C(this,Ie,C1).call(this,!0);break;case 1:case 3:C(this,Ie,C1).call(this,!1);break}}select(){var n;super.select(),h(this,mr)&&((n=this.parent)==null||n.drawLayer.updateProperties(h(this,mr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var n;super.unselect(),h(this,mr)&&((n=this.parent)==null||n.drawLayer.updateProperties(h(this,mr),{rootClass:{selected:!1}}),h(this,Vn)||C(this,Ie,C1).call(this,!1))}get _mustFixPosition(){return!h(this,Vn)}show(n=this._isVisible){super.show(n),this.parent&&(this.parent.drawLayer.updateProperties(h(this,Oi),{rootClass:{hidden:!n}}),this.parent.drawLayer.updateProperties(h(this,mr),{rootClass:{hidden:!n}}))}static startHighlighting(n,r,{target:i,x:s,y:a}){const{x:o,y:l,width:u,height:d}=i.getBoundingClientRect(),f=new AbortController,p=n.combinedSignal(f),m=y=>{f.abort(),C(this,vs,nW).call(this,n,y)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",rn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Ps,{signal:p}),i.addEventListener("pointermove",C(this,vs,tW).bind(this,n),{signal:p}),this._freeHighlight=new J2({x:s,y:a},[o,l,u,d],n.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(n,r,i){var g,v,b,x;let s=null;if(n instanceof T9){const{data:{quadPoints:w,rect:S,rotation:_,id:A,color:j,opacity:N,popupRef:P,richText:O,contentsObj:M,creationDate:R,modificationDate:I},parent:{page:{pageNumber:L}}}=n;s=n={annotationType:Pe.HIGHLIGHT,color:Array.from(j),opacity:N,quadPoints:w,boxes:null,pageIndex:L-1,rect:S.slice(0),rotation:_,annotationElementId:A,id:A,deleted:!1,popupRef:P,richText:O,comment:(M==null?void 0:M.str)||null,creationDate:R,modificationDate:I}}else if(n instanceof BO){const{data:{inkLists:w,rect:S,rotation:_,id:A,color:j,borderStyle:{rawWidth:N},popupRef:P,richText:O,contentsObj:M,creationDate:R,modificationDate:I},parent:{page:{pageNumber:L}}}=n;s=n={annotationType:Pe.HIGHLIGHT,color:Array.from(j),thickness:N,inkLists:w,boxes:null,pageIndex:L-1,rect:S.slice(0),rotation:_,annotationElementId:A,id:A,deleted:!1,popupRef:P,richText:O,comment:(M==null?void 0:M.str)||null,creationDate:R,modificationDate:I}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=n,d=await super.deserialize(n,r,i);d.color=ge.makeHexColor(...a),d.opacity=u||1,l&&k(d,hs,n.thickness),d._initialData=s,n.comment&&d.setCommentData(n);const[f,p]=d.pageDimensions,[m,y]=d.pageTranslation;if(o){const w=k(d,Zo,[]);for(let S=0;S<o.length;S+=8)w.push({x:(o[S]-m)/f,y:1-(o[S+1]-y)/p,width:(o[S+2]-o[S])/f,height:(o[S+1]-o[S+5])/p});C(g=d,Ie,Z2).call(g),C(v=d,Ie,qu).call(v),d.rotate(d.rotation)}else if(l){k(d,Vn,!0);const w=l[0],S={x:w[0]-m,y:p-(w[1]-y)},_=new J2(S,[0,0,f,p],1,h(d,hs)/2,!0,.001);for(let N=0,P=w.length;N<P;N+=2)S.x=w[N]-m,S.y=p-(w[N+1]-y),_.add(S);const{id:A,clipPathId:j}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);C(b=d,Ie,E1).call(b,{highlightOutlines:_.getOutlines(),highlightId:A,clipPathId:j}),C(x=d,Ie,qu).call(x),d.rotate(d.parentRotation)}return d}serialize(n=!1){if(this.isEmpty()||n)return null;if(this.deleted)return this.serializeDeleted();const r=Nt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(n);return Object.assign(i,{color:r,opacity:this.opacity,thickness:h(this,hs),quadPoints:C(this,Ie,Z9).call(this),outlines:C(this,Ie,eW).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!C(this,Ie,rW).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(n){return this.deleted?(n.hide(),null):(n.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Rm=new WeakMap,yb=new WeakMap,Zo=new WeakMap,vh=new WeakMap,vb=new WeakMap,ti=new WeakMap,xb=new WeakMap,bb=new WeakMap,xh=new WeakMap,Ti=new WeakMap,Oi=new WeakMap,Vn=new WeakMap,Im=new WeakMap,Dm=new WeakMap,mr=new WeakMap,$m=new WeakMap,hs=new WeakMap,wb=new WeakMap,Ie=new WeakSet,Z2=function(){const n=new X2(h(this,Zo),.001);k(this,Ti,n.getOutlines()),[this.x,this.y,this.width,this.height]=h(this,Ti).box;const r=new X2(h(this,Zo),.0025,.001,this._uiManager.direction==="ltr");k(this,ti,r.getOutlines());const{firstPoint:i}=h(this,Ti);k(this,Im,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:s}=h(this,ti);k(this,Dm,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},E1=function({highlightOutlines:n,highlightId:r,clipPathId:i}){var p,m;if(k(this,Ti,n),k(this,ti,n.getNewOutline(h(this,hs)/2+1.5,.0025)),r>=0)k(this,Oi,r),k(this,vh,i),this.parent.drawLayer.finalizeDraw(r,{bbox:n.box,path:{d:n.toSVGPath()}}),k(this,mr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:h(this,ti).box,path:{d:h(this,ti).toSVGPath()}},!0));else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(h(this,Oi),{bbox:C(p=Ye,vs,Pf).call(p,h(this,Ti).box,(y-this.rotation+360)%360),path:{d:n.toSVGPath()}}),this.parent.drawLayer.updateProperties(h(this,mr),{bbox:C(m=Ye,vs,Pf).call(m,h(this,ti).box,y),path:{d:h(this,ti).toSVGPath()}})}const[a,o,l,u]=n.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[y,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/y,this.height=u*y/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[y,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/y,this.height=u*y/g;break}}const{firstPoint:d}=n;k(this,Im,[(d[0]-a)/l,(d[1]-o)/u]);const{lastPoint:f}=h(this,ti);k(this,Dm,[(f[0]-a)/l,(f[1]-o)/u])},Y9=function(n){const r=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:r.bind(this,n,Ye._defaultOpacity),undo:r.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(n)},!0)},X9=function(n){const r=h(this,hs),i=s=>{k(this,hs,s),C(this,Ie,Q9).call(this,s)};this.addCommands({cmd:i.bind(this,n),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ze.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:n},!0)},Q9=function(n){h(this,Vn)&&(C(this,Ie,E1).call(this,{highlightOutlines:h(this,Ti).getNewOutline(n/2)}),this.fixAndSetPosition(),this.setDims())},eP=function(){h(this,Oi)===null||!this.parent||(this.parent.drawLayer.remove(h(this,Oi)),k(this,Oi,null),this.parent.drawLayer.remove(h(this,mr)),k(this,mr,null))},qu=function(n=this.parent){h(this,Oi)===null&&({id:Vt(this,Oi)._,clipPathId:Vt(this,vh)._}=n.drawLayer.draw({bbox:h(this,Ti).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:h(this,Vn)},path:{d:h(this,Ti).toSVGPath()}},!1,!0),k(this,mr,n.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:h(this,Vn)},bbox:h(this,ti).box,path:{d:h(this,ti).toSVGPath()}},h(this,Vn))),h(this,xh)&&(h(this,xh).style.clipPath=h(this,vh)))},vs=new WeakSet,Pf=function([n,r,i,s],a){switch(a){case 90:return[1-r-s,n,s,i];case 180:return[1-n-i,1-r-s,i,s];case 270:return[r,1-n-i,s,i]}return[n,r,i,s]},J9=function(n){Ye._keyboardManager.exec(this,n)},C1=function(n){if(!h(this,Rm))return;const r=window.getSelection();n?r.setPosition(h(this,Rm),h(this,yb)):r.setPosition(h(this,xb),h(this,bb))},P1=function(){return h(this,Vn)?this.rotation:0},Z9=function(){if(h(this,Vn))return null;const[n,r]=this.pageDimensions,[i,s]=this.pageTranslation,a=h(this,Zo),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:d,width:f,height:p}of a){const m=u*n+i,y=(1-d)*r+s;o[l]=o[l+4]=m,o[l+1]=o[l+3]=y,o[l+2]=o[l+6]=m+f*n,o[l+5]=o[l+7]=y-p*r,l+=8}return o},eW=function(n){return h(this,Ti).serialize(n,C(this,Ie,P1).call(this))},tW=function(n,r){this._freeHighlight.add(r)&&n.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},nW=function(n,r){this._freeHighlight.isEmpty()?n.drawLayer.remove(this._freeHighlightId):n.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},rW=function(n){const{color:r}=this._initialData;return this.hasEditedComment||n.color.some((i,s)=>i!==r[s])},E(Ye,vs),ae(Ye,"_defaultColor",null),ae(Ye,"_defaultOpacity",1),ae(Ye,"_defaultThickness",12),ae(Ye,"_type","highlight"),ae(Ye,"_editorType",Pe.HIGHLIGHT),ae(Ye,"_freeHighlightId",-1),ae(Ye,"_freeHighlight",null),ae(Ye,"_freeHighlightClipId","");let TS=Ye;var bh;class iW{constructor(){E(this,bh,Object.create(null))}updateProperty(e,n){this[e]=n,this.updateSVGProperty(e,n)}updateProperties(e){if(e)for(const[n,r]of Object.entries(e))n.startsWith("_")||this.updateProperty(n,r)}updateSVGProperty(e,n){h(this,bh)[e]=n}toSVGProperties(){const e=h(this,bh);return k(this,bh,Object.create(null)),{root:e}}reset(){k(this,bh,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){bt("Not implemented")}}bh=new WeakMap;var Mi,Lm,Rn,wh,_h,Ge,tP,nP,rP,Qy,sW,T1,Jy,Tf;const Fe=class Fe extends Nt{constructor(n){super(n);E(this,Ge);E(this,Mi,null);E(this,Lm);ae(this,"_colorPicker",null);ae(this,"_drawId",null);k(this,Lm,n.mustBeCommitted||!1),this._addOutlines(n)}onUpdatedColor(){var n;(n=this._colorPicker)==null||n.update(this.color),super.onUpdatedColor()}_addOutlines(n){n.drawOutlines&&(C(this,Ge,tP).call(this,n),C(this,Ge,Qy).call(this))}static _mergeSVGProperties(n,r){const i=new Set(Object.keys(n));for(const[s,a]of Object.entries(r))i.has(s)?Object.assign(n[s],a):n[s]=a;return n}static getDefaultDrawingOptions(n){bt("Not implemented")}static get typesMap(){bt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(n,r){const i=this.typesMap.get(n);i&&this._defaultDrawingOptions.updateProperty(i,r),this._currentParent&&(h(Fe,Rn).updateProperty(i,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(n,r){const i=this.constructor.typesMap.get(n);i&&this._updateProperty(n,i,r)}static get defaultPropertiesToUpdate(){const n=[],r=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)n.push([i,r[s]]);return n}get propertiesToUpdate(){const n=[],{_drawingOptions:r}=this;for(const[i,s]of this.constructor.typesMap)n.push([i,r[s]]);return n}_updateProperty(n,r,i){const s=this._drawingOptions,a=s[r],o=l=>{var d;s.updateProperty(r,l);const u=h(this,Mi).updateProperty(r,l);u&&C(this,Ge,Jy).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),n===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:n,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,Fe._mergeSVGProperties(h(this,Mi).getPathResizingSVGProperties(C(this,Ge,T1).call(this)),{bbox:C(this,Ge,Tf).call(this)}))}_onResized(){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,Fe._mergeSVGProperties(h(this,Mi).getPathResizedSVGProperties(C(this,Ge,T1).call(this)),{bbox:C(this,Ge,Tf).call(this)}))}_onTranslating(n,r){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:C(this,Ge,Tf).call(this)})}_onTranslated(){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,Fe._mergeSVGProperties(h(this,Mi).getPathTranslatedSVGProperties(C(this,Ge,T1).call(this),this.parentDimensions),{bbox:C(this,Ge,Tf).call(this)}))}_onStartDragging(){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var n;(n=this.parent)==null||n.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(n){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,h(this,Lm)&&(k(this,Lm,!1),this.commit(),this.parent.setSelected(this),n&&this.isOnScreen&&this.div.focus())}remove(){C(this,Ge,rP).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,Ge,Qy).call(this),C(this,Ge,Jy).call(this,h(this,Mi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(n){var i;let r=!1;this.parent&&!n?(this._uiManager.removeShouldRescale(this),C(this,Ge,rP).call(this)):n&&(this._uiManager.addShouldRescale(this),C(this,Ge,Qy).call(this,n),r=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(n),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Fe._mergeSVGProperties({bbox:C(this,Ge,Tf).call(this)},h(this,Mi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&C(this,Ge,Jy).call(this,h(this,Mi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let n,r;this._isCopy&&(n=this.x,r=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(n,r),i}static createDrawerInstance(n,r,i,s,a){bt("Not implemented")}static startDrawing(n,r,i,s){var v;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:d}=s;if(ur.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:f}}=n,{width:p,height:m}=a.getBoundingClientRect(),y=k(Fe,wh,new AbortController),g=n.combinedSignal(y);if(ur.setPointer(d,u),window.addEventListener("pointerup",b=>{ur.isSamePointerIdOrRemove(b.pointerId)&&this._endDraw(b)},{signal:g}),window.addEventListener("pointercancel",b=>{ur.isSamePointerIdOrRemove(b.pointerId)&&this._currentParent.endDrawingSession()},{signal:g}),window.addEventListener("pointerdown",b=>{ur.isSamePointerType(b.pointerType)&&(ur.initializeAndAddPointerId(b.pointerId),h(Fe,Rn).isCancellable()&&(h(Fe,Rn).removeLastElement(),h(Fe,Rn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Ps,{signal:g}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),a.addEventListener("touchmove",b=>{ur.isSameTimeStamp(b.timeStamp)&&rn(b)},{signal:g}),n.toggleDrawing(),(v=r._editorUndoBar)==null||v.hide(),h(Fe,Rn)){n.drawLayer.updateProperties(this._currentDrawId,h(Fe,Rn).startNew(o,l,p,m,f));return}r.updateUIForDefaultProperties(this),k(Fe,Rn,this.createDrawerInstance(o,l,p,m,f)),k(Fe,_h,this.getDefaultDrawingOptions()),this._currentParent=n,{id:this._currentDrawId}=n.drawLayer.draw(this._mergeSVGProperties(h(Fe,_h).toSVGProperties(),h(Fe,Rn).defaultSVGProperties),!0,!1)}static _drawMove(n){if(ur.isSameTimeStamp(n.timeStamp),!h(Fe,Rn))return;const{offsetX:r,offsetY:i,pointerId:s}=n;if(ur.isSamePointerId(s)){if(ur.isUsingMultiplePointers()){this._endDraw(n);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,h(Fe,Rn).add(r,i)),ur.setTimeStamp(n.timeStamp),rn(n)}}static _cleanup(n){n&&(this._currentDrawId=-1,this._currentParent=null,k(Fe,Rn,null),k(Fe,_h,null),ur.clearPointerType(),ur.clearTimeStamp()),h(Fe,wh)&&(h(Fe,wh).abort(),k(Fe,wh,null),ur.clearPointerIds())}static _endDraw(n){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(n==null?void 0:n.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,h(Fe,Rn).end(n.offsetX,n.offsetY)),this.supportMultipleDrawings){const i=h(Fe,Rn),s=this._currentDrawId,a=i.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,i.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:ze.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(n){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(ze.DRAW_STEP),!h(Fe,Rn).isEmpty()){const{pageDimensions:[i,s],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:h(Fe,Rn).getOutlines(i*a,s*a,a,this._INNER_MARGIN),drawingOptions:h(Fe,_h),mustBeCommitted:!n});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(n){}static deserializeDraw(n,r,i,s,a,o){bt("Not implemented")}static async deserialize(n,r,i){var f,p;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=r.viewport,u=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,n),d=await super.deserialize(n,r,i);return d.createDrawingOptions(n),C(f=d,Ge,tP).call(f,{drawOutlines:u}),C(p=d,Ge,Qy).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(n){const[r,i]=this.pageTranslation,[s,a]=this.pageDimensions;return h(this,Mi).serialize([r,i,s,a],n)}renderAnnotationElement(n){return n.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Mi=new WeakMap,Lm=new WeakMap,Rn=new WeakMap,wh=new WeakMap,_h=new WeakMap,Ge=new WeakSet,tP=function({drawOutlines:n,drawId:r,drawingOptions:i}){k(this,Mi,n),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,n.defaultProperties)):this._drawId=C(this,Ge,nP).call(this,n,this.parent),C(this,Ge,Jy).call(this,n.box)},nP=function(n,r){const{id:i}=r.drawLayer.draw(Fe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),n.defaultSVGProperties),!1,!1);return i},rP=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Qy=function(n=this.parent){if(!(this._drawId!==null&&this.parent===n)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,n.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=C(this,Ge,nP).call(this,h(this,Mi),n)}},sW=function([n,r,i,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-n,i*(o/a),s*(a/o)];case 180:return[1-n,1-r,i,s];case 270:return[1-r,n,i*(o/a),s*(a/o)];default:return[n,r,i,s]}},T1=function(){const{x:n,y:r,width:i,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,n,i*(a/o),s*(o/a)];case 180:return[1-n,1-r,i,s];case 270:return[r,1-n,i*(a/o),s*(o/a)];default:return[n,r,i,s]}},Jy=function(n){[this.x,this.y,this.width,this.height]=C(this,Ge,sW).call(this,n),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Tf=function(){const{x:n,y:r,width:i,height:s,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-r-s,n,s,i];case 2:return[1-n-i,1-r-s,i,s];case 3:return[r,1-n-i,s,i];case 4:return[n,r-i*(l/u),s*(u/l),i*(l/u)];case 5:return[1-r,n,i*(l/u),s*(u/l)];case 6:return[1-n-s*(u/l),1-r,s*(u/l),i*(l/u)];case 7:return[r-i*(l/u),1-n-s*(u/l),i*(l/u),s*(u/l)];case 8:return[n-i,r-s,i,s];case 9:return[1-r,n-i,s,i];case 10:return[1-n,1-r,i,s];case 11:return[r-s,1-n,s,i];case 12:return[n-s*(u/l),r,s*(u/l),i*(l/u)];case 13:return[1-r-i*(l/u),n-s*(u/l),i*(l/u),s*(u/l)];case 14:return[1-n,1-r-i*(l/u),s*(u/l),i*(l/u)];case 15:return[r,1-n,i*(l/u),s*(u/l)];default:return[n,r,i,s]}},ae(Fe,"_currentDrawId",-1),ae(Fe,"_currentParent",null),E(Fe,Rn,null),E(Fe,wh,null),E(Fe,_h,null),ae(Fe,"_INNER_MARGIN",3);let OS=Fe;var za,In,Dn,Sh,Fm,kr,Yn,fs,Ah,jh,kh,Bm,O1;class jke{constructor(e,n,r,i,s,a){E(this,Bm);E(this,za,new Float64Array(6));E(this,In);E(this,Dn);E(this,Sh);E(this,Fm);E(this,kr);E(this,Yn,"");E(this,fs,0);E(this,Ah,new Yb);E(this,jh);E(this,kh);k(this,jh,r),k(this,kh,i),k(this,Sh,s),k(this,Fm,a),[e,n]=C(this,Bm,O1).call(this,e,n);const o=k(this,In,[NaN,NaN,NaN,NaN,e,n]);k(this,kr,[e,n]),k(this,Dn,[{line:o,points:h(this,kr)}]),h(this,za).set(o,0)}updateProperty(e,n){e==="stroke-width"&&k(this,Fm,n)}isEmpty(){return!h(this,Dn)||h(this,Dn).length===0}isCancellable(){return h(this,kr).length<=10}add(e,n){[e,n]=C(this,Bm,O1).call(this,e,n);const[r,i,s,a]=h(this,za).subarray(2,6),o=e-s,l=n-a;return Math.hypot(h(this,jh)*o,h(this,kh)*l)<=2?null:(h(this,kr).push(e,n),isNaN(r)?(h(this,za).set([s,a,e,n],2),h(this,In).push(NaN,NaN,NaN,NaN,e,n),{path:{d:this.toSVGPath()}}):(isNaN(h(this,za)[0])&&h(this,In).splice(6,6),h(this,za).set([r,i,s,a,e,n],0),h(this,In).push(...pe.createBezierPoints(r,i,s,a,e,n)),{path:{d:this.toSVGPath()}}))}end(e,n){const r=this.add(e,n);return r||(h(this,kr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,n,r,i,s){k(this,jh,r),k(this,kh,i),k(this,Sh,s),[e,n]=C(this,Bm,O1).call(this,e,n);const a=k(this,In,[NaN,NaN,NaN,NaN,e,n]);k(this,kr,[e,n]);const o=h(this,Dn).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),h(this,Dn).push({line:a,points:h(this,kr)}),h(this,za).set(a,0),k(this,fs,0),this.toSVGPath(),null}getLastElement(){return h(this,Dn).at(-1)}setLastElement(e){return h(this,Dn)?(h(this,Dn).push(e),k(this,In,e.line),k(this,kr,e.points),k(this,fs,0),{path:{d:this.toSVGPath()}}):h(this,Ah).setLastElement(e)}removeLastElement(){if(!h(this,Dn))return h(this,Ah).removeLastElement();h(this,Dn).pop(),k(this,Yn,"");for(let e=0,n=h(this,Dn).length;e<n;e++){const{line:r,points:i}=h(this,Dn)[e];k(this,In,r),k(this,kr,i),k(this,fs,0),this.toSVGPath()}return{path:{d:h(this,Yn)}}}toSVGPath(){const e=pe.svgRound(h(this,In)[4]),n=pe.svgRound(h(this,In)[5]);if(h(this,kr).length===2)return k(this,Yn,`${h(this,Yn)} M ${e} ${n} Z`),h(this,Yn);if(h(this,kr).length<=6){const i=h(this,Yn).lastIndexOf("M");k(this,Yn,`${h(this,Yn).slice(0,i)} M ${e} ${n}`),k(this,fs,6)}if(h(this,kr).length===4){const i=pe.svgRound(h(this,In)[10]),s=pe.svgRound(h(this,In)[11]);return k(this,Yn,`${h(this,Yn)} L ${i} ${s}`),k(this,fs,12),h(this,Yn)}const r=[];h(this,fs)===0&&(r.push(`M ${e} ${n}`),k(this,fs,6));for(let i=h(this,fs),s=h(this,In).length;i<s;i+=6){const[a,o,l,u,d,f]=h(this,In).slice(i,i+6).map(pe.svgRound);r.push(`C${a} ${o} ${l} ${u} ${d} ${f}`)}return k(this,Yn,h(this,Yn)+r.join(" ")),k(this,fs,h(this,In).length),h(this,Yn)}getOutlines(e,n,r,i){const s=h(this,Dn).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),h(this,Ah).build(h(this,Dn),e,n,r,h(this,Sh),h(this,Fm),i),k(this,za,null),k(this,In,null),k(this,Dn,null),k(this,Yn,null),h(this,Ah)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}za=new WeakMap,In=new WeakMap,Dn=new WeakMap,Sh=new WeakMap,Fm=new WeakMap,kr=new WeakMap,Yn=new WeakMap,fs=new WeakMap,Ah=new WeakMap,jh=new WeakMap,kh=new WeakMap,Bm=new WeakSet,O1=function(e,n){return pe._normalizePoint(e,n,h(this,jh),h(this,kh),h(this,Sh))};var Nr,_b,Sb,Ri,Wa,Ha,Um,zm,Nh,Zn,po,aW,oW,lW;class Yb extends pe{constructor(){super(...arguments);E(this,Zn);E(this,Nr);E(this,_b,0);E(this,Sb);E(this,Ri);E(this,Wa);E(this,Ha);E(this,Um);E(this,zm);E(this,Nh)}build(n,r,i,s,a,o,l){k(this,Wa,r),k(this,Ha,i),k(this,Um,s),k(this,zm,a),k(this,Nh,o),k(this,Sb,l??0),k(this,Ri,n),C(this,Zn,oW).call(this)}get thickness(){return h(this,Nh)}setLastElement(n){return h(this,Ri).push(n),{path:{d:this.toSVGPath()}}}removeLastElement(){return h(this,Ri).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const n=[];for(const{line:r}of h(this,Ri)){if(n.push(`M${pe.svgRound(r[4])} ${pe.svgRound(r[5])}`),r.length===6){n.push("Z");continue}if(r.length===12&&isNaN(r[6])){n.push(`L${pe.svgRound(r[10])} ${pe.svgRound(r[11])}`);continue}for(let i=6,s=r.length;i<s;i+=6){const[a,o,l,u,d,f]=r.subarray(i,i+6).map(pe.svgRound);n.push(`C${a} ${o} ${l} ${u} ${d} ${f}`)}}return n.join("")}serialize([n,r,i,s],a){const o=[],l=[],[u,d,f,p]=C(this,Zn,aW).call(this);let m,y,g,v,b,x,w,S,_;switch(h(this,zm)){case 0:_=pe._rescale,m=n,y=r+s,g=i,v=-s,b=n+u*i,x=r+(1-d-p)*s,w=n+(u+f)*i,S=r+(1-d)*s;break;case 90:_=pe._rescaleAndSwap,m=n,y=r,g=i,v=s,b=n+d*i,x=r+u*s,w=n+(d+p)*i,S=r+(u+f)*s;break;case 180:_=pe._rescale,m=n+i,y=r,g=-i,v=s,b=n+(1-u-f)*i,x=r+d*s,w=n+(1-u)*i,S=r+(d+p)*s;break;case 270:_=pe._rescaleAndSwap,m=n+i,y=r+s,g=-i,v=-s,b=n+(1-d-p)*i,x=r+(1-u-f)*s,w=n+(1-d)*i,S=r+(1-u)*s;break}for(const{line:A,points:j}of h(this,Ri))o.push(_(A,m,y,g,v,a?new Array(A.length):null)),l.push(_(j,m,y,g,v,a?new Array(j.length):null));return{lines:o,points:l,rect:[b,x,w,S]}}static deserialize(n,r,i,s,a,{paths:{lines:o,points:l},rotation:u,thickness:d}){const f=[];let p,m,y,g,v;switch(u){case 0:v=pe._rescale,p=-n/i,m=r/s+1,y=1/i,g=-1/s;break;case 90:v=pe._rescaleAndSwap,p=-r/s,m=-n/i,y=1/s,g=1/i;break;case 180:v=pe._rescale,p=n/i+1,m=-r/s,y=-1/i,g=1/s;break;case 270:v=pe._rescaleAndSwap,p=r/s+1,m=n/i+1,y=-1/s,g=-1/i;break}if(!o){o=[];for(const x of l){const w=x.length;if(w===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(w===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const S=new Float32Array(3*(w-2));o.push(S);let[_,A,j,N]=x.subarray(0,4);S.set([NaN,NaN,NaN,NaN,_,A],0);for(let P=4;P<w;P+=2){const O=x[P],M=x[P+1];S.set(pe.createBezierPoints(_,A,j,N,O,M),(P-2)*3),[_,A,j,N]=[j,N,O,M]}}}for(let x=0,w=o.length;x<w;x++)f.push({line:v(o[x].map(S=>S??NaN),p,m,y,g),points:v(l[x].map(S=>S??NaN),p,m,y,g)});const b=new this.prototype.constructor;return b.build(f,i,s,1,u,d,a),b}get box(){return h(this,Nr)}updateProperty(n,r){return n==="stroke-width"?C(this,Zn,lW).call(this,r):null}updateParentDimensions([n,r],i){const[s,a]=C(this,Zn,po).call(this);k(this,Wa,n),k(this,Ha,r),k(this,Um,i);const[o,l]=C(this,Zn,po).call(this),u=o-s,d=l-a,f=h(this,Nr);return f[0]-=u,f[1]-=d,f[2]+=2*u,f[3]+=2*d,f}updateRotation(n){return k(this,_b,n),{path:{transform:this.rotationTransform}}}get viewBox(){return h(this,Nr).map(pe.svgRound).join(" ")}get defaultProperties(){const[n,r]=h(this,Nr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pe.svgRound(n)} ${pe.svgRound(r)}`}}}get rotationTransform(){const[,,n,r]=h(this,Nr);let i=0,s=0,a=0,o=0,l=0,u=0;switch(h(this,_b)){case 90:s=r/n,a=-n/r,l=n;break;case 180:i=-1,o=-1,l=n,u=r;break;case 270:s=-r/n,a=n/r,u=r;break;default:return""}return`matrix(${i} ${s} ${a} ${o} ${pe.svgRound(l)} ${pe.svgRound(u)})`}getPathResizingSVGProperties([n,r,i,s]){const[a,o]=C(this,Zn,po).call(this),[l,u,d,f]=h(this,Nr);if(Math.abs(d-a)<=pe.PRECISION||Math.abs(f-o)<=pe.PRECISION){const v=n+i/2-(l+d/2),b=r+s/2-(u+f/2);return{path:{"transform-origin":`${pe.svgRound(n)} ${pe.svgRound(r)}`,transform:`${this.rotationTransform} translate(${v} ${b})`}}}const p=(i-2*a)/(d-2*a),m=(s-2*o)/(f-2*o),y=d/i,g=f/s;return{path:{"transform-origin":`${pe.svgRound(l)} ${pe.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${g}) translate(${pe.svgRound(a)} ${pe.svgRound(o)}) scale(${p} ${m}) translate(${pe.svgRound(-a)} ${pe.svgRound(-o)})`}}}getPathResizedSVGProperties([n,r,i,s]){const[a,o]=C(this,Zn,po).call(this),l=h(this,Nr),[u,d,f,p]=l;if(l[0]=n,l[1]=r,l[2]=i,l[3]=s,Math.abs(f-a)<=pe.PRECISION||Math.abs(p-o)<=pe.PRECISION){const b=n+i/2-(u+f/2),x=r+s/2-(d+p/2);for(const{line:w,points:S}of h(this,Ri))pe._translate(w,b,x,w),pe._translate(S,b,x,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pe.svgRound(n)} ${pe.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*a)/(f-2*a),y=(s-2*o)/(p-2*o),g=-m*(u+a)+n+a,v=-y*(d+o)+r+o;if(m!==1||y!==1||g!==0||v!==0)for(const{line:b,points:x}of h(this,Ri))pe._rescale(b,g,v,m,y,b),pe._rescale(x,g,v,m,y,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${pe.svgRound(n)} ${pe.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([n,r],i){const[s,a]=i,o=h(this,Nr),l=n-o[0],u=r-o[1];if(h(this,Wa)===s&&h(this,Ha)===a)for(const{line:d,points:f}of h(this,Ri))pe._translate(d,l,u,d),pe._translate(f,l,u,f);else{const d=h(this,Wa)/s,f=h(this,Ha)/a;k(this,Wa,s),k(this,Ha,a);for(const{line:p,points:m}of h(this,Ri))pe._rescale(p,l,u,d,f,p),pe._rescale(m,l,u,d,f,m);o[2]*=d,o[3]*=f}return o[0]=n,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${pe.svgRound(n)} ${pe.svgRound(r)}`}}}get defaultSVGProperties(){const n=h(this,Nr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${pe.svgRound(n[0])} ${pe.svgRound(n[1])}`,transform:this.rotationTransform||null},bbox:n}}}Nr=new WeakMap,_b=new WeakMap,Sb=new WeakMap,Ri=new WeakMap,Wa=new WeakMap,Ha=new WeakMap,Um=new WeakMap,zm=new WeakMap,Nh=new WeakMap,Zn=new WeakSet,po=function(n=h(this,Nh)){const r=h(this,Sb)+n/2*h(this,Um);return h(this,zm)%180===0?[r/h(this,Wa),r/h(this,Ha)]:[r/h(this,Ha),r/h(this,Wa)]},aW=function(){const[n,r,i,s]=h(this,Nr),[a,o]=C(this,Zn,po).call(this,0);return[n+a,r+o,i-2*a,s-2*o]},oW=function(){const n=k(this,Nr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of h(this,Ri)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6)ge.pointBoundingBox(s[l],s[l+1],n);continue}let a=s[4],o=s[5];for(let l=6,u=s.length;l<u;l+=6){const[d,f,p,m,y,g]=s.subarray(l,l+6);ge.bezierBoundingBox(a,o,d,f,p,m,y,g,n),a=y,o=g}}const[r,i]=C(this,Zn,po).call(this);n[0]=Pr(n[0]-r,0,1),n[1]=Pr(n[1]-i,0,1),n[2]=Pr(n[2]+r,0,1),n[3]=Pr(n[3]+i,0,1),n[2]-=n[0],n[3]-=n[1]},lW=function(n){const[r,i]=C(this,Zn,po).call(this);k(this,Nh,n);const[s,a]=C(this,Zn,po).call(this),[o,l]=[s-r,a-i],u=h(this,Nr);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};class Sj extends iW{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Nt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,n){e==="stroke-width"&&(n??(n=this["stroke-width"]),n*=this._viewParameters.realScale),super.updateSVGProperty(e,n)}clone(){const e=new Sj(this._viewParameters);return e.updateAll(this),e}}var XS,cW;const ep=class ep extends OS{constructor(n){super({...n,name:"inkEditor"});E(this,XS);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(n,r){Nt.initialize(n,r),this._defaultDrawingOptions=new Sj(r.viewParameters)}static getDefaultDrawingOptions(n){const r=this._defaultDrawingOptions.clone();return r.updateProperties(n),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Oe(this,"typesMap",new Map([[ze.INK_THICKNESS,"stroke-width"],[ze.INK_COLOR,"stroke"],[ze.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(n,r,i,s,a){return new jke(n,r,i,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(n,r,i,s,a,o){return Yb.deserialize(n,r,i,s,a,o)}static async deserialize(n,r,i){let s=null;if(n instanceof BO){const{data:{inkLists:o,rect:l,rotation:u,id:d,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:y,richText:g,contentsObj:v,creationDate:b,modificationDate:x},parent:{page:{pageNumber:w}}}=n;s=n={annotationType:Pe.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:w-1,rect:l.slice(0),rotation:u,annotationElementId:d,id:d,deleted:!1,popupRef:y,richText:g,comment:(v==null?void 0:v.str)||null,creationDate:b,modificationDate:x}}const a=await super.deserialize(n,r,i);return a._initialData=s,n.comment&&a.setCommentData(n),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new ES(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ze.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:n,_drawingOptions:r,parent:i}=this;r.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(n,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const n=this._currentParent;n&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:n,thickness:r,opacity:i}){this._drawingOptions=ep.getDefaultDrawingOptions({stroke:ge.makeHexColor(...n),"stroke-width":r,"stroke-opacity":i})}serialize(n=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:i}=this.serializeDraw(n),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(n),{color:Nt._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:r,points:i}});return this.addComment(l),n?(l.isCopy=!0,l):this.annotationElementId&&!C(this,XS,cW).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(n){if(this.deleted)return n.hide(),null;const{points:r,rect:i}=this.serializeDraw(!1);return n.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};XS=new WeakSet,cW=function(n){const{color:r,thickness:i,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||n.color.some((o,l)=>o!==r[l])||n.thickness!==i||n.opacity!==s||n.pageIndex!==a},ae(ep,"_type","ink"),ae(ep,"_editorType",Pe.INK),ae(ep,"_defaultDrawingOptions",null);let iP=ep;class sP extends Yb{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Uw=8,jy=3;var Eh,tt,aP,Qs,uW,dW,oP,M1,hW,fW,pW,lP,cP,mW;class sl{static extractContoursFromText(e,{fontFamily:n,fontStyle:r,fontWeight:i},s,a,o,l){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const f=200,p=d.font=`${r} ${i} ${f}px ${n}`,{actualBoundingBoxLeft:m,actualBoundingBoxRight:y,actualBoundingBoxAscent:g,actualBoundingBoxDescent:v,fontBoundingBoxAscent:b,fontBoundingBoxDescent:x,width:w}=d.measureText(e),S=1.5,_=Math.ceil(Math.max(Math.abs(m)+Math.abs(y)||0,w)*S),A=Math.ceil(Math.max(Math.abs(g)+Math.abs(v)||f,Math.abs(b)+Math.abs(x)||f)*S);u=new OffscreenCanvas(_,A),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,_,A),d.fillStyle="black",d.fillText(e,_*(S-1)/2,A*(3-S)/2);const j=C(this,tt,lP).call(this,d.getImageData(0,0,_,A).data),N=C(this,tt,pW).call(this,j),P=C(this,tt,cP).call(this,N),O=C(this,tt,oP).call(this,j,_,A,P);return this.processDrawnLines({lines:{curves:O,width:_,height:A},pageWidth:s,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,n,r,i,s){const[a,o,l]=C(this,tt,mW).call(this,e),[u,d]=C(this,tt,fW).call(this,a,o,l,Math.hypot(o,l)*h(this,Eh).sigmaSFactor,h(this,Eh).sigmaR,h(this,Eh).kernelSize),f=C(this,tt,cP).call(this,d),p=C(this,tt,oP).call(this,u,o,l,f);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:n,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:n,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:a,areContours:o}){i%180!==0&&([n,r]=[r,n]);const{curves:l,width:u,height:d}=e,f=e.thickness??0,p=[],m=Math.min(n/u,r/d),y=m/n,g=m/r,v=[];for(const{points:x}of l){const w=a?C(this,tt,hW).call(this,x):x;if(!w)continue;v.push(w);const S=w.length,_=new Float32Array(S),A=new Float32Array(3*(S===2?2:S-2));if(p.push({line:A,points:_}),S===2){_[0]=w[0]*y,_[1]=w[1]*g,A.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[j,N,P,O]=w;j*=y,N*=g,P*=y,O*=g,_.set([j,N,P,O],0),A.set([NaN,NaN,NaN,NaN,j,N],0);for(let M=4;M<S;M+=2){const R=_[M]=w[M]*y,I=_[M+1]=w[M+1]*g;A.set(pe.createBezierPoints(j,N,P,O,R,I),(M-2)*3),[j,N,P,O]=[P,O,R,I]}}if(p.length===0)return null;const b=o?new sP:new Yb;return b.build(p,n,r,1,i,o?0:f,s),{outline:b,newCurves:v,areContours:o,thickness:f,width:u,height:d}}static async compressSignature({outlines:e,areContours:n,thickness:r,width:i,height:s}){let a=1/0,o=-1/0,l=0;for(const w of e){l+=w.length;for(let S=2,_=w.length;S<_;S++){const A=w[S]-w[S-2];a=Math.min(a,A),o=Math.max(o,A)}}let u;a>=-128&&o<=127?u=Int8Array:a>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const d=e.length,f=Uw+jy*d,p=new Uint32Array(f);let m=0;p[m++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*d)*u.BYTES_PER_ELEMENT,p[m++]=0,p[m++]=i,p[m++]=s,p[m++]=n?0:1,p[m++]=Math.max(0,Math.floor(r??0)),p[m++]=d,p[m++]=u.BYTES_PER_ELEMENT;for(const w of e)p[m++]=w.length-2,p[m++]=w[0],p[m++]=w[1];const y=new CompressionStream("deflate-raw"),g=y.writable.getWriter();await g.ready,g.write(p);const v=u.prototype.constructor;for(const w of e){const S=new v(w.length-2);for(let _=2,A=w.length;_<A;_++)S[_-2]=w[_]-w[_-2];g.write(S)}g.close();const b=await new Response(y.readable).arrayBuffer(),x=new Uint8Array(b);return fz(x)}static async decompressSignature(e){try{const n=UAe(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(n).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,o=0;for await(const w of r)a||(a=new Uint8Array(new Uint32Array(w.buffer,0,4)[0])),a.set(w,o),o+=w.length;const l=new Uint32Array(a.buffer,0,a.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=l[2],f=l[3],p=l[4]===0,m=l[5],y=l[6],g=l[7],v=[],b=(Uw+jy*y)*Uint32Array.BYTES_PER_ELEMENT;let x;switch(g){case Int8Array.BYTES_PER_ELEMENT:x=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:x=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:x=new Int32Array(a.buffer,b);break}o=0;for(let w=0;w<y;w++){const S=l[jy*w+Uw],_=new Float32Array(S+2);v.push(_);for(let A=0;A<jy-1;A++)_[A]=l[jy*w+Uw+A+1];for(let A=0;A<S;A++)_[A+2]=_[A]+x[o++]}return{areContours:p,thickness:m,outlines:v,width:d,height:f}}catch(n){return Ne(`decompressSignature: ${n}`),null}}}Eh=new WeakMap,tt=new WeakSet,aP=function(e,n,r,i){return r-=e,i-=n,r===0?i>0?0:4:r===1?i+6:2-i},Qs=new WeakMap,uW=function(e,n,r,i,s,a,o){const l=C(this,tt,aP).call(this,r,i,s,a);for(let u=0;u<8;u++){const d=(-u+l-o+16)%8,f=h(this,Qs)[2*d],p=h(this,Qs)[2*d+1];if(e[(r+f)*n+(i+p)]!==0)return d}return-1},dW=function(e,n,r,i,s,a,o){const l=C(this,tt,aP).call(this,r,i,s,a);for(let u=0;u<8;u++){const d=(u+l+o+16)%8,f=h(this,Qs)[2*d],p=h(this,Qs)[2*d+1];if(e[(r+f)*n+(i+p)]!==0)return d}return-1},oP=function(e,n,r,i){const s=e.length,a=new Int32Array(s);for(let d=0;d<s;d++)a[d]=e[d]<=i?1:0;for(let d=1;d<r-1;d++)a[d*n]=a[d*n+n-1]=0;for(let d=0;d<n;d++)a[d]=a[n*r-1-d]=0;let o=1,l;const u=[];for(let d=1;d<r-1;d++){l=1;for(let f=1;f<n-1;f++){const p=d*n+f,m=a[p];if(m===0)continue;let y=d,g=f;if(m===1&&a[p-1]===0)o+=1,g-=1;else if(m>=1&&a[p+1]===0)o+=1,g+=1,m>1&&(l=m);else{m!==1&&(l=Math.abs(m));continue}const v=[f,d],b=g===f+1,x={isHole:b,points:v,id:o,parent:0};u.push(x);let w;for(const M of u)if(M.id===l){w=M;break}w?w.isHole?x.parent=b?w.parent:l:x.parent=b?l:w.parent:x.parent=b?l:0;const S=C(this,tt,uW).call(this,a,n,d,f,y,g,0);if(S===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let _=h(this,Qs)[2*S],A=h(this,Qs)[2*S+1];const j=d+_,N=f+A;y=j,g=N;let P=d,O=f;for(;;){const M=C(this,tt,dW).call(this,a,n,P,O,y,g,1);_=h(this,Qs)[2*M],A=h(this,Qs)[2*M+1];const R=P+_,I=O+A;v.push(I,R);const L=P*n+O;if(a[L+1]===0?a[L]=-o:a[L]===1&&(a[L]=o),R===d&&I===f&&P===j&&O===N){a[p]!==1&&(l=Math.abs(a[p]));break}else y=P,g=O,P=R,O=I}}}return u},M1=function(e,n,r,i){if(r-n<=4){for(let j=n;j<r-2;j+=2)i.push(e[j],e[j+1]);return}const s=e[n],a=e[n+1],o=e[r-4]-s,l=e[r-3]-a,u=Math.hypot(o,l),d=o/u,f=l/u,p=d*a-f*s,m=l/o,y=1/u,g=Math.atan(m),v=Math.cos(g),b=Math.sin(g),x=y*(Math.abs(v)+Math.abs(b)),w=y*(1-x+x**2),S=Math.max(Math.atan(Math.abs(b+v)*w),Math.atan(Math.abs(b-v)*w));let _=0,A=n;for(let j=n+2;j<r-2;j+=2){const N=Math.abs(p-d*e[j+1]+f*e[j]);N>_&&(A=j,_=N)}_>(u*S)**2?(C(this,tt,M1).call(this,e,n,A+2,i),C(this,tt,M1).call(this,e,A,r,i)):i.push(s,a)},hW=function(e){const n=[],r=e.length;return C(this,tt,M1).call(this,e,0,r,n),n.push(e[r-2],e[r-1]),n.length<=4?null:n},fW=function(e,n,r,i,s,a){const o=new Float32Array(a**2),l=-2*i**2,u=a>>1;for(let g=0;g<a;g++){const v=(g-u)**2;for(let b=0;b<a;b++)o[g*a+b]=Math.exp((v+(b-u)**2)/l)}const d=new Float32Array(256),f=-2*s**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/f);const p=e.length,m=new Uint8Array(p),y=new Uint32Array(256);for(let g=0;g<r;g++)for(let v=0;v<n;v++){const b=g*n+v,x=e[b];let w=0,S=0;for(let A=0;A<a;A++){const j=g+A-u;if(!(j<0||j>=r))for(let N=0;N<a;N++){const P=v+N-u;if(P<0||P>=n)continue;const O=e[j*n+P],M=o[A*a+N]*d[Math.abs(O-x)];w+=O*M,S+=M}}const _=m[b]=Math.round(w/S);y[_]++}return[m,y]},pW=function(e){const n=new Uint32Array(256);for(const r of e)n[r]++;return n},lP=function(e){const n=e.length,r=new Uint8ClampedArray(n>>2);let i=-1/0,s=1/0;for(let o=0,l=r.length;o<l;o++){const u=r[o]=e[o<<2];i=Math.max(i,u),s=Math.min(s,u)}const a=255/(i-s);for(let o=0,l=r.length;o<l;o++)r[o]=(r[o]-s)*a;return r},cP=function(e){let n,r=-1/0,i=-1/0;const s=e.findIndex(l=>l!==0);let a=s,o=s;for(n=s;n<256;n++){const l=e[n];l>r&&(n-a>i&&(i=n-a,o=n-1),r=l,a=n)}for(n=o-1;n>=0&&!(e[n]>e[n+1]);n--);return n},mW=function(e){const n=e,{width:r,height:i}=e,{maxDim:s}=h(this,Eh);let a=r,o=i;if(r>s||i>s){let p=r,m=i,y=Math.log2(Math.max(r,i)/s);const g=Math.floor(y);y=y===g?g-1:g;for(let b=0;b<y;b++){a=Math.ceil(p/2),o=Math.ceil(m/2);const x=new OffscreenCanvas(a,o);x.getContext("2d").drawImage(e,0,0,p,m,0,0,a,o),p=a,m=o,e!==n&&e.close(),e=x.transferToImageBitmap()}const v=Math.min(s/a,s/o);a=Math.round(a*v),o=Math.round(o*v)}const u=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,o),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,o);const d=u.getImageData(0,0,a,o).data;return[C(this,tt,lP).call(this,d),a,o]},E(sl,tt),E(sl,Eh,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),E(sl,Qs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class UO extends iW{constructor(){super(),super.updateProperties({fill:Nt._defaultLineColor,"stroke-width":0})}clone(){const e=new UO;return e.updateAll(this),e}}class zO extends Sj{constructor(e){super(e),super.updateProperties({stroke:Nt._defaultLineColor,"stroke-width":1})}clone(){const e=new zO(this._viewParameters);return e.updateAll(this),e}}var Wc,qa,Hc,Ch;const gi=class gi extends OS{constructor(n){super({...n,mustBeCommitted:!0,name:"signatureEditor"});E(this,Wc,!1);E(this,qa,null);E(this,Hc,null);E(this,Ch,null);this._willKeepAspectRatio=!0,k(this,Hc,n.signatureData||null),k(this,qa,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(n,r){Nt.initialize(n,r),this._defaultDrawingOptions=new UO,this._defaultDrawnSignatureOptions=new zO(r.viewParameters)}static getDefaultDrawingOptions(n){const r=this._defaultDrawingOptions.clone();return r.updateProperties(n),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return Oe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!h(this,qa)}}static computeTelemetryFinalData(n){const r=n.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let n,r;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,n=this.x,r=this.y),super.render(),this._drawId===null)if(h(this,Hc)){const{lines:s,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:d}=h(this,Hc),{rawDims:{pageWidth:f,pageHeight:p},rotation:m}=this.parent.viewport,y=sl.processDrawnLines({lines:s,pageWidth:f,pageHeight:p,rotation:m,innerMargin:gi._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(y,d,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:h(this,qa)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(n,r)),this.div}setUuid(n){k(this,Ch,n),this.addEditToolbar()}getUuid(){return h(this,Ch)}get description(){return h(this,qa)}set description(n){k(this,qa,n),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:n})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(n)}))}getSignaturePreview(){const{newCurves:n,areContours:r,thickness:i,width:s,height:a}=h(this,Hc),o=Math.max(s,a),l=sl.processDrawnLines({lines:{curves:n.map(u=>({points:u})),thickness:i,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(n,r,i,s){const{x:a,y:o}=this,{outline:l}=k(this,Hc,n);k(this,Wc,l instanceof sP),this.description=i;let u;h(this,Wc)?u=gi.getDefaultDrawingOptions():(u=gi._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,d]=this.pageDimensions;let f=r/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(n){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return sl.process(n,r,i,s,gi._INNER_MARGIN)}getFromText(n,r){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return sl.extractContoursFromText(n,r,i,s,a,gi._INNER_MARGIN)}getDrawnSignature(n){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return sl.processDrawnLines({lines:n,pageWidth:r,pageHeight:i,rotation:s,innerMargin:gi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:n,thickness:r}){n?this._drawingOptions=gi.getDefaultDrawingOptions():(this._drawingOptions=gi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(n=!1){if(this.isEmpty())return null;const{lines:r,points:i}=this.serializeDraw(n),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(n),{isSignature:!0,areContours:h(this,Wc),color:[0,0,0],thickness:h(this,Wc)?0:s});return this.addComment(a),n?(a.paths={lines:r,points:i},a.uuid=h(this,Ch),a.isCopy=!0):a.lines=r,h(this,qa)&&(a.accessibilityData={type:"Figure",alt:h(this,qa)}),a}static deserializeDraw(n,r,i,s,a,o){return o.areContours?sP.deserialize(n,r,i,s,a,o):Yb.deserialize(n,r,i,s,a,o)}static async deserialize(n,r,i){var a;const s=await super.deserialize(n,r,i);return k(s,Wc,n.areContours),s.description=((a=n.accessibilityData)==null?void 0:a.alt)||"",k(s,Ch,n.uuid),s}};Wc=new WeakMap,qa=new WeakMap,Hc=new WeakMap,Ch=new WeakMap,ae(gi,"_type","signature"),ae(gi,"_editorType",Pe.SIGNATURE),ae(gi,"_defaultDrawingOptions",null);let uP=gi;var $t,$n,qc,el,Gc,Wm,tl,Ph,Ga,Ii,Hm,Ke,Zy,e0,R1,I1,D1,hP,$1,gW;class dP extends Nt{constructor(n){super({...n,name:"stampEditor"});E(this,Ke);E(this,$t,null);E(this,$n,null);E(this,qc,null);E(this,el,null);E(this,Gc,null);E(this,Wm,"");E(this,tl,null);E(this,Ph,!1);E(this,Ga,null);E(this,Ii,!1);E(this,Hm,!1);k(this,el,n.bitmapUrl),k(this,Gc,n.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(n,r){Nt.initialize(n,r)}static isHandlingMimeForPasting(n){return XC.includes(n)}static paste(n,r){r.pasteEditor({mode:Pe.STAMP},{bitmapFile:n.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var n;return{type:"stamp",hasAltText:!!((n=this.altTextData)!=null&&n.altText)}}static computeTelemetryFinalData(n){const r=n.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(n=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=n||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),r&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var n;h(this,$n)&&(k(this,$t,null),this._uiManager.imageManager.deleteId(h(this,$n)),(n=h(this,tl))==null||n.remove(),k(this,tl,null),h(this,Ga)&&(clearTimeout(h(this,Ga)),k(this,Ga,null))),super.remove()}rebuild(){if(!this.parent){h(this,$n)&&C(this,Ke,R1).call(this);return}super.rebuild(),this.div!==null&&(h(this,$n)&&h(this,tl)===null&&C(this,Ke,R1).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(n){this._isDraggable=!0,n&&this.div.focus()}isEmpty(){return!(h(this,qc)||h(this,$t)||h(this,el)||h(this,Gc)||h(this,$n)||h(this,Ph))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let n,r;return this._isCopy&&(n=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),h(this,Ph)||(h(this,$t)?C(this,Ke,I1).call(this):C(this,Ke,R1).call(this)),this._isCopy&&this._moveAfterPaste(n,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(n,r){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(n,r);r.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(k(this,$n,i),s&&k(this,$t,s),k(this,Ph,!1),C(this,Ke,I1).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;h(this,Ga)!==null&&clearTimeout(h(this,Ga)),k(this,Ga,setTimeout(()=>{k(this,Ga,null),C(this,Ke,hP).call(this)},200))}copyCanvas(n,r,i=!1){n||(n=224);const{width:s,height:a}=h(this,$t),o=new io;let l=h(this,$t),u=s,d=a,f=null;if(r){if(s>r||a>r){const j=Math.min(r/s,r/a);u=Math.floor(s*j),d=Math.floor(a*j)}f=document.createElement("canvas");const m=f.width=Math.ceil(u*o.sx),y=f.height=Math.ceil(d*o.sy);h(this,Ii)||(l=C(this,Ke,D1).call(this,m,y));const g=f.getContext("2d");g.filter=this._uiManager.hcmFilter;let v="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":KAe.isDarkMode&&(v="#8f8f9d",b="#42414d");const x=15,w=x*o.sx,S=x*o.sy,_=new OffscreenCanvas(w*2,S*2),A=_.getContext("2d");A.fillStyle=v,A.fillRect(0,0,w*2,S*2),A.fillStyle=b,A.fillRect(0,0,w,S),A.fillRect(w,S,w,S),g.fillStyle=g.createPattern(_,"repeat"),g.fillRect(0,0,m,y),g.drawImage(l,0,0,l.width,l.height,0,0,m,y)}let p=null;if(i){let m,y;if(o.symmetric&&l.width<n&&l.height<n)m=l.width,y=l.height;else if(l=h(this,$t),s>n||a>n){const b=Math.min(n/s,n/a);m=Math.floor(s*b),y=Math.floor(a*b),h(this,Ii)||(l=C(this,Ke,D1).call(this,m,y))}const v=new OffscreenCanvas(m,y).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,m,y),p={width:m,height:y,data:v.getImageData(0,0,m,y).data}}return{canvas:f,width:u,height:d,imageData:p}}static async deserialize(n,r,i){var v;let s=null,a=!1;if(n instanceof O9){const{data:{rect:b,rotation:x,id:w,structParent:S,popupRef:_,richText:A,contentsObj:j,creationDate:N,modificationDate:P},container:O,parent:{page:{pageNumber:M}},canvas:R}=n;let I,L;R?(delete n.canvas,{id:I,bitmap:L}=i.imageManager.getFromCanvas(O.id,R),R.remove()):(a=!0,n._hasNoCanvas=!0);const W=((v=await r._structTree.getAriaAttributes(`${Yf}${w}`))==null?void 0:v.get("aria-label"))||"";s=n={annotationType:Pe.STAMP,bitmapId:I,bitmap:L,pageIndex:M-1,rect:b.slice(0),rotation:x,annotationElementId:w,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:W},isSvg:!1,structParent:S,popupRef:_,richText:A,comment:(j==null?void 0:j.str)||null,creationDate:N,modificationDate:P}}const o=await super.deserialize(n,r,i),{rect:l,bitmap:u,bitmapUrl:d,bitmapId:f,isSvg:p,accessibilityData:m}=n;a?(i.addMissingCanvas(n.id,o),k(o,Ph,!0)):f&&i.imageManager.isValidId(f)?(k(o,$n,f),u&&k(o,$t,u)):k(o,el,d),k(o,Ii,p);const[y,g]=o.pageDimensions;return o.width=(l[2]-l[0])/y,o.height=(l[3]-l[1])/g,m&&(o.altTextData=m),o._initialData=s,n.comment&&o.setCommentData(n),k(o,Hm,!!s),o}serialize(n=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(n),{bitmapId:h(this,$n),isSvg:h(this,Ii)});if(this.addComment(i),n)return i.bitmapUrl=C(this,Ke,$1).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=C(this,Ke,gW).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(r===null)return i;r.stamps||(r.stamps=new Map);const o=h(this,Ii)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!r.stamps.has(h(this,$n)))r.stamps.set(h(this,$n),{area:o,serialized:i}),i.bitmap=C(this,Ke,$1).call(this,!1);else if(h(this,Ii)){const l=r.stamps.get(h(this,$n));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=C(this,Ke,$1).call(this,!1))}return i}renderAnnotationElement(n){return this.deleted?(n.hide(),null):(n.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}$t=new WeakMap,$n=new WeakMap,qc=new WeakMap,el=new WeakMap,Gc=new WeakMap,Wm=new WeakMap,tl=new WeakMap,Ph=new WeakMap,Ga=new WeakMap,Ii=new WeakMap,Hm=new WeakMap,Ke=new WeakSet,Zy=function(n,r=!1){if(!n){this.remove();return}k(this,$t,n.bitmap),r||(k(this,$n,n.id),k(this,Ii,n.isSvg)),n.file&&k(this,Wm,n.file.name),C(this,Ke,I1).call(this)},e0=function(){if(k(this,qc,null),this._uiManager.enableWaiting(!1),!!h(this,tl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,$t)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&h(this,$t)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},R1=function(){if(h(this,$n)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(h(this,$n)).then(i=>C(this,Ke,Zy).call(this,i,!0)).finally(()=>C(this,Ke,e0).call(this));return}if(h(this,el)){const i=h(this,el);k(this,el,null),this._uiManager.enableWaiting(!0),k(this,qc,this._uiManager.imageManager.getFromUrl(i).then(s=>C(this,Ke,Zy).call(this,s)).finally(()=>C(this,Ke,e0).call(this)));return}if(h(this,Gc)){const i=h(this,Gc);k(this,Gc,null),this._uiManager.enableWaiting(!0),k(this,qc,this._uiManager.imageManager.getFromFile(i).then(s=>C(this,Ke,Zy).call(this,s)).finally(()=>C(this,Ke,e0).call(this)));return}const n=document.createElement("input");n.type="file",n.accept=XC.join(",");const r=this._uiManager._signal;k(this,qc,new Promise(i=>{n.addEventListener("change",async()=>{if(!n.files||n.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(n.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),C(this,Ke,Zy).call(this,s)}i()},{signal:r}),n.addEventListener("cancel",()=>{this.remove(),i()},{signal:r})}).finally(()=>C(this,Ke,e0).call(this))),n.click()},I1=function(){var u;const{div:n}=this;let{width:r,height:i}=h(this,$t);const[s,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*s,i=this.height*a;else if(r>o*s||i>o*a){const d=Math.min(o*s/r,o*a/i);r*=d,i*=d}this._uiManager.enableWaiting(!1);const l=k(this,tl,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/s,this.height=i/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(n.hidden=!1),C(this,Ke,hP).call(this),h(this,Hm)||(this.parent.addUndoableEditor(this),k(this,Hm,!0)),this._reportTelemetry({action:"inserted_image"}),h(this,Wm)&&this.div.setAttribute("aria-description",h(this,Wm)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},D1=function(n,r){const{width:i,height:s}=h(this,$t);let a=i,o=s,l=h(this,$t);for(;a>2*n||o>2*r;){const u=a,d=o;a>2*n&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,u,d,0,0,a,o),l=f.transferToImageBitmap()}return l},hP=function(){const[n,r]=this.parentDimensions,{width:i,height:s}=this,a=new io,o=Math.ceil(i*n*a.sx),l=Math.ceil(s*r*a.sy),u=h(this,tl);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const d=h(this,Ii)?h(this,$t):C(this,Ke,D1).call(this,o,l),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,l)},$1=function(n){if(n){if(h(this,Ii)){const s=this._uiManager.imageManager.getSvgUrl(h(this,$n));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=h(this,$t),r.getContext("2d").drawImage(h(this,$t),0,0),r.toDataURL()}if(h(this,Ii)){const[r,i]=this.pageDimensions,s=Math.round(this.width*r*xu.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*xu.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(h(this,$t),0,0,h(this,$t).width,h(this,$t).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(h(this,$t))},gW=function(n){var o;const{pageIndex:r,accessibilityData:{altText:i}}=this._initialData,s=n.pageIndex===r,a=(((o=n.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},ae(dP,"_type","stamp"),ae(dP,"_editorType",Pe.STAMP);var Th,qm,Kc,Vc,nl,ni,Yc,Gm,Km,Js,rl,Ln,il,Xc,Vm,ve,Qc,vt,pP,yW,va,mP,gP,L1;const Ls=class Ls{constructor({uiManager:e,pageIndex:n,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:d}){E(this,vt);E(this,Th);E(this,qm,!1);E(this,Kc,null);E(this,Vc,null);E(this,nl,null);E(this,ni,new Map);E(this,Yc,!1);E(this,Gm,!1);E(this,Km,!1);E(this,Js,null);E(this,rl,null);E(this,Ln,null);E(this,il,null);E(this,Xc,null);E(this,Vm,-1);E(this,ve);const f=[...h(Ls,Qc).values()];if(!Ls._initialized){Ls._initialized=!0;for(const p of f)p.initialize(d,e)}e.registerEditorTypes(f),k(this,ve,e),this.pageIndex=n,this.div=r,k(this,Th,s),k(this,Kc,a),this.viewport=u,k(this,Ln,l),this.drawLayer=o,this._structTree=i,h(this,ve).addLayer(this)}get isEmpty(){return h(this,ni).size===0}get isInvisible(){return this.isEmpty&&h(this,ve).getMode()===Pe.NONE}updateToolbar(e){h(this,ve).updateToolbar(e)}updateMode(e=h(this,ve).getMode()){switch(C(this,vt,L1).call(this),e){case Pe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Pe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Pe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:n}=this.div;if(n.toggle("nonEditing",!1),e===Pe.POPUP)n.toggle("commentEditing",!0);else{n.toggle("commentEditing",!1);for(const r of h(Ls,Qc).values())n.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var n;return e===((n=h(this,Ln))==null?void 0:n.div)}setEditingState(e){h(this,ve).setEditingState(e)}addCommands(e){h(this,ve).addCommands(e)}cleanUndoStack(e){h(this,ve).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var n;(n=h(this,Kc))==null||n.togglePointerEvents(e)}async enable(){var r;k(this,Km,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=h(this,Xc))==null||r.abort(),k(this,Xc,null);const e=new Set;for(const i of h(this,vt,pP))i.enableEditing(),i.show(!0),i.annotationElementId&&(h(this,ve).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const n=h(this,Kc);if(n)for(const i of n.getEditableAnnotations()){if(i.hide(),h(this,ve).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}k(this,Km,!1),h(this,ve)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(k(this,Gm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),h(this,Ln)&&!h(this,Xc)){k(this,Xc,new AbortController);const s=h(this,ve).combinedSignal(h(this,Xc));h(this,Ln).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:u,timeStamp:d}=a,f=h(this,Vm);if(d-f>500){k(this,Vm,d);return}k(this,Vm,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const m=document.elementsFromPoint(l,u);if(p.toggle("getElements",!1),!this.div.contains(m[0]))return;let y;const g=new RegExp(`^${kv}[0-9]+$`);for(const b of m)if(g.test(b.id)){y=b.id;break}if(!y)return;const v=h(this,ni).get(y);(v==null?void 0:v.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),v.dblclick(a))},{signal:s,capture:!0})}const e=h(this,Kc),n=[];if(e){const s=new Map,a=new Map;for(const l of h(this,vt,pP)){if(l.disableEditing(),!l.annotationElementId){n.push(l);continue}if(l.serialize()!==null){s.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:u}=l.data;if(h(this,ve).isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let d=a.get(u);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=s.get(u),d&&(h(this,ve).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}C(this,vt,L1).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of h(Ls,Qc).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(n),k(this,Gm,!1)}getEditableAnnotation(e){var n;return((n=h(this,Kc))==null?void 0:n.getEditableAnnotation(e))||null}setActiveEditor(e){h(this,ve).getActive()!==e&&h(this,ve).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=h(this,Ln))!=null&&e.div&&!h(this,il)){k(this,il,new AbortController);const n=h(this,ve).combinedSignal(h(this,il));h(this,Ln).div.addEventListener("pointerdown",C(this,vt,yW).bind(this),{signal:n}),h(this,Ln).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=h(this,Ln))!=null&&e.div&&h(this,il)&&(h(this,il).abort(),k(this,il,null),h(this,Ln).div.classList.remove("highlighting"))}enableClick(){if(h(this,Vc))return;k(this,Vc,new AbortController);const e=h(this,ve).combinedSignal(h(this,Vc));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const n=this.pointerup.bind(this);this.div.addEventListener("pointerup",n,{signal:e}),this.div.addEventListener("pointercancel",n,{signal:e})}disableClick(){var e;(e=h(this,Vc))==null||e.abort(),k(this,Vc,null)}attach(e){h(this,ni).set(e.id,e);const{annotationElementId:n}=e;n&&h(this,ve).isDeletedAnnotationElement(n)&&h(this,ve).removeDeletedAnnotationElement(e)}detach(e){var n;h(this,ni).delete(e.id),(n=h(this,Th))==null||n.removePointerInTextLayer(e.contentDiv),!h(this,Gm)&&e.annotationElementId&&h(this,ve).addDeletedAnnotationElement(e)}remove(e){this.detach(e),h(this,ve).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var n;e.parent!==this&&(e.parent&&e.annotationElementId&&(h(this,ve).addDeletedAnnotationElement(e.annotationElementId),Nt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(n=e.parent)==null||n.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),h(this,ve).addEditor(e),this.attach(e),!e.isAttachedToDOM){const n=e.render();this.div.append(n),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!h(this,Km)),h(this,ve).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!h(this,nl)&&(e._focusEventsAllowed=!1,k(this,nl,setTimeout(()=>{k(this,nl,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:h(this,ve)._signal}),n.focus())},0))),e._structTreeParentId=(r=h(this,Th))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const n=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:n,undo:r,mustExec:!1})}getEditorByUID(e){for(const n of h(this,ni).values())if(n.uid===e)return n;return null}getNextId(){return h(this,ve).getId()}combinedSignal(e){return h(this,ve).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=h(this,vt,va))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,n){this.updateToolbar(e),await h(this,ve).updateMode(e.mode);const{offsetX:r,offsetY:i}=C(this,vt,gP).call(this),s=this.getNextId(),a=C(this,vt,mP).call(this,{parent:this,id:s,x:r,y:i,uiManager:h(this,ve),isCentered:!0,...n});a&&this.add(a)}async deserialize(e){var n;return await((n=h(Ls,Qc).get(e.annotationType??e.annotationEditorType))==null?void 0:n.deserialize(e,this,h(this,ve)))||null}createAndAddNewEditor(e,n,r={}){const i=this.getNextId(),s=C(this,vt,mP).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:h(this,ve),isCentered:n,...r});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(C(this,vt,gP).call(this),!0,e)}setSelected(e){h(this,ve).setSelected(e)}toggleSelected(e){h(this,ve).toggleSelected(e)}unselect(e){h(this,ve).unselect(e)}pointerup(e){var i;const{isMac:n}=nr.platform;if(e.button!==0||e.ctrlKey&&n||e.target!==this.div||!h(this,Yc)||(k(this,Yc,!1),(i=h(this,vt,va))!=null&&i.isDrawer&&h(this,vt,va).supportMultipleDrawings))return;if(!h(this,qm)){k(this,qm,!0);return}const r=h(this,ve).getMode();if(r===Pe.STAMP||r===Pe.SIGNATURE){h(this,ve).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(h(this,ve).getMode()===Pe.HIGHLIGHT&&this.enableTextSelection(),h(this,Yc)){k(this,Yc,!1);return}const{isMac:n}=nr.platform;if(e.button!==0||e.ctrlKey&&n||e.target!==this.div)return;if(k(this,Yc,!0),(i=h(this,vt,va))!=null&&i.isDrawer){this.startDrawingSession(e);return}const r=h(this,ve).getActive();k(this,qm,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),h(this,Js)){h(this,vt,va).startDrawing(this,h(this,ve),!1,e);return}h(this,ve).setCurrentDrawingSession(this),k(this,Js,new AbortController);const n=h(this,ve).combinedSignal(h(this,Js));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(k(this,rl,null),this.commitOrRemove())},{signal:n}),h(this,vt,va).startDrawing(this,h(this,ve),!1,e)}pause(e){if(e){const{activeElement:n}=document;this.div.contains(n)&&k(this,rl,n);return}h(this,rl)&&setTimeout(()=>{var n;(n=h(this,rl))==null||n.focus(),k(this,rl,null)},0)}endDrawingSession(e=!1){return h(this,Js)?(h(this,ve).setCurrentDrawingSession(null),h(this,Js).abort(),k(this,Js,null),k(this,rl,null),h(this,vt,va).endDrawing(e)):null}findNewParent(e,n,r){const i=h(this,ve).findParent(n,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return h(this,Js)?(this.endDrawingSession(),!0):!1}onScaleChanging(){h(this,Js)&&h(this,vt,va).onScaleChangingWhenDrawing(this)}destroy(){var e,n;this.commitOrRemove(),((e=h(this,ve).getActive())==null?void 0:e.parent)===this&&(h(this,ve).commitOrRemove(),h(this,ve).setActiveEditor(null)),h(this,nl)&&(clearTimeout(h(this,nl)),k(this,nl,null));for(const r of h(this,ni).values())(n=h(this,Th))==null||n.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,h(this,ni).clear(),h(this,ve).removeLayer(this)}render({viewport:e}){this.viewport=e,Yh(this.div,e);for(const n of h(this,ve).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update({viewport:e}){h(this,ve).commitOrRemove(),C(this,vt,L1).call(this);const n=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Yh(this.div,{rotation:r}),n!==r)for(const i of h(this,ni).values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:n}=this.viewport.rawDims;return[e,n]}get scale(){return h(this,ve).viewParameters.realScale}};Th=new WeakMap,qm=new WeakMap,Kc=new WeakMap,Vc=new WeakMap,nl=new WeakMap,ni=new WeakMap,Yc=new WeakMap,Gm=new WeakMap,Km=new WeakMap,Js=new WeakMap,rl=new WeakMap,Ln=new WeakMap,il=new WeakMap,Xc=new WeakMap,Vm=new WeakMap,ve=new WeakMap,Qc=new WeakMap,vt=new WeakSet,pP=function(){return h(this,ni).size!==0?h(this,ni).values():h(this,ve).getEditors(this.pageIndex)},yW=function(e){h(this,ve).unselectAll();const{target:n}=e;if(n===h(this,Ln).div||(n.getAttribute("role")==="img"||n.classList.contains("endOfContent"))&&h(this,Ln).div.contains(n)){const{isMac:r}=nr.platform;if(e.button!==0||e.ctrlKey&&r)return;h(this,ve).showAllEditors("highlight",!0,!0),h(this,Ln).div.classList.add("free"),this.toggleDrawing(),TS.startHighlighting(this,h(this,ve).direction==="ltr",{target:h(this,Ln).div,x:e.x,y:e.y}),h(this,Ln).div.addEventListener("pointerup",()=>{h(this,Ln).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:h(this,ve)._signal}),e.preventDefault()}},va=function(){return h(Ls,Qc).get(h(this,ve).getMode())},mP=function(e){const n=h(this,vt,va);return n?new n.prototype.constructor(e):null},gP=function(){const{x:e,y:n,width:r,height:i}=this.boundingClientRect,s=Math.max(0,e),a=Math.max(0,n),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,n+i),u=(s+o)/2-e,d=(a+l)/2-n,[f,p]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:f,offsetY:p}},L1=function(){for(const e of h(this,ni).values())e.isEmpty()&&e.remove()},ae(Ls,"_initialized",!1),E(Ls,Qc,new Map([V2,iP,dP,TS,uP].map(e=>[e._editorType,e])));let fP=Ls;var Zs,Er,Oh,Ab,QS,vW,so,vP,xW,xP;const _n=class _n{constructor({pageIndex:e}){E(this,so);E(this,Zs,null);E(this,Er,new Map);E(this,Oh,new Map);this.pageIndex=e}setParent(e){if(!h(this,Zs)){k(this,Zs,e);return}if(h(this,Zs)!==e){if(h(this,Er).size>0)for(const n of h(this,Er).values())n.remove(),e.append(n);k(this,Zs,e)}}static get _svgFactory(){return Oe(this,"_svgFactory",new CS)}draw(e,n=!1,r=!1){const i=Vt(_n,Ab)._++,s=C(this,so,vP).call(this),a=_n._svgFactory.createElement("defs");s.append(a);const o=_n._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),n&&h(this,Oh).set(i,o);const u=r?C(this,so,xW).call(this,a,l):null,d=_n._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(s,e),h(this,Er).set(i,s),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,n){const r=Vt(_n,Ab)._++,i=C(this,so,vP).call(this),s=_n._svgFactory.createElement("defs");i.append(s);const a=_n._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(n){const f=_n._svgFactory.createElement("mask");s.append(f),l=`mask_p${this.pageIndex}_${r}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=_n._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=_n._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=_n._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),h(this,Er).set(r,i),r}finalizeDraw(e,n){h(this,Oh).delete(e),this.updateProperties(e,n)}updateProperties(e,n){var l;if(!n)return;const{root:r,bbox:i,rootClass:s,path:a}=n,o=typeof e=="number"?h(this,Er).get(e):e;if(o){if(r&&C(this,so,xP).call(this,o,r),i&&C(l=_n,QS,vW).call(l,o,i),s){const{classList:u}=o;for(const[d,f]of Object.entries(s))u.toggle(d,f)}if(a){const d=o.firstChild.firstChild;C(this,so,xP).call(this,d,a)}}}updateParent(e,n){if(n===this)return;const r=h(this,Er).get(e);r&&(h(n,Zs).append(r),h(this,Er).delete(e),h(n,Er).set(e,r))}remove(e){h(this,Oh).delete(e),h(this,Zs)!==null&&(h(this,Er).get(e).remove(),h(this,Er).delete(e))}destroy(){k(this,Zs,null);for(const e of h(this,Er).values())e.remove();h(this,Er).clear(),h(this,Oh).clear()}};Zs=new WeakMap,Er=new WeakMap,Oh=new WeakMap,Ab=new WeakMap,QS=new WeakSet,vW=function(e,[n,r,i,s]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*n}%`,a.width=`${100*i}%`,a.height=`${100*s}%`},so=new WeakSet,vP=function(){const e=_n._svgFactory.create(1,1,!0);return h(this,Zs).append(e),e.setAttribute("aria-hidden",!0),e},xW=function(e,n){const r=_n._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${n}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=_n._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${n}`),s.classList.add("clip"),i},xP=function(e,n){for(const[r,i]of Object.entries(n))i===null?e.removeAttribute(r):e.setAttribute(r,i)},E(_n,QS),E(_n,Ab,0);let yP=_n;globalThis._pdfjsTestingUtils={HighlightOutliner:X2};globalThis.pdfjsLib={AbortException:vu,AnnotationEditorLayer:fP,AnnotationEditorParamsType:ze,AnnotationEditorType:Pe,AnnotationEditorUIManager:Xh,AnnotationLayer:G2,AnnotationMode:Ql,AnnotationType:un,applyOpacity:YAe,build:nke,ColorPicker:NS,createValidAbsoluteUrl:cz,CSSConstants:VAe,DOMSVGFactory:CS,DrawLayer:yP,FeatureTest:nr,fetchData:Hb,findContrastColor:XAe,getDocument:y9,getFilenameFromUrl:zAe,getPdfFilenameFromUrl:WAe,getRGB:Gb,getUuid:hz,getXfaPageViewport:qAe,GlobalWorkerOptions:Va,ImageKind:s1,InvalidPDFException:VC,isDataScheme:wj,isPdfFile:IO,isValidExplicitDest:aje,MathClamp:Pr,noContextMenu:Ps,normalizeUnicode:FAe,OPS:Nv,OutputScale:io,PasswordResponses:PAe,PDFDataRangeTransport:v9,PDFDateString:wS,PDFWorker:Pv,PermissionFlag:CAe,PixelsPerInch:xu,RenderingCancelledException:RO,renderRichText:mz,ResponseException:bS,setLayerDimensions:Yh,shadow:Oe,SignatureExtractor:sl,stopEvent:rn,SupportedImageMimeTypes:XC,TextLayer:Cv,TouchManager:SS,updateUrlHash:uz,Util:ge,VerbosityLevel:vj,version:tke,XfaLayer:pz};Va.workerSrc=new URL("/fire-app/assets/pdf.worker.min-Cpi8b8z3.mjs",import.meta.url).toString();function kke({onClose:t}){const[e,n]=T.useState([]),[r,i]=T.useState(""),[s,a]=T.useState(""),[o,l]=T.useState(!1),[u,d]=T.useState({current:0,total:0}),[f,p]=T.useState(""),[m,y]=T.useState("checking"),[g,v]=T.useState(""),[b,x]=T.useState(!1),[w,S]=T.useState(!1),_=T.useRef(null),A=T.useRef(null),{data:j=[]}=ar(),{data:N=[]}=Rl(),{data:P=[]}=Ms(),O=mj(),M=sz(),R=async H=>{var B;const Q=(B=H.target.files)==null?void 0:B[0];Q&&(v(Q.name),A.current=Q)},I=async H=>{try{const Q=await H.arrayBuffer(),Y=await y9({data:Q}).promise;let ne="";for(let V=1;V<=Y.numPages;V++){const q=(await(await Y.getPage(V)).getTextContent()).items.map(G=>G.str).join(" ");ne+=q+`
`}return ne}catch(Q){throw console.error("Error extracting PDF text:",Q),Q}},L=async()=>{if(A.current){S(!0);try{const H=await I(A.current);if(!H.trim()){x(!0),v(""),A.current=null,_.current&&(_.current.value="");return}p(H);const Q=W(H,m);Q.length===0?(console.log("Extracted PDF text:",H),x(!0)):n(Q.map(B=>({...B,selected:!0})))}catch(H){console.error("Error processing PDF:",H),x(!0)}finally{S(!1)}}},W=(H,Q)=>{const B=[],Y=H.split(`
`).map(q=>q.trim()).filter(q=>q.length>0);console.log(`Parsing ${Y.length} lines from ${Q} statement`),console.log("First 20 lines:",Y.slice(0,20));const ne=/^(\d{1,2}\/\d{1,2}(?:\/\d{2,4})?)\s+(.+)/,V=/-?([\d,]+\.\d{2})$/,te=/\$?([\d,]+\.\d{2})/g;let $=!1;for(let q=0;q<Y.length;q++){const G=Y[q];(G.includes("PAYMENTS")||G.includes("CREDITS"))&&($=!0),(G.includes("PURCHASE")||G.includes("FEES")||G.includes("INTEREST"))&&($=!1);const re=G.match(ne);if(!re)continue;const Z=re[1],J=re[2].trim();let X=0,se=J;const ce=J.match(V);if(ce)X=parseFloat(ce[1].replace(/,/g,"")),se=J.replace(V,"").trim();else{const je=[];let Be;const mt=new RegExp(te);for(;(Be=mt.exec(J))!==null;)je.push(parseFloat(Be[1].replace(/,/g,"")));if(je.length>0){X=je[je.length-1];const Hr=Be?Be[0]:"",fi=J.lastIndexOf(Hr);fi>0&&(se=J.substring(0,fi).trim())}}if(X===0||se.toLowerCase().includes("order number")||(se=se.replace(/\s+/g," ").replace(/\$\d+\.\d{2}/g,"").trim(),!se||se.length<2))continue;let ue;Q==="credit"?$||se.toLowerCase().includes("payment")?(ue="credit",X=Math.abs(X)):ue="debit":se.toLowerCase().includes("deposit")||se.toLowerCase().includes("credit")?ue="credit":ue="debit",B.push({date:F(Z),description:se.substring(0,100),amount:Math.abs(X),type:ue,selected:!0})}return console.log(`Parsed ${B.length} transactions`),B.length>0&&console.log("First 3 transactions:",B.slice(0,3)),B},F=H=>{try{const Q=H.split("/");let B,Y,ne;return Y=parseInt(Q[0])-1,ne=parseInt(Q[1]),Q.length===3?(B=parseInt(Q[2]),B<100&&(B+=B<50?2e3:1900)):B=new Date().getFullYear(),new Date(B,Y,ne).toISOString().split("T")[0]}catch{return H}},z=H=>{p(H);const Q=W(H,m);n(Q.map(B=>({...B,selected:!0})))},U=H=>{n(Q=>Q.map((B,Y)=>Y===H?{...B,selected:!B.selected}:B))},K=async()=>{if(!r){alert("Please select an account");return}const H=e.filter(ne=>ne.selected);if(H.length===0){alert("Please select at least one transaction to import");return}l(!0),d({current:0,total:H.length});let Q=0,B=0;const Y=new Map(N.map(ne=>[ne.name.toLowerCase(),ne.id]));for(let ne=0;ne<H.length;ne++){const V=H[ne];d({current:ne+1,total:H.length});try{let te=null;const $=V.description.trim(),q=Y.get($.toLowerCase());if(q)te=q;else{const Z=await M.mutateAsync({name:$,default_category_id:s||null,default_account_id:r});te=Z[0].id,Y.set($.toLowerCase(),Z[0].id)}const G=V.type==="debit"?-Math.abs(V.amount):Math.abs(V.amount),re={date:V.date,amount:G,account_id:r,payee_id:te,category_id:s||null,notes:null,is_pending:!1};await O.mutateAsync(re),Q++}catch(te){console.error("Error importing transaction:",V,te),B++}}l(!1),alert(`Import complete!
Success: ${Q}
Errors: ${B}`),t()};return c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"p-6 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Import from PDF Statement"}),c.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",disabled:o,children:""})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[!e.length&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statement Type"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>y("checking"),className:`px-4 py-2 rounded-md border-2 transition-colors ${m==="checking"?"border-primary bg-primary text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:"Checking/Savings"}),c.jsx("button",{onClick:()=>y("credit"),className:`px-4 py-2 rounded-md border-2 transition-colors ${m==="credit"?"border-primary bg-primary text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"}`,children:"Credit Card"})]})]}),!e.length&&!o&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload PDF Statement or Paste Text"}),c.jsx("input",{ref:_,type:"file",accept:".pdf",onChange:R,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-medium
                    file:bg-primary file:text-white
                    hover:file:bg-primary/90
                    cursor-pointer mb-4`}),g&&c.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-sm text-gray-700",children:[" ",g]}),c.jsx("button",{onClick:L,disabled:w,className:"px-3 py-1 bg-primary text-white rounded text-sm hover:bg-primary/90 disabled:opacity-50",children:w?"Extracting...":"Extract Text"})]}),c.jsx("p",{className:"text-xs text-gray-600 mt-2",children:'Click "Extract Text" to automatically parse transactions from the PDF.'})]}),c.jsx("div",{className:"text-center text-sm text-gray-500 my-3",children:"- OR -"}),c.jsx("textarea",{value:f,onChange:H=>p(H.target.value),placeholder:`Paste your statement text here...

Example format:
01/15/2024  GROCERY STORE  $45.67
01/16/2024  GAS STATION    $32.50
01/17/2024  RESTAURANT     $78.90`,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm font-mono h-48 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),f.trim()&&c.jsx("button",{onClick:()=>z(f),className:"mt-2 px-4 py-2 bg-primary text-white rounded-md text-sm hover:bg-primary/90",children:"Parse Text"})]}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[c.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:" Tips for Best Results"}),c.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[c.jsx("li",{children:" Copy transaction lines from your PDF statement"}),c.jsx("li",{children:" Each line should contain: Date, Description, and Amount"}),c.jsx("li",{children:" Supported date formats: MM/DD/YYYY, YYYY-MM-DD"}),c.jsx("li",{children:" Amounts should include decimals (e.g., $45.67)"}),c.jsx("li",{children:" Remove any header/footer text that isn't transaction data"})]})]})]}),e.length>0&&!o&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Import to Account *"}),c.jsxs("select",{value:r,onChange:H=>i(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"Select account..."}),j.map(H=>c.jsx("option",{value:H.id,children:H.name},H.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Category (Optional)"}),c.jsxs("select",{value:s,onChange:H=>a(H.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[c.jsx("option",{value:"",children:"None (categorize later)"}),P.map(H=>c.jsx("option",{value:H.id,children:H.path||H.name},H.id))]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Parsed Transactions (",e.filter(H=>H.selected).length," selected)"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>n(H=>H.map(Q=>({...Q,selected:!0}))),className:"text-sm text-primary hover:underline",children:"Select All"}),c.jsx("span",{className:"text-gray-300",children:"|"}),c.jsx("button",{onClick:()=>n(H=>H.map(Q=>({...Q,selected:!1}))),className:"text-sm text-primary hover:underline",children:"Deselect All"}),c.jsx("span",{className:"text-gray-300",children:"|"}),c.jsx("button",{onClick:()=>n([]),className:"text-sm text-red-600 hover:underline",children:"Clear & Start Over"})]})]}),c.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden max-h-96 overflow-y-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50 sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"w-10 px-4 py-2"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Date"}),c.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Description"}),c.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500",children:"Amount"}),c.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500",children:"Type"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((H,Q)=>c.jsxs("tr",{className:`${H.selected?"":"opacity-40"} hover:bg-gray-50 cursor-pointer`,onClick:()=>U(Q),children:[c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{type:"checkbox",checked:H.selected,onChange:()=>U(Q),className:"rounded border-gray-300 text-primary focus:ring-primary",onClick:B=>B.stopPropagation()})}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 whitespace-nowrap",children:H.date}),c.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:H.description}),c.jsxs("td",{className:`px-4 py-2 text-sm text-right whitespace-nowrap font-medium ${H.type==="debit"?"text-red-600":"text-green-600"}`,children:["$",H.amount.toFixed(2)]}),c.jsx("td",{className:"px-4 py-2 text-sm text-center",children:c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${H.type==="debit"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:H.type==="debit"?"Expense":"Income"})})]},Q))})]})})]})]}),o&&c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:"Importing Transactions..."}),c.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[u.current," of ",u.total]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 max-w-md mx-auto",children:c.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${u.current/u.total*100}%`}})})]})]}),c.jsxs("div",{className:"p-6 border-t border-gray-200 flex justify-end gap-2",children:[c.jsx("button",{onClick:t,disabled:o,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.length>0&&c.jsxs("button",{onClick:K,disabled:o||!r,className:"px-4 py-2 bg-primary text-white rounded-md text-sm font-medium hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed",children:["Import ",e.filter(H=>H.selected).length," Transactions"]})]})]}),b&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"No Transactions Found"}),c.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[c.jsx("p",{children:"The PDF couldn't be parsed automatically. This can happen if the PDF is scanned/image-based or has an unusual format."}),c.jsx("p",{className:"font-medium",children:"Please copy the transactions from your PDF and paste them in the text area below."}),c.jsx("p",{className:"text-xs text-gray-600",children:"Tip: Open your PDF, select and copy the transaction lines, then paste them into the text box."})]}),c.jsx("button",{onClick:()=>x(!1),className:"mt-6 w-full px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 font-medium",children:"OK"})]})})]})}const TF="fire-app-dismissed-smart-features";function Nke({transactions:t,payees:e,categories:n}){const[r,i]=T.useState(()=>{try{const p=localStorage.getItem(TF);return p?new Set(JSON.parse(p)):new Set}catch{return new Set}});T.useEffect(()=>{try{localStorage.setItem(TF,JSON.stringify([...r]))}catch{}},[r]);const s=p=>{i(m=>new Set([...m,p]))},a=p=>{if(p.path){const m=p.path.split(">");return m[m.length-1]}return p.name},o=T.useMemo(()=>new Map(e.map(p=>[p.id,p.name])),[e]),l=T.useMemo(()=>new Map(n.map(p=>[p.id,a(p)])),[n]),u=T.useMemo(()=>{const p=[],y=[...t.filter(g=>!g.transfer_id)].sort((g,v)=>v.date.localeCompare(g.date));for(let g=0;g<y.length-1;g++){const v=y[g],b=y[g+1];if(Math.abs(v.amount)===Math.abs(b.amount)&&v.payee_id===b.payee_id&&v.payee_id!==null){const x=new Date(v.date),w=new Date(b.date);if(Math.abs(x.getTime()-w.getTime())/(1e3*60*60)<=24){const _=p.find(A=>A.transactions.some(j=>j.id===v.id||j.id===b.id));_?_.transactions.find(A=>A.id===b.id)||_.transactions.push(b):p.push({transactions:[v,b],amount:v.amount,date:v.date,payeeId:v.payee_id})}}}return p},[t]),d=T.useMemo(()=>{const p=new Map;t.forEach(y=>{if(y.payee_id&&!y.transfer_id){const g=p.get(y.payee_id)||[];g.push(y),p.set(y.payee_id,g)}});const m=[];return p.forEach((y,g)=>{if(y.length<3)return;const v=[...y].sort((j,N)=>j.date.localeCompare(N.date)),b=[];for(let j=1;j<v.length;j++){const N=Math.abs(new Date(v[j].date).getTime()-new Date(v[j-1].date).getTime())/864e5;b.push(N)}const x=b.filter(j=>j>=5&&j<=9).length,w=b.filter(j=>j>=28&&j<=32).length,S=b.filter(j=>j>=360&&j<=370).length;let _=null,A=0;if(x>=2?(_="weekly",A=x):w>=2?(_="monthly",A=w):S>=1&&(_="yearly",A=S),_){const j=v.map(I=>Math.abs(I.amount)),N=j.reduce((I,L)=>I+L,0)/j.length,P=v.map(I=>I.category_id).filter(I=>I),O=new Map;P.forEach(I=>{I&&O.set(I,(O.get(I)||0)+1)});const M=Array.from(O.entries()).sort((I,L)=>L[1]-I[1])[0],R=A/b.length;m.push({payeeId:g,payeeName:o.get(g)||"Unknown",amount:N,categoryId:(M==null?void 0:M[0])||null,categoryName:M!=null&&M[0]&&l.get(M[0])||"Uncategorized",frequency:_,count:A+1,confidence:R})}}),m.sort((y,g)=>g.confidence-y.confidence).slice(0,10)},[t,o,l]),f=T.useMemo(()=>{const p=new Map;t.forEach(y=>{if(y.payee_id&&y.category_id&&!y.transfer_id){p.has(y.payee_id)||p.set(y.payee_id,new Map);const g=p.get(y.payee_id);g.set(y.category_id,(g.get(y.category_id)||0)+1)}});const m=[];return p.forEach((y,g)=>{const v=Array.from(y.values()).reduce((_,A)=>_+A,0),b=Array.from(y.entries()),[x,w]=b.sort((_,A)=>A[1]-_[1])[0],S=w/v;S>=.7&&w>=3&&m.push({payeeId:g,payeeName:o.get(g)||"Unknown",categoryId:x,categoryName:l.get(x)||"Uncategorized",confidence:S,transactionCount:w})}),m.sort((y,g)=>g.confidence-y.confidence).slice(0,10)},[t,o,l]);return c.jsxs("div",{className:"space-y-6",children:[u.length>0&&!r.has("duplicates")&&c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"text-2xl",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-yellow-900",children:"Possible Duplicate Transactions"}),c.jsx("button",{onClick:()=>s("duplicates"),className:"text-yellow-600 hover:text-yellow-800 transition-colors",title:"Dismiss",children:c.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("p",{className:"text-sm text-yellow-700 mb-4",children:["Found ",u.length," group",u.length!==1?"s":""," of transactions that might be duplicates"]}),c.jsx("div",{className:"space-y-3",children:u.slice(0,5).map((p,m)=>c.jsxs("div",{className:"bg-white rounded-md p-3 border border-yellow-300",children:[c.jsxs("div",{className:"text-sm font-medium text-gray-900 mb-1",children:[o.get(p.payeeId||"")||"Unknown"," - ",ie(p.amount)]}),c.jsxs("div",{className:"text-xs text-gray-600",children:[p.transactions.length," transactions on ",wa(p.date)]})]},m))})]})]})}),d.length>0&&!r.has("recurring")&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"text-2xl",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Recurring Transaction Patterns"}),c.jsx("button",{onClick:()=>s("recurring"),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Dismiss",children:c.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("p",{className:"text-sm text-blue-700 mb-4",children:["Detected ",d.length," recurring pattern",d.length!==1?"s":""]}),c.jsx("div",{className:"space-y-3",children:d.map((p,m)=>c.jsx("div",{className:"bg-white rounded-md p-3 border border-blue-300",children:c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.payeeName}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[ie(p.amount),"  ",p.frequency,"  ",p.categoryName]}),c.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[p.count," occurrences  ",(p.confidence*100).toFixed(0),"% confidence"]})]})})},m))})]})]})}),f.length>0&&!r.has("autocategorize")&&c.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"text-2xl",children:""}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-start justify-between mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Auto-Categorization Rules"}),c.jsx("button",{onClick:()=>s("autocategorize"),className:"text-green-600 hover:text-green-800 transition-colors",title:"Dismiss",children:c.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsx("p",{className:"text-sm text-green-700 mb-4",children:"Based on your transaction history, these payees consistently use specific categories"}),c.jsx("div",{className:"space-y-3",children:f.map((p,m)=>c.jsx("div",{className:"bg-white rounded-md p-3 border border-green-300",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[p.payeeName,"  ",p.categoryName]}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[p.transactionCount," transactions  ",(p.confidence*100).toFixed(0),"% consistency"]})]}),c.jsx("button",{className:"px-3 py-1 text-xs bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:()=>alert("Auto-categorization rule creation coming soon!"),children:"Create Rule"})]})},m))})]})]})}),u.length===0&&d.length===0&&f.length===0&&c.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[c.jsx("div",{className:"text-4xl mb-3",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Insights Available Yet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Add more transactions to see smart suggestions and patterns"})]})]})}function Eke(){const[t,e]=T.useState("all"),[n,r]=T.useState("month"),[i,s]=T.useState(""),[a,o]=T.useState(""),[l,u]=T.useState(""),[d,f]=T.useState("date"),[p,m]=T.useState("desc"),[y,g]=T.useState(null),[v,b]=T.useState(new Set),[x,w]=T.useState(!1),[S,_]=T.useState(!1),[A,j]=T.useState(!1),{data:N=[],isLoading:P,error:O}=lo(500),{data:M=[]}=ar(),{data:R=[]}=Rl(),{data:I=[]}=Ms(),L=J8(),W=oz(),F=Q8(),z=X=>{if(X.path){const se=X.path.split(">");return se[se.length-1]}return X.name},U=T.useMemo(()=>new Map(M.map(X=>[X.id,X.name])),[M]),K=T.useMemo(()=>new Map(R.map(X=>[X.id,X.name])),[R]),H=T.useMemo(()=>new Map(I.map(X=>[X.id,z(X)])),[I]),Q=T.useMemo(()=>Array.from(new Set(N.filter(X=>X.transfer_id).map(X=>X.transfer_id))).filter(Boolean),[N]),{data:B=[]}=Bt({queryKey:["linked-transactions",Q.join(",")],queryFn:async()=>{if(Q.length===0)return[];const X=await He(),{data:se,error:ce}=await he.from("transactions").select("id, account_id, account:accounts(name)").in("id",Q).eq("created_by",X);if(ce)throw ce;return se||[]},staleTime:1e3*60*5}),Y=T.useMemo(()=>{const X=new Map;return N.forEach(se=>{if(se.transfer_id){const ce=N.find(ue=>ue.id===se.transfer_id);if(ce){const ue=U.get(ce.account_id);ue&&X.set(se.id,ue)}}}),B.forEach(se=>{N.filter(ue=>ue.transfer_id===se.id).forEach(ue=>{var Be;const je=((Be=se.account)==null?void 0:Be.name)||U.get(se.account_id)||"Unknown Account";X.set(ue.id,je)})}),X},[N,B,U]),ne=X=>{const se=new Date,ce=new Date(se.getFullYear(),se.getMonth(),se.getDate());switch(X){case"today":return{start:ce,end:new Date(ce.getTime()+24*60*60*1e3)};case"week":const ue=new Date(ce);return ue.setDate(ce.getDate()-7),{start:ue,end:ce};case"month":return{start:new Date(ce.getFullYear(),ce.getMonth(),1),end:ce};case"year":return{start:new Date(ce.getFullYear(),0,1),end:ce};case"custom":if(i&&a){const mt=new Date(a);return mt.setHours(23,59,59,999),{start:new Date(i),end:mt}}return null;default:return null}},V=T.useMemo(()=>{let X=[...N];t!=="all"&&(X=X.filter(ce=>ce.account_id===t));const se=ne(n);if(se&&(X=X.filter(ce=>{const ue=new Date(ce.date);return ue>=se.start&&ue<=se.end})),l){const ce=l.toLowerCase();X=X.filter(ue=>{var Hr,fi;const je=ue.payee_id?(Hr=K.get(ue.payee_id))==null?void 0:Hr.toLowerCase():"",Be=((fi=ue.notes)==null?void 0:fi.toLowerCase())||"",mt=Math.abs(ue.amount).toString();return(je==null?void 0:je.includes(ce))||Be.includes(ce)||mt.includes(ce)})}return X.sort((ce,ue)=>{let je,Be;switch(d){case"date":je=new Date(ce.date).getTime(),Be=new Date(ue.date).getTime();break;case"amount":je=Math.abs(ce.amount),Be=Math.abs(ue.amount);break;case"payee":je=K.get(ce.payee_id||"")||"",Be=K.get(ue.payee_id||"")||"";break;case"category":je=H.get(ce.category_id||"")||"",Be=H.get(ue.category_id||"")||"";break;default:return 0}return je<Be?p==="asc"?-1:1:je>Be?p==="asc"?1:-1:0}),X},[N,t,n,l,d,p,K,H,i,a]),te=T.useMemo(()=>{const X=V.filter(ce=>ce.amount>0).reduce((ce,ue)=>ce+ue.amount,0),se=V.filter(ce=>ce.amount<0).reduce((ce,ue)=>ce+Math.abs(ue.amount),0);return{count:V.length,income:X,expenses:se,net:X-se,average:V.length>0?V.reduce((ce,ue)=>ce+Math.abs(ue.amount),0)/V.length:0}},[V]),$=X=>{d===X?m(p==="asc"?"desc":"asc"):(f(X),m("desc"))},q=()=>{v.size===V.length?b(new Set):b(new Set(V.map(X=>X.id)))},G=X=>{const se=new Set(v);se.has(X)?se.delete(X):se.add(X),b(se)},re=async()=>{if(confirm(`Delete ${v.size} transaction${v.size!==1?"s":""}?`))try{const X=new Set;for(const se of v){if(X.has(se))continue;const ce=N.find(ue=>ue.id===se);ce!=null&&ce.transfer_id?(await W.mutateAsync(se),X.add(se),X.add(ce.transfer_id)):await L.mutateAsync(se)}b(new Set)}catch{alert("Failed to delete some transactions")}},Z=async X=>{if(X)try{for(const se of v)await F.mutateAsync({id:se,updates:{category_id:X}});b(new Set)}catch{alert("Failed to update some transactions")}},J=()=>{const X=["Date","Account","Payee","Category","Amount","Notes"],se=V.map(mt=>[mt.date,U.get(mt.account_id)||"",mt.payee_id&&K.get(mt.payee_id)||"",mt.category_id&&H.get(mt.category_id)||"",mt.amount.toString(),mt.notes||""]),ce=[X,...se].map(mt=>mt.map(Hr=>`"${Hr}"`).join(",")).join(`
`),ue=new Blob([ce],{type:"text/csv"}),je=URL.createObjectURL(ue),Be=document.createElement("a");Be.href=je,Be.download=`transactions-${new Date().toISOString().split("T")[0]}.csv`,Be.click(),URL.revokeObjectURL(je)};return P?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"}),c.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading transactions..."})]})}):O?c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:c.jsx("p",{className:"text-sm text-red-800",children:"Failed to load transactions. Please try again."})}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Transactions"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[te.count," ",te.count===1?"transaction":"transactions"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>w(!x),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:[" ",x?"Hide":"Show"," Analytics"]}),c.jsx("button",{onClick:()=>_(!0),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:" Import CSV"}),c.jsx("button",{onClick:()=>j(!0),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:" Import PDF"}),c.jsx("button",{onClick:J,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:" Export CSV"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Income"}),c.jsx("div",{className:"text-2xl font-bold text-green-600",children:ie(te.income)})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Expenses"}),c.jsx("div",{className:"text-2xl font-bold text-red-600",children:ie(te.expenses)})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Net"}),c.jsx("div",{className:`text-2xl font-bold ${te.net>=0?"text-green-600":"text-red-600"}`,children:ie(te.net)})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Average"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:ie(te.average)})]})]}),x&&c.jsx(NAe,{transactions:V,categories:I,payees:R}),c.jsx(Nke,{transactions:N,categories:I,payees:R}),c.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c.jsx("input",{type:"text",placeholder:"Search transactions...",value:l,onChange:X=>u(X.target.value),className:"flex-1 min-w-[200px] px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),c.jsxs("select",{value:n,onChange:X=>{r(X.target.value),X.target.value!=="custom"&&(s(""),o(""))},className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Time"}),c.jsx("option",{value:"today",children:"Today"}),c.jsx("option",{value:"week",children:"Last 7 Days"}),c.jsx("option",{value:"month",children:"This Month"}),c.jsx("option",{value:"year",children:"This Year"}),c.jsx("option",{value:"custom",children:"Custom Range"})]}),n==="custom"&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"date",value:i,onChange:X=>s(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),c.jsx("span",{className:"text-gray-500 text-sm",children:"to"}),c.jsx("input",{type:"date",value:a,onChange:X=>o(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),c.jsxs("select",{value:t,onChange:X=>e(X.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Accounts"}),M.map(X=>c.jsx("option",{value:X.id,children:X.name},X.id))]})]})}),v.size>0&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"text-sm font-medium text-blue-900",children:[v.size," transaction",v.size!==1?"s":""," selected"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("select",{onChange:X=>Z(X.target.value),className:"px-3 py-1.5 text-sm border border-blue-300 rounded-md bg-white",children:[c.jsx("option",{value:"",children:"Change Category..."}),I.filter(X=>X.is_budgetable).map(X=>c.jsx("option",{value:X.id,children:X.path||X.name},X.id))]}),c.jsx("button",{onClick:re,className:"px-3 py-1.5 text-sm bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Delete Selected"}),c.jsx("button",{onClick:()=>b(new Set),className:"px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})}),V.length===0?c.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[c.jsx("p",{className:"text-gray-600",children:"No transactions found."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l||t!=="all"||n!=="all"?"Try adjusting your filters.":c.jsxs(c.Fragment,{children:["Press ",c.jsx("kbd",{className:"px-2 py-1 bg-white border border-gray-300 rounded text-xs",children:"N"})," to add your first transaction!"]})})]}):c.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"py-3 px-4",children:c.jsx("input",{type:"checkbox",checked:v.size===V.length&&V.length>0,onChange:q,className:"rounded border-gray-300 text-primary focus:ring-primary"})}),c.jsxs("th",{onClick:()=>$("date"),className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Date ",d==="date"&&(p==="asc"?"":"")]}),c.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),c.jsxs("th",{onClick:()=>$("payee"),className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Payee ",d==="payee"&&(p==="asc"?"":"")]}),c.jsxs("th",{onClick:()=>$("category"),className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Category ",d==="category"&&(p==="asc"?"":"")]}),c.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"}),c.jsxs("th",{onClick:()=>$("amount"),className:"py-3 px-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",children:["Amount ",d==="amount"&&(p==="asc"?"":"")]})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:V.map(X=>c.jsx(kAe,{transaction:X,accountName:U.get(X.account_id),payeeName:X.payee_id?K.get(X.payee_id):void 0,categoryName:X.category_id?H.get(X.category_id):void 0,transferAccountName:Y.get(X.id),isSelected:v.has(X.id),onSelect:()=>G(X.id),onClick:()=>g(X)},X.id))})]})})}),y&&c.jsx(qC,{transaction:y,isOpen:!!y,onClose:()=>g(null)}),S&&c.jsx(EAe,{onClose:()=>_(!1)}),A&&c.jsx(kke,{onClose:()=>j(!1)})]})}function Cke(){return Bt({queryKey:["bills"],queryFn:async()=>{const t=await He(),{data:e,error:n}=await he.from("bills").select(`
          *,
          account:accounts(id, name),
          category:categories(id, name),
          payee:payees(id, name)
        `).eq("created_by",t).order("next_due",{ascending:!0});if(n)throw n;return e}})}function Pke(){const t=Xe();return et({mutationFn:async e=>(await ks("bills",e))[0],onSuccess:()=>{t.invalidateQueries({queryKey:["bills"]})}})}function Tke(){const t=Xe();return et({mutationFn:async({id:e,updates:n})=>{const{data:r,error:i}=await he.from("bills").update(n).eq("id",e).select().single();if(i)throw i;return r},onSuccess:()=>{t.invalidateQueries({queryKey:["bills"]})}})}function Oke(){const t=Xe();return et({mutationFn:async e=>{const{error:n}=await he.from("bills").delete().eq("id",e);if(n)throw n},onSuccess:()=>{t.invalidateQueries({queryKey:["bills"]})}})}function Mke(){const t=Xe();return et({mutationFn:async({id:e,status:n})=>{const{data:r,error:i}=await he.from("bills").update({status:n}).eq("id",e).select().single();if(i)throw i;return r},onSuccess:()=>{t.invalidateQueries({queryKey:["bills"]})}})}function Rke(){const t=Xe();return et({mutationFn:async({billId:e,amount:n,date:r,accountId:i,categoryId:s,payeeId:a})=>{const o=await ks("transactions",{date:r,account_id:i,amount:-Math.abs(n),payee_id:a,category_id:s,notes:"Bill payment",is_pending:!1}),l=new Date(r);return l.setMonth(l.getMonth()+1),await he.from("bills").update({next_due:l.toISOString().split("T")[0]}).eq("id",e),o[0]},onSuccess:()=>{t.invalidateQueries({queryKey:["bills"]}),t.invalidateQueries({queryKey:["transactions"]})}})}function Ike({onClose:t}){const[e,n]=T.useState(""),[r,i]=T.useState(""),[s,a]=T.useState(""),[o,l]=T.useState(""),[u,d]=T.useState(""),[f,p]=T.useState(""),[m,y]=T.useState("MONTHLY"),[g,v]=T.useState(""),{data:b}=ar(),{data:x}=Ms(),{data:w}=Rl(),S=Pke(),_=async A=>{if(A.preventDefault(),!e.trim()){alert("Please enter a bill name");return}if(!r||parseFloat(r)<=0){alert("Please enter a valid amount");return}if(!s){alert("Please select an account");return}if(!o){alert("Please select a category");return}if(!f){alert("Please enter the next due date");return}try{const j=`FREQ=${m}`;await S.mutateAsync({name:e.trim(),amount:parseFloat(r),account_id:s,category_id:o,payee_id:u||null,rrule:j,next_due:f,status:"active",notes:g.trim()||null}),Me.info("Bill created",{billName:e}),t()}catch(j){Me.error("Failed to create bill",{error:j}),alert("Failed to create bill. Please try again.")}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Bill"}),c.jsxs("form",{onSubmit:_,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Name *"}),c.jsx("input",{type:"text",id:"name",value:e,onChange:A=>n(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Rent, Electric Bill"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),c.jsx("input",{type:"number",id:"amount",value:r,onChange:A=>i(A.target.value),step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 mb-1",children:"Pay From Account *"}),c.jsxs("select",{id:"account",value:s,onChange:A=>a(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select an account"}),b==null?void 0:b.map(A=>c.jsx("option",{value:A.id,children:A.name},A.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),c.jsxs("select",{id:"category",value:o,onChange:A=>l(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a category"}),x==null?void 0:x.map(A=>c.jsx("option",{value:A.id,children:A.name},A.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"payee",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payee (Optional)"}),c.jsxs("select",{id:"payee",value:u,onChange:A=>d(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a payee"}),w==null?void 0:w.map(A=>c.jsx("option",{value:A.id,children:A.name},A.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"frequency",className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency *"}),c.jsxs("select",{id:"frequency",value:m,onChange:A=>y(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"WEEKLY",children:"Weekly"}),c.jsx("option",{value:"MONTHLY",children:"Monthly"}),c.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),c.jsx("option",{value:"YEARLY",children:"Yearly"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"nextDue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Due Date *"}),c.jsx("input",{type:"date",id:"nextDue",value:f,onChange:A=>p(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),c.jsx("textarea",{id:"notes",value:g,onChange:A=>v(A.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add any additional details..."})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:S.isPending,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:S.isPending?"Adding...":"Add Bill"})]})]})]})})})}function Dke({bill:t,onClose:e}){const[n,r]=T.useState(t.name),[i,s]=T.useState(t.amount.toString()),[a,o]=T.useState(t.account_id),[l,u]=T.useState(t.category_id),[d,f]=T.useState(t.payee_id||""),[p,m]=T.useState(t.next_due||""),[y,g]=T.useState(()=>t.rrule.includes("FREQ=WEEKLY")?"WEEKLY":t.rrule.includes("FREQ=QUARTERLY")?"QUARTERLY":t.rrule.includes("FREQ=YEARLY")?"YEARLY":"MONTHLY"),[v,b]=T.useState(t.notes||""),{data:x}=ar(),{data:w}=Ms(),{data:S}=Rl(),_=Tke(),A=async j=>{if(j.preventDefault(),!n.trim()){alert("Please enter a bill name");return}if(!i||parseFloat(i)<=0){alert("Please enter a valid amount");return}if(!a){alert("Please select an account");return}if(!l){alert("Please select a category");return}if(!p){alert("Please enter the next due date");return}try{const N=`FREQ=${y}`;await _.mutateAsync({id:t.id,updates:{name:n.trim(),amount:parseFloat(i),account_id:a,category_id:l,payee_id:d||null,rrule:N,next_due:p,notes:v.trim()||null}}),Me.info("Bill updated",{billId:t.id,billName:n}),e()}catch(N){Me.error("Failed to update bill",{error:N}),alert("Failed to update bill. Please try again.")}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Bill"}),c.jsxs("form",{onSubmit:A,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Name *"}),c.jsx("input",{type:"text",id:"name",value:n,onChange:j=>r(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),c.jsx("input",{type:"number",id:"amount",value:i,onChange:j=>s(j.target.value),step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-gray-700 mb-1",children:"Pay From Account *"}),c.jsxs("select",{id:"account",value:a,onChange:j=>o(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select an account"}),x==null?void 0:x.map(j=>c.jsx("option",{value:j.id,children:j.name},j.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),c.jsxs("select",{id:"category",value:l,onChange:j=>u(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a category"}),w==null?void 0:w.map(j=>c.jsx("option",{value:j.id,children:j.name},j.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"payee",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payee (Optional)"}),c.jsxs("select",{id:"payee",value:d,onChange:j=>f(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select a payee"}),S==null?void 0:S.map(j=>c.jsx("option",{value:j.id,children:j.name},j.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"frequency",className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency *"}),c.jsxs("select",{id:"frequency",value:y,onChange:j=>g(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"WEEKLY",children:"Weekly"}),c.jsx("option",{value:"MONTHLY",children:"Monthly"}),c.jsx("option",{value:"QUARTERLY",children:"Quarterly"}),c.jsx("option",{value:"YEARLY",children:"Yearly"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"nextDue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Next Due Date *"}),c.jsx("input",{type:"date",id:"nextDue",value:p,onChange:j=>m(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),c.jsx("textarea",{id:"notes",value:v,onChange:j=>b(j.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:_.isPending,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:_.isPending?"Saving...":"Save Changes"})]})]})]})})})}function $ke({bill:t,onClose:e}){const[n,r]=T.useState(t.amount.toString()),[i,s]=T.useState(()=>new Date().toISOString().split("T")[0]),a=Rke(),o=async l=>{l.preventDefault();const u=parseFloat(n);if(!u||u<=0){alert("Please enter a valid amount");return}if(!i){alert("Please enter a payment date");return}try{await a.mutateAsync({billId:t.id,amount:u,date:i,accountId:t.account_id,categoryId:t.category_id,payeeId:t.payee_id}),Me.info("Bill paid",{billId:t.id,billName:t.name,amount:u,date:i}),e()}catch(d){Me.error("Failed to pay bill",{error:d}),alert("Failed to record payment. Please try again.")}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Pay Bill"}),c.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-md",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Bill"}),c.jsx("div",{className:"font-semibold text-gray-900",children:t.name}),t.payee&&c.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Payee: ",t.payee.name]}),t.account&&c.jsxs("div",{className:"text-sm text-gray-600",children:["From: ",t.account.name]}),t.category&&c.jsxs("div",{className:"text-sm text-gray-600",children:["Category: ",t.category.name]})]}),c.jsxs("form",{onSubmit:o,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),c.jsx("input",{type:"number",id:"amount",value:n,onChange:l=>r(l.target.value),step:"0.01",min:"0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Default: $",t.amount.toFixed(2)]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),c.jsx("input",{type:"date",id:"date",value:i,onChange:l=>s(l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 border border-blue-200 rounded-md p-3",children:[c.jsx("strong",{children:"Note:"})," This will create a transaction and update the next due date."]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:a.isPending,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:a.isPending?"Processing...":"Mark as Paid"})]})]})]})})})}function Lke(){const{data:t,isLoading:e,error:n}=Cke(),r=Mke(),i=Oke(),[s,a]=T.useState(!1),[o,l]=T.useState(null),[u,d]=T.useState(null);if(e)return c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"text-gray-500",children:"Loading bills..."})});if(n)return Me.error("Failed to load bills",{error:n}),c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"text-red-500",children:"Failed to load bills. Please try again."})});const f=(t==null?void 0:t.filter(S=>S.status==="active"))||[],p=(t==null?void 0:t.filter(S=>S.status==="paused"))||[],m=async S=>{try{const _=S.status==="active"?"paused":"active";await r.mutateAsync({id:S.id,status:_}),Me.info(`Bill ${_}`,{billId:S.id,billName:S.name})}catch(_){Me.error("Failed to toggle bill status",{error:_})}},y=async S=>{if(confirm(`Are you sure you want to delete "${S.name}"?`))try{await i.mutateAsync(S.id),Me.info("Bill deleted",{billId:S.id,billName:S.name})}catch(_){Me.error("Failed to delete bill",{error:_})}},g=S=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(S),v=S=>S?new Date(S).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Not scheduled",b=S=>{if(!S)return null;const _=new Date,j=new Date(S).getTime()-_.getTime();return Math.ceil(j/(1e3*60*60*24))},x=S=>S===null?"text-gray-500":S<0?"text-red-600":S<=3?"text-orange-600":S<=7?"text-yellow-600":"text-gray-600",w=S=>{const _=b(S.next_due),A=x(_);return c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:S.name}),c.jsxs("div",{className:"mt-1 space-y-1 text-sm text-gray-600",children:[S.payee&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-gray-400",children:"To:"}),c.jsx("span",{children:S.payee.name})]}),S.category&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-gray-400",children:"Category:"}),c.jsx("span",{children:S.category.name})]}),S.account&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-gray-400",children:"From:"}),c.jsx("span",{children:S.account.name})]})]})]}),c.jsxs("div",{className:"text-right ml-4",children:[c.jsx("div",{className:"text-lg font-bold text-gray-900",children:g(S.amount)}),c.jsx("div",{className:`text-sm ${A}`,children:S.next_due?c.jsxs(c.Fragment,{children:[v(S.next_due),_!==null&&_>=0&&c.jsxs("div",{className:"text-xs",children:["in ",_," days"]}),_!==null&&_<0&&c.jsx("div",{className:"text-xs font-semibold",children:"OVERDUE"})]}):"Not scheduled"})]})]}),S.notes&&c.jsx("div",{className:"mt-2 text-sm text-gray-500 italic",children:S.notes}),c.jsxs("div",{className:"mt-4 flex gap-2",children:[c.jsx("button",{onClick:()=>d(S),className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Pay Now"}),c.jsx("button",{onClick:()=>l(S),className:"px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:"Edit"}),c.jsx("button",{onClick:()=>m(S),className:"px-3 py-1.5 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors",children:S.status==="active"?"Pause":"Resume"}),c.jsx("button",{onClick:()=>y(S),className:"px-3 py-1.5 text-sm bg-red-50 text-red-600 rounded-md hover:bg-red-100 transition-colors",children:"Delete"})]})]},S.id)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Bills"}),c.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"+ Add Bill"})]}),(t==null?void 0:t.length)===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-gray-400 text-lg mb-4",children:"No bills yet"}),c.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Add Your First Bill"})]}),f.length>0&&c.jsxs("div",{children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:["Active Bills (",f.length,")"]}),c.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:f.map(w)})]}),p.length>0&&c.jsxs("div",{children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-500 mb-3",children:["Paused Bills (",p.length,")"]}),c.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 opacity-60",children:p.map(w)})]}),s&&c.jsx(Ike,{onClose:()=>a(!1)}),o&&c.jsx(Dke,{bill:o,onClose:()=>l(null)}),u&&c.jsx($ke,{bill:u,onClose:()=>d(null)})]})}async function Fke(){Me.debug("Fetching scenarios");const{data:t,error:e}=await he.from("scenarios").select("*").order("name",{ascending:!0});if(e)throw Me.error("Error fetching scenarios",e),e;return Me.debug(`Fetched ${(t==null?void 0:t.length)||0} scenarios`),(t||[]).map(Y8)}function Bke(){return Bt({queryKey:["scenarios","v2"],queryFn:Fke})}async function Uke(t){Me.debug("Creating new scenario",{name:t.name});const{data:{user:e}}=await he.auth.getUser();if(!e)throw new Error("User not authenticated");const n={...t,created_by:e.id},{data:r,error:i}=await he.from("scenarios").insert(n).select().single();if(i)throw Me.error("Error creating scenario",i),i;return Me.info("Scenario created successfully",{id:r.id,name:r.name}),r}async function zke(t,e){Me.debug("Updating scenario",{id:t});const{data:n,error:r}=await he.from("scenarios").update(e).eq("id",t).select().single();if(r)throw Me.error("Error updating scenario",r,{id:t}),r;return Me.info("Scenario updated successfully",{id:t,name:n.name}),n}async function Wke(t){Me.debug("Deleting scenario",{id:t});const{error:e}=await he.from("scenarios").delete().eq("id",t);if(e)throw Me.error("Error deleting scenario",e,{id:t}),e;Me.info("Scenario deleted successfully",{id:t})}function Aj(){const t=Xe(),e=et({mutationFn:Uke,onSuccess:()=>{t.invalidateQueries({queryKey:["scenarios"]})}}),n=et({mutationFn:({id:i,updates:s})=>zke(i,s),onSuccess:i=>{t.invalidateQueries({queryKey:["scenarios"]}),t.invalidateQueries({queryKey:["scenarios",i.id]}),t.invalidateQueries({queryKey:["selectedScenario"]}),t.invalidateQueries({queryKey:["dashboardMetrics"]})}}),r=et({mutationFn:Wke,onSuccess:()=>{t.invalidateQueries({queryKey:["scenarios"]})}});return{createScenario:e.mutateAsync,updateScenario:(i,s)=>n.mutateAsync({id:i,updates:s}),deleteScenario:r.mutateAsync,isCreating:e.isPending,isUpdating:n.isPending,isDeleting:r.isPending}}function Hke({isOpen:t,onClose:e}){const{createScenario:n,isCreating:r}=Aj(),[i,s]=T.useState({name:"",current_age:35,retirement_age:65,life_expectancy:95,current_savings:1e5,annual_contribution:2e4,annual_expenses:4e4,portfolio_stock_pct:.6,expected_return_mean:.05,expected_return_stdev:.12,inflation_rate:.02,withdrawal_strategy:"guardrails",notes:null}),a=async o=>{o.preventDefault();try{const l=K_e(i);await n(l),e()}catch(l){console.error("Failed to create scenario:",l)}};return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Create New Scenario"}),c.jsxs("form",{onSubmit:a,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name *"}),c.jsx("input",{type:"text",value:i.name,onChange:o=>s({...i,name:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Conservative Plan, Early Retirement",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Age"}),c.jsx("input",{type:"number",value:i.current_age,onChange:o=>s({...i,current_age:Number(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"18",max:"100",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retirement Age"}),c.jsx("input",{type:"number",value:i.retirement_age,onChange:o=>s({...i,retirement_age:Number(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"18",max:"100",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Life Expectancy"}),c.jsx("input",{type:"number",value:i.life_expectancy,onChange:o=>s({...i,life_expectancy:Number(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"18",max:"120",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Savings"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:i.current_savings,onChange:o=>s({...i,current_savings:Number(o.target.value)}),className:"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Contribution"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:i.annual_contribution,onChange:o=>s({...i,annual_contribution:Number(o.target.value)}),className:"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Expenses (in retirement)"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:i.annual_expenses,onChange:o=>s({...i,annual_expenses:Number(o.target.value)}),className:"w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Allocation (%)"}),c.jsx("input",{type:"number",value:(i.portfolio_stock_pct||.6)*100,onChange:o=>s({...i,portfolio_stock_pct:Number(o.target.value)/100}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"5",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Return (%)"}),c.jsx("input",{type:"number",value:(i.expected_return_mean||.05)*100,onChange:o=>s({...i,expected_return_mean:Number(o.target.value)/100}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"20",step:"0.1",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Std Dev (%)"}),c.jsx("input",{type:"number",value:(i.expected_return_stdev||.12)*100,onChange:o=>s({...i,expected_return_stdev:Number(o.target.value)/100}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"50",step:"0.1",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inflation Rate (%)"}),c.jsx("input",{type:"number",value:(i.inflation_rate||.02)*100,onChange:o=>s({...i,inflation_rate:Number(o.target.value)/100}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"10",step:"0.1",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Withdrawal Strategy"}),c.jsxs("select",{value:i.withdrawal_strategy,onChange:o=>s({...i,withdrawal_strategy:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[c.jsx("option",{value:"guardrails",children:"Guardrails (Recommended)"}),c.jsx("option",{value:"fixed",children:"Fixed Dollar Amount"}),c.jsx("option",{value:"percentage",children:"Percentage of Portfolio"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Guardrails adjusts spending based on portfolio performance (10% bands)"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),c.jsx("textarea",{value:i.notes||"",onChange:o=>s({...i,notes:o.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Add any notes about this scenario..."})]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",disabled:r,children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors disabled:bg-blue-400",disabled:r,children:r?"Creating...":"Create Scenario"})]})]})]})})}):null}function qke(t,e,n,r,i,s,a,o=.02){const l=new Date().getFullYear(),u=n-t,d=[];let f=r;for(let p=0;p<=u;p++){const m=t+p,y=l+p,g=m<e?"accumulation":"retirement";if(d.push({year:y,age:m,netWorth:f,phase:g,yearLabel:`${y}`}),p<u)if(g==="accumulation")f=(f+i)*(1+a);else{const v=m-e,b=s*Math.pow(1+o,v);f=(f-b)*(1+a),f=Math.max(0,f)}}return d}function Gke(t,e=20){const n=t.simulations.map(o=>o.finalPortfolio),r=Math.min(...n),s=(Math.max(...n)-r)/e,a=[];for(let o=0;o<e;o++){const l=r+o*s,u=l+s,f=n.filter(m=>m>=l&&m<u).length,p=f/n.length*100;a.push({binStart:l,binEnd:u,binLabel:Vke(l,u),count:f,percentage:p,isSuccess:u>0})}return a}function Kke(t){const e=t.simulations.map(r=>r.finalPortfolio).sort((r,i)=>r-i),n=r=>{const i=Math.floor(r/100*e.length);return e[i]||0};return{p10:n(10),p25:n(25),p50:n(50),p75:n(75),p90:n(90)}}function Vke(t,e){const n=r=>r===0?"$0":Math.abs(r)>=1e6?`$${(r/1e6).toFixed(1)}M`:Math.abs(r)>=1e3?`$${(r/1e3).toFixed(0)}k`:`$${r.toFixed(0)}`;return`${n(t)} - ${n(e)}`}function bP({scenario:t,height:e=400}){var o,l;const n=T.useMemo(()=>qke(t.current_age,t.retirement_age,t.life_expectancy,t.current_savings,t.annual_contribution,t.annual_expenses,t.expected_return_mean,t.inflation_rate),[t]),r=t.retirement_age-t.current_age,i=({active:u,payload:d})=>{if(!u||!d||d.length===0)return null;const f=d[0].payload;return c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-3",children:[c.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:[f.yearLabel," (Age ",f.age,")"]}),c.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:["Net Worth: ",s(f.netWorth)]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 capitalize",children:f.phase})]})},s=u=>u>=1e6?`$${(u/1e6).toFixed(2)}M`:u>=1e3?`$${(u/1e3).toFixed(0)}K`:`$${u.toFixed(0)}`,a=u=>u>=1e6?`$${(u/1e6).toFixed(1)}M`:u>=1e3?`$${(u/1e3).toFixed(0)}K`:`$${u}`;return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Net Worth Projection"}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Expected portfolio growth over time (",(t.expected_return_mean*100).toFixed(1),"% return, ",(t.inflation_rate*100).toFixed(1),"% inflation)"]})]}),c.jsx(_s,{width:"100%",height:e,children:c.jsxs(Zg,{data:n,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",className:"stroke-gray-300 dark:stroke-gray-600"}),c.jsx(ir,{dataKey:"year",label:{value:"Years from Now",position:"insideBottom",offset:-5},className:"text-gray-700 dark:text-gray-300"}),c.jsx(sr,{tickFormatter:a,label:{value:"Net Worth",angle:-90,position:"insideLeft"},className:"text-gray-700 dark:text-gray-300"}),c.jsx(on,{content:c.jsx(i,{})}),c.jsx(Fr,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),c.jsx(Ub,{x:r,stroke:"#ef4444",strokeDasharray:"5 5",label:{value:"Retirement",position:"top",fill:"#ef4444",fontSize:12}}),c.jsx(di,{type:"monotone",dataKey:"netWorth",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"Net Worth",connectNulls:!0})]})}),c.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Current"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s(t.current_savings)})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"At Retirement"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s(((o=n[r])==null?void 0:o.netWorth)||0)})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[c.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["At Age ",t.life_expectancy]}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s(((l=n[n.length-1])==null?void 0:l.netWorth)||0)})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Years to Retirement"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.retirement_age-t.current_age})]})]})]})}function Yke({result:t,height:e=400}){const n=T.useMemo(()=>Gke(t,25),[t]),r=T.useMemo(()=>Kke(t),[t]),i=({active:o,payload:l})=>{if(!o||!l||l.length===0)return null;const u=l[0].payload;return c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-3",children:[c.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:u.binLabel}),c.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:["Outcomes: ",u.count," (",u.percentage.toFixed(1),"%)"]}),c.jsx("p",{className:`text-xs mt-1 ${u.isSuccess?"text-green-600":"text-red-600"}`,children:u.isSuccess?" Success":" Failure"})]})},s=o=>o>=1e6?`$${(o/1e6).toFixed(1)}M`:o>=1e3?`$${(o/1e3).toFixed(0)}K`:o<0?`-$${Math.abs(o).toFixed(0)}`:`$${o.toFixed(0)}`,a=o=>o.isSuccess?"#10b981":"#ef4444";return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Monte Carlo Simulation Results"}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Distribution of ",t.simulations.length.toLocaleString()," possible outcomes at end of retirement"]})]}),c.jsx(_s,{width:"100%",height:e,children:c.jsxs(fj,{data:n,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",className:"stroke-gray-300 dark:stroke-gray-600"}),c.jsx(ir,{dataKey:"binLabel",angle:-45,textAnchor:"end",height:80,className:"text-gray-700 dark:text-gray-300",tick:{fontSize:11}}),c.jsx(sr,{label:{value:"Number of Outcomes",angle:-90,position:"insideLeft"},className:"text-gray-700 dark:text-gray-300"}),c.jsx(on,{content:c.jsx(i,{})}),c.jsx(Fr,{wrapperStyle:{paddingTop:"20px"},formatter:o=>o==="count"?"Outcomes":o}),c.jsx(Ub,{x:0,stroke:"#ef4444",strokeDasharray:"5 5",label:{value:"Failure Threshold",position:"top",fill:"#ef4444",fontSize:10}}),c.jsx(br,{dataKey:"count",fill:"#3b82f6",radius:[4,4,0,0],shape:o=>{const{x:l,y:u,width:d,height:f,payload:p}=o,m=a(p);return c.jsx("rect",{x:l,y:u,width:d,height:f,fill:m,rx:4,ry:4})}})]})}),c.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-red-700 dark:text-red-400",children:"10th Percentile"}),c.jsx("p",{className:"text-lg font-semibold text-red-900 dark:text-red-200",children:s(r.p10)}),c.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Worst 10%"})]}),c.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400",children:"25th Percentile"}),c.jsx("p",{className:"text-lg font-semibold text-yellow-900 dark:text-yellow-200",children:s(r.p25)}),c.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-1",children:"Lower Quartile"})]}),c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-400",children:"Median (50th)"}),c.jsx("p",{className:"text-lg font-semibold text-blue-900 dark:text-blue-200",children:s(r.p50)}),c.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Typical Outcome"})]}),c.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"75th Percentile"}),c.jsx("p",{className:"text-lg font-semibold text-green-900 dark:text-green-200",children:s(r.p75)}),c.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:"Upper Quartile"})]}),c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-emerald-700 dark:text-emerald-400",children:"90th Percentile"}),c.jsx("p",{className:"text-lg font-semibold text-emerald-900 dark:text-emerald-200",children:s(r.p90)}),c.jsx("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 mt-1",children:"Best 10%"})]})]}),c.jsx("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Overall Success Rate"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Scenarios where portfolio remained positive throughout retirement"})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:[(t.successRate*100).toFixed(1),"%"]}),c.jsx("span",{className:`inline-block mt-1 px-3 py-1 rounded-full text-xs font-medium ${t.successRate>=.9?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":t.successRate>=.75?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"}`,children:t.successRate>=.9?"Excellent":t.successRate>=.75?"Moderate":"High Risk"})]})]})})]})}function Xke({result:t,initialPortfolio:e,height:n=400,maxLinesToShow:r=10}){const i=T.useMemo(()=>{const{simulations:u}=t,d=[...u].sort((b,x)=>b.finalPortfolio-x.finalPortfolio),f=[];f.push({...d[0],label:"Worst Case",color:"#ef4444"});const p=Math.floor(d.length*.1);p>0&&p<d.length&&f.push({...d[p],label:"10th Percentile",color:"#f97316"});const m=Math.floor(d.length*.5);f.push({...d[m],label:"Median",color:"#3b82f6"});const y=Math.floor(d.length*.9);y<d.length-1&&f.push({...d[y],label:"90th Percentile",color:"#22c55e"}),f.push({...d[d.length-1],label:"Best Case",color:"#10b981"});const g=Math.max(0,r-f.length),v=Math.floor(d.length/(g+1));for(let b=1;b<=g&&b*v<d.length;b++){const x=b*v;x>p&&x<y&&f.push({...d[x],label:`${d[x].startYear}`,color:"#94a3b8"})}return f},[t,r]),s=T.useMemo(()=>{const u=Math.max(...i.map(f=>f.returns.length)),d=[];for(let f=0;f<=u;f++){const p={year:f};i.forEach((m,y)=>{const g=m.label||`Run ${y}`;if(f===0)p[g]=e;else if(f<=m.returns.length){let v=e;for(let b=0;b<f;b++)v=v*(1+m.returns[b]);p[g]=Math.max(0,v)}else p[g]=null}),d.push(p)}return d},[i,e]),a=({active:u,payload:d})=>!u||!d||d.length===0?null:c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-3 max-w-xs",children:[c.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:["Year ",d[0].payload.year]}),c.jsx("div",{className:"space-y-1",children:d.map((f,p)=>c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:f.color}}),c.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:f.name})]}),c.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:f.value!==null?o(f.value):"Depleted"})]},p))})]}),o=u=>u>=1e6?`$${(u/1e6).toFixed(1)}M`:u>=1e3?`$${(u/1e3).toFixed(0)}K`:`$${u.toFixed(0)}`,l=u=>u>=1e6?`$${(u/1e6).toFixed(1)}M`:u>=1e3?`$${(u/1e3).toFixed(0)}K`:`$${u}`;return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Historical Backtest Results"}),c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Portfolio performance using actual historical market returns (",t.simulations.length," scenarios analyzed)"]})]}),c.jsx(_s,{width:"100%",height:n,children:c.jsxs(Zg,{data:s,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",className:"stroke-gray-300 dark:stroke-gray-600"}),c.jsx(ir,{dataKey:"year",label:{value:"Years in Retirement",position:"insideBottom",offset:-5},className:"text-gray-700 dark:text-gray-300"}),c.jsx(sr,{tickFormatter:l,label:{value:"Portfolio Value",angle:-90,position:"insideLeft"},className:"text-gray-700 dark:text-gray-300"}),c.jsx(on,{content:c.jsx(a,{})}),c.jsx(Fr,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),i.map(u=>{const d=u.label||`Run ${u.runId}`,f=["Worst Case","Median","Best Case"].includes(u.label)?2.5:1.5,p=u.color==="#94a3b8"?.4:1;return c.jsx(di,{type:"monotone",dataKey:d,stroke:u.color,strokeWidth:f,dot:!1,name:d,connectNulls:!1,opacity:p},d)})]})}),c.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Success Rate"}),c.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[(t.successRate*100).toFixed(1),"%"]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[t.simulations.filter(u=>u.success).length," / ",t.simulations.length," scenarios"]})]}),c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-red-700 dark:text-red-400",children:"Worst Case"}),c.jsx("p",{className:"text-lg font-semibold text-red-900 dark:text-red-200",children:o(t.percentile10FinalPortfolio)}),c.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:["Started ",t.worstCaseStartYear]})]}),c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-400",children:"Median"}),c.jsx("p",{className:"text-lg font-semibold text-blue-900 dark:text-blue-200",children:o(t.medianFinalPortfolio)}),c.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Typical outcome"})]}),c.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[c.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"Best Case"}),c.jsx("p",{className:"text-lg font-semibold text-green-900 dark:text-green-200",children:o(t.percentile90FinalPortfolio)}),c.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:["Started ",t.bestCaseStartYear]})]})]}),c.jsx("div",{className:"mt-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:c.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[c.jsx("strong",{children:"Historical Context:"})," This chart uses actual market returns from different historical periods. Each line represents your portfolio's performance if you had retired in a specific year. The worst case typically reflects retiring just before major market downturns (e.g., 1929, 2000, 2008)."]})})]})}function Qke({retirementYears:t,initialPortfolio:e,annualWithdrawal:n,expectedReturnMean:r,expectedReturnStdev:i,inflationRate:s,height:a=400}){const{fixedResult:o,guardrailsResult:l}=T.useMemo(()=>{const y={numSimulations:1e3,retirementYears:t,initialPortfolio:e,expectedReturnMean:r,expectedReturnStdev:i,inflationRate:s},g=jv({...y,withdrawalStrategy:"fixed",annualWithdrawal:n}),v=jv({...y,withdrawalStrategy:"guardrails",annualWithdrawal:n});return{fixedResult:g,guardrailsResult:v}},[t,e,n,r,i,s]),u=[{metric:"Success Rate",Fixed:o.successRate*100,Guardrails:l.successRate*100},{metric:"Median Final",Fixed:o.medianFinalPortfolio/1e3,Guardrails:l.medianFinalPortfolio/1e3},{metric:"10th Percentile",Fixed:o.percentile10FinalPortfolio/1e3,Guardrails:l.percentile10FinalPortfolio/1e3}],d=y=>y>=1e6?`$${(y/1e6).toFixed(1)}M`:y>=1e3?`$${(y/1e3).toFixed(0)}K`:`$${y.toFixed(0)}`,f=({active:y,payload:g})=>{if(!y||!g||g.length===0)return null;const v=g[0].payload.metric,b=v==="Success Rate";return c.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg p-3",children:[c.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:v}),g.map((x,w)=>c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:x.color}}),c.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:x.name})]}),c.jsx("span",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:b?`${x.value.toFixed(1)}%`:d(x.value*1e3)})]},w))]})},p=(l.successRate-o.successRate)*100,m=l.medianFinalPortfolio-o.medianFinalPortfolio;return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Withdrawal Strategy Comparison"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Fixed withdrawals vs. Dynamic guardrails strategy"})]}),c.jsx(_s,{width:"100%",height:a,children:c.jsxs(fj,{data:u,margin:{top:5,right:30,left:20,bottom:5},children:[c.jsx(Cs,{strokeDasharray:"3 3",className:"stroke-gray-300 dark:stroke-gray-600"}),c.jsx(ir,{dataKey:"metric",className:"text-gray-700 dark:text-gray-300"}),c.jsx(sr,{className:"text-gray-700 dark:text-gray-300"}),c.jsx(on,{content:c.jsx(f,{})}),c.jsx(Fr,{wrapperStyle:{paddingTop:"20px"}}),c.jsx(br,{dataKey:"Fixed",fill:"#ef4444",radius:[4,4,0,0],name:"Fixed Withdrawal"}),c.jsx(br,{dataKey:"Guardrails",fill:"#10b981",radius:[4,4,0,0],name:"Dynamic Guardrails"})]})}),c.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:"text-sm font-semibold text-red-900 dark:text-red-200",children:"Fixed Withdrawal"}),c.jsx("span",{className:"text-xs px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded",children:"Conservative"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-red-700 dark:text-red-300",children:"Success Rate"}),c.jsxs("span",{className:"font-medium text-red-900 dark:text-red-100",children:[(o.successRate*100).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-red-700 dark:text-red-300",children:"Median Final"}),c.jsx("span",{className:"font-medium text-red-900 dark:text-red-100",children:d(o.medianFinalPortfolio)})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-red-700 dark:text-red-300",children:"10th Percentile"}),c.jsx("span",{className:"font-medium text-red-900 dark:text-red-100",children:d(o.percentile10FinalPortfolio)})]})]}),c.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-3",children:"Withdraws same amount every year, inflation-adjusted"})]}),c.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-200",children:"Dynamic Guardrails"}),c.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded",children:"Adaptive"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Success Rate"}),c.jsxs("span",{className:"font-medium text-green-900 dark:text-green-100",children:[(l.successRate*100).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Median Final"}),c.jsx("span",{className:"font-medium text-green-900 dark:text-green-100",children:d(l.medianFinalPortfolio)})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-green-700 dark:text-green-300",children:"10th Percentile"}),c.jsx("span",{className:"font-medium text-green-900 dark:text-green-100",children:d(l.percentile10FinalPortfolio)})]})]}),c.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mt-3",children:"Adjusts withdrawals based on portfolio performance"})]})]}),c.jsx("div",{className:"mt-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:c.jsx("span",{className:"text-blue-600 dark:text-blue-400 text-sm font-bold",children:""})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-200 mb-1",children:"Strategy Comparison"}),c.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-300",children:p>0?c.jsxs(c.Fragment,{children:["Guardrails strategy improves success rate by ",c.jsxs("strong",{children:[p.toFixed(1),"%"]}),m>0&&` and increases median final portfolio by ${d(m)}`,". Dynamic adjustments help preserve capital during downturns while allowing higher withdrawals in good times."]}):p<0?c.jsxs(c.Fragment,{children:["Fixed strategy shows ",c.jsxs("strong",{children:[Math.abs(p).toFixed(1),"%"]})," higher success rate. This scenario may benefit from predictable withdrawals."]}):c.jsx(c.Fragment,{children:"Both strategies show similar success rates. Consider personal preference for withdrawal consistency vs. flexibility."})})]})]})})]})}class zw extends T.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Chart rendering error:",e,n)}render(){return this.state.hasError?c.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(RSe,{className:"w-6 h-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-semibold text-red-800 dark:text-red-200 mb-1",children:this.props.fallbackTitle||"Chart Error"}),c.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:"Unable to render this chart. This may be due to invalid data or a calculation error."}),this.state.error&&c.jsxs("details",{className:"mt-2",children:[c.jsx("summary",{className:"text-xs text-red-600 dark:text-red-400 cursor-pointer",children:"Technical details"}),c.jsx("pre",{className:"mt-1 text-xs text-red-600 dark:text-red-400 overflow-auto",children:this.state.error.message})]})]})]})}):this.props.children}}function Jke({isOpen:t,onClose:e,scenario:n}){const{updateScenario:r,isUpdating:i}=Aj(),[s,a]=T.useState({name:"",current_age:35,retirement_age:65,life_expectancy:95,current_savings:1e5,annual_contribution:2e4,annual_expenses:4e4,portfolio_stock_pct:.6,expected_return_mean:.05,expected_return_stdev:.12,inflation_rate:.02,effective_tax_rate:.25,contribution_schedule:"fixed",withdrawal_schedule:"fixed",withdrawal_strategy:"guardrails",notes:null});T.useEffect(()=>{t&&n&&a({name:n.name,current_age:n.current_age,retirement_age:n.retirement_age,life_expectancy:n.life_expectancy,current_savings:n.current_savings,annual_contribution:n.annual_contribution,annual_expenses:n.annual_expenses,portfolio_stock_pct:n.portfolio_stock_pct,expected_return_mean:n.expected_return_mean,expected_return_stdev:n.expected_return_stdev,inflation_rate:n.inflation_rate,effective_tax_rate:.25,contribution_schedule:"fixed",withdrawal_schedule:"fixed",withdrawal_strategy:n.withdrawal_strategy,notes:n.notes})},[t,n]);const[o,l]=T.useState({}),u=()=>{const m={};return s.name.trim()||(m.name="Scenario name is required"),(s.current_age<18||s.current_age>100)&&(m.current_age="Current age must be between 18 and 100"),(s.retirement_age<18||s.retirement_age>100)&&(m.retirement_age="Retirement age must be between 18 and 100"),(s.life_expectancy<18||s.life_expectancy>120)&&(m.life_expectancy="Life expectancy must be between 18 and 120"),s.retirement_age<=s.current_age&&(m.retirement_age="Retirement age must be greater than current age"),s.life_expectancy<=s.retirement_age&&(m.life_expectancy="Life expectancy must be greater than retirement age"),s.current_savings<0&&(m.current_savings="Current savings cannot be negative"),s.annual_contribution<0&&(m.annual_contribution="Annual contribution cannot be negative"),s.annual_expenses<=0&&(m.annual_expenses="Annual expenses must be greater than 0"),(s.portfolio_stock_pct<0||s.portfolio_stock_pct>1)&&(m.portfolio_stock_pct="Stock allocation must be between 0% and 100%"),(s.expected_return_mean<0||s.expected_return_mean>.2)&&(m.expected_return_mean="Expected return must be between 0% and 20%"),(s.expected_return_stdev<0||s.expected_return_stdev>.5)&&(m.expected_return_stdev="Standard deviation must be between 0% and 50%"),(s.inflation_rate<0||s.inflation_rate>.1)&&(m.inflation_rate="Inflation rate must be between 0% and 10%"),l(m),Object.keys(m).length===0},d=async m=>{if(m.preventDefault(),!!u())try{const y=V_e(s);await r(n.id,y),e(),l({})}catch(y){console.error("Failed to update scenario:",y),l({submit:"Failed to update scenario. Please try again."})}},f=()=>{l({}),e()},p=(m,y="w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500")=>`${y} ${o[m]?"border-red-500":"border-gray-300"}`;return t?c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Scenario"}),c.jsx("button",{onClick:f,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:i,children:c.jsx(nz,{className:"w-6 h-6"})})]}),c.jsxs("form",{onSubmit:d,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name *"}),c.jsx("input",{type:"text",value:s.name,onChange:m=>a({...s,name:m.target.value}),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${o.name?"border-red-500":"border-gray-300"}`,placeholder:"e.g., Conservative Plan, Early Retirement",required:!0,disabled:i}),o.name&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.name})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Age"}),c.jsx("input",{type:"number",value:s.current_age,onChange:m=>a({...s,current_age:Number(m.target.value)}),className:p("current_age"),min:"18",max:"100",required:!0,disabled:i}),o.current_age&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.current_age})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retirement Age"}),c.jsx("input",{type:"number",value:s.retirement_age,onChange:m=>a({...s,retirement_age:Number(m.target.value)}),className:p("retirement_age"),min:"18",max:"100",required:!0,disabled:i}),o.retirement_age&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.retirement_age})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Life Expectancy"}),c.jsx("input",{type:"number",value:s.life_expectancy,onChange:m=>a({...s,life_expectancy:Number(m.target.value)}),className:p("life_expectancy"),min:"18",max:"120",required:!0,disabled:i}),o.life_expectancy&&c.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.life_expectancy})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Savings"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:s.current_savings,onChange:m=>a({...s,current_savings:Number(m.target.value)}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0,disabled:i})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Contribution"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:s.annual_contribution,onChange:m=>a({...s,annual_contribution:Number(m.target.value)}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0,disabled:i})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Annual Expenses"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),c.jsx("input",{type:"number",value:s.annual_expenses,onChange:m=>a({...s,annual_expenses:Number(m.target.value)}),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"1000",required:!0,disabled:i})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Allocation"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:(s.portfolio_stock_pct*100).toFixed(0),onChange:m=>a({...s,portfolio_stock_pct:Number(m.target.value)/100}),className:"w-full pr-8 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"5",required:!0,disabled:i}),c.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:"%"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Return"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:(s.expected_return_mean*100).toFixed(1),onChange:m=>a({...s,expected_return_mean:Number(m.target.value)/100}),className:"w-full pr-8 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"20",step:"0.1",required:!0,disabled:i}),c.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:"%"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard Deviation"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:(s.expected_return_stdev*100).toFixed(1),onChange:m=>a({...s,expected_return_stdev:Number(m.target.value)/100}),className:"w-full pr-8 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"50",step:"0.1",required:!0,disabled:i}),c.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:"%"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inflation Rate"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:(s.inflation_rate*100).toFixed(1),onChange:m=>a({...s,inflation_rate:Number(m.target.value)/100}),className:"w-full pr-8 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"10",step:"0.1",required:!0,disabled:i}),c.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:"%"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effective Tax Rate"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:(s.effective_tax_rate*100).toFixed(1),onChange:m=>a({...s,effective_tax_rate:Number(m.target.value)/100}),className:"w-full pr-8 pl-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"50",step:"0.1",required:!0,disabled:i}),c.jsx("span",{className:"absolute right-3 top-2 text-gray-500",children:"%"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Withdrawal Strategy"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"guardrails",checked:s.withdrawal_strategy==="guardrails",onChange:m=>a({...s,withdrawal_strategy:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Guardrails (Recommended)"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Adjusts spending based on portfolio performance"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"fixed",checked:s.withdrawal_strategy==="fixed",onChange:m=>a({...s,withdrawal_strategy:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Fixed Dollar Amount"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Same spending amount every year (inflation-adjusted)"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"percentage",checked:s.withdrawal_strategy==="percentage",onChange:m=>a({...s,withdrawal_strategy:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Fixed Percentage (4% Rule)"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Withdraw fixed percentage of portfolio each year"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contribution Schedule"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"fixed",checked:s.contribution_schedule==="fixed",onChange:m=>a({...s,contribution_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Fixed Amount"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Same contribution every year"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"increasing",checked:s.contribution_schedule==="increasing",onChange:m=>a({...s,contribution_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Increasing"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Contributions increase over time (e.g., with salary growth)"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"decreasing",checked:s.contribution_schedule==="decreasing",onChange:m=>a({...s,contribution_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Decreasing"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Contributions decrease over time"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Withdrawal Schedule"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"fixed",checked:s.withdrawal_schedule==="fixed",onChange:m=>a({...s,withdrawal_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Fixed Amount"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Same withdrawal every year (inflation-adjusted)"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"increasing",checked:s.withdrawal_schedule==="increasing",onChange:m=>a({...s,withdrawal_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Increasing"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Withdrawals increase over time"})]})]}),c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"radio",value:"decreasing",checked:s.withdrawal_schedule==="decreasing",onChange:m=>a({...s,withdrawal_schedule:m.target.value}),className:"mr-3",disabled:i}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:"Decreasing"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Withdrawals decrease over time"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),c.jsx("textarea",{value:s.notes||"",onChange:m=>a({...s,notes:m.target.value||null}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes about this scenario...",disabled:i})]}),o.submit&&c.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:c.jsx("p",{className:"text-sm text-red-600",children:o.submit})}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:f,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors font-medium disabled:opacity-50",disabled:i,children:"Cancel"}),c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:i,children:i?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):"Update Scenario"})]})]})]})})}):null}function Zke({scenario:t,onBack:e}){const[n,r]=T.useState(!0),[i,s]=T.useState(!1),a=T.useMemo(()=>{const u=Math.max(0,t.retirement_age-t.current_age);let d=t.current_savings;for(let f=0;f<u;f++)d=(d+t.annual_contribution)*(1+t.expected_return_mean);return d},[t]),o=T.useMemo(()=>{const u=t.annual_expenses/a||.04,d={numSimulations:1e3,retirementYears:t.life_expectancy-t.retirement_age,initialPortfolio:a,annualWithdrawal:t.withdrawal_strategy==="percentage"?void 0:t.annual_expenses,withdrawalRate:t.withdrawal_strategy==="percentage"?u:void 0,withdrawalStrategy:t.withdrawal_strategy,expectedReturnMean:t.expected_return_mean,expectedReturnStdev:t.expected_return_stdev,inflationRate:t.inflation_rate};return jv(d)},[t,a]),l=T.useMemo(()=>{const u={numSimulations:100,retirementYears:t.life_expectancy-t.retirement_age,initialPortfolio:a,annualWithdrawal:t.annual_expenses,stockAllocation:t.portfolio_stock_pct,historicalData:dSe,inflationAdjusted:!0};return uSe(u)},[t,a]);return T.useEffect(()=>{r(!0);const u=setTimeout(()=>{r(!1)},100);return()=>clearTimeout(u)},[t]),c.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:e,className:"inline-flex items-center text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4",children:[c.jsx(OSe,{className:"w-4 h-4 mr-2"}),"Back"]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:t.name}),t.notes&&c.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:t.notes})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:()=>s(!0),disabled:n,title:"Edit scenario",children:c.jsx(BSe,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>{confirm("Are you sure you want to delete this scenario? This action cannot be undone.")&&alert("Delete functionality will be implemented to remove the scenario from the database.")},className:"p-2 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20",title:"Delete scenario",children:c.jsx(zSe,{className:"w-5 h-5"})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[c.jsx(Ll,{label:"Current Age",value:t.current_age.toString()}),c.jsx(Ll,{label:"Retirement Age",value:t.retirement_age.toString()}),c.jsx(Ll,{label:"Years to Retirement",value:(t.retirement_age-t.current_age).toString()}),c.jsx(Ll,{label:"Life Expectancy",value:t.life_expectancy.toString()}),c.jsx(Ll,{label:"Current Savings",value:Kk(t.current_savings)}),c.jsx(Ll,{label:"Annual Contribution",value:Kk(t.annual_contribution)}),c.jsx(Ll,{label:"Annual Expenses",value:Kk(t.annual_expenses)}),c.jsx(Ll,{label:"Stock Allocation",value:`${(t.portfolio_stock_pct*100).toFixed(0)}%`})]}),n?c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-12 mb-8",children:c.jsxs("div",{className:"flex flex-col items-center justify-center",children:[c.jsx(DSe,{className:"w-12 h-12 text-blue-600 animate-spin mb-4"}),c.jsx("p",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"Running Simulations..."}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Analyzing 1,100+ scenarios to calculate your retirement outlook"})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-4 md:p-6 mb-8",children:c.jsx(zw,{fallbackTitle:"Net Worth Chart Error",children:c.jsx(bP,{scenario:t,height:400})})}),c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-4 md:p-6 mb-8",children:c.jsx(zw,{fallbackTitle:"Monte Carlo Chart Error",children:c.jsx(Yke,{result:o,height:350})})}),c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-4 md:p-6 mb-8",children:c.jsx(zw,{fallbackTitle:"Historical Chart Error",children:c.jsx(Xke,{result:l,initialPortfolio:a,height:350,maxLinesToShow:8})})}),c.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-4 md:p-6 mb-8",children:c.jsx(zw,{fallbackTitle:"Withdrawal Strategy Chart Error",children:c.jsx(Qke,{retirementYears:t.life_expectancy-t.retirement_age,initialPortfolio:a,annualWithdrawal:t.annual_expenses,expectedReturnMean:t.expected_return_mean,expectedReturnStdev:t.expected_return_stdev,inflationRate:t.inflation_rate,height:350})})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-6",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Scenario Parameters"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Portfolio Settings"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(ky,{label:"Expected Return (Mean)",value:`${(t.expected_return_mean*100).toFixed(1)}%`}),c.jsx(ky,{label:"Expected Return (Std Dev)",value:`${(t.expected_return_stdev*100).toFixed(1)}%`}),c.jsx(ky,{label:"Inflation Rate",value:`${(t.inflation_rate*100).toFixed(1)}%`}),c.jsx(ky,{label:"Stock Allocation",value:`${(t.portfolio_stock_pct*100).toFixed(0)}%`})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Withdrawal Strategy"}),c.jsx("div",{className:"space-y-2",children:c.jsx(ky,{label:"Strategy",value:t.withdrawal_strategy,capitalize:!0})})]})]})]}),c.jsx(Jke,{isOpen:i,onClose:()=>s(!1),scenario:t})]})}function Ll({label:t,value:e}){return c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow p-4",children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:t}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:e})]})}function ky({label:t,value:e,capitalize:n}){return c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t}),c.jsx("span",{className:`font-medium text-gray-900 dark:text-gray-100 ${n?"capitalize":""}`,children:e})]})}function Kk(t){return t>=1e6?`$${(t/1e6).toFixed(2)}M`:t>=1e3?`$${(t/1e3).toFixed(0)}K`:`$${t.toFixed(0)}`}async function eNe(){const t=await He(),{data:e,error:n}=await he.from("scenarios").select("*").eq("created_by",t).order("created_at",{ascending:!1});return n?(console.error("Error fetching scenarios:",n),[]):e||[]}function tNe({onNavigateToScenarios:t}){const{selectedScenario:e,setSelectedScenario:n,isLoading:r,isUpdating:i}=CO(),{data:s=[],isLoading:a}=Bt({queryKey:["scenarios"],queryFn:eNe}),{updateScenario:o}=Aj(),l=gj(),[u,d]=T.useState(!1),[f,p]=T.useState(!1),[m,y]=T.useState(!1),g=S=>{n(S),d(!1)},v=()=>{t&&e&&t(e.id)},b=()=>{t&&t()},x=async()=>{if(e){y(!0);try{await o(e.id,{portfolio_value_now:l.netWorth}),p(!1)}catch(S){console.error("Error updating scenario:",S)}finally{y(!1)}}},w=e&&Math.abs(e.current_savings-l.netWorth)>100;return!a&&s.length===0?c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"FIRE Scenario"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No scenarios yet"})]}),c.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:c.jsxs("svg",{className:"w-6 h-6 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"})]})})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a FIRE scenario to see projections and track your progress."}),c.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors font-medium text-sm",children:"Create Your First Scenario"})]}):r||a?c.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:c.jsxs("div",{className:"animate-pulse",children:[c.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3 mb-2"}),c.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),c.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})}):c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"FIRE Scenario"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e?"Active scenario":"Select scenario"})]}),c.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:c.jsxs("svg",{className:"w-6 h-6 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"})]})})]}),c.jsxs("div",{className:"relative mb-4",children:[c.jsxs("button",{onClick:()=>d(!u),disabled:i,className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"Select a scenario..."}),c.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform ${u?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&c.jsx("div",{className:"absolute z-10 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:s.map(S=>c.jsx("button",{onClick:()=>g(S.id),className:`w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors first:rounded-t-lg last:rounded-b-lg ${(e==null?void 0:e.id)===S.id?"bg-primary/5":""}`,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:S.name}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Retire at ",S.retirement_age,"  ",S.life_expectancy-S.retirement_age," years"]})]}),(e==null?void 0:e.id)===S.id&&c.jsx("svg",{className:"w-5 h-5 text-primary",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},S.id))})]}),e&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:c.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Current Age"}),c.jsx("p",{className:"font-semibold text-gray-900",children:e.current_age})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Retirement Age"}),c.jsx("p",{className:"font-semibold text-gray-900",children:e.retirement_age})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Expected Return"}),c.jsxs("p",{className:"font-semibold text-gray-900",children:[(e.expected_return_mean*100).toFixed(1),"%"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Inflation"}),c.jsxs("p",{className:"font-semibold text-gray-900",children:[(e.inflation_rate*100).toFixed(1),"%"]})]})]})}),w&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:c.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Net Worth Changed"}),c.jsxs("p",{className:"text-xs text-blue-700 mb-2",children:["Scenario: ",ie(e.current_savings),"  Actual: ",ie(l.netWorth)]}),c.jsx("button",{onClick:()=>p(!0),className:"text-xs font-medium text-blue-600 hover:text-blue-800 transition-colors",children:"Sync Scenario "})]})]})})]}),f&&e&&c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-6",children:[c.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[c.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:c.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Update Scenario"}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:['Sync "',e.name,'" with your current net worth']})]})]}),c.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Current Scenario Value:"}),c.jsx("span",{className:"text-sm font-semibold text-gray-900",children:ie(e.current_savings)})]}),c.jsx("div",{className:"flex items-center justify-center",children:c.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"New Value (Actual):"}),c.jsx("span",{className:"text-sm font-bold text-blue-600",children:ie(l.netWorth)})]}),c.jsx("div",{className:"pt-3 border-t border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Change:"}),c.jsxs("span",{className:`text-sm font-bold ${l.netWorth>e.current_savings?"text-green-600":"text-red-600"}`,children:[l.netWorth>e.current_savings?"+":"",ie(l.netWorth-e.current_savings)]})]})})]})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>p(!1),disabled:m,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm disabled:opacity-50",children:"Cancel"}),c.jsx("button",{onClick:x,disabled:m,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm disabled:opacity-50 flex items-center justify-center gap-2",children:m?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Scenario"})]})]})}),c.jsxs("div",{className:"flex gap-2",children:[e&&c.jsx("button",{onClick:v,className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors font-medium text-sm",children:"View Details"}),c.jsx("button",{onClick:b,className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm",children:"Manage Scenarios"})]})]})}function nNe({scenario:t}){const e=gj(),n=Z8({currentNetWorth:e.netWorth,annualSavings:t.annual_contribution,annualExpenses:t.annual_expenses,expectedReturn:t.expected_return_mean,withdrawalRate:.04}),{yearsToFI:r,fiNumber:i,currentProgress:s,remainingNeeded:a}=n,o=()=>{const l=[];let u=e.netWorth;const d=Math.min(Math.ceil(r),50);for(let f=0;f<=d;f++)l.push({year:new Date().getFullYear()+f,value:u}),u=(u+t.annual_contribution)*(1+t.expected_return_mean);return l};return c.jsx(V8,{title:`Scenario: ${t.name}`,yearsToFI:r,fiNumber:i,remainingNeeded:a,currentProgress:s,projectionData:o(),annualSavings:t.annual_contribution,isLoading:!1})}function rNe({scenarios:t,onClose:e}){if(t.length!==2)return null;const[n,r]=t;return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:c.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl max-w-7xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 p-6 flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Scenario Comparison"}),c.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:[n.name," vs ",r.name]})]}),c.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",children:c.jsx(nz,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[c.jsx(OF,{scenario:n}),c.jsx(OF,{scenario:r})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:n.name}),c.jsx(bP,{scenario:n,height:300})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:r.name}),c.jsx(bP,{scenario:r,height:300})]})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Key Assumptions Comparison"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[c.jsx("th",{className:"text-left py-2 px-4 font-medium text-gray-700 dark:text-gray-300",children:"Assumption"}),c.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-700 dark:text-gray-300",children:n.name}),c.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-700 dark:text-gray-300",children:r.name}),c.jsx("th",{className:"text-center py-2 px-4 font-medium text-gray-700 dark:text-gray-300",children:"Difference"})]})}),c.jsxs("tbody",{children:[c.jsx(wf,{label:"Current Savings",value1:n.current_savings,value2:r.current_savings,format:"currency"}),c.jsx(wf,{label:"Annual Contribution",value1:n.annual_contribution,value2:r.annual_contribution,format:"currency"}),c.jsx(wf,{label:"Annual Expenses",value1:n.annual_expenses,value2:r.annual_expenses,format:"currency"}),c.jsx(wf,{label:"Expected Return",value1:n.expected_return_mean,value2:r.expected_return_mean,format:"percentage"}),c.jsx(wf,{label:"Inflation Rate",value1:n.inflation_rate,value2:r.inflation_rate,format:"percentage"}),c.jsx(wf,{label:"Stock Allocation",value1:n.portfolio_stock_pct,value2:r.portfolio_stock_pct,format:"percentage"})]})]})})]})]})]})})}function OF({scenario:t}){return c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:t.name}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsx(Ww,{label:"Years to Retirement",value:(t.retirement_age-t.current_age).toString()}),c.jsx(Ww,{label:"Life Expectancy",value:t.life_expectancy.toString()}),c.jsx(Ww,{label:"Current Savings",value:wP(t.current_savings)}),c.jsx(Ww,{label:"Annual Expenses",value:wP(t.annual_expenses)})]})]})}function Ww({label:t,value:e}){return c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t}),c.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e})]})}function wf({label:t,value1:e,value2:n,format:r}){const i=o=>r==="currency"?wP(o):r==="percentage"?`${(o*100).toFixed(1)}%`:o.toString(),s=n-e,a=s>0?"text-green-600":s<0?"text-red-600":"text-gray-600";return c.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[c.jsx("td",{className:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100",children:t}),c.jsx("td",{className:"py-3 px-4 text-center text-gray-700 dark:text-gray-300",children:i(e)}),c.jsx("td",{className:"py-3 px-4 text-center text-gray-700 dark:text-gray-300",children:i(n)}),c.jsx("td",{className:`py-3 px-4 text-center font-medium ${a}`,children:s===0?"":(s>0?"+":"")+i(s)})]})}function wP(t){return t>=1e6?`$${(t/1e6).toFixed(2)}M`:t>=1e3?`$${(t/1e3).toFixed(0)}K`:`$${t.toFixed(0)}`}function iNe({initialSelectedScenarioId:t}={}){const{data:e,isLoading:n,error:r}=Bke(),{deleteScenario:i,isDeleting:s}=Aj(),[a,o]=T.useState(!1),[l,u]=T.useState(null),[d,f]=T.useState(t||null),[p,m]=T.useState(!1),[y,g]=T.useState([]),[v,b]=T.useState(!1);if(v&&y.length===2){const A=(e==null?void 0:e.filter(j=>y.includes(j.id)))||[];return c.jsx(rNe,{scenarios:A,onClose:()=>{b(!1),g([]),m(!1)}})}const x=async A=>{if(confirm("Are you sure you want to delete this scenario?")){u(A);try{await i(A)}finally{u(null)}}},w=A=>{g(j=>j.includes(A)?j.filter(N=>N!==A):j.length<2?[...j,A]:j)},S=()=>{g([]),m(!1)},_=A=>{const j=Z8({currentNetWorth:A.current_savings,annualExpenses:A.annual_expenses,annualSavings:A.annual_contribution,expectedReturn:A.expected_return_mean,withdrawalRate:.04}),N=A.life_expectancy-A.retirement_age,P=Math.max(0,A.retirement_age-A.current_age);let O=A.current_savings;for(let L=0;L<P;L++)O=(O+A.annual_contribution)*(1+A.expected_return_mean);const M=A.annual_expenses/O||.04,R={numSimulations:1e3,retirementYears:N,initialPortfolio:O,annualWithdrawal:A.withdrawal_strategy==="percentage"?void 0:A.annual_expenses,withdrawalRate:A.withdrawal_strategy==="percentage"?M:void 0,withdrawalStrategy:A.withdrawal_strategy,expectedReturnMean:A.expected_return_mean,expectedReturnStdev:A.expected_return_stdev,inflationRate:A.inflation_rate},I=jv(R);return{yearsToFI:j,successRate:I.successRate,projectedNetWorth:O}};if(n)return c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"text-gray-500",children:"Loading scenarios..."})});if(r)return c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:c.jsx("p",{className:"text-red-800",children:"Error loading scenarios. Please try again."})});if(d){const A=e==null?void 0:e.find(j=>j.id===d);if(A)return c.jsxs("div",{children:[c.jsx("button",{onClick:()=>f(null),className:"text-blue-600 hover:underline mb-4",children:" Back to all scenarios"}),c.jsx(nNe,{scenario:A}),c.jsx("div",{className:"mt-6",children:c.jsx(Zke,{scenario:A,onBack:()=>f(null)})})]})}return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"FIRE Scenarios"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Create and compare different retirement planning scenarios"})]}),c.jsxs("div",{className:"flex gap-2",children:[p?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:S,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Cancel Compare"}),y.length===2&&c.jsx("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Compare Selected"})]}):c.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Compare Scenarios"}),c.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"+ New Scenario"})]})]}),c.jsx("div",{className:"mb-6",children:c.jsx(tNe,{onNavigateToScenarios:A=>f(A??null)})}),!e||e.length===0?c.jsx("div",{className:"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-12 text-center",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No scenarios yet"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first FIRE planning scenario to see personalized projections and probability analysis."}),c.jsx("button",{onClick:()=>o(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Create Your First Scenario"})]})}):c.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(A=>{const j=_(A),N=l===A.id;return c.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow ${p?"cursor-default":"cursor-pointer"} ${y.includes(A.id)?"ring-2 ring-purple-500":""}`,onClick:()=>{p?w(A.id):f(A.id)},children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[p&&c.jsx("input",{type:"checkbox",checked:y.includes(A.id),onChange:()=>w(A.id),className:"mr-3 mt-1",onClick:P=>P.stopPropagation()}),c.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:A.name}),c.jsx("button",{onClick:P=>{P.stopPropagation(),x(A.id)},disabled:N||s,className:"text-red-600 hover:text-red-700 disabled:text-gray-400",title:"Delete scenario",children:N?"...":""})]}),c.jsxs("div",{className:"space-y-3 mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Years to FI"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600",children:j.yearsToFI.yearsToFI===1/0?"":j.yearsToFI.yearsToFI<=0?"Reached!":j.yearsToFI.yearsToFI.toFixed(1)})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Success Rate (Monte Carlo)"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("p",{className:"text-xl font-semibold text-gray-900",children:[(j.successRate*100).toFixed(1),"%"]}),c.jsx("span",{className:`text-xs px-2 py-1 rounded ${j.successRate>=.9?"bg-green-100 text-green-700":j.successRate>=.75?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:j.successRate>=.9?"Good":j.successRate>=.75?"Moderate":"Risky"})]})]})]}),c.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Age"}),c.jsxs("span",{className:"text-gray-900 font-medium",children:[A.current_age,"  ",A.retirement_age]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Current Savings"}),c.jsxs("span",{className:"text-gray-900 font-medium",children:["$",A.current_savings.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Annual Contribution"}),c.jsxs("span",{className:"text-gray-900 font-medium",children:["$",A.annual_contribution.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Retirement Expenses"}),c.jsxs("span",{className:"text-gray-900 font-medium",children:["$",A.annual_expenses.toLocaleString()]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Withdrawal Strategy"}),c.jsx("span",{className:"text-gray-900 font-medium capitalize",children:A.withdrawal_strategy})]})]}),A.notes&&c.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:c.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:A.notes})})]},A.id)})}),c.jsx(Hke,{isOpen:a,onClose:()=>o(!1)})]})}const bW=T.createContext(void 0);function sNe(){const t=T.useContext(bW);if(!t)throw new Error("useToast must be used within ToastProvider");return t}const aNe=({children:t})=>{const[e,n]=T.useState([]),r=T.useCallback(s=>{n(a=>a.filter(o=>o.id!==s))},[]),i=T.useCallback((s,a="info",o=3500)=>{const l=Math.random().toString(36).slice(2),u={id:l,message:s,type:a,duration:o};n(d=>[...d,u]),setTimeout(()=>r(l),o)},[r]);return c.jsxs(bW.Provider,{value:{toasts:e,push:i,remove:r},children:[t,c.jsx(lNe,{toasts:e,onDismiss:r})]})},oNe={success:"bg-green-600",error:"bg-red-600",info:"bg-gray-700"},lNe=({toasts:t,onDismiss:e})=>c.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 w-80",children:t.map(n=>c.jsxs("div",{className:`text-white px-4 py-3 rounded shadow flex items-start gap-3 animate-fadeIn ${oNe[n.type]}`,children:[c.jsx("div",{className:"flex-1 text-sm leading-snug",children:n.message}),c.jsx("button",{onClick:()=>e(n.id),className:"text-white/70 hover:text-white transition-colors text-xs","aria-label":"Dismiss",children:""})]},n.id))});function cNe({parentCategories:t,childCategories:e,onEdit:n,onDelete:r,deletingId:i}){return console.log("CategoryList rendering with delete handlers:",{hasOnDelete:!!r,deletingId:i}),t.length===0?c.jsxs("div",{className:"p-8 text-center text-gray-500",children:[c.jsx("div",{className:"text-4xl mb-3",children:""}),c.jsx("p",{children:"No categories yet"}),c.jsx("p",{className:"text-sm mt-1",children:'Click "Add Category" to create your first one'})]}):c.jsx("div",{className:"divide-y divide-gray-200",children:t.map(s=>{const a=e.get(s.id)||[];return c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"text-lg",children:""}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold text-gray-900",children:s.name}),c.jsxs("div",{className:"text-xs text-gray-500",children:[a.length," ",a.length===1?"subcategory":"subcategories"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[!s.is_budgetable&&c.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:"Group Only"}),c.jsx("button",{onClick:()=>n(s),className:"px-3 py-1 text-sm text-gray-600 hover:text-primary transition-colors",children:"Edit"}),c.jsx("button",{disabled:i===s.id,onClick:()=>r(s),className:"px-3 py-1 text-sm text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50",children:i===s.id?"Deleting...":a.length>0?"Delete + Subs":"Delete"})]})]}),a.length>0&&c.jsx("div",{className:"ml-8 mt-2 space-y-2",children:a.map(o=>c.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"text-sm",children:""}),c.jsx("span",{className:"text-sm text-gray-700",children:o.name})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[o.is_budgetable&&c.jsx("span",{className:"text-xs text-green-600",children:" Budgetable"}),o.is_envelope&&c.jsx("span",{className:"text-xs",children:""}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:()=>n(o),className:"px-2 py-1 text-xs text-gray-600 hover:text-primary transition-colors",children:"Edit"}),c.jsx("button",{disabled:i===o.id,onClick:()=>r(o),className:"px-2 py-1 text-xs text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50",children:i===o.id?"":"Delete"})]})]})]},o.id))})]},s.id)})})}function MF({mode:t,category:e,parentCategories:n,onSubmit:r,onCancel:i}){const[s,a]=T.useState((e==null?void 0:e.name)||""),[o,l]=T.useState((e==null?void 0:e.parent_id)||""),[u,d]=T.useState((e==null?void 0:e.is_budgetable)??!0);T.useEffect(()=>{e&&(a(e.name),l(e.parent_id||""),d(e.is_budgetable??!0))},[e]);const f=p=>{p.preventDefault(),r({name:s.trim(),parentId:o||null,isBudgetable:u})};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[c.jsx("div",{className:"p-6 border-b border-gray-200",children:c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:t==="create"?"Create Category":"Edit Category"})}),c.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),c.jsx("input",{type:"text",value:s,onChange:p=>a(p.target.value),placeholder:"e.g., Electric, Groceries",required:!0,autoFocus:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),c.jsxs("select",{value:o,onChange:p=>l(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[c.jsx("option",{value:"",children:"None (Top-level category)"}),n.map(p=>c.jsx("option",{value:p.id,children:p.name},p.id))]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional: Select a parent to create a subcategory"})]}),c.jsxs("div",{className:"flex items-start",children:[c.jsx("input",{type:"checkbox",id:"isBudgetable",checked:u,onChange:p=>d(p.target.checked),className:"mt-1 h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"}),c.jsxs("label",{htmlFor:"isBudgetable",className:"ml-2",children:[c.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Budgetable Category"}),c.jsx("div",{className:"text-xs text-gray-500",children:"Can be used for transactions and budgets"})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[c.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-md text-sm font-medium hover:bg-primary/90",children:t==="create"?"Create":"Save Changes"})]})]})]})})}function uNe({isOpen:t,title:e,message:n,confirmLabel:r="Confirm",cancelLabel:i="Cancel",onConfirm:s,onCancel:a,variant:o="warning"}){if(!t)return null;const l={danger:"bg-red-600 hover:bg-red-700",warning:"bg-yellow-600 hover:bg-yellow-700",info:"bg-primary hover:bg-primary/90"};return c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs("div",{className:"relative bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[c.jsx("div",{className:"mb-4 flex justify-center",children:c.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${o==="danger"?"bg-red-100":o==="warning"?"bg-yellow-100":"bg-blue-100"}`,children:c.jsx("span",{className:"text-2xl",children:o==="danger"||o==="warning"?"":""})})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 text-center mb-2",children:e}),c.jsx("p",{className:"text-sm text-gray-600 text-center mb-6",children:n}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:i}),c.jsx("button",{onClick:()=>{s(),a()},className:`flex-1 px-4 py-2 rounded-md text-sm font-medium text-white transition-colors ${l[o]}`,children:r})]})]})})]})}function dNe(){const{data:t=[],isLoading:e}=Ms(),n=ez(),r=fSe(),i=pSe(),s=mSe(),a=sNe(),[o,l]=T.useState(!1),[u,d]=T.useState(null),[f,p]=T.useState(null),m=t.filter(v=>v.parent_id===null),y=new Map;t.forEach(v=>{if(v.parent_id){const b=y.get(v.parent_id)||[];b.push(v),y.set(v.parent_id,b)}});const g=async v=>{var b;try{const x=v.parentId?`${(b=t.find(w=>w.id===v.parentId))==null?void 0:b.name}>${v.name}`:v.name;await n.mutateAsync({name:v.name,path:x,parent_id:v.parentId,is_budgetable:v.isBudgetable}),a.push("Category created","success"),l(!1)}catch(x){console.error("Failed to create category:",x),a.push("Failed to create category","error")}};return e?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"text-gray-500",children:"Loading categories..."})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Categories"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your transaction categories and subcategories"})]}),c.jsxs("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors flex items-center gap-2",children:[c.jsx("span",{className:"text-lg",children:""}),"Add Category"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Total Categories"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Parent Categories"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:m.length})]}),c.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Budgetable"}),c.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.filter(v=>v.is_budgetable).length})]})]}),c.jsx("div",{className:"bg-white border border-gray-200 rounded-lg",children:c.jsx(cNe,{parentCategories:m,childCategories:y,onEdit:d,onDelete:v=>{var x;const b=(((x=y.get(v.id))==null?void 0:x.length)||0)>0;p({category:v,hasChildren:b})},deletingId:r.isPending&&r.variables||i.isPending&&i.variables||null})}),o&&c.jsx(MF,{mode:"create",parentCategories:m,onSubmit:g,onCancel:()=>l(!1)}),u&&c.jsx(MF,{mode:"edit",category:u,parentCategories:m,onSubmit:async v=>{try{await s.mutateAsync({id:u.id,name:v.name,parentId:v.parentId,isBudgetable:v.isBudgetable}),a.push("Category updated","success"),d(null)}catch(b){a.push(b.message||"Failed to update category","error")}},onCancel:()=>d(null)}),c.jsx(uNe,{isOpen:!!f,title:"Delete Category",message:f!=null&&f.hasChildren?`Delete "${f.category.name}" AND all its subcategories? Budgets & bills linked will be removed.`:`Delete "${f==null?void 0:f.category.name}"? Related transactions will become Uncategorized.`,confirmLabel:"Delete",cancelLabel:"Cancel",variant:"danger",onConfirm:()=>{f&&(f.hasChildren?i.mutate(f.category.id,{onSuccess:()=>a.push("Category + descendants deleted","success"),onError:v=>a.push(v.message||"Failed cascade delete","error")}):r.mutate(f.category.id,{onSuccess:()=>a.push("Category deleted","success"),onError:v=>a.push(v.message||"Failed to delete category","error")}),p(null))},onCancel:()=>p(null)})]})}async function hNe(){const t=await He(),{data:e,error:n}=await he.from("profiles").select("*").eq("id",t).single();if(n){if(n.code==="PGRST116"){console.log("Profile not found, creating default profile...");try{const{data:r,error:i}=await he.from("profiles").insert({id:t,birth_date:"1990-01-01"}).select().single();if(i)throw console.error("Error creating profile:",i),new Error(i.message);return r}catch(r){throw console.error("Error creating profile:",r),r}}throw console.error("Error fetching profile:",n),new Error(n.message)}return e}async function fNe(t){const e=await He(),{data:n,error:r}=await he.from("profiles").update(t).eq("id",e).select().single();if(r)throw console.error("Error updating profile:",r),new Error(r.message);return n}function pNe(){const t=Xe(),{data:e,isLoading:n,error:r}=Bt({queryKey:["profile"],queryFn:hNe}),{mutateAsync:i,isPending:s}=et({mutationFn:fNe,onSuccess:a=>{t.setQueryData(["profile"],a),t.invalidateQueries({queryKey:["user"]})}});return{profile:e,isLoading:n,isUpdating:s,error:r,updateProfile:i}}function mNe(){const{profile:t,isLoading:e,isUpdating:n,updateProfile:r}=pNe(),[i,s]=T.useState(""),[a,o]=T.useState(null);T.useEffect(()=>{t&&s(t.birth_date)},[t]);const l=async u=>{if(u.preventDefault(),o(null),!i){o({type:"error",message:"Birth date cannot be empty."});return}try{await r({birth_date:i}),o({type:"success",message:"Profile updated successfully!"})}catch(d){const f=d instanceof Error?d.message:"An unknown error occurred.";o({type:"error",message:`Failed to update profile: ${f}`})}};return e?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"text-gray-500",children:"Loading profile..."})}):c.jsxs("div",{className:"max-w-2xl mx-auto",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Your Profile"}),c.jsx("div",{className:"bg-white shadow-md rounded-lg p-6",children:c.jsxs("form",{onSubmit:l,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"birthDate",className:"block text-sm font-medium text-gray-700",children:"Birth Date"}),c.jsx("div",{className:"mt-1",children:c.jsx("input",{type:"date",id:"birthDate",name:"birthDate",value:i,onChange:u=>s(u.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})}),t&&c.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["This means you are currently ",qB(t.birth_date)," years old."]})]}),a&&c.jsx("div",{className:`p-4 rounded-md text-sm ${a.type==="success"?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:a.message}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400",children:n?"Saving...":"Save Changes"})})]})})]})}function gNe({items:t,className:e=""}){return t.length<=1?null:c.jsx("nav",{className:`flex items-center space-x-2 text-sm ${e}`,"aria-label":"Breadcrumb",children:c.jsx("ol",{className:"flex items-center space-x-2",children:t.map((n,r)=>c.jsxs("li",{className:"flex items-center",children:[r>0&&c.jsx("svg",{className:"w-4 h-4 text-gray-400 mx-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),n.onClick&&!n.isActive?c.jsx("button",{onClick:n.onClick,className:"text-gray-500 hover:text-gray-700 transition-colors font-medium truncate max-w-[120px] sm:max-w-none",title:n.label,children:n.label}):c.jsx("span",{className:`truncate max-w-[120px] sm:max-w-none ${n.isActive?"text-gray-900 font-semibold":"text-gray-500"}`,title:n.label,children:n.label})]},r))})})}const Hw={dashboard:{label:"Dashboard",shortLabel:"Home",icon:c.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5v4M16 5v4"})]})},analytics:{label:"Analytics",shortLabel:"Charts",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},scenarios:{label:"Scenarios",shortLabel:"Plans",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},budgets:{label:"Budgets",shortLabel:"Budget",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})},bills:{label:"Bills",shortLabel:"Bills",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},accounts:{label:"Accounts",shortLabel:"Money",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},transactions:{label:"Transactions",shortLabel:"History",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},categories:{label:"Categories",shortLabel:"Tags",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})},profile:{label:"Profile",shortLabel:"You",icon:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}};function yNe({activeTab:t,onNavigate:e,onBack:n,canGoBack:r=!1,className:i=""}){const[s,a]=T.useState(!1),o=l=>{e(l),a(!1)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`lg:hidden bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between ${i}`,children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[r&&n&&c.jsx("button",{onClick:n,className:"p-2 -ml-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Go back",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[Hw[t].icon,c.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:Hw[t].label})]})]}),c.jsx("button",{onClick:()=>a(!s),className:"p-2 text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Open navigation menu",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s?c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),s&&c.jsx("div",{className:"lg:hidden fixed inset-0 z-50 bg-black bg-opacity-50",onClick:()=>a(!1),children:c.jsxs("div",{className:"absolute top-0 right-0 w-64 h-full bg-white shadow-xl",onClick:l=>l.stopPropagation(),children:[c.jsx("div",{className:"p-4 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Navigation"}),c.jsx("button",{onClick:()=>a(!1),className:"p-1 text-gray-500 hover:text-gray-700",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsx("nav",{className:"p-2",children:Object.entries(Hw).map(([l,u])=>c.jsxs("button",{onClick:()=>o(l),className:`w-full flex items-center space-x-3 p-3 rounded-lg text-left transition-colors ${t===l?"bg-primary/10 text-primary font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx("span",{className:t===l?"text-primary":"text-gray-500",children:u.icon}),c.jsx("span",{children:u.label})]},l))})]})}),c.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-2 py-2",children:c.jsxs("div",{className:"flex items-center justify-around",children:[Object.entries(Hw).slice(0,5).map(([l,u])=>c.jsxs("button",{onClick:()=>o(l),className:`flex flex-col items-center justify-center px-2 py-2 min-w-0 flex-1 transition-colors ${t===l?"text-primary":"text-gray-500 hover:text-gray-700"}`,children:[c.jsx("span",{className:"mb-1",children:u.icon}),c.jsx("span",{className:"text-xs font-medium truncate w-full text-center",children:u.shortLabel})]},l)),c.jsxs("button",{onClick:()=>a(!0),className:"flex flex-col items-center justify-center px-2 py-2 min-w-0 flex-1 text-gray-500 hover:text-gray-700 transition-colors",children:[c.jsx("svg",{className:"w-5 h-5 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),c.jsx("span",{className:"text-xs font-medium",children:"More"})]})]})})]})}const vNe={dashboard:{label:"Dashboard",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"})})},analytics:{label:"Analytics",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},scenarios:{label:"Scenarios",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})},budgets:{label:"Budgets",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})},bills:{label:"Bills",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},accounts:{label:"Accounts",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},transactions:{label:"Transactions",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},categories:{label:"Categories",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})},profile:{label:"Profile",icon:c.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}};function xNe({activeTab:t,onNavigate:e,className:n=""}){const r=(i,s)=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),e(s))};return c.jsx("nav",{className:`hidden lg:block border-b border-gray-200 ${n}`,"aria-label":"Main navigation",children:c.jsx("div",{className:"-mb-px flex space-x-8",children:Object.entries(vNe).map(([i,s])=>c.jsxs("button",{onClick:()=>e(i),onKeyDown:a=>r(a,i),className:`group inline-flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2 ${t===i?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,role:"tab","aria-selected":t===i,tabIndex:0,children:[c.jsx("span",{className:`transition-colors ${t===i?"text-primary":"text-gray-400 group-hover:text-gray-600"}`,children:s.icon}),c.jsx("span",{children:s.label})]},i))})})}const Fl={bug:{label:"Bug Report",icon:"",description:"Something is broken or not working as expected",color:"red",categories:["UI/Display Issue","Calculation Error","Navigation Problem","Data Not Saving","Performance Issue","Other"]},feature:{label:"Feature Request",icon:"",description:"Suggest a new feature or improvement",color:"blue",categories:["New Chart/Visualization","Better Mobile Experience","Export/Import","Automation","Integration","Other"]},help:{label:"Need Help",icon:"",description:"Get help with using the app",color:"green",categories:["How to Use Feature","Understanding Results","FIRE Strategy Questions","Account Setup","Troubleshooting","Other"]},feedback:{label:"General Feedback",icon:"",description:"Share your thoughts and suggestions",color:"purple",categories:["User Experience","Design Feedback","Feature Usefulness","Performance","Overall Satisfaction","Other"]},data:{label:"Data Issue",icon:"",description:"Problem with your financial data or calculations",color:"orange",categories:["Incorrect Calculations","Missing Data","Sync Issues","Import Problems","Data Export","Other"]}};function bNe({isOpen:t,onClose:e,initialType:n="help",initialTitle:r="",initialDescription:i=""}){const{user:s}=Mb(),[a,o]=T.useState({type:n,title:r,description:i,priority:"medium",category:Fl[n].categories[0],userEmail:(s==null?void 0:s.email)||"",browserInfo:RF(),currentPage:window.location.pathname,userAgent:navigator.userAgent,timestamp:new Date().toISOString()}),[l,u]=T.useState(!1),[d,f]=T.useState(!1),p=T.useRef(null),m=v=>{o(b=>({...b,type:v,category:Fl[v].categories[0]}))},y=async v=>{v.preventDefault(),u(!0);try{await _Ne(a),f(!0)}catch(b){console.error("Failed to submit issue:",b),alert("Failed to submit issue. Please try again.")}finally{u(!1)}},g=()=>{f(!1),o({type:"help",title:"",description:"",priority:"medium",category:Fl.help.categories[0],userEmail:(s==null?void 0:s.email)||"",browserInfo:RF(),currentPage:window.location.pathname,userAgent:navigator.userAgent,timestamp:new Date().toISOString()}),e()};return t?c.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:g}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsx("div",{className:"relative bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:d?c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:c.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),c.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Thank You for Your ",Fl[a.type].label,"!"]}),c.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:[a.type==="bug"&&"We'll investigate this issue and work on a fix. You can continue using the app.",a.type==="feature"&&"Your suggestion has been noted and we'll consider it for future updates.",a.type==="help"&&"Here are some quick resources while we prepare a detailed response:",a.type==="feedback"&&"Your feedback helps us improve the app. Thank you for taking the time to share!",a.type==="data"&&"We'll review this data issue. In the meantime, you can check your inputs in the relevant section."]}),a.type==="help"&&c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 text-left",children:[c.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"Quick Resources:"}),c.jsxs("ul",{className:"space-y-2 text-sm text-blue-800",children:[c.jsxs("li",{children:[" ",c.jsx("strong",{children:"FIRE Basics:"})," Start with Dashboard  Add a Scenario"]}),c.jsxs("li",{children:[" ",c.jsx("strong",{children:"Calculations:"})," All projections use Monte Carlo simulation"]}),c.jsxs("li",{children:[" ",c.jsx("strong",{children:"Data Entry:"})," Press 'N' for quick transaction entry"]}),c.jsxs("li",{children:[" ",c.jsx("strong",{children:"Strategy:"})," Try different scenarios to compare approaches"]})]})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsx("button",{onClick:g,className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:"Close"})})]})}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Help & Feedback"}),c.jsx("button",{onClick:g,className:"text-gray-400 hover:text-gray-600 transition-colors",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:y,className:"p-6 space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"What can we help you with?"}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:Object.entries(Fl).map(([v,b])=>c.jsx("button",{type:"button",onClick:()=>m(v),className:`p-3 rounded-lg border-2 text-left transition-all ${a.type===v?"border-primary bg-primary/10":"border-gray-200 hover:border-gray-300"}`,children:c.jsxs("div",{className:"flex items-start space-x-3",children:[c.jsx("span",{className:"text-lg",children:b.icon}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900",children:b.label}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:b.description})]})]})},v))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),c.jsx("select",{value:a.category,onChange:v=>o(b=>({...b,category:v.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0,children:Fl[a.type].categories.map(v=>c.jsx("option",{value:v,children:v},v))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),c.jsxs("select",{value:a.priority,onChange:v=>o(b=>({...b,priority:v.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[c.jsx("option",{value:"low",children:"Low - Minor issue or suggestion"}),c.jsx("option",{value:"medium",children:"Medium - Affects my workflow"}),c.jsx("option",{value:"high",children:"High - Blocks me from using the app"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:a.title,onChange:v=>o(b=>({...b,title:v.target.value})),placeholder:a.type==="bug"?"Brief description of the problem":a.type==="feature"?"Feature you'd like to see":a.type==="help"?"What do you need help with?":a.type==="feedback"?"Your feedback topic":"Data issue description",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Description ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("textarea",{ref:p,value:a.description,onChange:v=>o(b=>({...b,description:v.target.value})),placeholder:wNe(a.type),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-y",required:!0}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please provide as much detail as possible to help us assist you better."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (optional)"}),c.jsx("input",{type:"email",value:a.userEmail,onChange:v=>o(b=>({...b,userEmail:v.target.value})),placeholder:"your.email@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["We'll only use this to follow up on your ",Fl[a.type].label.toLowerCase(),"."]})]}),c.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:c.jsxs("details",{className:"cursor-pointer",children:[c.jsx("summary",{className:"text-sm font-medium text-gray-700 mb-2",children:"System Information (automatically included)"}),c.jsxs("div",{className:"text-xs text-gray-600 space-y-1 mt-2",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Page:"})," ",a.currentPage]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Browser:"})," ",a.browserInfo]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Timestamp:"})," ",new Date(a.timestamp).toLocaleString()]})]})]})}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:g,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",disabled:l||!a.title.trim()||!a.description.trim(),className:"flex-1 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Submitting...":`Submit ${Fl[a.type].label}`})]})]})]})})})]}):null}function RF(){const t=navigator.userAgent;return t.includes("Chrome")?"Chrome":t.includes("Firefox")?"Firefox":t.includes("Safari")?"Safari":t.includes("Edge")?"Edge":"Unknown"}function wNe(t){switch(t){case"bug":return`Please describe:
 What you were trying to do
 What happened instead
 Steps to reproduce the issue`;case"feature":return`Please describe:
 What feature you'd like to see
 How it would help you
 Any specific requirements`;case"help":return`Please describe:
 What you're trying to accomplish
 Where you're getting stuck
 What you've already tried`;case"feedback":return`Please share:
 What you like or dislike
 Suggestions for improvement
 Your overall experience`;case"data":return`Please describe:
 What data seems incorrect
 Expected vs actual results
 Which section/calculation is affected`;default:return"Please provide as much detail as possible..."}}async function _Ne(t){await new Promise(e=>setTimeout(e,1500)),console.log("Issue submitted:",t)}const Vk=[{type:"help",label:"Get Help",icon:"",description:"How to use features"},{type:"bug",label:"Report Bug",icon:"",description:"Something not working"},{type:"feature",label:"Request Feature",icon:"",description:"Suggest improvements"},{type:"feedback",label:"Give Feedback",icon:"",description:"Share your thoughts"}];function IF({variant:t="inline",size:e="md",context:n,className:r=""}){const[i,s]=T.useState(!1),{openModal:a}=yj(),o=T.useRef(null);T.useEffect(()=>{function f(p){o.current&&!o.current.contains(p.target)&&s(!1)}return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const l=f=>{const p=n?`${n}: `:"";a(f.type,p),s(!1)},u={sm:"px-2 py-1 text-xs",md:"px-3 py-2 text-sm",lg:"px-4 py-3 text-base"},d={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return t==="floating"?c.jsxs("div",{className:`fixed bottom-6 right-6 z-40 ${r}`,ref:o,children:[c.jsx("button",{onClick:()=>s(!i),className:"bg-primary text-white rounded-full p-3 shadow-lg hover:bg-primary/90 transition-all hover:scale-105",title:"Help & Feedback",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i&&c.jsx("div",{className:"absolute bottom-16 right-0 bg-white rounded-lg shadow-xl border border-gray-200 py-2 w-56 animate-in slide-in-from-bottom-2",children:Vk.map(f=>c.jsxs("button",{onClick:()=>l(f),className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors flex items-center space-x-3",children:[c.jsx("span",{className:"text-lg",children:f.icon}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900 text-sm",children:f.label}),c.jsx("div",{className:"text-xs text-gray-500",children:f.description})]})]},f.type))})]}):t==="icon"?c.jsxs("div",{className:`relative ${r}`,ref:o,children:[c.jsx("button",{onClick:()=>s(!i),className:"text-gray-500 hover:text-gray-700 transition-colors",title:"Help & Feedback",children:c.jsx("svg",{className:d[e],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),i&&c.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-xl border border-gray-200 py-2 w-48 z-50",children:Vk.map(f=>c.jsxs("button",{onClick:()=>l(f),className:"w-full px-3 py-2 text-left hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[c.jsx("span",{children:f.icon}),c.jsx("span",{className:"text-sm text-gray-900",children:f.label})]},f.type))})]}):c.jsxs("div",{className:`relative ${r}`,ref:o,children:[c.jsxs("button",{onClick:()=>s(!i),className:`${u[e]} border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors flex items-center space-x-2`,children:[c.jsx("svg",{className:d[e],fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.jsx("span",{children:"Help"})]}),i&&c.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white rounded-lg shadow-xl border border-gray-200 py-2 w-56 z-50",children:Vk.map(f=>c.jsxs("button",{onClick:()=>l(f),className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors flex items-center space-x-3",children:[c.jsx("span",{className:"text-lg",children:f.icon}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900 text-sm",children:f.label}),c.jsx("div",{className:"text-xs text-gray-500",children:f.description})]})]},f.type))})]})}function SNe(){const{getHelp:t}=yj();return T.useEffect(()=>{function e(n){n.shiftKey&&n.key==="?"&&(n.preventDefault(),t())}return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t]),null}function ANe(){const{user:t}=Mb(),e=_V(),[n,r]=T.useState(!1),i=yj(),{data:s=[]}=ar(),a=T.useMemo(()=>{var l;if(e.activeTab==="accounts"){try{const u=localStorage.getItem("lastSelectedAccountId")||void 0;if(u)return u}catch{}return(l=s[0])==null?void 0:l.id}},[e.activeTab,s]);T.useEffect(()=>{t&&yV().catch(l=>{Me.error("Setup error",l)})},[t]),T.useEffect(()=>{const l=u=>{u.target instanceof HTMLInputElement||u.target instanceof HTMLTextAreaElement||(u.key==="n"||u.key==="N")&&(u.preventDefault(),e.activeTab==="accounts"?window.dispatchEvent(new CustomEvent("open-account-add-modal")):r(!0))};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]),T.useEffect(()=>{e.activeTab==="accounts"&&n&&r(!1)},[e.activeTab,n]);const o=()=>{switch(e.activeTab){case"dashboard":return c.jsx(rF,{onNavigate:e.navigateToTab});case"analytics":return c.jsx(dAe,{});case"accounts":return c.jsx(AAe,{});case"transactions":return c.jsx(Eke,{});case"bills":return c.jsx(Lke,{});case"budgets":return c.jsx(eAe,{});case"scenarios":return c.jsx(iNe,{initialSelectedScenarioId:e.selectedScenarioId});case"categories":return c.jsx(dNe,{});case"profile":return c.jsx(mNe,{});default:return c.jsx(rF,{onNavigate:e.navigateToTab})}};return c.jsxs("div",{className:"min-h-screen bg-background",children:[c.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[c.jsxs("header",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"FIRE Finance"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Track your path to Financial Independence"})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(IF,{variant:"inline",size:"sm"}),c.jsx("button",{onClick:()=>{e.activeTab==="accounts"?window.dispatchEvent(new CustomEvent("open-account-add-modal")):r(!0)},className:"px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx("span",{children:"Add Transaction"}),c.jsx("kbd",{className:"px-2 py-0.5 text-xs bg-white/20 rounded",children:"N"})]})})]})]}),c.jsx(yNe,{activeTab:e.activeTab,onNavigate:l=>e.navigateToTab(l,{resetScenario:l==="scenarios"}),onBack:e.canGoBack?e.navigateBack:void 0,canGoBack:e.canGoBack}),c.jsx(xNe,{activeTab:e.activeTab,onNavigate:l=>e.navigateToTab(l,{resetScenario:l==="scenarios"}),className:"mt-6"}),e.breadcrumbs.length>1&&c.jsx("div",{className:"mt-4 px-4 lg:px-0",children:c.jsx(gNe,{items:e.breadcrumbs})})]}),c.jsx("main",{className:"pb-20 lg:pb-0",children:o()})]}),e.activeTab!=="accounts"&&c.jsx(jAe,{isOpen:n,onClose:()=>r(!1),defaultAccountId:a,lockAccountSelection:!!a}),c.jsx(bNe,{isOpen:i.modalState.isOpen,onClose:i.closeModal,initialType:i.modalState.initialType,initialTitle:i.modalState.initialTitle,initialDescription:i.modalState.initialDescription}),c.jsx(IF,{variant:"floating"}),c.jsx(SNe,{})]})}const jNe=new vq({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}});Yk.createRoot(document.getElementById("root")).render(c.jsx(D.StrictMode,{children:c.jsx(xq,{client:jNe,children:c.jsx(aNe,{children:c.jsx(fV,{children:c.jsx(mV,{children:c.jsx(ANe,{})})})})})}));
//# sourceMappingURL=index-4-GoaDon.js.map
